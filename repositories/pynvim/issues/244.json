{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "I've created [benchmark](https://gist.github.com/purpleP/626faf5c1cbcd204c6478f57e76dc518) that compares your current approach with the one I'm suggesting.\r\n\r\nYou can run this with `pytest` and with `pytest-benchmark` installed. But here's the result on my machine\r\n\r\n```\r\n----------------------------------------------------------------------------------------- benchmark: 2 tests ----------------------------------------------------------------------------------------\r\nName (time in ns)                   Min                     Max                    Mean                 StdDev                  Median                 IQR            Outliers(*)  Rounds  Iterations\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\ntest_strategies[store]         277.6878 (1.0)       12,090.6252 (1.0)          306.9411 (1.0)          77.6767 (1.0)          285.0002 (1.0)        5.2505 (1.0)      13192;46481  199721          16\r\ntest_strategies[tag]       139,222.0001 (501.36)   436,723.9890 (36.12)    147,089.0559 (479.21)   23,119.3189 (297.64)   140,545.0021 (493.14)   772.4993 (147.13)        77;2841399           1\r\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n(*) Outliers: 1 Standard Deviation from Mean; 1.5 IQR (InterQuartile Range) from 1st Quartile and 3rd Quartile.\r\n============================================================================= 2 passed in 3.77 seconds ==============================================================================\r\n```\r\n\r\nAs you can see your current approach is  almost 500 times slower.\r\n\r\nI can see only one reason for not changing that - which is some user could have defined this `_store` variable, but\r\n    1. This can be mitigated by using some more or less unique name.\r\n    2. You already have this problem in class decorators. Because if user for some evil reason had class attribute `_nvim_plugin` you would overwrite it.\r\n\r\nSo you already have the same problem with exactly the same solution (using unique name).\r\n\r\nNotice that for 100 functions the time that is needed to find tagged function is more than 100 ms. That's 100 ms of startup time of neovim. For me neovim startup time is about 300-400 ms. That means that for users, that use a lot of python plugins (or plugins that exports a lot of functions) this can be significant portion of startup time. And that's one of the things that I like about vim/neovim. That is so fast to start. Another 100 ms would make it even better.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Very nice. I don't think anyone's attached to the current approach. Are you willing to send a PR? cc @bfredl @tarruda ",
            "created_at": "2017-01-15T01:35:27Z",
            "html_url": "https://github.com/neovim/pynvim/issues/244#issuecomment-272666918",
            "id": 272666918,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/244",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY2NjkxOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272666918/reactions"
            },
            "updated_at": "2017-01-15T01:35:27Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272666918",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "@justinmk Okay, It seems that working late isn't good for me, because I've mistakenly thought that 139,222.0001 ns is 139 ms, but in fact it is 139 us, which isn't that bad. But I'm still enthusiastic about relative performance improvement. I will try to create pull request later.",
            "created_at": "2017-01-15T11:42:11Z",
            "html_url": "https://github.com/neovim/pynvim/issues/244#issuecomment-272689813",
            "id": 272689813,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/244",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjY4OTgxMw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272689813/reactions"
            },
            "updated_at": "2017-01-15T11:42:11Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272689813",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6205841?v=4",
                "events_url": "https://api.github.com/users/purpleP/events{/privacy}",
                "followers_url": "https://api.github.com/users/purpleP/followers",
                "following_url": "https://api.github.com/users/purpleP/following{/other_user}",
                "gists_url": "https://api.github.com/users/purpleP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/purpleP",
                "id": 6205841,
                "login": "purpleP",
                "node_id": "MDQ6VXNlcjYyMDU4NDE=",
                "organizations_url": "https://api.github.com/users/purpleP/orgs",
                "received_events_url": "https://api.github.com/users/purpleP/received_events",
                "repos_url": "https://api.github.com/users/purpleP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/purpleP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/purpleP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/purpleP",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@purpleP Ok, first thing to do would be to verify that startup time of nvim improves after making the change. Else the change won't be worth it.",
            "created_at": "2017-01-15T16:09:11Z",
            "html_url": "https://github.com/neovim/pynvim/issues/244#issuecomment-272704702",
            "id": 272704702,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/244",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjcwNDcwMg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272704702/reactions"
            },
            "updated_at": "2017-01-15T16:09:11Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272704702",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Well, I'll do that just for fun (if I would have time) and you can decide wether you want to merge it or not.",
            "created_at": "2017-01-15T16:36:36Z",
            "html_url": "https://github.com/neovim/pynvim/issues/244#issuecomment-272706493",
            "id": 272706493,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/244",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjcwNjQ5Mw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272706493/reactions"
            },
            "updated_at": "2017-01-15T16:36:36Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/272706493",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6205841?v=4",
                "events_url": "https://api.github.com/users/purpleP/events{/privacy}",
                "followers_url": "https://api.github.com/users/purpleP/followers",
                "following_url": "https://api.github.com/users/purpleP/following{/other_user}",
                "gists_url": "https://api.github.com/users/purpleP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/purpleP",
                "id": 6205841,
                "login": "purpleP",
                "node_id": "MDQ6VXNlcjYyMDU4NDE=",
                "organizations_url": "https://api.github.com/users/purpleP/orgs",
                "received_events_url": "https://api.github.com/users/purpleP/received_events",
                "repos_url": "https://api.github.com/users/purpleP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/purpleP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/purpleP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/purpleP",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/pynvim/issues/244/comments",
    "created_at": "2017-01-14T23:09:29Z",
    "events_url": "https://api.github.com/repos/neovim/pynvim/issues/244/events",
    "html_url": "https://github.com/neovim/pynvim/issues/244",
    "id": 200835724,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [],
    "labels_url": "https://api.github.com/repos/neovim/pynvim/issues/244/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWUyMDA4MzU3MjQ=",
    "number": 244,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/neovim/pynvim/issues/244/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/pynvim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/pynvim/issues/244/timeline",
    "title": "Improve startup time by storing plugin function in module variable instead of using tagging and inspect",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-09-22T19:34:17Z",
    "url": "https://api.github.com/repos/neovim/pynvim/issues/244",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/6205841?v=4",
        "events_url": "https://api.github.com/users/purpleP/events{/privacy}",
        "followers_url": "https://api.github.com/users/purpleP/followers",
        "following_url": "https://api.github.com/users/purpleP/following{/other_user}",
        "gists_url": "https://api.github.com/users/purpleP/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/purpleP",
        "id": 6205841,
        "login": "purpleP",
        "node_id": "MDQ6VXNlcjYyMDU4NDE=",
        "organizations_url": "https://api.github.com/users/purpleP/orgs",
        "received_events_url": "https://api.github.com/users/purpleP/received_events",
        "repos_url": "https://api.github.com/users/purpleP/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/purpleP/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/purpleP/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/purpleP",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": null,
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Peek usually doesn't pop. Perhaps `try_next_message`   ?\n",
            "created_at": "2016-07-07T18:45:38Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-231170832",
            "id": 231170832,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTE3MDgzMg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/231170832/reactions"
            },
            "updated_at": "2016-07-07T18:45:38Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/231170832",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Peek is the most general API, as `try_next_message` (`next_message(block=False)` ?) could be implemented as\n\n```\nif nvim.peek_message():\n    msg = nvim.next_message()\n    # do stuff with msg\n```\n\nbut of course we can have both.\n",
            "created_at": "2016-07-07T18:48:59Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-231171740",
            "id": 231171740,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzMTE3MTc0MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/231171740/reactions"
            },
            "updated_at": "2016-07-07T18:48:59Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/231171740",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Chiming in for a me too:). I'm trying to implement a plugin for [GhostText](https://addons.mozilla.org/en-US/firefox/addon/ghosttext/) and basically need two workers that both need to be on the main thread since they call nvim apis. I don't have a good understanding of the underlying libuv event loop - but as of now, I'm running into all sorts of problems because nvim.next_message() blocks. I've tried python threads and gevent greenlets but basically pulling my hair out now :)\r\n\r\nAn alternative may be to provide a `nvim.next_message(timeout)` - and looks like it was there earlier but removed (see [Issue 12](https://github.com/neovim/python-client/issues/12)).\r\n\r\nFor my case, I even tried to implement the approach alluded to there by having a timer job post a notification so that next_message gets unblocked - but even that is flaky at best.\r\n\r\nIt would also help a lot to have some documentation on dos and donts of usage  - esp for folks who don't fully grok the libuv event loop.\r\n",
            "created_at": "2017-11-08T10:56:34Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-342782831",
            "id": 342782831,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0Mjc4MjgzMQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/342782831/reactions"
            },
            "updated_at": "2017-11-08T10:56:34Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/342782831",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/516267?v=4",
                "events_url": "https://api.github.com/users/raghur/events{/privacy}",
                "followers_url": "https://api.github.com/users/raghur/followers",
                "following_url": "https://api.github.com/users/raghur/following{/other_user}",
                "gists_url": "https://api.github.com/users/raghur/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/raghur",
                "id": 516267,
                "login": "raghur",
                "node_id": "MDQ6VXNlcjUxNjI2Nw==",
                "organizations_url": "https://api.github.com/users/raghur/orgs",
                "received_events_url": "https://api.github.com/users/raghur/received_events",
                "repos_url": "https://api.github.com/users/raghur/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/raghur/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/raghur/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/raghur",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The most scalable way to integrate multiple event sources and yieldable workers is to use the event loop `nvim.run_loop(request_cb,  notification_cb, setup_cb)` and not `nvim.next_message`. It implements a gevent-like interface, also using greenlets. But I agree it is poorly documented.",
            "created_at": "2017-11-08T11:45:50Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-342793896",
            "id": 342793896,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0Mjc5Mzg5Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/342793896/reactions"
            },
            "updated_at": "2017-11-08T11:45:50Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/342793896",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "@bfredl thanks.. can you point me to some more documentation/details on how to use nvim.run_loop?",
            "created_at": "2017-11-09T01:49:00Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-343021521",
            "id": 343021521,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzAyMTUyMQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343021521/reactions"
            },
            "updated_at": "2017-11-09T01:49:00Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343021521",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/516267?v=4",
                "events_url": "https://api.github.com/users/raghur/events{/privacy}",
                "followers_url": "https://api.github.com/users/raghur/followers",
                "following_url": "https://api.github.com/users/raghur/following{/other_user}",
                "gists_url": "https://api.github.com/users/raghur/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/raghur",
                "id": 516267,
                "login": "raghur",
                "node_id": "MDQ6VXNlcjUxNjI2Nw==",
                "organizations_url": "https://api.github.com/users/raghur/orgs",
                "received_events_url": "https://api.github.com/users/raghur/received_events",
                "repos_url": "https://api.github.com/users/raghur/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/raghur/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/raghur/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/raghur",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "So I tried to `nvim.run_loop` with gevent greenlets and hasn't worked out well. It's most likely my poor understanding of the nvim.run_loop - but could it be that mixing Gevent greenlets with the run_loop greenlets is causing problems? One thing I do know is that Gevent has it's own event loop - the hub - but this would mean that the greenlets in nvim.run_loop are unaware of this?\r\n\r\nJust looking for somsalksjfe advice on how to use the python client. Is it better to just use threads while working with the python client? (I need to start a http server and on each request from the browser, start a websocket server. When a message arrives at the websocket channel, I need to open a buffer in nvim and whenever the buffer is modified, push back the modified text to the websocket channel.\r\n\r\nThanks for reading.",
            "created_at": "2017-11-10T12:56:57Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-343466538",
            "id": 343466538,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzQ2NjUzOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343466538/reactions"
            },
            "updated_at": "2017-11-10T12:56:57Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343466538",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/516267?v=4",
                "events_url": "https://api.github.com/users/raghur/events{/privacy}",
                "followers_url": "https://api.github.com/users/raghur/followers",
                "following_url": "https://api.github.com/users/raghur/following{/other_user}",
                "gists_url": "https://api.github.com/users/raghur/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/raghur",
                "id": 516267,
                "login": "raghur",
                "node_id": "MDQ6VXNlcjUxNjI2Nw==",
                "organizations_url": "https://api.github.com/users/raghur/orgs",
                "received_events_url": "https://api.github.com/users/raghur/received_events",
                "repos_url": "https://api.github.com/users/raghur/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/raghur/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/raghur/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/raghur",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Literally mixing with gevent code will likely never work, what I meant is that it implements a gevent-like abstraction: you typically don't need to suspend and resume greenlets yourself, rather, when you do `nvim.some_blocking_method()` inside a event handler (or even `setub_cb`), nvim will suspend the greenlet and potentially let other event handlers run, or even a callback scheduled by another thread using `nvim.async_call(callable, args)` (which is the _only_ thread-safe function)",
            "created_at": "2017-11-10T13:31:54Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-343473926",
            "id": 343473926,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzQ3MzkyNg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343473926/reactions"
            },
            "updated_at": "2017-11-10T13:31:54Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343473926",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Got it. By the way, can I start multiple nvim.run_loop - one per thread? ",
            "created_at": "2017-11-11T04:39:10Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-343640262",
            "id": 343640262,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzY0MDI2Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343640262/reactions"
            },
            "updated_at": "2017-11-11T04:39:10Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343640262",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/516267?v=4",
                "events_url": "https://api.github.com/users/raghur/events{/privacy}",
                "followers_url": "https://api.github.com/users/raghur/followers",
                "following_url": "https://api.github.com/users/raghur/following{/other_user}",
                "gists_url": "https://api.github.com/users/raghur/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/raghur",
                "id": 516267,
                "login": "raghur",
                "node_id": "MDQ6VXNlcjUxNjI2Nw==",
                "organizations_url": "https://api.github.com/users/raghur/orgs",
                "received_events_url": "https://api.github.com/users/raghur/received_events",
                "repos_url": "https://api.github.com/users/raghur/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/raghur/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/raghur/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/raghur",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I _think_ you can, but you must have then created different `nvim` objects by multiple `neovim.attach` calls, and then always use the correct `nvim` instance in each loop.",
            "created_at": "2017-11-11T06:57:07Z",
            "html_url": "https://github.com/neovim/pynvim/issues/214#issuecomment-343645551",
            "id": 343645551,
            "issue_url": "https://api.github.com/repos/neovim/pynvim/issues/214",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzY0NTU1MQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343645551/reactions"
            },
            "updated_at": "2017-11-11T06:57:07Z",
            "url": "https://api.github.com/repos/neovim/pynvim/issues/comments/343645551",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 9,
    "comments_url": "https://api.github.com/repos/neovim/pynvim/issues/214/comments",
    "created_at": "2016-07-07T17:41:36Z",
    "events_url": "https://api.github.com/repos/neovim/pynvim/issues/214/events",
    "html_url": "https://github.com/neovim/pynvim/issues/214",
    "id": 164366729,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [],
    "labels_url": "https://api.github.com/repos/neovim/pynvim/issues/214/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWUxNjQzNjY3Mjk=",
    "number": 214,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/neovim/pynvim/issues/214/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/pynvim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/pynvim/issues/214/timeline",
    "title": "non-blocking next_message (peek_message)",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-09-22T19:34:19Z",
    "url": "https://api.github.com/repos/neovim/pynvim/issues/214",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
        "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
        "followers_url": "https://api.github.com/users/bfredl/followers",
        "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
        "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/bfredl",
        "id": 1363104,
        "login": "bfredl",
        "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
        "organizations_url": "https://api.github.com/users/bfredl/orgs",
        "received_events_url": "https://api.github.com/users/bfredl/received_events",
        "repos_url": "https://api.github.com/users/bfredl/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/bfredl",
        "user_view_type": "public"
    }
}
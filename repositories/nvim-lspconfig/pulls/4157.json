{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4157/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157/commits"
        },
        "html": {
            "href": "https://github.com/neovim/nvim-lspconfig/pull/4157"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4157"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/nvim-lspconfig/statuses/829d1858aa8014c1ecd34c7269e1a74b2fe2f4c5"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "FIRST_TIME_CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/nvim-lspconfig/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/nvim-lspconfig/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/nvim-lspconfig/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/nvim-lspconfig/branches{/branch}",
            "clone_url": "https://github.com/neovim/nvim-lspconfig.git",
            "collaborators_url": "https://api.github.com/repos/neovim/nvim-lspconfig/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/nvim-lspconfig/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/nvim-lspconfig/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/nvim-lspconfig/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/nvim-lspconfig/contributors",
            "created_at": "2019-11-13T17:12:28Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/deployments",
            "description": "Quickstart configs for Nvim LSP",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/nvim-lspconfig/downloads",
            "events_url": "https://api.github.com/repos/neovim/nvim-lspconfig/events",
            "fork": false,
            "forks": 2365,
            "forks_count": 2365,
            "forks_url": "https://api.github.com/repos/neovim/nvim-lspconfig/forks",
            "full_name": "neovim/nvim-lspconfig",
            "git_commits_url": "https://api.github.com/repos/neovim/nvim-lspconfig/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/nvim-lspconfig/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/nvim-lspconfig/git/tags{/sha}",
            "git_url": "git://github.com/neovim/nvim-lspconfig.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": false,
            "has_wiki": true,
            "homepage": "",
            "hooks_url": "https://api.github.com/repos/neovim/nvim-lspconfig/hooks",
            "html_url": "https://github.com/neovim/nvim-lspconfig",
            "id": 221512407,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/nvim-lspconfig/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/nvim-lspconfig/labels{/name}",
            "language": "Lua",
            "languages_url": "https://api.github.com/repos/neovim/nvim-lspconfig/languages",
            "license": {
                "key": "apache-2.0",
                "name": "Apache License 2.0",
                "node_id": "MDc6TGljZW5zZTI=",
                "spdx_id": "Apache-2.0",
                "url": "https://api.github.com/licenses/apache-2.0"
            },
            "merges_url": "https://api.github.com/repos/neovim/nvim-lspconfig/merges",
            "milestones_url": "https://api.github.com/repos/neovim/nvim-lspconfig/milestones{/number}",
            "mirror_url": null,
            "name": "nvim-lspconfig",
            "node_id": "MDEwOlJlcG9zaXRvcnkyMjE1MTI0MDc=",
            "notifications_url": "https://api.github.com/repos/neovim/nvim-lspconfig/notifications{?since,all,participating}",
            "open_issues": 36,
            "open_issues_count": 36,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls{/number}",
            "pushed_at": "2025-11-03T23:42:41Z",
            "releases_url": "https://api.github.com/repos/neovim/nvim-lspconfig/releases{/id}",
            "size": 7172,
            "ssh_url": "git@github.com:neovim/nvim-lspconfig.git",
            "stargazers_count": 12948,
            "stargazers_url": "https://api.github.com/repos/neovim/nvim-lspconfig/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/nvim-lspconfig/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/nvim-lspconfig/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/nvim-lspconfig/subscription",
            "svn_url": "https://github.com/neovim/nvim-lspconfig",
            "tags_url": "https://api.github.com/repos/neovim/nvim-lspconfig/tags",
            "teams_url": "https://api.github.com/repos/neovim/nvim-lspconfig/teams",
            "topics": [
                "language-server",
                "language-server-protocol",
                "lsp",
                "neovim",
                "nvim",
                "plugin",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/nvim-lspconfig/git/trees{/sha}",
            "updated_at": "2025-11-11T00:40:36Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig",
            "visibility": "public",
            "watchers": 12948,
            "watchers_count": 12948,
            "web_commit_signoff_required": false
        },
        "sha": "2010fc6ec03e2da552b4886fceb2f7bc0fc2e9c0",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "# Add GitLab Duo Language Server configuration\r\n\r\n## Summary\r\n\r\nThis PR adds support for the [GitLab Duo Language Server](https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp), enabling AI-powered code suggestions through the Language Server Protocol.\r\n\r\n## What is GitLab Duo?\r\n\r\nGitLab Duo is GitLab's AI-powered coding assistant that provides intelligent code completion and suggestions directly in your editor. The LSP implementation allows any LSP-compatible editor to integrate with GitLab Duo.\r\n\r\n## Key Features\r\n\r\n- **OAuth Device Flow Authentication**: Secure authentication using GitLab's OAuth device flow\r\n- **Automatic Token Refresh**: Handles token expiration and refresh automatically\r\n- **Inline Code Completion**: Native support for Neovim's inline completion API (requires Neovim 0.12+)\r\n- **Multi-language Support**: Works with 25+ programming languages including Python, JavaScript, TypeScript, Go, Rust, and more\r\n- **User Commands**: Convenient commands for authentication management:\r\n  - `:LspGitLabDuoSignIn` - Authenticate with GitLab\r\n  - `:LspGitLabDuoSignOut` - Sign out and remove tokens\r\n  - `:LspGitLabDuoStatus` - View authentication status\r\n\r\n## Prerequisites\r\n\r\n- Node.js and npm installed\r\n- GitLab account with Duo Pro license\r\n- Neovim 0.12+ (for inline completion support)\r\n\r\n## Current Limitations\r\n\r\n**This initial implementation only supports GitLab.com.** Support for self-managed GitLab instances will be added in a future iteration. The configuration is structured to make this addition straightforward when the OAuth application setup is documented for self-managed instances.\r\n\r\n## Usage\r\n\r\n### Basic Setup\r\n\r\n```lua\r\nvim.lsp.enable(\"gitlab_duo\")\r\n```\r\n\r\n### Enable Inline Completion\r\n\r\nAdd this to your config to enable inline completions with Tab acceptance:\r\n\r\n```lua\r\nvim.api.nvim_create_autocmd('LspAttach', {\r\n  callback = function(args)\r\n    local client = vim.lsp.get_client_by_id(args.data.client_id)\r\n    \r\n    if client and client.name == 'gitlab' and vim.lsp.inline_completion then\r\n      vim.lsp.inline_completion.enable(true, { bufnr = args.buf })\r\n      \r\n      -- Tab to accept\r\n      vim.keymap.set('i', '<Tab>', function()\r\n        if vim.lsp.inline_completion.is_visible() then\r\n          return vim.lsp.inline_completion.accept()\r\n        else\r\n          return '<Tab>'\r\n        end\r\n      end, { expr = true, buffer = args.buf })\r\n    end\r\n  end\r\n})\r\n```\r\n\r\n### Authentication Flow\r\n\r\n1. Run `:LspGitLabDuoSignIn` in any buffer with the LSP attached\r\n2. Your browser will open to GitLab's authorization page\r\n3. Authorize the application\r\n4. The LSP will automatically authenticate and start providing suggestions\r\n\r\nTokens are stored locally and refreshed automatically.\r\n\r\n## Implementation Details\r\n\r\n- Uses `npx` to run the GitLab LSP package from GitLab's npm registry\r\n- Implements OAuth device flow for secure authentication\r\n- Token storage in Neovim's data directory\r\n- Automatic token refresh with 60-second expiration buffer\r\n- Error handling for token validation and feature state changes\r\n- Telemetry disabled by default\r\n- Hardcoded to gitlab.com in this iteration\r\n\r\n## Testing\r\n\r\nTested on:\r\n- Neovim v0.12+\r\n- Multiple file types (Lua, Python, JavaScript, TypeScript, Go, Rust)\r\n- Token refresh flow\r\n- Authentication error handling\r\n\r\n## Future Enhancements\r\n\r\n- Support for self-managed GitLab instances with custom URLs\r\n- Configurable OAuth client credentials for self-managed setups\r\n\r\n## Related Links\r\n\r\n- [GitLab LSP Repository](https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp)\r\n- [GitLab Duo Documentation](https://docs.gitlab.com/ee/user/project/repository/code_suggestions/)\r\n\r\n\r\n<img width=\"617\" height=\"474\" alt=\"Screenshot 2025-11-08 at 7 55 25 PM\" src=\"https://github.com/user-attachments/assets/771c93d3-5de3-4dc8-a215-49a375716d98\" />\r\n<img width=\"617\" height=\"474\" alt=\"Screenshot 2025-11-08 at 7 55 46 PM\" src=\"https://github.com/user-attachments/assets/1944648d-8806-4729-8877-898b6e8c9296\" />\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2466940180"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466940180"
                }
            },
            "author_association": "MEMBER",
            "body": "Nvim 0.12 has `vim.net.request` but currently does not support POST :(\n\nWe have gone to a lot of trouble to keep all the configs in this repo totally \"isolated\" (self-contained), so would like to avoid a dependency on `plenary`.\n\nWriting a `curl` wrapper for the purposes of this config using `vim.system` should not be much code.\n\nAlternatively, we are interested in gaining POST support for `vim.net.request` if you want to work on that.",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-10-27T20:08:56Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+local curl = require('plenary.curl')",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2466940180",
            "id": 2466940180,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TCoUU",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 52,
            "original_position": 52,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3385274027,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466940180/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-27T20:14:10Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466940180",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2466951023"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466951023"
                }
            },
            "author_association": "MEMBER",
            "body": "can we drop this condition? similar to https://github.com/neovim/nvim-lspconfig/blob/master/lsp/copilot.lua , there is nothing service-specific about inline_completion. The `desc` field should be generic like in the copilot config.",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-10-27T20:12:03Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2466951023",
            "id": 2466951023,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TCq9v",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 27,
            "original_position": 27,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3385288611,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466951023/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-27T20:12:03Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466951023",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2466965843"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466965843"
                }
            },
            "author_association": "MEMBER",
            "body": "Just mentioning: users can provide arbitrary fields using `vim.lsp.config()`:\n\n```lua\nvim.lsp.config('gitlab_duo', {\n  gitlab_duo = {\n    gitlab_url = '...',\n  },\n})\n```\n\nThen in callbacks such as `cmd()` in this config, which are passed a `config` object, you can access those fields:\n\n```lua\ncmd = function(..., config)\n  local foo = config.gitlab_duo\n  ...\nend)\n```",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-10-27T20:17:54Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+local curl = require('plenary.curl')\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2466965843",
            "id": 2466965843,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TCulT",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 56,
            "original_position": 56,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3385309744,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466965843/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-27T20:17:54Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2466965843",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2470225565"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470225565"
                }
            },
            "author_association": "NONE",
            "body": "I removed plenary dependency, thanks to Claude. I'm new to lua, So I may not be able to make substantial contributions for now",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-10-28T16:22:30Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+local curl = require('plenary.curl')",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2470225565",
            "id": 2470225565,
            "in_reply_to_id": 2466940180,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TPKad",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 52,
            "original_position": 52,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3389692937,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470225565/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-28T16:22:31Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470225565",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2470231274"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470231274"
                }
            },
            "author_association": "NONE",
            "body": "@justinmk  It is now removed, I was bit worried if it can have unexpected behaviours if we haven't added allow list of client names. ",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-10-28T16:23:56Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2470231274",
            "id": 2470231274,
            "in_reply_to_id": 2466951023,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TPLzq",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 27,
            "original_position": 27,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3389700763,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470231274/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-28T16:23:56Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470231274",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2470234917"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470234917"
                }
            },
            "author_association": "NONE",
            "body": "@justinmk I couldn't get this working, cmd expects a table, not a function, right ?",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-10-28T16:24:49Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+local curl = require('plenary.curl')\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2470234917",
            "id": 2470234917,
            "in_reply_to_id": 2466965843,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TPMsl",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 56,
            "original_position": 56,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3389705335,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470234917/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-28T16:24:50Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2470234917",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471483077"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471483077"
                }
            },
            "author_association": "MEMBER",
            "body": "`cmd` can be a function. Example https://github.com/neovim/nvim-lspconfig/blob/cbd1e91296189a765094810de1b71a04e2597579/lsp/leanls.lua#L16-L19",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-10-29T01:13:16Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+local curl = require('plenary.curl')\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471483077",
            "id": 2471483077,
            "in_reply_to_id": 2466965843,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TT9bF",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 56,
            "original_position": 56,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3391379380,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471483077/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-29T01:13:16Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471483077",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471484012"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471484012"
                }
            },
            "author_association": "MEMBER",
            "body": "avoid `*` since the doc gen might not be smart enough to remove it, and `:help` will flag it as an invalid tag\n```suggestion\n--- Prerequisites:\n```",
            "commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "created_at": "2025-10-29T01:14:04Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471484012",
            "id": 2471484012,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TT9ps",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 10,
            "original_position": 10,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3391381067,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471484012/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-29T01:14:04Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471484012",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471485138"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471485138"
                }
            },
            "author_association": "MEMBER",
            "body": "maybe a code comment that gives a reference about where this id came from. e.g. is it a personally generated thing or part of official gitlab docs.",
            "commit_id": "acc9021590c571b9a5c6e72f16e57afa113c4e57",
            "created_at": "2025-10-29T01:15:03Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471485138",
            "id": 2471485138,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TT97S",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 55,
            "original_position": 55,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3391383222,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471485138/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-29T01:15:03Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471485138",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471490363"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471490363"
                }
            },
            "author_association": "MEMBER",
            "body": "can save code here by using `vim.fn.readblob()`",
            "commit_id": "e7251591d29a6ea730abd38deb2c7e02996eb252",
            "created_at": "2025-10-29T01:19:33Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  local file = io.open(config.token_file, 'r')\n+  if file then\n+    local content = file:read('*all')\n+    file:close()",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471490363",
            "id": 2471490363,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TT_M7",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 122,
            "original_position": 122,
            "original_start_line": 119,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3391390744,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471490363/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-29T01:19:33Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471490363",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471497394"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471497394"
                }
            },
            "author_association": "MEMBER",
            "body": "might be better just to drop the `pcall` so that an actual error is thrown with a stacktrace.",
            "commit_id": "e7251591d29a6ea730abd38deb2c7e02996eb252",
            "created_at": "2025-10-29T01:26:33Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  local file = io.open(config.token_file, 'r')\n+  if file then\n+    local content = file:read('*all')\n+    file:close()\n+    local ok, token_data = pcall(vim.json.decode, content)\n+    if ok then\n+      return token_data\n+    end\n+  end\n+  return nil\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, data = pcall(vim.json.decode, response.body)\n+  if not ok then\n+    vim.notify('Failed to parse authorization response', vim.log.levels.ERROR)\n+    return nil\n+  end",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471497394",
            "id": 2471497394,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TUA6y",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 202,
            "original_position": 202,
            "original_start_line": 198,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3391398871,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471497394/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-29T01:26:33Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471497394",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471502399"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471502399"
                }
            },
            "author_association": "MEMBER",
            "body": "nit: can just a single `[[...]]` string with `vim.text.indent(0,...)` to dedent the text.",
            "commit_id": "e7251591d29a6ea730abd38deb2c7e02996eb252",
            "created_at": "2025-10-29T01:31:42Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  local file = io.open(config.token_file, 'r')\n+  if file then\n+    local content = file:read('*all')\n+    file:close()\n+    local ok, token_data = pcall(vim.json.decode, content)\n+    if ok then\n+      return token_data\n+    end\n+  end\n+  return nil\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, data = pcall(vim.json.decode, response.body)\n+  if not ok then\n+    vim.notify('Failed to parse authorization response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  local message = string.format(\n+    'GitLab Duo Authorization\\n\\n'\n+      .. '1. Open: %s\\n'\n+      .. '2. Enter code: %s\\n\\n'\n+      .. 'Code copied to clipboard. Waiting for authorization...',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471502399",
            "id": 2471502399,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TUCI_",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 280,
            "original_position": 280,
            "original_start_line": 276,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3391405092,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471502399/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-29T01:31:42Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471502399",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471503201"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471503201"
                }
            },
            "author_association": "MEMBER",
            "body": "use `vim.ui.open()`",
            "commit_id": "e7251591d29a6ea730abd38deb2c7e02996eb252",
            "created_at": "2025-10-29T01:32:28Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  local file = io.open(config.token_file, 'r')\n+  if file then\n+    local content = file:read('*all')\n+    file:close()\n+    local ok, token_data = pcall(vim.json.decode, content)\n+    if ok then\n+      return token_data\n+    end\n+  end\n+  return nil\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, data = pcall(vim.json.decode, response.body)\n+  if not ok then\n+    vim.notify('Failed to parse authorization response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  local message = string.format(\n+    'GitLab Duo Authorization\\n\\n'\n+      .. '1. Open: %s\\n'\n+      .. '2. Enter code: %s\\n\\n'\n+      .. 'Code copied to clipboard. Waiting for authorization...',\n+    auth_data.verification_uri,\n+    auth_data.user_code\n+  )\n+\n+  -- Copy code to clipboard\n+  vim.fn.setreg('+', auth_data.user_code)\n+  vim.fn.setreg('*', auth_data.user_code)\n+\n+  -- Show message with option to open browser\n+  local choice = vim.fn.confirm(message, '&Open Browser\\n&Continue')\n+\n+  if choice == 1 then\n+    -- Try to open browser\n+    local open_cmd = vim.fn.has('mac') == 1 and 'open'\n+      or vim.fn.has('unix') == 1 and 'xdg-open'\n+      or vim.fn.has('win32') == 1 and 'start'\n+\n+    if open_cmd then\n+      vim.fn.system(open_cmd .. ' ' .. auth_data.verification_uri)",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2471503201",
            "id": 2471503201,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TUCVh",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 299,
            "original_position": 299,
            "original_start_line": 294,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3391405982,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471503201/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-29T01:32:28Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2471503201",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2473431268"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2473431268"
                }
            },
            "author_association": "NONE",
            "body": "That is a neat API, thanks",
            "commit_id": "e7251591d29a6ea730abd38deb2c7e02996eb252",
            "created_at": "2025-10-29T14:25:12Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  local file = io.open(config.token_file, 'r')\n+  if file then\n+    local content = file:read('*all')\n+    file:close()\n+    local ok, token_data = pcall(vim.json.decode, content)\n+    if ok then\n+      return token_data\n+    end\n+  end\n+  return nil\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, data = pcall(vim.json.decode, response.body)\n+  if not ok then\n+    vim.notify('Failed to parse authorization response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  local message = string.format(\n+    'GitLab Duo Authorization\\n\\n'\n+      .. '1. Open: %s\\n'\n+      .. '2. Enter code: %s\\n\\n'\n+      .. 'Code copied to clipboard. Waiting for authorization...',\n+    auth_data.verification_uri,\n+    auth_data.user_code\n+  )\n+\n+  -- Copy code to clipboard\n+  vim.fn.setreg('+', auth_data.user_code)\n+  vim.fn.setreg('*', auth_data.user_code)\n+\n+  -- Show message with option to open browser\n+  local choice = vim.fn.confirm(message, '&Open Browser\\n&Continue')\n+\n+  if choice == 1 then\n+    -- Try to open browser\n+    local open_cmd = vim.fn.has('mac') == 1 and 'open'\n+      or vim.fn.has('unix') == 1 and 'xdg-open'\n+      or vim.fn.has('win32') == 1 and 'start'\n+\n+    if open_cmd then\n+      vim.fn.system(open_cmd .. ' ' .. auth_data.verification_uri)",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2473431268",
            "id": 2473431268,
            "in_reply_to_id": 2471503201,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TbZDk",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 299,
            "original_position": 299,
            "original_start_line": 294,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3393846506,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2473431268/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-29T14:25:13Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2473431268",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2473434133"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2473434133"
                }
            },
            "author_association": "NONE",
            "body": "I removed this and redirected to the browser by default.",
            "commit_id": "e7251591d29a6ea730abd38deb2c7e02996eb252",
            "created_at": "2025-10-29T14:25:35Z",
            "diff_hunk": "@@ -0,0 +1,473 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  local file = io.open(config.token_file, 'r')\n+  if file then\n+    local content = file:read('*all')\n+    file:close()\n+    local ok, token_data = pcall(vim.json.decode, content)\n+    if ok then\n+      return token_data\n+    end\n+  end\n+  return nil\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, data = pcall(vim.json.decode, response.body)\n+  if not ok then\n+    vim.notify('Failed to parse authorization response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  local message = string.format(\n+    'GitLab Duo Authorization\\n\\n'\n+      .. '1. Open: %s\\n'\n+      .. '2. Enter code: %s\\n\\n'\n+      .. 'Code copied to clipboard. Waiting for authorization...',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2473434133",
            "id": 2473434133,
            "in_reply_to_id": 2471502399,
            "line": null,
            "node_id": "PRRC_kwDODTQC186TbZwV",
            "original_commit_id": "261cf5ae82ed30835271654a530b7bf5f9c55fc9",
            "original_line": 280,
            "original_position": 280,
            "original_start_line": 276,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3393849988,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2473434133/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-29T14:25:35Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2473434133",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2474363051"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2474363051"
                }
            },
            "author_association": "MEMBER",
            "body": "and other cases...\n```suggestion\n--- Setup:\n```",
            "commit_id": "1fe0fc2913a0261e8d3f781084c09f1f48c8e99d",
            "created_at": "2025-10-29T17:35:59Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2474363051",
            "id": 2474363051,
            "line": null,
            "node_id": "PRRC_kwDODTQC186Te8ir",
            "original_commit_id": "1fe0fc2913a0261e8d3f781084c09f1f48c8e99d",
            "original_line": 15,
            "original_position": 15,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3394976359,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2474363051/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-29T17:36:00Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2474363051",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2474369623"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2474369623"
                }
            },
            "author_association": "MEMBER",
            "body": "this only happens once, at module-load time. if the token expires what then? i think `settings` can be modified in an `on_init` handler.",
            "commit_id": "829d1858aa8014c1ecd34c7269e1a74b2fe2f4c5",
            "created_at": "2025-10-29T17:38:40Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  if vim.fn.filereadable(config.token_file) == 0 then\n+    return nil\n+  end\n+\n+  local blob = vim.fn.readblob(config.token_file)\n+  return vim.json.decode(blob)\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local data = vim.json.decode(response.body)\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  vim.ui.open(auth_data.verification_uri .. '?user_code=' .. auth_data.user_code)\n+\n+  poll_for_token(auth_data.device_code, auth_data.interval or 5, client)\n+end\n+\n+---@param client vim.lsp.Client\n+local function sign_out(_, client)\n+  local ok = os.remove(config.token_file)\n+  if ok then\n+    vim.notify('Signed out. Token removed.', vim.log.levels.INFO)\n+    client.notify('workspace/didChangeConfiguration', {\n+      settings = { token = '' },\n+    })\n+  else\n+    vim.notify('Failed to remove token file', vim.log.levels.ERROR)\n+  end\n+end\n+\n+---@param client vim.lsp.Client\n+local function show_status(_, _client)\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    vim.notify('Not signed in. Run :LspGitLabDuoSignIn to authenticate.', vim.log.levels.INFO)\n+    return\n+  end\n+\n+  local info = {\n+    'GitLab Duo Status:',\n+    '',\n+    'Instance: ' .. config.gitlab_url,\n+    'Signed in: Yes',\n+    'Has refresh token: ' .. (token_data.refresh_token and 'Yes' or 'No'),\n+  }\n+\n+  if token_data.saved_at and token_data.expires_in then\n+    local time_left = token_data.expires_in - (os.time() - token_data.saved_at)\n+    if time_left > 0 then\n+      local hours = math.floor(time_left / 3600)\n+      local minutes = math.floor((time_left % 3600) / 60)\n+      table.insert(info, string.format('Token expires in: %dh %dm', hours, minutes))\n+    else\n+      table.insert(info, 'Token status: EXPIRED')\n+    end\n+  end\n+\n+  vim.notify(table.concat(info, '\\n'), vim.log.levels.INFO)\n+end\n+\n+---@type vim.lsp.Config\n+return {\n+  cmd = {\n+    'npx',\n+    '--registry=https://gitlab.com/api/v4/packages/npm/',\n+    '@gitlab-org/gitlab-lsp',\n+    '--stdio',\n+  },\n+  root_markers = { '.git' },\n+  filetypes = {\n+    'ruby',\n+    'go',\n+    'javascript',\n+    'typescript',\n+    'typescriptreact',\n+    'javascriptreact',\n+    'rust',\n+    'lua',\n+    'python',\n+    'java',\n+    'cpp',\n+    'c',\n+    'php',\n+    'cs',\n+    'kotlin',\n+    'swift',\n+    'scala',\n+    'vue',\n+    'svelte',\n+    'html',\n+    'css',\n+    'scss',\n+    'json',\n+    'yaml',\n+  },\n+  init_options = {\n+    editorInfo = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+    },\n+    editorPluginInfo = {\n+      name = 'Neovim LSP',\n+      version = tostring(vim.version()),\n+    },\n+    ide = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+      vendor = 'Neovim',\n+    },\n+    extension = {\n+      name = 'Neovim LSP Client',\n+      version = tostring(vim.version()),\n+    },\n+  },\n+  settings = {\n+    token = get_valid_token() or '',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2474369623",
            "id": 2474369623,
            "line": 373,
            "node_id": "PRRC_kwDODTQC186Te-JX",
            "original_commit_id": "1fe0fc2913a0261e8d3f781084c09f1f48c8e99d",
            "original_line": 373,
            "original_position": 372,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 373,
            "pull_request_review_id": 3394984595,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2474369623/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-29T17:38:40Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2474369623",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2476696451"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2476696451"
                }
            },
            "author_association": "NONE",
            "body": "@justinmk We already do that on `on_int` by checking the `/gitlab/token/check` call. We use `client.notify` to update this value in LSP",
            "commit_id": "829d1858aa8014c1ecd34c7269e1a74b2fe2f4c5",
            "created_at": "2025-10-30T07:32:39Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  if vim.fn.filereadable(config.token_file) == 0 then\n+    return nil\n+  end\n+\n+  local blob = vim.fn.readblob(config.token_file)\n+  return vim.json.decode(blob)\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local data = vim.json.decode(response.body)\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  vim.ui.open(auth_data.verification_uri .. '?user_code=' .. auth_data.user_code)\n+\n+  poll_for_token(auth_data.device_code, auth_data.interval or 5, client)\n+end\n+\n+---@param client vim.lsp.Client\n+local function sign_out(_, client)\n+  local ok = os.remove(config.token_file)\n+  if ok then\n+    vim.notify('Signed out. Token removed.', vim.log.levels.INFO)\n+    client.notify('workspace/didChangeConfiguration', {\n+      settings = { token = '' },\n+    })\n+  else\n+    vim.notify('Failed to remove token file', vim.log.levels.ERROR)\n+  end\n+end\n+\n+---@param client vim.lsp.Client\n+local function show_status(_, _client)\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    vim.notify('Not signed in. Run :LspGitLabDuoSignIn to authenticate.', vim.log.levels.INFO)\n+    return\n+  end\n+\n+  local info = {\n+    'GitLab Duo Status:',\n+    '',\n+    'Instance: ' .. config.gitlab_url,\n+    'Signed in: Yes',\n+    'Has refresh token: ' .. (token_data.refresh_token and 'Yes' or 'No'),\n+  }\n+\n+  if token_data.saved_at and token_data.expires_in then\n+    local time_left = token_data.expires_in - (os.time() - token_data.saved_at)\n+    if time_left > 0 then\n+      local hours = math.floor(time_left / 3600)\n+      local minutes = math.floor((time_left % 3600) / 60)\n+      table.insert(info, string.format('Token expires in: %dh %dm', hours, minutes))\n+    else\n+      table.insert(info, 'Token status: EXPIRED')\n+    end\n+  end\n+\n+  vim.notify(table.concat(info, '\\n'), vim.log.levels.INFO)\n+end\n+\n+---@type vim.lsp.Config\n+return {\n+  cmd = {\n+    'npx',\n+    '--registry=https://gitlab.com/api/v4/packages/npm/',\n+    '@gitlab-org/gitlab-lsp',\n+    '--stdio',\n+  },\n+  root_markers = { '.git' },\n+  filetypes = {\n+    'ruby',\n+    'go',\n+    'javascript',\n+    'typescript',\n+    'typescriptreact',\n+    'javascriptreact',\n+    'rust',\n+    'lua',\n+    'python',\n+    'java',\n+    'cpp',\n+    'c',\n+    'php',\n+    'cs',\n+    'kotlin',\n+    'swift',\n+    'scala',\n+    'vue',\n+    'svelte',\n+    'html',\n+    'css',\n+    'scss',\n+    'json',\n+    'yaml',\n+  },\n+  init_options = {\n+    editorInfo = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+    },\n+    editorPluginInfo = {\n+      name = 'Neovim LSP',\n+      version = tostring(vim.version()),\n+    },\n+    ide = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+      vendor = 'Neovim',\n+    },\n+    extension = {\n+      name = 'Neovim LSP Client',\n+      version = tostring(vim.version()),\n+    },\n+  },\n+  settings = {\n+    token = get_valid_token() or '',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2476696451",
            "id": 2476696451,
            "in_reply_to_id": 2474369623,
            "line": 373,
            "node_id": "PRRC_kwDODTQC186Tn2OD",
            "original_commit_id": "1fe0fc2913a0261e8d3f781084c09f1f48c8e99d",
            "original_line": 373,
            "original_position": 372,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 373,
            "pull_request_review_id": 3397793472,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2476696451/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-30T07:32:39Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2476696451",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2480025912"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480025912"
                }
            },
            "author_association": "MEMBER",
            "body": "Then just set this to `''` ? It is misleading to just sprinkle a `get_valid_token()` call here, which again will have side effects like network calls at module-load time. It's better to do things in one place.",
            "commit_id": "829d1858aa8014c1ecd34c7269e1a74b2fe2f4c5",
            "created_at": "2025-10-31T03:05:19Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  if vim.fn.filereadable(config.token_file) == 0 then\n+    return nil\n+  end\n+\n+  local blob = vim.fn.readblob(config.token_file)\n+  return vim.json.decode(blob)\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local data = vim.json.decode(response.body)\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  vim.ui.open(auth_data.verification_uri .. '?user_code=' .. auth_data.user_code)\n+\n+  poll_for_token(auth_data.device_code, auth_data.interval or 5, client)\n+end\n+\n+---@param client vim.lsp.Client\n+local function sign_out(_, client)\n+  local ok = os.remove(config.token_file)\n+  if ok then\n+    vim.notify('Signed out. Token removed.', vim.log.levels.INFO)\n+    client.notify('workspace/didChangeConfiguration', {\n+      settings = { token = '' },\n+    })\n+  else\n+    vim.notify('Failed to remove token file', vim.log.levels.ERROR)\n+  end\n+end\n+\n+---@param client vim.lsp.Client\n+local function show_status(_, _client)\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    vim.notify('Not signed in. Run :LspGitLabDuoSignIn to authenticate.', vim.log.levels.INFO)\n+    return\n+  end\n+\n+  local info = {\n+    'GitLab Duo Status:',\n+    '',\n+    'Instance: ' .. config.gitlab_url,\n+    'Signed in: Yes',\n+    'Has refresh token: ' .. (token_data.refresh_token and 'Yes' or 'No'),\n+  }\n+\n+  if token_data.saved_at and token_data.expires_in then\n+    local time_left = token_data.expires_in - (os.time() - token_data.saved_at)\n+    if time_left > 0 then\n+      local hours = math.floor(time_left / 3600)\n+      local minutes = math.floor((time_left % 3600) / 60)\n+      table.insert(info, string.format('Token expires in: %dh %dm', hours, minutes))\n+    else\n+      table.insert(info, 'Token status: EXPIRED')\n+    end\n+  end\n+\n+  vim.notify(table.concat(info, '\\n'), vim.log.levels.INFO)\n+end\n+\n+---@type vim.lsp.Config\n+return {\n+  cmd = {\n+    'npx',\n+    '--registry=https://gitlab.com/api/v4/packages/npm/',\n+    '@gitlab-org/gitlab-lsp',\n+    '--stdio',\n+  },\n+  root_markers = { '.git' },\n+  filetypes = {\n+    'ruby',\n+    'go',\n+    'javascript',\n+    'typescript',\n+    'typescriptreact',\n+    'javascriptreact',\n+    'rust',\n+    'lua',\n+    'python',\n+    'java',\n+    'cpp',\n+    'c',\n+    'php',\n+    'cs',\n+    'kotlin',\n+    'swift',\n+    'scala',\n+    'vue',\n+    'svelte',\n+    'html',\n+    'css',\n+    'scss',\n+    'json',\n+    'yaml',\n+  },\n+  init_options = {\n+    editorInfo = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+    },\n+    editorPluginInfo = {\n+      name = 'Neovim LSP',\n+      version = tostring(vim.version()),\n+    },\n+    ide = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+      vendor = 'Neovim',\n+    },\n+    extension = {\n+      name = 'Neovim LSP Client',\n+      version = tostring(vim.version()),\n+    },\n+  },\n+  settings = {\n+    token = get_valid_token() or '',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2480025912",
            "id": 2480025912,
            "in_reply_to_id": 2474369623,
            "line": 373,
            "node_id": "PRRC_kwDODTQC186T0jE4",
            "original_commit_id": "1fe0fc2913a0261e8d3f781084c09f1f48c8e99d",
            "original_line": 373,
            "original_position": 372,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 373,
            "pull_request_review_id": 3402397804,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480025912/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T03:05:19Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480025912",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2480026911"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480026911"
                }
            },
            "author_association": "MEMBER",
            "body": "I guess it wasn't clear but I was hoping that all cases would be looked at. Not just the ones I mentioned.",
            "commit_id": "acc9021590c571b9a5c6e72f16e57afa113c4e57",
            "created_at": "2025-10-31T03:06:21Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- Setup:\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2480026911",
            "id": 2480026911,
            "line": null,
            "node_id": "PRRC_kwDODTQC186T0jUf",
            "original_commit_id": "acc9021590c571b9a5c6e72f16e57afa113c4e57",
            "original_line": 20,
            "original_position": 20,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3402398975,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480026911/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T03:06:21Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480026911",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2480824798"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480824798"
                }
            },
            "author_association": "NONE",
            "body": "@justinmk No, I was planning to do it with the other things including making gitlab_url and application_id configurable. \r\n",
            "commit_id": "acc9021590c571b9a5c6e72f16e57afa113c4e57",
            "created_at": "2025-10-31T09:58:52Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- Setup:\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2480824798",
            "id": 2480824798,
            "in_reply_to_id": 2480026911,
            "line": null,
            "node_id": "PRRC_kwDODTQC186T3mHe",
            "original_commit_id": "acc9021590c571b9a5c6e72f16e57afa113c4e57",
            "original_line": 20,
            "original_position": 20,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3403434636,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480824798/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T09:58:52Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2480824798",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2506954525"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506954525"
                }
            },
            "author_association": "NONE",
            "body": "@justinmk I couldn't get configuration support working properly with config block, So I dropped  support for self managed instances from this iteration. Could you review rest of the changes ?",
            "commit_id": "acc9021590c571b9a5c6e72f16e57afa113c4e57",
            "created_at": "2025-11-08T14:29:44Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- Setup:\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2506954525",
            "id": 2506954525,
            "in_reply_to_id": 2480026911,
            "line": null,
            "node_id": "PRRC_kwDODTQC186VbRcd",
            "original_commit_id": "acc9021590c571b9a5c6e72f16e57afa113c4e57",
            "original_line": 20,
            "original_position": 20,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3438420918,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506954525/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-08T14:29:44Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506954525",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2506954760"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506954760"
                }
            },
            "author_association": "NONE",
            "body": "@justinmk Thanks, I dropped method call from settings",
            "commit_id": "829d1858aa8014c1ecd34c7269e1a74b2fe2f4c5",
            "created_at": "2025-11-08T14:30:19Z",
            "diff_hunk": "@@ -0,0 +1,440 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- Prerequisites:\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if vim.lsp.inline_completion and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',\n+  client_id = '5f1f9933c9bff0a3e908007703f260bf1ff87bcdb91d38279a9f0d0ddecceadf',\n+  scopes = 'api',\n+  token_file = vim.fn.stdpath('data') .. '/gitlab_duo_oauth.json',\n+}\n+\n+-- Helper function to make POST requests with curl via vim.system\n+local function curl_post(url, data, headers)\n+  local curl_args = {\n+    'curl',\n+    '-s',\n+    '-w',\n+    '\\n%{http_code}',\n+    '-X',\n+    'POST',\n+    url,\n+  }\n+\n+  -- Add headers\n+  for key, value in pairs(headers or {}) do\n+    table.insert(curl_args, '-H')\n+    table.insert(curl_args, key .. ': ' .. value)\n+  end\n+\n+  -- Add data\n+  if data then\n+    table.insert(curl_args, '-d')\n+    table.insert(curl_args, data)\n+  end\n+\n+  local result = vim.system(curl_args, { text = true }):wait()\n+\n+  -- Split body and status code\n+  local output = result.stdout or ''\n+  local body_end = output:match('.*\\n()%d+$')\n+\n+  local body = ''\n+  local status = 0\n+\n+  if body_end then\n+    body = output:sub(1, body_end - 2) -- -2 to remove trailing newline\n+    status = tonumber(output:match('\\n(%d+)$')) or 0\n+  else\n+    body = output\n+  end\n+\n+  return {\n+    status = status,\n+    body = body,\n+  }\n+end\n+\n+-- Token management\n+local function save_token(token_data)\n+  token_data.saved_at = os.time()\n+  local file = io.open(config.token_file, 'w')\n+  if file then\n+    file:write(vim.json.encode(token_data))\n+    file:close()\n+    return true\n+  end\n+  return false\n+end\n+\n+local function load_token()\n+  if vim.fn.filereadable(config.token_file) == 0 then\n+    return nil\n+  end\n+\n+  local blob = vim.fn.readblob(config.token_file)\n+  return vim.json.decode(blob)\n+end\n+\n+local function is_token_expired(token_data)\n+  if not token_data or not token_data.saved_at or not token_data.expires_in then\n+    return true\n+  end\n+  local token_age = os.time() - token_data.saved_at\n+  return token_age >= (token_data.expires_in - 60) -- 60 second buffer\n+end\n+\n+local function refresh_access_token(refresh_token)\n+  vim.notify('Refreshing GitLab OAuth token...', vim.log.levels.INFO)\n+\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/token',\n+    string.format('client_id=%s&refresh_token=%s&grant_type=refresh_token', config.client_id, refresh_token),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Failed to refresh token: ' .. (response.body or 'Unknown error'), vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local ok, body = pcall(vim.json.decode, response.body)\n+  if not ok or not body.access_token then\n+    vim.notify('Invalid refresh response', vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  save_token(body)\n+  vim.notify('Token refreshed successfully', vim.log.levels.INFO)\n+  return body\n+end\n+\n+local function get_valid_token()\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    return nil, 'no_token'\n+  end\n+\n+  if is_token_expired(token_data) then\n+    if token_data.refresh_token then\n+      local new_token_data = refresh_access_token(token_data.refresh_token)\n+      if new_token_data then\n+        return new_token_data.access_token, 'refreshed'\n+      end\n+      return nil, 'refresh_failed'\n+    end\n+    return nil, 'expired'\n+  end\n+\n+  return token_data.access_token, 'valid'\n+end\n+\n+-- OAuth Device Flow\n+local function device_authorization()\n+  local response = curl_post(\n+    config.gitlab_url .. '/oauth/authorize_device',\n+    string.format('client_id=%s&scope=%s', config.client_id, config.scopes),\n+    { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+  )\n+\n+  if response.status ~= 200 then\n+    vim.notify('Device authorization failed: ' .. response.status, vim.log.levels.ERROR)\n+    return nil\n+  end\n+\n+  local data = vim.json.decode(response.body)\n+\n+  return data\n+end\n+\n+local function poll_for_token(device_code, interval, client)\n+  local max_attempts = 60\n+  local attempts = 0\n+\n+  local function poll()\n+    attempts = attempts + 1\n+\n+    local response = curl_post(\n+      config.gitlab_url .. '/oauth/token',\n+      string.format(\n+        'client_id=%s&device_code=%s&grant_type=urn:ietf:params:oauth:grant-type:device_code',\n+        config.client_id,\n+        device_code\n+      ),\n+      { ['Content-Type'] = 'application/x-www-form-urlencoded' }\n+    )\n+\n+    local ok, body = pcall(vim.json.decode, response.body)\n+    if not ok then\n+      vim.notify('Failed to parse token response', vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    if response.status == 200 and body.access_token then\n+      save_token(body)\n+      vim.notify('GitLab Duo authentication successful!', vim.log.levels.INFO)\n+\n+      -- Update LSP with new token\n+      vim.schedule(function()\n+        client.notify('workspace/didChangeConfiguration', {\n+          settings = {\n+            token = body.access_token,\n+            baseUrl = config.gitlab_url,\n+          },\n+        })\n+      end)\n+      return\n+    end\n+\n+    if body.error == 'authorization_pending' then\n+      if attempts < max_attempts then\n+        vim.defer_fn(poll, interval * 1000)\n+      else\n+        vim.notify('Authorization timed out', vim.log.levels.ERROR)\n+      end\n+    elseif body.error == 'slow_down' then\n+      vim.defer_fn(poll, (interval + 5) * 1000)\n+    elseif body.error == 'access_denied' then\n+      vim.notify('Authorization denied', vim.log.levels.ERROR)\n+    elseif body.error == 'expired_token' then\n+      vim.notify('Device code expired. Please run :LspGitLabDuoSignIn again', vim.log.levels.ERROR)\n+    else\n+      vim.notify('OAuth error: ' .. (body.error or 'unknown'), vim.log.levels.ERROR)\n+    end\n+  end\n+\n+  poll()\n+end\n+\n+---@param bufnr integer\n+---@param client vim.lsp.Client\n+local function sign_in(_bufnr, client)\n+  vim.notify('Starting GitLab device authorization...', vim.log.levels.INFO)\n+\n+  local auth_data = device_authorization()\n+  if not auth_data then\n+    return\n+  end\n+\n+  vim.ui.open(auth_data.verification_uri .. '?user_code=' .. auth_data.user_code)\n+\n+  poll_for_token(auth_data.device_code, auth_data.interval or 5, client)\n+end\n+\n+---@param client vim.lsp.Client\n+local function sign_out(_, client)\n+  local ok = os.remove(config.token_file)\n+  if ok then\n+    vim.notify('Signed out. Token removed.', vim.log.levels.INFO)\n+    client.notify('workspace/didChangeConfiguration', {\n+      settings = { token = '' },\n+    })\n+  else\n+    vim.notify('Failed to remove token file', vim.log.levels.ERROR)\n+  end\n+end\n+\n+---@param client vim.lsp.Client\n+local function show_status(_, _client)\n+  local token_data = load_token()\n+\n+  if not token_data then\n+    vim.notify('Not signed in. Run :LspGitLabDuoSignIn to authenticate.', vim.log.levels.INFO)\n+    return\n+  end\n+\n+  local info = {\n+    'GitLab Duo Status:',\n+    '',\n+    'Instance: ' .. config.gitlab_url,\n+    'Signed in: Yes',\n+    'Has refresh token: ' .. (token_data.refresh_token and 'Yes' or 'No'),\n+  }\n+\n+  if token_data.saved_at and token_data.expires_in then\n+    local time_left = token_data.expires_in - (os.time() - token_data.saved_at)\n+    if time_left > 0 then\n+      local hours = math.floor(time_left / 3600)\n+      local minutes = math.floor((time_left % 3600) / 60)\n+      table.insert(info, string.format('Token expires in: %dh %dm', hours, minutes))\n+    else\n+      table.insert(info, 'Token status: EXPIRED')\n+    end\n+  end\n+\n+  vim.notify(table.concat(info, '\\n'), vim.log.levels.INFO)\n+end\n+\n+---@type vim.lsp.Config\n+return {\n+  cmd = {\n+    'npx',\n+    '--registry=https://gitlab.com/api/v4/packages/npm/',\n+    '@gitlab-org/gitlab-lsp',\n+    '--stdio',\n+  },\n+  root_markers = { '.git' },\n+  filetypes = {\n+    'ruby',\n+    'go',\n+    'javascript',\n+    'typescript',\n+    'typescriptreact',\n+    'javascriptreact',\n+    'rust',\n+    'lua',\n+    'python',\n+    'java',\n+    'cpp',\n+    'c',\n+    'php',\n+    'cs',\n+    'kotlin',\n+    'swift',\n+    'scala',\n+    'vue',\n+    'svelte',\n+    'html',\n+    'css',\n+    'scss',\n+    'json',\n+    'yaml',\n+  },\n+  init_options = {\n+    editorInfo = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+    },\n+    editorPluginInfo = {\n+      name = 'Neovim LSP',\n+      version = tostring(vim.version()),\n+    },\n+    ide = {\n+      name = 'Neovim',\n+      version = tostring(vim.version()),\n+      vendor = 'Neovim',\n+    },\n+    extension = {\n+      name = 'Neovim LSP Client',\n+      version = tostring(vim.version()),\n+    },\n+  },\n+  settings = {\n+    token = get_valid_token() or '',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2506954760",
            "id": 2506954760,
            "in_reply_to_id": 2474369623,
            "line": 373,
            "node_id": "PRRC_kwDODTQC186VbRgI",
            "original_commit_id": "1fe0fc2913a0261e8d3f781084c09f1f48c8e99d",
            "original_line": 373,
            "original_position": 372,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 373,
            "pull_request_review_id": 3438421135,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506954760/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-08T14:30:20Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506954760",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2506956497"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506956497"
                }
            },
            "author_association": "NONE",
            "body": "@justinmk Thanks, cmd does not requires gitlab_uri, it is required in the `workspace/didChangeConfiguration` call.  I couldn't find an easy way to pass this value around, we also need to make client_id configurable for self managed GitLab instances as the client_id will also be different. So I thought doing it in a separate iteration. ",
            "commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "created_at": "2025-11-08T14:34:20Z",
            "diff_hunk": "@@ -0,0 +1,426 @@\n+---@brief\n+---\n+--- GitLab Duo Language Server Configuration for Neovim\n+---\n+--- https://gitlab.com/gitlab-org/editor-extensions/gitlab-lsp\n+---\n+--- The GitLab LSP enables any editor or IDE to integrate with GitLab Duo\n+--- for AI-powered code suggestions via the Language Server Protocol.\n+---\n+--- **Prerequisites:**\n+--- - Node.js and npm installed\n+--- - GitLab account with Duo Pro license\n+--- - Internet connection for OAuth device flow\n+---\n+--- **Setup:**\n+--- 1. Run :LspGitLabDuoSignIn to start OAuth authentication\n+--- 2. Follow the browser prompts to authorize\n+--- 3. Enable inline completion in LspAttach event (see example below)\n+---\n+--- **Inline Completion Example:**\n+--- ```lua\n+--- vim.api.nvim_create_autocmd('LspAttach', {\n+---   callback = function(args)\n+---     local bufnr = args.buf\n+---     local client = assert(vim.lsp.get_client_by_id(args.data.client_id))\n+---\n+---     if client.name == 'gitlab_duo' and\n+---        client:supports_method(vim.lsp.protocol.Methods.textDocument_inlineCompletion, bufnr) then\n+---       vim.lsp.inline_completion.enable(true, { bufnr = bufnr })\n+---\n+---       -- Tab to accept suggestion\n+---       vim.keymap.set('i', '<Tab>', function()\n+---         if vim.lsp.inline_completion.is_visible() then\n+---           return vim.lsp.inline_completion.accept()\n+---         else\n+---           return '<Tab>'\n+---         end\n+---       end, { expr = true, buffer = bufnr, desc = 'GitLab Duo: Accept suggestion' })\n+---\n+---       -- Alt/Option+[ for previous suggestion\n+---       vim.keymap.set('i', '<M-[>', vim.lsp.inline_completion.select_prev,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Previous suggestion' })\n+---\n+---       -- Alt/Option+] for next suggestion\n+---       vim.keymap.set('i', '<M-]>', vim.lsp.inline_completion.select_next,\n+---         { buffer = bufnr, desc = 'GitLab Duo: Next suggestion' })\n+---     end\n+---   end\n+--- })\n+--- ```\n+\n+local curl = require('plenary.curl')\n+\n+-- Configuration\n+local config = {\n+  gitlab_url = vim.env.GITLAB_URL or 'https://gitlab.com',",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#discussion_r2506956497",
            "id": 2506956497,
            "in_reply_to_id": 2466965843,
            "line": null,
            "node_id": "PRRC_kwDODTQC186VbR7R",
            "original_commit_id": "e63b9ca42bcc5702c0980bd23bb261be1e7a89c3",
            "original_line": 56,
            "original_position": 56,
            "original_start_line": null,
            "path": "lsp/gitlab_duo.lua",
            "position": 1,
            "pull_request_review_id": 3438422490,
            "pull_request_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506956497/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-08T14:34:20Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments/2506956497",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "MEMBER",
            "body": "This is a lot of code which is normally discouraged in this repo, but it looks pretty good and points to some common use-cases that we need to start thinking about in the stdlib. And for supporting LSP/AI providers that require sign-in, it's good to have self-contained examples (another is `copilot.lua`) of what is required to complete that full process. \r\n\r\nSo I'm fine with this.",
            "created_at": "2025-10-29T01:36:59Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157#issuecomment-3459288687",
            "id": 3459288687,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4157",
            "node_id": "IC_kwDODTQC187OMI5v",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3459288687/reactions"
            },
            "updated_at": "2025-10-29T01:36:59Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3459288687",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4157/comments",
    "commits_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157/commits",
    "created_at": "2025-10-27T07:44:44Z",
    "diff_url": "https://github.com/neovim/nvim-lspconfig/pull/4157.diff",
    "draft": false,
    "head": {
        "label": "tachyons:patch-1",
        "ref": "patch-1",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/branches{/branch}",
            "clone_url": "https://github.com/tachyons/nvim-lspconfig.git",
            "collaborators_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/comments{/number}",
            "commits_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/commits{/sha}",
            "compare_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/contributors",
            "created_at": "2025-10-27T07:03:42Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/deployments",
            "description": "Quickstart configs for Nvim LSP",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/downloads",
            "events_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/forks",
            "full_name": "tachyons/nvim-lspconfig",
            "git_commits_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/git/tags{/sha}",
            "git_url": "git://github.com/tachyons/nvim-lspconfig.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "",
            "hooks_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/hooks",
            "html_url": "https://github.com/tachyons/nvim-lspconfig",
            "id": 1084064129,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/issues{/number}",
            "keys_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/labels{/name}",
            "language": null,
            "languages_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/languages",
            "license": {
                "key": "apache-2.0",
                "name": "Apache License 2.0",
                "node_id": "MDc6TGljZW5zZTI=",
                "spdx_id": "Apache-2.0",
                "url": "https://api.github.com/licenses/apache-2.0"
            },
            "merges_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/merges",
            "milestones_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/milestones{/number}",
            "mirror_url": null,
            "name": "nvim-lspconfig",
            "node_id": "R_kgDOQJ2BgQ",
            "notifications_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
                "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
                "followers_url": "https://api.github.com/users/tachyons/followers",
                "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tachyons",
                "id": 3112976,
                "login": "tachyons",
                "node_id": "MDQ6VXNlcjMxMTI5NzY=",
                "organizations_url": "https://api.github.com/users/tachyons/orgs",
                "received_events_url": "https://api.github.com/users/tachyons/received_events",
                "repos_url": "https://api.github.com/users/tachyons/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tachyons",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/pulls{/number}",
            "pushed_at": "2025-11-08T14:19:31Z",
            "releases_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/releases{/id}",
            "size": 7005,
            "ssh_url": "git@github.com:tachyons/nvim-lspconfig.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/stargazers",
            "statuses_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/subscribers",
            "subscription_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/subscription",
            "svn_url": "https://github.com/tachyons/nvim-lspconfig",
            "tags_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/tags",
            "teams_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/tachyons/nvim-lspconfig/git/trees{/sha}",
            "updated_at": "2025-10-27T07:03:42Z",
            "url": "https://api.github.com/repos/tachyons/nvim-lspconfig",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "829d1858aa8014c1ecd34c7269e1a74b2fe2f4c5",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
            "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
            "followers_url": "https://api.github.com/users/tachyons/followers",
            "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
            "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/tachyons",
            "id": 3112976,
            "login": "tachyons",
            "node_id": "MDQ6VXNlcjMxMTI5NzY=",
            "organizations_url": "https://api.github.com/users/tachyons/orgs",
            "received_events_url": "https://api.github.com/users/tachyons/received_events",
            "repos_url": "https://api.github.com/users/tachyons/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/tachyons",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/nvim-lspconfig/pull/4157",
    "id": 2949824505,
    "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4157",
    "labels": [],
    "locked": false,
    "merge_commit_sha": "d3aa0312b3e4e18f8f103ce8a22b6548762dcb15",
    "merged_at": null,
    "milestone": null,
    "node_id": "PR_kwDODTQC186v0r_5",
    "number": 4157,
    "patch_url": "https://github.com/neovim/nvim-lspconfig/pull/4157.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157/comments",
    "state": "open",
    "statuses_url": "https://api.github.com/repos/neovim/nvim-lspconfig/statuses/829d1858aa8014c1ecd34c7269e1a74b2fe2f4c5",
    "title": "Add Gitlab Duo LSP configuration",
    "updated_at": "2025-11-08T14:34:20Z",
    "url": "https://api.github.com/repos/neovim/nvim-lspconfig/pulls/4157",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/3112976?v=4",
        "events_url": "https://api.github.com/users/tachyons/events{/privacy}",
        "followers_url": "https://api.github.com/users/tachyons/followers",
        "following_url": "https://api.github.com/users/tachyons/following{/other_user}",
        "gists_url": "https://api.github.com/users/tachyons/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tachyons",
        "id": 3112976,
        "login": "tachyons",
        "node_id": "MDQ6VXNlcjMxMTI5NzY=",
        "organizations_url": "https://api.github.com/users/tachyons/orgs",
        "received_events_url": "https://api.github.com/users/tachyons/received_events",
        "repos_url": "https://api.github.com/users/tachyons/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tachyons/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tachyons/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tachyons",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Description\n\nRecently migrated my project to clang/libc++. My project is built in `/build` by cmake, which also generates a `compile_commands.json` there. While troubleshooting, I also symlinked this to `project root/compile_commands.json`, but ideally I wouldn't have that (and it didn't help).\n\nMy `.clangd` looks like:\n\n```\nCompileFlags:\n  CompilationDatabase: build\n```\n\nWhen I run `clangd --check=...`, it reports no errors. But when I open nvim with lspconfig clangd enabled, here is what I get:\n\n![Image](https://github.com/user-attachments/assets/8620e09d-9eb2-4bfc-aea8-0e71cb61df46)\n\nHere are the configurations I have tried, all with the same error:\n\n```\nrequire('lspconfig').clangd.setup{\n  on_attach = function(client, bufnr)\n    require(\"nvim-navic\").attach(client, bufnr)\n  end\n}\n```\n\n```\nrequire('lspconfig').clangd.setup{\n  cmd = { \"clangd\", \"--compile-commands-dir=build\" },\n  root_dir = require('lspconfig.util').root_pattern('.clangd', 'compile_commands.json', '.git'),\n  on_attach = function(client, bufnr)\n    require(\"nvim-navic\").attach(client, bufnr)\n  end\n}\n```\n\n```\nrequire('lspconfig').clangd.setup{\n  cmd = { \"clangd\" },\n  root_dir = require('lspconfig.util').root_pattern('.clangd', 'compile_commands.json', '.git'),\n  on_attach = function(client, bufnr)\n    require(\"nvim-navic\").attach(client, bufnr)\n  end\n}\n```\n\nAnd `:LspInfo`:\n\n```\n\n==============================================================================\nlspconfig: require(\"lspconfig.health\").check()\n\nLSP configs active in this session (globally) ~\n- Configured servers: clangd, ruff, hls\n- OK Deprecated servers: (none)\n\nLSP configs active in this buffer (bufnr: 30) ~\n- Language client log: ~/.local/state/nvim/lsp.log\n- Detected filetype: `cpp`\n- 1 client(s) attached to this buffer\n- Client: `clangd` (id: 3, bufnr: [20, 30])\n  root directory:    ~/projects/tachyon/\n  filetypes:         c, cpp, objc, objcpp, cuda, proto\n  cmd:               /etc/profiles/per-user/areg/bin/clangd\n  version:           `clangd version 18.1.8`\n  executable:        true\n  autostart:         true\n\nDocs for active configs: ~\n- clangd docs: >markdown\n  \n  https://clangd.llvm.org/installation.html\n  \n  - **NOTE:** Clang >= 11 is recommended! See [#23](https://github.com/neovim/nvim-lspconfig/issues/23).\n  - If `compile_commands.json` lives in a build directory, you should\n    symlink it to the root of your source tree.\n    ```\n    ln -s /path/to/myproject/build/compile_commands.json /path/to/myproject/\n    ```\n  - clangd relies on a [JSON compilation database](https://clang.llvm.org/docs/JSONCompilationDatabase.html)\n    specified as compile_commands.json, see https://clangd.llvm.org/installation#compile_commandsjson\n```\n\nI have also tried using `:cd <project root>` and then restarting the LSP, but that doesn't help either. And `!which clangd` returns the same path as `which clangd` in the terminal (not sure if this helps).\n\nWould really appreciate some insight. How does lspconfig spawn clangd? Surely, if it spawned it with just clangd, it would work the same as in the terminal, right?",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "FYI: I also recently switched to cmake, I was using meson previously.\n```\n> clangd --version\nclangd version 19.1.7\nFeatures: linux\nPlatform: x86_64-unknown-linux-gnu\n```",
            "created_at": "2025-04-01T00:18:40Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/3679#issuecomment-2767700418",
            "id": 2767700418,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/3679",
            "node_id": "IC_kwDODTQC186k98HC",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/2767700418/reactions"
            },
            "updated_at": "2025-04-01T00:18:40Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/2767700418",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/148818484?v=4",
                "events_url": "https://api.github.com/users/kostareg/events{/privacy}",
                "followers_url": "https://api.github.com/users/kostareg/followers",
                "following_url": "https://api.github.com/users/kostareg/following{/other_user}",
                "gists_url": "https://api.github.com/users/kostareg/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kostareg",
                "id": 148818484,
                "login": "kostareg",
                "node_id": "U_kgDOCN7KNA",
                "organizations_url": "https://api.github.com/users/kostareg/orgs",
                "received_events_url": "https://api.github.com/users/kostareg/received_events",
                "repos_url": "https://api.github.com/users/kostareg/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kostareg/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kostareg/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kostareg",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/3679/comments",
    "created_at": "2025-04-01T00:17:26Z",
    "events_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/3679/events",
    "html_url": "https://github.com/neovim/nvim-lspconfig/issues/3679",
    "id": 2961843364,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "Something isn't working",
            "id": 1674892761,
            "name": "bug",
            "node_id": "MDU6TGFiZWwxNjc0ODkyNzYx",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/labels/bug"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/3679/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDODTQC186wiiSk",
    "number": 3679,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/3679/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/nvim-lspconfig",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/3679/timeline",
    "title": "Nvim-lsp clangd does not find expected (but clangd does)",
    "type": null,
    "updated_at": "2025-04-01T00:18:42Z",
    "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/3679",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/148818484?v=4",
        "events_url": "https://api.github.com/users/kostareg/events{/privacy}",
        "followers_url": "https://api.github.com/users/kostareg/followers",
        "following_url": "https://api.github.com/users/kostareg/following{/other_user}",
        "gists_url": "https://api.github.com/users/kostareg/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/kostareg",
        "id": 148818484,
        "login": "kostareg",
        "node_id": "U_kgDOCN7KNA",
        "organizations_url": "https://api.github.com/users/kostareg/orgs",
        "received_events_url": "https://api.github.com/users/kostareg/received_events",
        "repos_url": "https://api.github.com/users/kostareg/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/kostareg/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/kostareg/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/kostareg",
        "user_view_type": "public"
    }
}
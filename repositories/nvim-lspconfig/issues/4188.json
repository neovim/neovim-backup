{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Description\n\nI've defined a simple root_dir function for clangd and lspconfig does not even attempt to start clangd anymore: nothing in the logs.\n\n```\n        root_dir = function(fname)\n            -- local root = \"/home/tests/clrc663/build\"  -- Always return the same root\n            local root = require('lspconfig').clangd.document_config.default_config.root_dir(fname)\n            print(\"Root gugu = \", fname, \" = \", root)\n            return root\n        end,\n```\nseems like the simple existence of root_dir prevents the start of clangd, no matter what value it returns. I'm not sure how to debug the logic in nvim-lspconfig which decides not to start clangd anymore (neither with fixed return value, nor with returning the original value. The function is called and prints the correct value. ",
    "closed_at": "2025-11-15T20:53:07Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Did you read https://github.com/neovim/nvim-lspconfig#support , this is not a support forum.\n\n\n\n> defined a simple root_dir function for clangd and lspconfig does not even attempt to start clangd anymore\n\nAs `:help lsp-root_dir()` documents (but doesn't have an example, we should improve that), you need to call the `on_dir` callback. Not sure where you came up with your example (I guess from the old lspconfig framework, you did not even mention how you defined your config). \n\nInstead it should look like this:\n\n```lua\nroot_dir = function(bufnr: integer, on_dir)\n  -- Call this only if a valid root dir was found\n  -- (may be `nil` if the LS supports \"single-file mode\".\n  on_dir(...)\nend\n```",
            "created_at": "2025-11-15T20:53:07Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/4188#issuecomment-3536878846",
            "id": 3536878846,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188",
            "node_id": "IC_kwDODTQC187S0Hz-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3536878846/reactions"
            },
            "updated_at": "2025-11-15T20:53:33Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3536878846",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Sorry for polluting the wrong venue, and thanks for pointing me in the right direction. I guess I just copied the model of some of the existing configs in this repository, for example: \n```\nlua/lspconfig/configs/textlsp.lua\n```\nthere are quite a few configs that use what I now know is the old root_dir logic\nThanks!",
            "created_at": "2025-11-15T21:08:58Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/4188#issuecomment-3536892120",
            "id": 3536892120,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188",
            "node_id": "IC_kwDODTQC187S0LDY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3536892120/reactions"
            },
            "updated_at": "2025-11-15T21:08:58Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3536892120",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1033518?v=4",
                "events_url": "https://api.github.com/users/iuliuv/events{/privacy}",
                "followers_url": "https://api.github.com/users/iuliuv/followers",
                "following_url": "https://api.github.com/users/iuliuv/following{/other_user}",
                "gists_url": "https://api.github.com/users/iuliuv/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iuliuv",
                "id": 1033518,
                "login": "iuliuv",
                "node_id": "MDQ6VXNlcjEwMzM1MTg=",
                "organizations_url": "https://api.github.com/users/iuliuv/orgs",
                "received_events_url": "https://api.github.com/users/iuliuv/received_events",
                "repos_url": "https://api.github.com/users/iuliuv/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iuliuv/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iuliuv/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iuliuv",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> existing configs in this repository, for example:\n> \n> ```\n> lua/lspconfig/configs/textlsp.lua\n> ```\n\nAll code in `lua/lspconfig/configs/` is deprecated, this is very loudly explained in the readme.",
            "created_at": "2025-11-15T21:17:36Z",
            "html_url": "https://github.com/neovim/nvim-lspconfig/issues/4188#issuecomment-3536904387",
            "id": 3536904387,
            "issue_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188",
            "node_id": "IC_kwDODTQC187S0ODD",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3536904387/reactions"
            },
            "updated_at": "2025-11-15T21:17:36Z",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/comments/3536904387",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188/comments",
    "created_at": "2025-11-15T20:42:06Z",
    "events_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188/events",
    "html_url": "https://github.com/neovim/nvim-lspconfig/issues/4188",
    "id": 3629219982,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "e6e6e6",
            "default": true,
            "description": "Further information is requested",
            "id": 1674892775,
            "name": "question",
            "node_id": "MDU6TGFiZWwxNjc0ODkyNzc1",
            "url": "https://api.github.com/repos/neovim/nvim-lspconfig/labels/question"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDODTQC187YUYCO",
    "number": 4188,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/nvim-lspconfig",
    "state": "closed",
    "state_reason": "not_planned",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188/timeline",
    "title": "adding the root_dir function in the clangd config prevents clangd from starting",
    "type": null,
    "updated_at": "2025-11-15T21:17:36Z",
    "url": "https://api.github.com/repos/neovim/nvim-lspconfig/issues/4188",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1033518?v=4",
        "events_url": "https://api.github.com/users/iuliuv/events{/privacy}",
        "followers_url": "https://api.github.com/users/iuliuv/followers",
        "following_url": "https://api.github.com/users/iuliuv/following{/other_user}",
        "gists_url": "https://api.github.com/users/iuliuv/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/iuliuv",
        "id": 1033518,
        "login": "iuliuv",
        "node_id": "MDQ6VXNlcjEwMzM1MTg=",
        "organizations_url": "https://api.github.com/users/iuliuv/orgs",
        "received_events_url": "https://api.github.com/users/iuliuv/received_events",
        "repos_url": "https://api.github.com/users/iuliuv/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/iuliuv/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/iuliuv/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/iuliuv",
        "user_view_type": "public"
    }
}
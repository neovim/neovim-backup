{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nI'm setting the env to LSP configuration. I noticed the `PATH` env is correctly set on Linux and Mac but not work in Windows. From what I can see\n\nCode:\nhttps://github.com/nvim-java/nvim-java/blob/14e37220f34c11d6ebbf22b124d7565ec96a18f3/lua/java-core/ls/servers/jdtls/env.lua?plain=1#L33-L36\n\nFailing Test:\nhttps://github.com/nvim-java/nvim-java/actions/runs/19872642735/job/56952094018\n\nWhile digging into this, I see the same behavior in `vim.system` function as well, which is the API used in `vim.lsp.rpc.start`.\n\nHere, `java_path` is a location to `/bin` of a JDK and `separator` is a platform specific path separator. On windows it's `;` and on other platforms, it's `:`.\n\n\n\n### Steps to reproduce\n\n1. Install two versions of the same binary. In my case it's JDK 17 and JDK 25. ()\n2. Add ONLY one of them to system env PATH variable using Windows system variable UI. I've added JDK 25.\n3. Run `java -version` and it should show version 25.\n4. Run `nvim test.lua`\n5. Add following content. Here, `java_path` should be the path to JDK 17. Path separator should be `;` on Windows and `:` on all other platforms\n\n```lua\nlocal test = vim\n  .system({ 'java', '-version' }, {\n    env = {\n      PATH = java_path .. ';' .. vim.fn.getenv('PATH'),\n    },\n}):wait(3000)\n\nvim.print(test)\n```\n\n6. Run the lua file `luafile %`\n7. (Expected) JDK 17 version text should be printed BUT Windows prints `25`\n8. Remove 25 from system env `PATH`\n9. Run the lua file again\n10. Now only JDK 17 is printed\n\n<img width=\"1280\" height=\"803\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c70d5fa7-7cd6-4ad3-969e-b5f7b341e039\" />\n\n<img width=\"1277\" height=\"798\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/f623e1e9-6392-40fb-af5d-602cf641fcd7\" />\n\n### Expected behavior\n\nJDK 17 version text should be printed on all 3 (Windows, Linux, Mac) platforms BUT while Linux and Mac prints `17` Windows prints `25`.\n\n### Nvim version (nvim -v)\n\n0.11.5\n\n### Vim (not Nvim) behaves the same?\n\n-\n\n### Operating system/version\n\nWindows 11\n\n### Terminal name/version\n\nPowershell\n\n### $TERM environment variable\n\n-\n\n### Installation\n\nChocolety",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Just for reference, please try the Nvim 0.12 nightly: https://github.com/neovim/neovim/releases/tag/nightly\n\n\nInstead of testing `java -version`, try `cmd.exe /c \"echo %PATH%\"`, so that we can confirm if PATH is being set.\n\nvim.system just passes `env` to libuv `spawn()`, nothing special going on: https://github.com/neovim/neovim/blob/e62dd13f83a200105a2b8466e729c39485fa766d/runtime/lua/vim/_system.lua#L437\n\nAlso try this:\n\n     lua =vim.uv.spawn('cmd.exe', {args={'/c', 'echo %PATH% > tmp.txt'}, env={'PATH=foo;'..vim.env.PATH}})\n\nwhat are the contents of `tmp.txt` ?\n",
            "created_at": "2025-12-03T17:57:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/36818#issuecomment-3608101053",
            "id": 3608101053,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36818",
            "node_id": "IC_kwDOAPphoM7XD0C9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608101053/reactions"
            },
            "updated_at": "2025-12-03T17:57:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608101053",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "This is probably the issue.\n\nhttps://github.com/joyent/libuv/issues/122\n\nRunning it through `cmd` somehow is not the same. This is on nightly build I just installed. Same `PATH` env but two different results on Windows.\n\n<img width=\"1496\" height=\"936\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/fe50a1cf-facb-4f49-aff7-121bedf66af0\" />",
            "created_at": "2025-12-03T21:14:31Z",
            "html_url": "https://github.com/neovim/neovim/issues/36818#issuecomment-3608867004",
            "id": 3608867004,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36818",
            "node_id": "IC_kwDOAPphoM7XGvC8",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608867004/reactions"
            },
            "updated_at": "2025-12-03T21:14:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608867004",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18459807?v=4",
                "events_url": "https://api.github.com/users/s1n7ax/events{/privacy}",
                "followers_url": "https://api.github.com/users/s1n7ax/followers",
                "following_url": "https://api.github.com/users/s1n7ax/following{/other_user}",
                "gists_url": "https://api.github.com/users/s1n7ax/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/s1n7ax",
                "id": 18459807,
                "login": "s1n7ax",
                "node_id": "MDQ6VXNlcjE4NDU5ODA3",
                "organizations_url": "https://api.github.com/users/s1n7ax/orgs",
                "received_events_url": "https://api.github.com/users/s1n7ax/received_events",
                "repos_url": "https://api.github.com/users/s1n7ax/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/s1n7ax/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/s1n7ax/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/s1n7ax",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> This is probably the issue:\n> \n> - https://github.com/joyent/libuv/issues/122\n\nNice find. I wonder if we workaround it.",
            "created_at": "2025-12-05T03:52:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/36818#issuecomment-3615194764",
            "id": 3615194764,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36818",
            "node_id": "IC_kwDOAPphoM7Xe36M",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3615194764/reactions"
            },
            "updated_at": "2025-12-05T03:52:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3615194764",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36818/comments",
    "created_at": "2025-12-03T08:26:36Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/36818/events",
    "html_url": "https://github.com/neovim/neovim/issues/36818",
    "id": 3689049404,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "d4c5f9",
            "default": false,
            "description": null,
            "id": 109461219,
            "name": "platform:windows",
            "node_id": "MDU6TGFiZWwxMDk0NjEyMTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/platform:windows"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "user system environment (terminal, shell, tmux)",
            "id": 147354524,
            "name": "environment",
            "node_id": "MDU6TGFiZWwxNDczNTQ1MjQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/environment"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "OS resources, pipes, streams",
            "id": 713599092,
            "name": "system",
            "node_id": "MDU6TGFiZWw3MTM1OTkwOTI=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/system"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/36818/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 761,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 638,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-12-08T23:16:37Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM7b4m08",
    "number": 36818,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/36818/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/36818/timeline",
    "title": "vim.lsp.start PATH env is overriden by system env on Windows",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-12-05T03:52:56Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/36818",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/18459807?v=4",
        "events_url": "https://api.github.com/users/s1n7ax/events{/privacy}",
        "followers_url": "https://api.github.com/users/s1n7ax/followers",
        "following_url": "https://api.github.com/users/s1n7ax/following{/other_user}",
        "gists_url": "https://api.github.com/users/s1n7ax/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/s1n7ax",
        "id": 18459807,
        "login": "s1n7ax",
        "node_id": "MDQ6VXNlcjE4NDU5ODA3",
        "organizations_url": "https://api.github.com/users/s1n7ax/orgs",
        "received_events_url": "https://api.github.com/users/s1n7ax/received_events",
        "repos_url": "https://api.github.com/users/s1n7ax/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/s1n7ax/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/s1n7ax/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/s1n7ax",
        "user_view_type": "public"
    }
}
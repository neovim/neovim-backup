{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nIf the window is scrolled during the `WinScrolled` event, the next scroll will not trigger the `WinScrolled` event for the window.\n\n### Steps to reproduce\n\nCreate a file `test.lua` with the following content:\n```lua\nvim.api.nvim_create_autocmd('WinScrolled', {\n  callback = function() vim.fn.winrestview({ topline = 0 }) end,\n})\n```\n\nReproduce with:\n```\nnvim --clean test.lua\nluafile %\nG\nzt (WinScrolled event fired, no scroll due to winrestview)\nzt (WinScrolled event doesn't fire, scrolled to bottom of buffer)\nk (WinScrolled event fired, scroll restored to top)\n```\n\n\n### Expected behavior\n\nThe `WinScrolled` event should be fired on every scroll, regardless of whether the window was scrolled during the event.\n\n### Nvim version (nvim -v)\n\n0.12.0-nightly+b79ff96\n\n### Vim (not Nvim) behaves the same?\n\nyes, vim 9.1.1475\n\n### Operating system/version\n\nNixOS Unstable 25.11\n\n### Terminal name/version\n\nfoot 1.23.0\n\n### $TERM environment variable\n\nfoot\n\n### Installation\n\nNix overlay: https://github.com/nix-community/neovim-nightly-overlay",
    "closed_at": "2025-09-04T23:18:22Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
        "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
        "followers_url": "https://api.github.com/users/zeertzjq/followers",
        "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
        "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zeertzjq",
        "id": 35768171,
        "login": "zeertzjq",
        "node_id": "MDQ6VXNlcjM1NzY4MTcx",
        "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
        "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
        "repos_url": "https://api.github.com/users/zeertzjq/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zeertzjq",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "`:help autocmd-nested`\n\nAlso `:help WinScrolled` specifically mentions:\n\n \n    Non-recursive: the event will not trigger\n    while executing commands for the WinScrolled\n    event.  However, if the command causes a\n    window to scroll or change size, then another\n    WinScrolled event will be triggered later.",
            "created_at": "2025-09-04T20:39:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/35633#issuecomment-3255567334",
            "id": 3255567334,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35633",
            "node_id": "IC_kwDOAPphoM7CDAPm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3255567334/reactions"
            },
            "updated_at": "2025-09-04T20:40:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3255567334",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "To clarify, I'm not saying that the `winrestview()` should be triggering the `WinScrolled` event. Rather, I'm saying that running `winrestview()` inside the callback of the `WinScrolled` event, causes the next `WinScrolled` event (triggered by the user via `zt`, not by the autocmd callback) to be ignored.",
            "created_at": "2025-09-04T20:43:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/35633#issuecomment-3255583533",
            "id": 3255583533,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35633",
            "node_id": "IC_kwDOAPphoM7CDEMt",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3255583533/reactions"
            },
            "updated_at": "2025-09-04T20:48:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3255583533",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10467983?v=4",
                "events_url": "https://api.github.com/users/Saghen/events{/privacy}",
                "followers_url": "https://api.github.com/users/Saghen/followers",
                "following_url": "https://api.github.com/users/Saghen/following{/other_user}",
                "gists_url": "https://api.github.com/users/Saghen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Saghen",
                "id": 10467983,
                "login": "Saghen",
                "node_id": "MDQ6VXNlcjEwNDY3OTgz",
                "organizations_url": "https://api.github.com/users/Saghen/orgs",
                "received_events_url": "https://api.github.com/users/Saghen/received_events",
                "repos_url": "https://api.github.com/users/Saghen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Saghen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Saghen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Saghen",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This is working as intended, because the scrolling from the first `winrestview()` and the scrolling from the second `zt` are counted in the same main loop iteration, and the scrolling position after the second `zt` is the same as the scrolling position before the first `WinScrolled` event.\n\nTo achieve the desired behavior, you can either put the `winrestview()` inside a `vim.schedule()`, or add an empty `vim.schedule()` after the `winrestview()`.",
            "created_at": "2025-09-04T23:18:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/35633#issuecomment-3256274806",
            "id": 3256274806,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35633",
            "node_id": "IC_kwDOAPphoM7CFs92",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3256274806/reactions"
            },
            "updated_at": "2025-09-04T23:28:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3256274806",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks! That works for `zt` although I'm still able to reproduce the missing `WinScrolled` events with `<ScrollWheelDown>`. \n\n```lua\nvim.api.nvim_create_autocmd('WinScrolled', {\n  callback = function()\n    vim.fn.winrestview({ topline = 0 })\n    vim.schedule(function() end)\n  end,\n})\n```",
            "created_at": "2025-09-05T16:34:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/35633#issuecomment-3258975095",
            "id": 3258975095,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35633",
            "node_id": "IC_kwDOAPphoM7CQAN3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3258975095/reactions"
            },
            "updated_at": "2025-09-05T16:34:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3258975095",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10467983?v=4",
                "events_url": "https://api.github.com/users/Saghen/events{/privacy}",
                "followers_url": "https://api.github.com/users/Saghen/followers",
                "following_url": "https://api.github.com/users/Saghen/following{/other_user}",
                "gists_url": "https://api.github.com/users/Saghen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Saghen",
                "id": 10467983,
                "login": "Saghen",
                "node_id": "MDQ6VXNlcjEwNDY3OTgz",
                "organizations_url": "https://api.github.com/users/Saghen/orgs",
                "received_events_url": "https://api.github.com/users/Saghen/received_events",
                "repos_url": "https://api.github.com/users/Saghen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Saghen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Saghen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Saghen",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Hmm, does it work if you use `vim.api.nvim_feedkeys(vim.keycode('<Ignore>'), 'ni', false)` instead of `vim.schedule(function() end)`?",
            "created_at": "2025-09-05T23:02:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/35633#issuecomment-3259976105",
            "id": 3259976105,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35633",
            "node_id": "IC_kwDOAPphoM7CT0mp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3259976105/reactions"
            },
            "updated_at": "2025-09-05T23:02:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3259976105",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "It does, tysm!",
            "created_at": "2025-09-06T04:22:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/35633#issuecomment-3260526847",
            "id": 3260526847,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35633",
            "node_id": "IC_kwDOAPphoM7CV7D_",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3260526847/reactions"
            },
            "updated_at": "2025-09-06T04:22:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3260526847",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10467983?v=4",
                "events_url": "https://api.github.com/users/Saghen/events{/privacy}",
                "followers_url": "https://api.github.com/users/Saghen/followers",
                "following_url": "https://api.github.com/users/Saghen/following{/other_user}",
                "gists_url": "https://api.github.com/users/Saghen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Saghen",
                "id": 10467983,
                "login": "Saghen",
                "node_id": "MDQ6VXNlcjEwNDY3OTgz",
                "organizations_url": "https://api.github.com/users/Saghen/orgs",
                "received_events_url": "https://api.github.com/users/Saghen/received_events",
                "repos_url": "https://api.github.com/users/Saghen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Saghen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Saghen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Saghen",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/35633/comments",
    "created_at": "2025-09-04T20:16:30Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/35633/events",
    "html_url": "https://github.com/neovim/neovim/issues/35633",
    "id": 3385321077,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "e6e6e6",
            "default": false,
            "description": "issues that are closed as usage questions",
            "id": 77997478,
            "name": "closed:question",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3OA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/closed:question"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "events, autocommands",
            "id": 3341085842,
            "name": "events",
            "node_id": "MDU6TGFiZWwzMzQxMDg1ODQy",
            "url": "https://api.github.com/repos/neovim/neovim/labels/events"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/35633/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM7Jx-Z1",
    "number": 35633,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/35633/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/35633/timeline",
    "title": "next `WinScrolled` event not fired after winrestview()",
    "type": null,
    "updated_at": "2025-09-06T04:22:46Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/35633",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/10467983?v=4",
        "events_url": "https://api.github.com/users/Saghen/events{/privacy}",
        "followers_url": "https://api.github.com/users/Saghen/followers",
        "following_url": "https://api.github.com/users/Saghen/following{/other_user}",
        "gists_url": "https://api.github.com/users/Saghen/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Saghen",
        "id": 10467983,
        "login": "Saghen",
        "node_id": "MDQ6VXNlcjEwNDY3OTgz",
        "organizations_url": "https://api.github.com/users/Saghen/orgs",
        "received_events_url": "https://api.github.com/users/Saghen/received_events",
        "repos_url": "https://api.github.com/users/Saghen/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Saghen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Saghen/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Saghen",
        "user_view_type": "public"
    }
}
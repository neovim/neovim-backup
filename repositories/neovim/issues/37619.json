{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nTo support reacting to failures and plugin integrations with `vim.pack`, the module should emit events for when things go wrong. In my case, I'm working on an interactive UI layer for `vim.pack` where I would like the UI to reflect that an installation of a package went wrong and why. It would also enable custom user logic for handling failures (sending notifications or perhaps retrying for example).\n\nAfter looking at the current implementation, the `PackChanged` event gets emitted after a git command so in case an update fails, you would only get the `PackChangedPre` event.\n\nOne could listen to `PackChangedPre`, set a timeout, and if the `PackChanged` event is not received within the timeout assume it failed. This is not great and won't work well with the confirmation buffer, as I understand it, as the user may take their time to select updates. Using `pcall` works with `vim.pack.add` but you still have to parse the error message to figure out what packages failed. `vim.pack.update` seems to always return `true` (I turned off my internet and did a `pcall` with `vim.pack.update`).\n\nI can see that there is private information in `vim.pack.PlugInfo` which would be useful (`installed` and `err`). Just exposing it would not be enough as it wouldn't allow for reactive handling.\n\n### Possible solutions:\n1. Extend the current `PackChanged` event with an `error` field that is `nil` when no errors occurred. Then the event will need to be emitted correctly on failure. Given the event definition of `\"after plugin's state has changed.\"` I would argue that the state has changed but this is just my view.\n2. Create a new event called something like `PackFailed` with the relevant info.\n\nI understand this is probably very low-priority and niche but I'm also mainly raising this issue to create awareness and influence the design process early on. Also, this might be covered wholly or partially by the planned `vim.ui.progress`.\n\n### Expected behavior\n\nExpected there to be a way to programmatically react to package-related failures.",
    "closed_at": "2026-01-31T00:02:50Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Thanks for the suggestion!\n\nI don't think there is a precedent of triggering events when something fails. A more common and straightforward approach here is to directly throw an error with specific messages, which is what `vim.pack` is doing. Yes, it might be cumbersome to deal with programmatically, but it is an easy and established solution.\n\nPlus I indeed agree that this is somewhat niche.\n\n> Using `pcall` works with `vim.pack.add` but you still have to parse the error message to figure out what packages failed. `vim.pack.update` seems to always return `true` (I turned off my internet and did a `pcall` with `vim.pack.update`).\n\nErrors in `vim.pack.update()` are shown in confirmation buffer or are written in the log file in case of `opts.force = true`. In any case they are shown to the end user in a way that doesn't stop the update process.\n\n---\n\nIf it were up to me, I'd probably close this as not planned (as is currently formulated). I don't think adding a `PackFail` event is justified here. But it is not a strong opinion. Also, as it sets a design precedent, I'll wait for  other opinions.",
            "created_at": "2026-01-30T13:14:31Z",
            "html_url": "https://github.com/neovim/neovim/issues/37619#issuecomment-3823691299",
            "id": 3823691299,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37619",
            "node_id": "IC_kwDOAPphoM7j6OYj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3823691299/reactions"
            },
            "updated_at": "2026-01-30T13:14:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3823691299",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
                "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
                "followers_url": "https://api.github.com/users/echasnovski/followers",
                "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
                "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/echasnovski",
                "id": 24854248,
                "login": "echasnovski",
                "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
                "organizations_url": "https://api.github.com/users/echasnovski/orgs",
                "received_events_url": "https://api.github.com/users/echasnovski/received_events",
                "repos_url": "https://api.github.com/users/echasnovski/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/echasnovski",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks for the reply.\n\n> A more common and straightforward approach here is to directly throw an error with specific messages, which is what vim.pack is doing. Yes, it might be cumbersome to deal with programmatically, but it is an easy and established solution.\n\nFair enough. The only thing is that those errors are currently (last time I tried) inaccessible if they are gobbled up by the module or difficult to handle if only thrown once the user interactively decides to update plugins.\n\n> Errors in vim.pack.update() are shown in confirmation buffer or are written in the log file in case of opts.force = true. In any case they are shown to the end user in a way that doesn't stop the update process.\n\nI thought about parsing the log file but that felt like a hack.\n\nI fully respect the design decisions made here. I imagine the design space is under a lot of internal and external scrutiny so my primary objective was to raise awareness more than anything else.\n\nClosing this as \"not planned\" is ok ðŸ™‚ and great work on the `vim.pack` module. I look forward to migrating to it soon!",
            "created_at": "2026-01-30T20:21:15Z",
            "html_url": "https://github.com/neovim/neovim/issues/37619#issuecomment-3825571819",
            "id": 3825571819,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37619",
            "node_id": "IC_kwDOAPphoM7kBZfr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3825571819/reactions"
            },
            "updated_at": "2026-01-30T20:21:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3825571819",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1846147?v=4",
                "events_url": "https://api.github.com/users/MisanthropicBit/events{/privacy}",
                "followers_url": "https://api.github.com/users/MisanthropicBit/followers",
                "following_url": "https://api.github.com/users/MisanthropicBit/following{/other_user}",
                "gists_url": "https://api.github.com/users/MisanthropicBit/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MisanthropicBit",
                "id": 1846147,
                "login": "MisanthropicBit",
                "node_id": "MDQ6VXNlcjE4NDYxNDc=",
                "organizations_url": "https://api.github.com/users/MisanthropicBit/orgs",
                "received_events_url": "https://api.github.com/users/MisanthropicBit/received_events",
                "repos_url": "https://api.github.com/users/MisanthropicBit/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MisanthropicBit/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MisanthropicBit/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MisanthropicBit",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/37619/comments",
    "created_at": "2026-01-29T19:24:07Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/37619/events",
    "html_url": "https://github.com/neovim/neovim/issues/37619",
    "id": 3872215414,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "bfd4f2",
            "default": false,
            "description": "vim.pack, start/opt packages, 'packpath'",
            "id": 8889050758,
            "name": "packages",
            "node_id": "LA_kwDOAPphoM8AAAACEdQmhg",
            "url": "https://api.github.com/repos/neovim/neovim/labels/packages"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/37619/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM7mzVF2",
    "number": 37619,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/37619/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "not_planned",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/37619/timeline",
    "title": "Add events for failure to `vim.pack.add`/`vim.pack.update`/`vim.pack.delete`",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2026-01-31T00:02:50Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/37619",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1846147?v=4",
        "events_url": "https://api.github.com/users/MisanthropicBit/events{/privacy}",
        "followers_url": "https://api.github.com/users/MisanthropicBit/followers",
        "following_url": "https://api.github.com/users/MisanthropicBit/following{/other_user}",
        "gists_url": "https://api.github.com/users/MisanthropicBit/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/MisanthropicBit",
        "id": 1846147,
        "login": "MisanthropicBit",
        "node_id": "MDQ6VXNlcjE4NDYxNDc=",
        "organizations_url": "https://api.github.com/users/MisanthropicBit/orgs",
        "received_events_url": "https://api.github.com/users/MisanthropicBit/received_events",
        "repos_url": "https://api.github.com/users/MisanthropicBit/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/MisanthropicBit/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/MisanthropicBit/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/MisanthropicBit",
        "user_view_type": "public"
    }
}
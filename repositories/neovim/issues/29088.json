{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\nI noticed that using undercurl isn't really working consistently depending on the terminal session. For me in particular this happens with konsole. When running it directly it works, when being in the ssh session (even on the localhost), it doesn't. This happens due to nvim relying on detecting `KONSOLE_VERSION` variable which isn't set when in the ssh session.\r\n\r\n### Steps to reproduce\r\n\r\nRun nvim from konsole locally.\r\n\r\nThen enable this highlighting:\r\n\r\n```vim\r\n:lua vim.api.nvim_set_hl(0, 'SpellBad', { sp = 'red', undercurl = true } )\r\n```\r\n\r\nTry spellchecking some invalid text like `zzzz` (with something like `:setlocal spell! spelllang=en_us`).\r\n\r\nIt works fine:\r\n\r\n![image](https://github.com/neovim/neovim/assets/310927/d0ee58c8-cfbf-425d-8c47-2ceba8de8221)\r\n\r\nUse ssh (even to localhost) and try the same thing, the result is underline fallback:\r\n\r\n![image](https://github.com/neovim/neovim/assets/310927/9a15c5f4-aea7-4e48-8fad-31fdfd1d498a)\r\n\r\n\r\n\r\n### Expected behavior\r\n\r\nI'm already forcing `set termguicolors` in general.\r\n\r\nUndercurl should work more consistently. Or may be there is a setting that may be simply forces that behavior if user knows that terminal supports it? As a workaround I can simply export KONSOLE_VERSION inside the ssh session, but that's messy.\r\n\r\n\r\n### Neovim version (nvim -v)\r\n\r\nv0.10.0\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\n---\r\n\r\n### Operating system/version\r\n\r\nDebian testing Linux\r\n\r\n### Terminal name/version\r\n\r\nKonsole 23.08.1\r\n\r\n### $TERM environment variable\r\n\r\nxterm-256color\r\n\r\n### Installation\r\n\r\nappimage from Github build",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/29088/comments",
    "created_at": "2024-05-29T22:56:44Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/29088/events",
    "html_url": "https://github.com/neovim/neovim/issues/29088",
    "id": 2324366554,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/29088/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6KiwTa",
    "number": 29088,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/29088/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/29088/timeline",
    "title": "Undercurl behavior is inconsistent due to flaky detection of the terminal (Konsole)",
    "updated_at": "2025-01-19T11:22:27Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/29088",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/310927?v=4",
        "events_url": "https://api.github.com/users/shmerl/events{/privacy}",
        "followers_url": "https://api.github.com/users/shmerl/followers",
        "following_url": "https://api.github.com/users/shmerl/following{/other_user}",
        "gists_url": "https://api.github.com/users/shmerl/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/shmerl",
        "id": 310927,
        "login": "shmerl",
        "node_id": "MDQ6VXNlcjMxMDkyNw==",
        "organizations_url": "https://api.github.com/users/shmerl/orgs",
        "received_events_url": "https://api.github.com/users/shmerl/received_events",
        "repos_url": "https://api.github.com/users/shmerl/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/shmerl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/shmerl/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/shmerl",
        "user_view_type": "public"
    }
}
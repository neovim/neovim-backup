{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nExecuting `:lua =vim.ui.open(\"C:\\\\\")` succeeds but the actual folder doesn't open to show the directory. I can't spot `explorer.exe` on task manager so I'm assuming it doesn't even start. However, it works with URLs, e.g. `:lua =vim.ui.open(\"https://neovim.io/\")`.\n\n\n### Steps to reproduce\n\nExecute `:lua =vim.ui.open(\"C:\\\\\")`\n\n### Expected behavior\n\nFor the C:\\ directory to open.\n\n### Nvim version (nvim -v)\n\n0.11.4\n\n### Vim (not Nvim) behaves the same?\n\nN/A\n\n### Operating system/version\n\nWindows 11\n\n### Terminal name/version\n\nWindows Terminal\n\n### $TERM environment variable\n\nN/A\n\n### Installation\n\nwinget",
    "closed_at": "2025-12-05T19:00:54Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Does `explorer.exe C:\\` in a cmd.exe console work? \n\nAlso what is the behavior of these variants:\n\n```\n:call system(['explorer.exe', 'C:\\'])\n:call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:\\'])\n:call system(['explorer.exe', 'C:'])\n:call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:'])\n:call system(['explorer.exe', 'C:/'])\n:call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:/'])\n:lua vim.system({'explorer.exe', 'C:\\\\'})\n:lua vim.system({'rundll32', 'url.dll,FileProtocolHandler', 'C:\\\\'})\n```",
            "created_at": "2025-10-23T11:09:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436360751",
            "id": 3436360751,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M0rQv",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436360751/reactions"
            },
            "updated_at": "2025-10-23T11:09:10Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436360751",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This is purely off of memory from when I last looked at this, but I tried using vim.system and friends to call explorer.exe directly, but I could never get it to open. When I typed the command in cmd and powershell, it did work, so something weird is going on under the hood in nvim.\n\nI'll double check when I get back to a computer ",
            "created_at": "2025-10-23T11:44:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436499756",
            "id": 3436499756,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M1NMs",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436499756/reactions"
            },
            "updated_at": "2025-10-23T13:20:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436499756",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Does explorer.exe C:\\ in a cmd.exe console work?\n\nYes.\n\nThe rest don't work...\n\n\n",
            "created_at": "2025-10-23T11:58:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436547890",
            "id": 3436547890,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M1Y8y",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436547890/reactions"
            },
            "updated_at": "2025-10-23T11:58:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436547890",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> :call system(['explorer.exe', 'C:\\'])\n> :call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:\\'])\n> :call system(['explorer.exe', 'C:'])\n> :call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:'])\n> :call system(['explorer.exe', 'C:/'])\n> :call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:/'])\n> :lua vim.system({'explorer.exe', 'C:\\\\'})\n> :lua vim.system({'rundll32', 'url.dll,FileProtocolHandler', 'C:\\\\'})\n\nOkay I tested these and they all do the same thing but I noticed something interesting. They all deactivate my terminal emulator window as if they tried to make window explorer the active window however window explorer doesn't actually open. This makes me think that maybe windows defender might be blocking it for some reason.",
            "created_at": "2025-10-23T12:12:18Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436605415",
            "id": 3436605415,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M1m_n",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436605415/reactions"
            },
            "updated_at": "2025-10-23T13:20:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436605415",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I retested with various combinations terminal emulators (windows terminal, wezterm, default cmd window), adminstrator permissions, and shells (powershell, cmd). They all behaved the same way I previously described.  ",
            "created_at": "2025-10-23T12:21:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436641616",
            "id": 3436641616,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M1v1Q",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436641616/reactions"
            },
            "updated_at": "2025-10-23T13:20:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436641616",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I can also verify this behaviour. Great catch, I hadn't noticed it before.",
            "created_at": "2025-10-23T12:29:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436673317",
            "id": 3436673317,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M13kl",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436673317/reactions"
            },
            "updated_at": "2025-10-23T13:20:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436673317",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> This makes me think that maybe windows defender might be blocking it for some reason.\n\nI tried checking into how to verify if something got blocked by windows defender and I think you check in `Windows Security -> Protection history` but nothing shows up in that list so maybe it is something else.",
            "created_at": "2025-10-23T12:30:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436679426",
            "id": 3436679426,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M15EC",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436679426/reactions"
            },
            "updated_at": "2025-10-23T13:20:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436679426",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I just tried it using a cmd file and it successfully opened the file explorer. I created a cmd file `open.cmd` with the contents `explorer.exe C:/`. Then ran `:call system(['open.cmd'])` and it worked. Not an ideal work around but may help us determine what is going on.",
            "created_at": "2025-10-23T12:46:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436736031",
            "id": 3436736031,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M2G4f",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436736031/reactions"
            },
            "updated_at": "2025-10-23T13:20:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436736031",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Using jobstart behaves the same using system and doesn't open windows explorer.\n```lua\nvim.fn.jobstart({'explorer.exe', 'C:/'})\nvim.fn.jobstart({'pwsh', '-Command', '{', 'explorer.exe', 'C:/', '}'})\n```",
            "created_at": "2025-10-23T13:02:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436809134",
            "id": 3436809134,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M2Yuu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436809134/reactions"
            },
            "updated_at": "2025-10-23T13:02:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436809134",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I can confirm that by using Process Explorer or the Details tab in Task Manager that the process is actually starting as explorer.exe with a PID. I was using this command `:call system(['explorer.exe', 'C:'])`. Still no folder showing as you would expect to show when using it through powershell.",
            "created_at": "2025-10-23T13:03:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436813472",
            "id": 3436813472,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M2Zyg",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436813472/reactions"
            },
            "updated_at": "2025-10-23T13:20:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436813472",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I can confirm that by using Process Explorer or the Details tab in Task Manager that the process is actually starting as explorer.exe with a PID.\n\nInteresting, I tried checking the PID in task manager and at least when I do it the PID isn't in the list (maybe I'm to slow and it closes) but there are also a suspicously high number of window explorers open in task manager despite now actual windows being visible.\n\n",
            "created_at": "2025-10-23T13:11:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436870047",
            "id": 3436870047,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M2nmf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436870047/reactions"
            },
            "updated_at": "2025-10-23T13:21:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436870047",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Yeah I think it's invisible but the process exists. If you use this command it works `:call system(['cmd', '/c', 'start', 'explorer.exe', 'C:\\'])\n`",
            "created_at": "2025-10-23T13:16:37Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436908297",
            "id": 3436908297,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M2w8J",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436908297/reactions"
            },
            "updated_at": "2025-10-23T13:16:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436908297",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Okay I confirmed that each call to `lua = vim.system({'explorer.exe', 'C:'})` does create a new explorer.exe process but the PID is not the same as the one that is printed to messages\n\n```\n{\n  _state = {\n    cmd = <1>{ \"explorer.exe\", \"C:\" },\n    done = false,\n    handle = <userdata 1>,\n    pid = 29028,\n    stderr = <userdata 2>,\n    stderr_data = {},\n    stdout = <userdata 3>,\n    stdout_data = {}\n  },\n  cmd = <table 1>,\n  pid = 29028,\n  <metatable> = {\n    __index = {\n      _timeout = <function 1>,\n      is_closing = <function 2>,\n      kill = <function 3>,\n      wait = <function 4>,\n      write = <function 5>\n    }\n  }\n}\n```\nThe actual pid for the created explorer.exe was 17800 for that run.",
            "created_at": "2025-10-23T13:18:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436925495",
            "id": 3436925495,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M21I3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436925495/reactions"
            },
            "updated_at": "2025-10-23T13:21:10Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436925495",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "\n\n> If you use this command it works `:call system(['cmd', '/c', 'start', 'explorer.exe', 'C:\\']) `\n\nGood to know. I think there was a reason that `start` (`cmd /c start`) was not used, but we could try it, or maybe special-case it.\n",
            "created_at": "2025-10-23T13:19:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436934179",
            "id": 3436934179,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M23Qj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436934179/reactions"
            },
            "updated_at": "2025-10-23T13:19:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436934179",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Okay I confirmed that each call to `lua = vim.system({'explorer.exe', 'C:'})` does create a new explorer.exe process but the PID is not the same as the one that is printed to messages\n> ...\n\nCan also confirm the PIDs don't match.",
            "created_at": "2025-10-23T13:20:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436942960",
            "id": 3436942960,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M25Zw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436942960/reactions"
            },
            "updated_at": "2025-10-23T13:21:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436942960",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> :call system(['cmd', '/c', 'start', 'explorer.exe', 'C:\\'])\n\nI verified and this does successfully open the file explorer and it is visible.",
            "created_at": "2025-10-23T13:21:15Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436945809",
            "id": 3436945809,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M26GR",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436945809/reactions"
            },
            "updated_at": "2025-10-23T13:21:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436945809",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Good to know. I think there was a reason that `start` (`cmd /c start`) was not used, but we could try it, or maybe special-case it.\n\n`start` is a cmdlet and an alias for [Start-Process](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/start-process?view=powershell-7.5) so who knows how that would behave because it gives no output back when executed. I believe it's best if it's invoked through Command Prompt (`cmd`).",
            "created_at": "2025-10-23T13:25:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436975545",
            "id": 3436975545,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M3BW5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436975545/reactions"
            },
            "updated_at": "2025-10-23T13:25:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436975545",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Might even be best to use `:call system(['cmd', '/c', 'explorer.exe', 'C:\\'])` so that as few PowerShell cmdlet things are used as possible. ",
            "created_at": "2025-10-23T13:28:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3436998792",
            "id": 3436998792,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M3HCI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436998792/reactions"
            },
            "updated_at": "2025-10-23T13:28:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3436998792",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I tried to make it clear that `cmd /c start` is what we would use. Powershell isn't relevant here. `vim.system([...])` does not involve any shell at all unless explicitly specified, which is not the case for `vim.ui.open`.",
            "created_at": "2025-10-23T13:35:16Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3437041267",
            "id": 3437041267,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7M3RZz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3437041267/reactions"
            },
            "updated_at": "2025-10-23T13:35:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3437041267",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I did some more looking into this because I wasn't satisfied that we still didn't know why vim.system didn't work and I think I found the reason. \nIn the _system.lua file we hardcode the `hide` option to true https://github.com/neovim/neovim/blob/2407833ba163e3390c471e632b39d6714afe3ece/runtime/lua/vim/_system.lua#L439\n\nThe field documentation says \n```lua\n--- If true, hide the subprocess console window that would\n--- normally be created. This option is only meaningful on Windows systems. On\n--- Unix it is silently ignored.\n--- @field hide boolean?\n```\n\nSo I set the value to false in my runtime files to see if it fixed it, but by itself it didn't fix the issues and I'm not yet sure why. However, when I copied the relevant functions from _system.lua to a minimum.lua with this modified system function, the minimum.lua did successfully open the file explorer gui.\n\n```lua\nlocal uv = vim.uv\n\n--- @param timeout integer\n--- @param cb fun()\n--- @return uv.uv_timer_t\nlocal function timer_oneshot(timeout, cb)\n\tlocal timer = assert(uv.new_timer())\n\ttimer:start(timeout, 0, function()\n\t\ttimer:stop()\n\t\ttimer:close()\n\t\tcb()\n\tend)\n\treturn timer\nend\n\n--- @param output? fun(err: string?, data: string?)|false\n--- @param text? boolean\n--- @return uv.uv_stream_t? pipe\n--- @return fun(err: string?, data: string?)? handler\n--- @return string[]? data\nlocal function setup_output(output, text)\n\tif output == false then\n\t\treturn\n\tend\n\n\tlocal bucket --- @type string[]?\n\tlocal handler --- @type fun(err: string?, data: string?)\n\n\tif type(output) == \"function\" then\n\t\thandler = output\n\telse\n\t\tbucket = {}\n\t\thandler = function(err, data)\n\t\t\tif err then\n\t\t\t\terror(err)\n\t\t\tend\n\t\t\tif text and data then\n\t\t\t\tbucket[#bucket + 1] = data:gsub(\"\\r\\n\", \"\\n\")\n\t\t\telse\n\t\t\t\tbucket[#bucket + 1] = data\n\t\t\tend\n\t\tend\n\tend\n\n\tlocal pipe = assert(uv.new_pipe(false))\n\n\t--- @param err? string\n\t--- @param data? string\n\tlocal function handler_with_close(err, data)\n\t\thandler(err, data)\n\t\tif data == nil then\n\t\t\tpipe:read_stop()\n\t\t\tpipe:close()\n\t\tend\n\tend\n\n\treturn pipe, handler_with_close, bucket\nend\n\n--- @param input? string|string[]|boolean\n--- @return uv.uv_stream_t?\n--- @return string|string[]?\nlocal function setup_input(input)\n\tif not input then\n\t\treturn\n\tend\n\n\tlocal towrite --- @type string|string[]?\n\tif type(input) == \"string\" or type(input) == \"table\" then\n\t\ttowrite = input\n\tend\n\n\treturn assert(uv.new_pipe(false)), towrite\nend\n\n--- @return table<string,string>\nlocal function base_env()\n\tlocal env = vim.fn.environ() --- @type table<string,string>\n\tenv[\"NVIM\"] = vim.v.servername\n\tenv[\"NVIM_LISTEN_ADDRESS\"] = nil\n\treturn env\nend\n\n--- uv.spawn will completely overwrite the environment\n--- when we just want to modify the existing one, so\n--- make sure to prepopulate it with the current env.\n--- @param env? table<string,string|number>\n--- @param clear_env? boolean\n--- @return string[]?\nlocal function setup_env(env, clear_env)\n\tif not env and clear_env then\n\t\treturn\n\tend\n\n\tenv = env or {}\n\tif not clear_env then\n\t\t--- @type table<string,string|number>\n\t\tenv = vim.tbl_extend(\"force\", base_env(), env)\n\tend\n\n\tlocal renv = {} --- @type string[]\n\tfor k, v in pairs(env) do\n\t\trenv[#renv + 1] = string.format(\"%s=%s\", k, tostring(v))\n\tend\n\n\treturn renv\nend\n\nlocal is_win = vim.fn.has(\"win32\") == 1\n\n--- @param cmd string\n--- @param opts uv.spawn.options\n--- @param on_exit fun(code: integer, signal: integer)\n--- @param on_error fun()\n--- @return uv.uv_process_t, integer\nlocal function spawn(cmd, opts, on_exit, on_error)\n\tif is_win then\n\t\tlocal cmd1 = vim.fn.exepath(cmd)\n\t\tif cmd1 ~= \"\" then\n\t\t\tcmd = cmd1\n\t\tend\n\tend\n\n\tlocal handle, pid_or_err = uv.spawn(cmd, opts, on_exit)\n\tif not handle then\n\t\ton_error()\n\t\tif opts.cwd and not uv.fs_stat(opts.cwd) then\n\t\t\terror((\"%s (cwd): '%s'\"):format(pid_or_err, opts.cwd))\n\t\telseif vim.fn.executable(cmd) == 0 then\n\t\t\terror((\"%s (cmd): '%s'\"):format(pid_or_err, cmd))\n\t\telse\n\t\t\terror(pid_or_err)\n\t\tend\n\tend\n\treturn handle, pid_or_err --[[@as integer]]\nend\n\n---@param handle uv.uv_handle_t?\nlocal function close_handle(handle)\n\tif handle and not handle:is_closing() then\n\t\thandle:close()\n\tend\nend\n\n--- @param state vim.SystemState\n--- @param code integer\n--- @param signal integer\n--- @param on_exit fun(result: vim.SystemCompleted)?\nlocal function _on_exit(state, code, signal, on_exit)\n\tclose_handle(state.handle)\n\tclose_handle(state.stdin)\n\tclose_handle(state.timer)\n\n\t-- #30846: Do not close stdout/stderr here, as they may still have data to\n\t-- read. They will be closed in uv.read_start on EOF.\n\n\tlocal check = uv.new_check()\n\tcheck:start(function()\n\t\tfor _, pipe in pairs({ state.stdin, state.stdout, state.stderr }) do\n\t\t\tif not pipe:is_closing() then\n\t\t\t\treturn\n\t\t\tend\n\t\tend\n\t\tcheck:stop()\n\t\tcheck:close()\n\n\t\tif state.done == nil then\n\t\t\tstate.done = true\n\t\tend\n\n\t\tif (code == 0 or code == 1) and state.done == \"timeout\" then\n\t\t\t-- Unix: code == 0\n\t\t\t-- Windows: code == 1\n\t\t\tcode = 124\n\t\tend\n\n\t\tlocal stdout_data = state.stdout_data\n\t\tlocal stderr_data = state.stderr_data\n\n\t\tstate.result = {\n\t\t\tcode = code,\n\t\t\tsignal = signal,\n\t\t\tstdout = stdout_data and table.concat(stdout_data) or nil,\n\t\t\tstderr = stderr_data and table.concat(stderr_data) or nil,\n\t\t}\n\n\t\tif on_exit then\n\t\t\ton_exit(state.result)\n\t\tend\n\tend)\nend\n\n--- @param state vim.SystemState\nlocal function _on_error(state)\n\tclose_handle(state.handle)\n\tclose_handle(state.stdin)\n\tclose_handle(state.stdout)\n\tclose_handle(state.stderr)\n\tclose_handle(state.timer)\nend\n\n--- @class vim.SystemObj\n--- @field cmd string[] Command name and args\n--- @field pid integer Process ID\n--- @field private _state vim.SystemState\nlocal SystemObj = {}\n\n--- @param state vim.SystemState\n--- @return vim.SystemObj\nlocal function new_systemobj(state)\n\treturn setmetatable({\n\t\tcmd = state.cmd,\n\t\tpid = state.pid,\n\t\t_state = state,\n\t}, { __index = SystemObj })\nend\n\n--- Run a system command\n---\n--- @param cmd string[]\n--- @param opts? vim.SystemOpts\n--- @param on_exit? fun(out: vim.SystemCompleted)\n--- @return vim.SystemObj\nlocal function run(cmd, opts, on_exit)\n\tvim.validate(\"cmd\", cmd, \"table\")\n\tvim.validate(\"opts\", opts, \"table\", true)\n\tvim.validate(\"on_exit\", on_exit, \"function\", true)\n\n\topts = opts or {}\n\n\tlocal stdout, stdout_handler, stdout_data = setup_output(opts.stdout, opts.text)\n\tlocal stderr, stderr_handler, stderr_data = setup_output(opts.stderr, opts.text)\n\tlocal stdin, towrite = setup_input(opts.stdin)\n\n\t--- @type vim.SystemState\n\tlocal state = {\n\t\tdone = false,\n\t\tcmd = cmd,\n\t\ttimeout = opts.timeout,\n\t\tstdin = stdin,\n\t\tstdout = stdout,\n\t\tstdout_data = stdout_data,\n\t\tstderr = stderr,\n\t\tstderr_data = stderr_data,\n\t}\n\n\t--- @diagnostic disable-next-line:missing-fields\n\tstate.handle, state.pid = spawn(cmd[1], {\n\t\targs = vim.list_slice(cmd, 2),\n\t\tstdio = { stdin, stdout, stderr },\n\t\tcwd = opts.cwd,\n\t\t--- @diagnostic disable-next-line:assign-type-mismatch\n\t\tenv = setup_env(opts.env, opts.clear_env),\n\t\tdetached = opts.detach,\n\t\thide = false, --Note: Changing this from true to false fixes opening explorer.exe gui\n\t}, function(code, signal)\n\t\t_on_exit(state, code, signal, on_exit)\n\tend, function()\n\t\t_on_error(state)\n\tend)\n\n\tif stdout and stdout_handler then\n\t\tstdout:read_start(stdout_handler)\n\tend\n\n\tif stderr and stderr_handler then\n\t\tstderr:read_start(stderr_handler)\n\tend\n\n\tlocal obj = new_systemobj(state)\n\n\tif towrite then\n\t\tobj:write(towrite)\n\t\tobj:write(nil) -- close the stream\n\tend\n\n\tif opts.timeout then\n\t\tstate.timer = timer_oneshot(opts.timeout, function()\n\t\t\tif state.handle and state.handle:is_active() then\n\t\t\t\tobj:_timeout()\n\t\t\tend\n\t\tend)\n\tend\n\n\treturn obj\nend\n\n--- @return vim.SystemObj\n--- @overload fun(cmd: string[], on_exit: fun(out: vim.SystemCompleted)): vim.SystemObj\nlocal function system(cmd, opts, on_exit)\n\tif type(opts) == \"function\" then\n\t\ton_exit = opts\n\t\topts = nil\n\tend\n\treturn run(cmd, opts, on_exit)\nend\n\n---------------------------------\n---Everything above is copied from the runtime/lua/vim/_system.lua file except the one change to the hide parameter which \n--- I changed from true to false\n\nsystem({ \"explorer.exe\", \"C:/nvim-win64\" })\n\n```",
            "created_at": "2025-10-26T16:32:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3448676928",
            "id": 3448676928,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7NjqJA",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 2,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3448676928/reactions"
            },
            "updated_at": "2025-10-26T16:41:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3448676928",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Something interesting I've found for this issue is that using,\n```\n:lua vim.system({ 'cmd.exe', '/c', 'start', '', 'C:/' })\n```\nworks 100% of the time, but once you use any of the other options here,\n\n```\n:call system(['explorer.exe', 'C:\\'])\n:call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:\\'])\n:call system(['explorer.exe', 'C:'])\n:call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:'])\n:call system(['explorer.exe', 'C:/'])\n:call system(['rundll32', 'url.dll,FileProtocolHandler', 'C:/'])\n:lua vim.system({'explorer.exe', 'C:\\\\'})\n:lua vim.system({'rundll32', 'url.dll,FileProtocolHandler', 'C:\\\\'})\n```\nit consistently starts a hidden `explorer.exe` process, even if you do `:lua vim.system({ 'cmd.exe', '/c', 'start', '', 'C:/' })`. For it to work again, you need to kill all the previously created hidden `explorer.exe` processes.\n\nI guess since now `vim.ui.open('C:/')` works due to #36731 so the issue can be closed? I understand if it's not satisfactory but this is weird behaviour.",
            "created_at": "2025-12-05T18:34:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3618062052",
            "id": 3618062052,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7Xpz7k",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618062052/reactions"
            },
            "updated_at": "2025-12-05T18:36:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618062052",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> since now `vim.ui.open('C:/')` works due to [#36731](https://github.com/neovim/neovim/pull/36731) so the issue can be closed?\n\nLet's do that since there is a lot of outdated discussion here. But your latest comment could be the basis for a new tracking issue for `vim.system` / `system()`.",
            "created_at": "2025-12-05T19:00:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3618167889",
            "id": 3618167889,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7XqNxR",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 1,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618167889/reactions"
            },
            "updated_at": "2025-12-05T19:00:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618167889",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Yup whatever you prefer. I believe this issue would pop up again if someone uses `vim.system()` without using a shell as the first string. Windows-only of course ",
            "created_at": "2025-12-05T19:26:30Z",
            "html_url": "https://github.com/neovim/neovim/issues/36293#issuecomment-3618269659",
            "id": 3618269659,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36293",
            "node_id": "IC_kwDOAPphoM7Xqmnb",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618269659/reactions"
            },
            "updated_at": "2025-12-05T19:26:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618269659",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 23,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36293/comments",
    "created_at": "2025-10-23T10:36:32Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/36293/events",
    "html_url": "https://github.com/neovim/neovim/issues/36293",
    "id": 3544118447,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "d4c5f9",
            "default": false,
            "description": null,
            "id": 109461219,
            "name": "platform:windows",
            "node_id": "MDU6TGFiZWwxMDk0NjEyMTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/platform:windows"
        },
        {
            "color": "BFDADC",
            "default": false,
            "description": "Low-risk, self-contained. Do NOT ask \"can I work on this\", just read CONTRIBUTING.md",
            "id": 407246773,
            "name": "complexity:low",
            "node_id": "MDU6TGFiZWw0MDcyNDY3NzM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/complexity:low"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "",
            "id": 606691254,
            "name": "has:plan",
            "node_id": "MDU6TGFiZWw2MDY2OTEyNTQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:plan"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "file metadata/attributes, filenames, path manipulation",
            "id": 3386070083,
            "name": "filesystem",
            "node_id": "LA_kwDOAPphoM7J01RD",
            "url": "https://api.github.com/repos/neovim/neovim/labels/filesystem"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/36293/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 761,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 638,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-12-08T23:16:37Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM7TPvSv",
    "number": 36293,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/36293/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/36293/timeline",
    "title": "`vim.ui.open(\"C:\\\\\")` succeeds but doesn't open `explorer.exe`",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-12-05T19:26:30Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/36293",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
        "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
        "followers_url": "https://api.github.com/users/ymich9963/followers",
        "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
        "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ymich9963",
        "id": 79522843,
        "login": "ymich9963",
        "node_id": "MDQ6VXNlcjc5NTIyODQz",
        "organizations_url": "https://api.github.com/users/ymich9963/orgs",
        "received_events_url": "https://api.github.com/users/ymich9963/received_events",
        "repos_url": "https://api.github.com/users/ymich9963/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ymich9963",
        "user_view_type": "public"
    }
}
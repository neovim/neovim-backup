{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Describe the bug\n\nThere's a [section of `:h tui-cursor-tmux`](https://github.com/neovim/neovim/blob/master/runtime/doc/term.txt#L220-L222) that reads:\r\n\r\n> Unlike Nvim, if [the \"Ss\" and \"Se\" capabilities] are not in terminfo you must add them by setting \"terminal-overrides\" in ~/.tmux.conf .\r\n\r\nThis line confused me for a bit since they are not in my terminfo (I'm using `tmux-256color` and verified this with `infocmp`) and I do not have terminal overrides for those capabilities in my `~/.tmux.conf` but cursor style is still working properly. Maybe this was fixed in a newer version of tmux? I'm using tmux 3.1c.\n\n### Steps to reproduce\n\n- `infocmp tmux-256color`: verify that Ss and Se are absent\r\n- `tmux -V`: Check the tmux the version (I tested with 3.1c)\r\n- In `~/.tmux.conf`: `set-option -g default-terminal \"tmux-256color\"`\r\n- In `~/.tmux.conf`, verify that the `terminal-overrides` setting omits Ss and Se\r\n- Open Neovim and enter insert mode\n\n### Expected behavior\n\nBehavior for me is that cursor shape changes correctly - if it does, I think the documentation needs to be updated.\n\n### Neovim version (nvim -v)\n\n0.7.0\n\n### Vim (not Nvim) behaves the same?\n\nN/A\n\n### Operating system/version\n\nCentOS 7.9\n\n### Terminal name/version\n\nxfce4-terminal 0.8.10\n\n### $TERM environment variable\n\ntmux-256color\n\n### Installation\n\nsystem package manager",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "Possibly also related: This [FAQ](https://github.com/neovim/neovim/wiki/FAQ#cursor-shape-doesnt-change-in-tmux) directs to https://github.com/neovim/neovim/pull/3165, which was merged - looks like that happened a long time ago (commit is tagged as [v0.1.2](https://github.com/neovim/neovim/releases/tag/v0.1.2))",
            "created_at": "2023-01-21T15:30:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/21938#issuecomment-1399271937",
            "id": 1399271937,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21938",
            "node_id": "IC_kwDOAPphoM5TZzIB",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1399271937/reactions"
            },
            "updated_at": "2023-01-21T15:30:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1399271937",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/802511?v=4",
                "events_url": "https://api.github.com/users/ddickstein/events{/privacy}",
                "followers_url": "https://api.github.com/users/ddickstein/followers",
                "following_url": "https://api.github.com/users/ddickstein/following{/other_user}",
                "gists_url": "https://api.github.com/users/ddickstein/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ddickstein",
                "id": 802511,
                "login": "ddickstein",
                "node_id": "MDQ6VXNlcjgwMjUxMQ==",
                "organizations_url": "https://api.github.com/users/ddickstein/orgs",
                "received_events_url": "https://api.github.com/users/ddickstein/received_events",
                "repos_url": "https://api.github.com/users/ddickstein/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ddickstein/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ddickstein/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ddickstein",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "PR welcome",
            "created_at": "2023-01-23T10:40:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/21938#issuecomment-1400133573",
            "id": 1400133573,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21938",
            "node_id": "IC_kwDOAPphoM5TdFfF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1400133573/reactions"
            },
            "updated_at": "2023-01-23T10:40:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1400133573",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@ddickstein There is a problem with your confirmation method. I briefly checked the [`tmux` source](https://github.com/tmux/tmux/tree/f5af3cfb211c12897b15e3b5a3b29c4bbb0493a8), and that description is still correct.\r\n\r\n> `infocmp tmux-256color`: verify that Ss and Se are absent\r\n\r\nThe presence of `Ss`, `Se` is never reported because the correct command line options are not given. See man `terminfo(5)` `User-Defined Capabilities`.\r\n\r\nAlso, in this case, it does not make sense to examine `tmux-256color`. If you knew what `terminal-overrides` overrides, you wouldn't think to check `tmux-256color`. You need to understand which of the following does `terminal-overrides` override.\r\n\r\n- The `terminfo` entry for the host terminal used by `tmux`.\r\n- The `terminfo` entries used by applications running on `tmux` (such as neovim).\r\n\r\nIf you can improve this description with the above understanding, PR is welcome.\r\n",
            "created_at": "2023-01-23T13:40:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/21938#issuecomment-1400365626",
            "id": 1400365626,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21938",
            "node_id": "IC_kwDOAPphoM5Td-I6",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1400365626/reactions"
            },
            "updated_at": "2023-01-23T14:09:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1400365626",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11682285?v=4",
                "events_url": "https://api.github.com/users/erw7/events{/privacy}",
                "followers_url": "https://api.github.com/users/erw7/followers",
                "following_url": "https://api.github.com/users/erw7/following{/other_user}",
                "gists_url": "https://api.github.com/users/erw7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/erw7",
                "id": 11682285,
                "login": "erw7",
                "node_id": "MDQ6VXNlcjExNjgyMjg1",
                "organizations_url": "https://api.github.com/users/erw7/orgs",
                "received_events_url": "https://api.github.com/users/erw7/received_events",
                "repos_url": "https://api.github.com/users/erw7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/erw7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/erw7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/erw7",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "If you are willing to create a PR for us, please remove the following `putty`. `Putty` does not implement `DECSCUSR`, so the cursor shape does not change on `putty`.\r\n\r\nhttps://github.com/neovim/neovim/blob/3b7548504344d72b0228e1bd29a7f28df813a3bd/runtime/doc/term.txt#L207-L212\r\n\r\nThus, the answer to your following question in #20027 is that implement `DECSCUSR` in putty.\r\n\r\n> Is there something more that I need to do to make this work?\r\n\r\n",
            "created_at": "2023-01-23T14:03:49Z",
            "html_url": "https://github.com/neovim/neovim/issues/21938#issuecomment-1400402617",
            "id": 1400402617,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21938",
            "node_id": "IC_kwDOAPphoM5TeHK5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1400402617/reactions"
            },
            "updated_at": "2023-01-23T14:03:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1400402617",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11682285?v=4",
                "events_url": "https://api.github.com/users/erw7/events{/privacy}",
                "followers_url": "https://api.github.com/users/erw7/followers",
                "following_url": "https://api.github.com/users/erw7/following{/other_user}",
                "gists_url": "https://api.github.com/users/erw7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/erw7",
                "id": 11682285,
                "login": "erw7",
                "node_id": "MDQ6VXNlcjExNjgyMjg1",
                "organizations_url": "https://api.github.com/users/erw7/orgs",
                "received_events_url": "https://api.github.com/users/erw7/received_events",
                "repos_url": "https://api.github.com/users/erw7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/erw7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/erw7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/erw7",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thank you for explaining. Here's my current understanding:\r\n\r\n1. To see user-defined capabilities, the `-x` flag needs to be passed to `infocmp`.\r\n2. If I check `infocmp -x` outside tmux (where for me, `TERM=xterm-256color`), I do see `Ss` and `Se`. This means that tmux will know that the terminal supports cursor shapes.\r\n3. If I had not seen `Ss` and `Se` in `infocmp -x` outside tmux, but my terminal did in fact support cursor shapes, I would have either needed to update the terminfo for `xterm-256color` or have added these capabilities to `terminal-overrides`, which tmux uses to interpret the capabilities of the terminal in which it's running.\r\n4. Tmux changes `TERM` based on the `default-terminal` setting in `~/.tmux.conf`. This is the `TERM` value applications inside tmux, such as Neovim, will see, and they will use its terminfo entry to learn about the terminal's capabilities.\r\n5. Neovim does more than just take terminfo at face value - if `Ss` and `Se` are missing, it adds them under the following conditions:\r\n    ```\r\n    If your terminfo definition is missing them, then Nvim will decide whether to add them to your\r\n    terminfo definition, by looking at $TERM and other environment variables.  For the \"rxvt\", \"putty\",\r\n    \"linux\", \"screen\", \"teraterm\", and \"iterm\" terminal types, or when Konsole, a libvte-based terminal\r\n    emulator, or genuine Xterm are detected, it will add constructed \"Ss\" and \"Se\" capabilities.\r\n    ```\r\n    I take it that `\"tmux\"`, though not listed here, falls under `\"screen\"`. But this note in the docs is cautioning that this is behavior Neovim is choosing to perform, and assume other programs (e.g., tmux), do this same kind of augmentation.\r\n6. Re: the referenced `putty` issue, since `putty` actually does not have the capability required for cursor shape (i.e., proper interpretation of the DECSCUSR escape sequence), it isn't possible to update the cursor shape. Updating its terminfo wouldn't help, since terminfo is just meant to reflect the capabilities that the terminal emulator actually provides.\r\n\r\nIs that correct?",
            "created_at": "2023-01-24T16:38:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/21938#issuecomment-1402245908",
            "id": 1402245908,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21938",
            "node_id": "IC_kwDOAPphoM5TlJMU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1402245908/reactions"
            },
            "updated_at": "2023-01-24T16:38:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1402245908",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/802511?v=4",
                "events_url": "https://api.github.com/users/ddickstein/events{/privacy}",
                "followers_url": "https://api.github.com/users/ddickstein/followers",
                "following_url": "https://api.github.com/users/ddickstein/following{/other_user}",
                "gists_url": "https://api.github.com/users/ddickstein/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ddickstein",
                "id": 802511,
                "login": "ddickstein",
                "node_id": "MDQ6VXNlcjgwMjUxMQ==",
                "organizations_url": "https://api.github.com/users/ddickstein/orgs",
                "received_events_url": "https://api.github.com/users/ddickstein/received_events",
                "repos_url": "https://api.github.com/users/ddickstein/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ddickstein/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ddickstein/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ddickstein",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Is that correct?\r\n\r\nYes. However, for 5, the relevant document is outdated or incorrect. Neovim completes the missing `Ss`, `Se` in the following code. Therefore, `alacritty`, `cygwin`, `hterm`, `st`, and `tmux` must be added (I may have missed some, so someone please double check).\r\nhttps://github.com/neovim/neovim/blob/06d1e86ff8e7814e4a648293c1a90414fe82bb1e/src/nvim/tui/tui.c#L1906-L1996\r\n\r\nRegarding `screen`, there is a [patch](https://lists.gnu.org/archive/html/screen-devel/2013-03/msg00000.html) that implements `DECSCUSR`, but it has not yet been merged in v4.9.0. Therefore, if this patch is not applied, `screen` will not change the cursor shape.\r\n\r\nhttps://git.savannah.gnu.org/cgit/screen.git/tree/src/ansi.c?h=v.4.9.0\r\nhttps://www.gnu.org/software/screen/manual/html_node/Control-Sequences.html\r\n\r\nRegarding `putty`, `DECSCUSR` is not implemented in the source on this [page](https://github.com/github/putty/blob/7003b43963aef6cdf2841c2a882a684025f1d806/terminal.c), although it is not the latest source. Also, the cursor shape does not change when the command (`printf \"\\x1b[4 q\"`) is executed in 0.7.8 (latest) to actually send the `DECSCUSR` sequence. Therefore, it should not be implemented. The MinTTY release notes mentioned in the code comment above are too old to find.\r\n\r\n~I am skeptical about `cygwin`, although I can't confirm this as I don't already have an environment where `TERM` is `cygwin`(command prompt before the so-called `conpty` implementation). However, `cygwin` currently uses `conpty` if it is available, so setting `TERM` to `xterm` changes the cursor shape.~\r\n\r\nI was able to confirm this by using \"Use legacy console\". It appears that `DECSCUSR` is also implemented in legacy consoles, although incomplete. It was me who added `cygwin` in the above code in the first place lol.\r\n\r\nhttps://github.com/cygwin/cygwin/blob/9ddd48ee1b8d736ebbd0b0bdf146ecf96774cd8a/winsup/cygwin/fhandler/console.cc#L3068",
            "created_at": "2023-01-25T14:06:48Z",
            "html_url": "https://github.com/neovim/neovim/issues/21938#issuecomment-1403677655",
            "id": 1403677655,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21938",
            "node_id": "IC_kwDOAPphoM5TqmvX",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1403677655/reactions"
            },
            "updated_at": "2023-01-26T12:08:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1403677655",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11682285?v=4",
                "events_url": "https://api.github.com/users/erw7/events{/privacy}",
                "followers_url": "https://api.github.com/users/erw7/followers",
                "following_url": "https://api.github.com/users/erw7/following{/other_user}",
                "gists_url": "https://api.github.com/users/erw7/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/erw7",
                "id": 11682285,
                "login": "erw7",
                "node_id": "MDQ6VXNlcjExNjgyMjg1",
                "organizations_url": "https://api.github.com/users/erw7/orgs",
                "received_events_url": "https://api.github.com/users/erw7/received_events",
                "repos_url": "https://api.github.com/users/erw7/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/erw7/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/erw7/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/erw7",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/21938/comments",
    "created_at": "2023-01-21T15:25:47Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/21938/events",
    "html_url": "https://github.com/neovim/neovim/issues/21938",
    "id": 1551829444,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": true,
            "description": "",
            "id": 84744038,
            "name": "documentation",
            "node_id": "MDU6TGFiZWw4NDc0NDAzOA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/documentation"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/21938/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5cfwnE",
    "number": 21938,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/21938/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/21938/timeline",
    "title": "Documentation around cursor shape in tmux is outdated (or needs clarification)",
    "updated_at": "2025-01-19T11:34:59Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/21938",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/802511?v=4",
        "events_url": "https://api.github.com/users/ddickstein/events{/privacy}",
        "followers_url": "https://api.github.com/users/ddickstein/followers",
        "following_url": "https://api.github.com/users/ddickstein/following{/other_user}",
        "gists_url": "https://api.github.com/users/ddickstein/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/ddickstein",
        "id": 802511,
        "login": "ddickstein",
        "node_id": "MDQ6VXNlcjgwMjUxMQ==",
        "organizations_url": "https://api.github.com/users/ddickstein/orgs",
        "received_events_url": "https://api.github.com/users/ddickstein/received_events",
        "repos_url": "https://api.github.com/users/ddickstein/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/ddickstein/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ddickstein/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/ddickstein",
        "user_view_type": "public"
    }
}
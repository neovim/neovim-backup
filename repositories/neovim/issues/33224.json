{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Problem\n\n\n    Error executing lua callback: /usr/local/share/nvim/runtime/lua/vim/lsp/sync.lua:142: attempt to get length of local 'prev_line' (a nil value)\n    stack traceback:\n            /usr/local/share/nvim/runtime/lua/vim/lsp/sync.lua:142: in function 'compute_start_range'\n            /usr/local/share/nvim/runtime/lua/vim/lsp/sync.lua:390: in function 'compute_diff'\n            ...local/share/nvim/runtime/lua/vim/lsp/_changetracking.lua:106: in function 'incremental_changes'\n            ...local/share/nvim/runtime/lua/vim/lsp/_changetracking.lua:311: in function 'send_changes_for_group'\n            ...local/share/nvim/runtime/lua/vim/lsp/_changetracking.lua:348: in function 'send_changes'\n            /usr/local/share/nvim/runtime/lua/vim/lsp.lua:869: in function </usr/local/share/nvim/runtime/lua/vim/lsp.lua:863>\n\n\n\nRelated: https://github.com/neovim/neovim/issues/33142\n\n\n\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\n\nDon't have exact steps. Try using lsp-driven autocompletion in a `buftype=prompt` buffer.\n\n### Expected behavior\n\nlsp module should never fail in this way. It should check that buffers/windows are valid before trying to operate on them.\n\n### Nvim version (nvim -v)\n\n0.12\n\n### Language server name/version\n\nany\n\n### Operating system/version\n\nmacos\n\n### Log file\n\n_No response_",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "Hi, I am getting a similar error message when using `:AvanteEdit` on a block of code that begins with file first line (I think). It does not happen with neovim 0.10.4, is reproducible every time with 0.11.0. Thank you.\n\n```\nError executing vim.schedule lua callback: ...cal/share/nvim/lazy/avante.nvim/lua/avante/selection.lua:164: Vim:Error executing lua callback\n: ...unwrapped-0.11.0/share/nvim/runtime/lua/vim/lsp/sync.lua:195: attempt to get length of local 'prev_line' (a nil value)\nstack traceback:\n        ...unwrapped-0.11.0/share/nvim/runtime/lua/vim/lsp/sync.lua:195: in function 'compute_end_range'\n        ...unwrapped-0.11.0/share/nvim/runtime/lua/vim/lsp/sync.lua:401: in function 'compute_diff'\n        ....11.0/share/nvim/runtime/lua/vim/lsp/_changetracking.lua:106: in function 'incremental_changes'\n        ....11.0/share/nvim/runtime/lua/vim/lsp/_changetracking.lua:311: in function 'send_changes_for_group'\n        ....11.0/share/nvim/runtime/lua/vim/lsp/_changetracking.lua:348: in function 'send_changes'\n        ...ovim-unwrapped-0.11.0/share/nvim/runtime/lua/vim/lsp.lua:869: in function <...ovim-unwrapped-0.11.0/share/nvim/runtime/lua/vim/ls\np.lua:863>\n        [C]: in function 'nvim_buf_set_lines'\n        ...cal/share/nvim/lazy/avante.nvim/lua/avante/selection.lua:164: in function ''\n        vim/_editor.lua: in function <vim/_editor.lua:0>\nstack traceback:\n        [C]: in function 'nvim_buf_set_lines'\n        ...cal/share/nvim/lazy/avante.nvim/lua/avante/selection.lua:164: in function ''\n        vim/_editor.lua: in function <vim/_editor.lua:0>\n```",
            "created_at": "2025-04-02T10:59:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/33224#issuecomment-2772202181",
            "id": 2772202181,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33224",
            "node_id": "IC_kwDOAPphoM6lPHLF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2772202181/reactions"
            },
            "updated_at": "2025-04-02T10:59:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2772202181",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/15679217?v=4",
                "events_url": "https://api.github.com/users/Kamilcuk/events{/privacy}",
                "followers_url": "https://api.github.com/users/Kamilcuk/followers",
                "following_url": "https://api.github.com/users/Kamilcuk/following{/other_user}",
                "gists_url": "https://api.github.com/users/Kamilcuk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Kamilcuk",
                "id": 15679217,
                "login": "Kamilcuk",
                "node_id": "MDQ6VXNlcjE1Njc5MjE3",
                "organizations_url": "https://api.github.com/users/Kamilcuk/orgs",
                "received_events_url": "https://api.github.com/users/Kamilcuk/received_events",
                "repos_url": "https://api.github.com/users/Kamilcuk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Kamilcuk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Kamilcuk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Kamilcuk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@Kamilcuk are you using `vim.lsp.config` / `vim.lsp.enable` ? I'm wondering if this correlates with that.",
            "created_at": "2025-04-02T12:21:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/33224#issuecomment-2772391999",
            "id": 2772391999,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33224",
            "node_id": "IC_kwDOAPphoM6lP1g_",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2772391999/reactions"
            },
            "updated_at": "2025-04-02T12:22:23Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2772391999",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "In Neovim 0.11, this error occurs whenever a swap file is present for the active buffer. Deleting the swap file fixes the error.",
            "created_at": "2025-04-17T18:56:47Z",
            "html_url": "https://github.com/neovim/neovim/issues/33224#issuecomment-2813783479",
            "id": 2813783479,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33224",
            "node_id": "IC_kwDOAPphoM6ntu23",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2813783479/reactions"
            },
            "updated_at": "2025-04-17T18:56:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2813783479",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/13303?v=4",
                "events_url": "https://api.github.com/users/jrasanen/events{/privacy}",
                "followers_url": "https://api.github.com/users/jrasanen/followers",
                "following_url": "https://api.github.com/users/jrasanen/following{/other_user}",
                "gists_url": "https://api.github.com/users/jrasanen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jrasanen",
                "id": 13303,
                "login": "jrasanen",
                "node_id": "MDQ6VXNlcjEzMzAz",
                "organizations_url": "https://api.github.com/users/jrasanen/orgs",
                "received_events_url": "https://api.github.com/users/jrasanen/received_events",
                "repos_url": "https://api.github.com/users/jrasanen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jrasanen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jrasanen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jrasanen",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> are you using vim.lsp.config / vim.lsp.enable ? \n\nyes",
            "created_at": "2025-04-17T22:11:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/33224#issuecomment-2814115295",
            "id": 2814115295,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33224",
            "node_id": "IC_kwDOAPphoM6nu_3f",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2814115295/reactions"
            },
            "updated_at": "2025-04-17T22:11:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2814115295",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/15679217?v=4",
                "events_url": "https://api.github.com/users/Kamilcuk/events{/privacy}",
                "followers_url": "https://api.github.com/users/Kamilcuk/followers",
                "following_url": "https://api.github.com/users/Kamilcuk/following{/other_user}",
                "gists_url": "https://api.github.com/users/Kamilcuk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Kamilcuk",
                "id": 15679217,
                "login": "Kamilcuk",
                "node_id": "MDQ6VXNlcjE1Njc5MjE3",
                "organizations_url": "https://api.github.com/users/Kamilcuk/orgs",
                "received_events_url": "https://api.github.com/users/Kamilcuk/received_events",
                "repos_url": "https://api.github.com/users/Kamilcuk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Kamilcuk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Kamilcuk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Kamilcuk",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/33224/comments",
    "created_at": "2025-03-31T13:59:31Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/33224/events",
    "html_url": "https://github.com/neovim/neovim/issues/33224",
    "id": 2960592572,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/33224/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 54,
        "created_at": "2025-03-14T12:12:07Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
            "events_url": "https://api.github.com/users/clason/events{/privacy}",
            "followers_url": "https://api.github.com/users/clason/followers",
            "following_url": "https://api.github.com/users/clason/following{/other_user}",
            "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/clason",
            "id": 2361214,
            "login": "clason",
            "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
            "organizations_url": "https://api.github.com/users/clason/orgs",
            "received_events_url": "https://api.github.com/users/clason/received_events",
            "repos_url": "https://api.github.com/users/clason/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/clason",
            "user_view_type": "public"
        },
        "description": "",
        "due_on": "2025-04-18T07:00:00Z",
        "html_url": "https://github.com/neovim/neovim/milestone/49",
        "id": 12520861,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/49/labels",
        "node_id": "MI_kwDOAPphoM4Avw2d",
        "number": 49,
        "open_issues": 21,
        "state": "open",
        "title": "0.11.1",
        "updated_at": "2025-04-21T23:18:03Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/49"
    },
    "node_id": "I_kwDOAPphoM6wdw68",
    "number": 33224,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 2,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 2,
        "url": "https://api.github.com/repos/neovim/neovim/issues/33224/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/33224/timeline",
    "title": "LSP: nil reference in `compute_start_range`",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-04-17T22:11:39Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/33224",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "In #7473 we incorrectly decided that a terminal supported colon-delimited RGB sequences. We need a more reliable way to detect support for that. And other capabilities, where possible.\r\n\r\nVim \"term response\" handling: https://github.com/neovim/neovim/issues/6279\r\n\r\n- `may_req_ambiguous_char_width()` [src](https://github.com/vim/vim/blob/93343725b5fa1cf580a24302455980faacae8ee2/src/term.c#L3570)\r\n- `req_codes_from_term`, `check_for_codes_from_term` [src](https://github.com/vim/vim/blob/93343725b5fa1cf580a24302455980faacae8ee2/src/term.c#L6428                                                         \r\n)\r\n\r\ncolon-delimited RGB:\r\n\r\n- Motivation for colon delimiters: https://github.com/kovidgoyal/kitty/issues/160#issuecomment-341902195 \r\n    - See also https://github.com/neovim/neovim/issues/7473#issuecomment-341899848\r\n- detect via [DECRQSS](https://github.com/neovim/neovim/issues/7490#issuecomment-348645326)\r\n\r\ncursor capability:\r\n\r\n- Vim patch to detect xterm-compatible cursor capability: https://github.com/vim/vim/pull/2126\r\n- Related: https://github.com/neovim/neovim/pull/5556",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "IMO you should just use semi-colons. There is no reliable way to detect it. You cannot use TERM (it is often overriden by users). You cannot use other environment variables because then launching one terminal from another will break detection. Not to mention SSH sessions will not work since env vars are not passed over SSH unconditionally. \r\n\r\nThe best you can do is use some escape sequence such as DECQRM to query the terminal for support. But no terminals currently implement this. kitty implements DECQRM detection for all its protocol extensions, but since this one predates kitty I did not assign a DECQRM code for it. ",
            "created_at": "2017-11-06T03:37:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/7490#issuecomment-342038344",
            "id": 342038344,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/7490",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0MjAzODM0NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/342038344/reactions"
            },
            "updated_at": "2017-11-06T03:37:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/342038344",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1308621?v=4",
                "events_url": "https://api.github.com/users/kovidgoyal/events{/privacy}",
                "followers_url": "https://api.github.com/users/kovidgoyal/followers",
                "following_url": "https://api.github.com/users/kovidgoyal/following{/other_user}",
                "gists_url": "https://api.github.com/users/kovidgoyal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kovidgoyal",
                "id": 1308621,
                "login": "kovidgoyal",
                "node_id": "MDQ6VXNlcjEzMDg2MjE=",
                "organizations_url": "https://api.github.com/users/kovidgoyal/orgs",
                "received_events_url": "https://api.github.com/users/kovidgoyal/received_events",
                "repos_url": "https://api.github.com/users/kovidgoyal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kovidgoyal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kovidgoyal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kovidgoyal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> you should just use semi-colons. There is no reliable way to detect it.\r\n\r\n@kovidgoyal We do use semicolons almost always. But for reference, @leonerd mentioned that DECRQSS could be used:\r\n\r\n> set colour 255, then query the SGR mode using DECRQSS and see if the reply comes back with colons in it\r\n> If it does, that seems pretty likely that the terminal understands colons\r\n",
            "created_at": "2017-12-01T23:54:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/7490#issuecomment-348645326",
            "id": 348645326,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/7490",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODY0NTMyNg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/348645326/reactions"
            },
            "updated_at": "2017-12-01T23:54:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/348645326",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Sure, if you are willing to query the terminal then there are possibilities, but I would not have thought that is appropriate for something as basic as colors. If you decide to wait for a reply before drawing anything on screen, then nvim startup times wil be slow, or if you just use one without waiting for a reply then you could get weirs effects where the appearance of the screen changes after the reply is received.",
            "created_at": "2017-12-02T02:45:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/7490#issuecomment-348662348",
            "id": 348662348,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/7490",
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODY2MjM0OA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/348662348/reactions"
            },
            "updated_at": "2017-12-02T02:45:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/348662348",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1308621?v=4",
                "events_url": "https://api.github.com/users/kovidgoyal/events{/privacy}",
                "followers_url": "https://api.github.com/users/kovidgoyal/followers",
                "following_url": "https://api.github.com/users/kovidgoyal/following{/other_user}",
                "gists_url": "https://api.github.com/users/kovidgoyal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kovidgoyal",
                "id": 1308621,
                "login": "kovidgoyal",
                "node_id": "MDQ6VXNlcjEzMDg2MjE=",
                "organizations_url": "https://api.github.com/users/kovidgoyal/orgs",
                "received_events_url": "https://api.github.com/users/kovidgoyal/received_events",
                "repos_url": "https://api.github.com/users/kovidgoyal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kovidgoyal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kovidgoyal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kovidgoyal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "This issue has been mentioned on **Neovim Discourse**. There might be relevant details there:\n\nhttps://neovim.discourse.group/t/nitty-gritty-questions-on-terminal-nvim-and-keyboard-events/1624/1\n",
            "created_at": "2021-12-04T19:04:29Z",
            "html_url": "https://github.com/neovim/neovim/issues/7490#issuecomment-986077416",
            "id": 986077416,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/7490",
            "node_id": "IC_kwDOAPphoM46xljo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/986077416/reactions"
            },
            "updated_at": "2021-12-04T19:04:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/986077416",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79666652?v=4",
                "events_url": "https://api.github.com/users/neovim-discourse/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim-discourse/followers",
                "following_url": "https://api.github.com/users/neovim-discourse/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim-discourse/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim-discourse",
                "id": 79666652,
                "login": "neovim-discourse",
                "node_id": "MDQ6VXNlcjc5NjY2NjUy",
                "organizations_url": "https://api.github.com/users/neovim-discourse/orgs",
                "received_events_url": "https://api.github.com/users/neovim-discourse/received_events",
                "repos_url": "https://api.github.com/users/neovim-discourse/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim-discourse/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim-discourse/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/neovim-discourse",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/7490/comments",
    "created_at": "2017-11-05T23:21:23Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/7490/events",
    "html_url": "https://github.com/neovim/neovim/issues/7490",
    "id": 271324473,
    "labels": [
        {
            "color": "c7def8",
            "default": false,
            "description": "user experience",
            "id": 151718455,
            "name": "ux",
            "node_id": "MDU6TGFiZWwxNTE3MTg0NTU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ux"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/7490/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 726,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 630,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-07-07T03:51:31Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "MDU6SXNzdWUyNzEzMjQ0NzM=",
    "number": 7490,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/7490/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/7490/timeline",
    "title": "TUI: better terminal-type detection",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-07-02T08:57:43Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/7490",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nWhen the shell's prompt spans multiple lines (e.g., default config from [starship](https://starship.rs/)), closing a window may cause the cursor to be drawn on the wrong position.\n\n### Steps to reproduce\n\n1. `:term`\n2. `:vert new`\n3. Repeat step 2 until prompt wraps into multiple lines:\nStart:\n\n<img width=\"597\" height=\"116\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/d16ad41b-10c6-477d-bb95-c1dd6b888b62\" />\n\nExpected:\n\n<img width=\"502\" height=\"140\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/b3109a5a-d5a4-432a-a103-18c923c29355\" />\n\n4.  Switch to terminal window\n5. `:new|quit|starti`\n6. Insert any text, it will not show on the correct line:\n<img width=\"551\" height=\"129\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c6557453-e87a-4503-acda-2c8b05df1fb1\" />\n\n### Expected behavior\n\nCursor should be drawn on the correct line\n\n### Nvim version (nvim -v)\n\nv0.12.0-dev-2246+g57fc77ed29\n\n### Vim (not Nvim) behaves the same?\n\nN/A\n\n### Operating system/version\n\nLinux 6.18\n\n### Terminal name/version\n\nfoot 1.25.0\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nAUR",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "How do you get the prompt to wrap into multiple lines? I get a one-line truncated prompt.",
            "created_at": "2026-02-10T01:03:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/37800#issuecomment-3874735157",
            "id": 3874735157,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37800",
            "node_id": "IC_kwDOAPphoM7m88Q1",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874735157/reactions"
            },
            "updated_at": "2026-02-10T01:03:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874735157",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> How do you get the prompt to wrap into multiple lines?\n\nIt just does that, once I trigger the last `vert new`. Could be an issue with starship, though.",
            "created_at": "2026-02-10T01:06:01Z",
            "html_url": "https://github.com/neovim/neovim/issues/37800#issuecomment-3874743209",
            "id": 3874743209,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37800",
            "node_id": "IC_kwDOAPphoM7m8-Op",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874743209/reactions"
            },
            "updated_at": "2026-02-10T01:06:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874743209",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/84649544?v=4",
                "events_url": "https://api.github.com/users/igorlfs/events{/privacy}",
                "followers_url": "https://api.github.com/users/igorlfs/followers",
                "following_url": "https://api.github.com/users/igorlfs/following{/other_user}",
                "gists_url": "https://api.github.com/users/igorlfs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/igorlfs",
                "id": 84649544,
                "login": "igorlfs",
                "node_id": "MDQ6VXNlcjg0NjQ5NTQ0",
                "organizations_url": "https://api.github.com/users/igorlfs/orgs",
                "received_events_url": "https://api.github.com/users/igorlfs/received_events",
                "repos_url": "https://api.github.com/users/igorlfs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/igorlfs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/igorlfs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/igorlfs",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Ah, it doesn't wrap in fish. Still cannot reproduce in bash or zsh, either.",
            "created_at": "2026-02-10T01:07:31Z",
            "html_url": "https://github.com/neovim/neovim/issues/37800#issuecomment-3874747329",
            "id": 3874747329,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37800",
            "node_id": "IC_kwDOAPphoM7m8_PB",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874747329/reactions"
            },
            "updated_at": "2026-02-10T01:09:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874747329",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Still cannot reproduce in bash or zsh, either.\n\nLet me know if this happens to be an issue with fish",
            "created_at": "2026-02-10T01:42:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/37800#issuecomment-3874844975",
            "id": 3874844975,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37800",
            "node_id": "IC_kwDOAPphoM7m9XEv",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874844975/reactions"
            },
            "updated_at": "2026-02-10T01:42:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874844975",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/84649544?v=4",
                "events_url": "https://api.github.com/users/igorlfs/events{/privacy}",
                "followers_url": "https://api.github.com/users/igorlfs/followers",
                "following_url": "https://api.github.com/users/igorlfs/following{/other_user}",
                "gists_url": "https://api.github.com/users/igorlfs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/igorlfs",
                "id": 84649544,
                "login": "igorlfs",
                "node_id": "MDQ6VXNlcjg0NjQ5NTQ0",
                "organizations_url": "https://api.github.com/users/igorlfs/orgs",
                "received_events_url": "https://api.github.com/users/igorlfs/received_events",
                "repos_url": "https://api.github.com/users/igorlfs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/igorlfs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/igorlfs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/igorlfs",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I got the wrapping to happen with `fish -N -C 'starship init fish | source'`. Still cannot reproduce.",
            "created_at": "2026-02-10T02:15:26Z",
            "html_url": "https://github.com/neovim/neovim/issues/37800#issuecomment-3874926827",
            "id": 3874926827,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37800",
            "node_id": "IC_kwDOAPphoM7m9rDr",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874926827/reactions"
            },
            "updated_at": "2026-02-10T02:22:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874926827",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "This also happended for zsh with p10k theme.\n\nSteps:\n\n1. `nvim --clean`\n2. `:term`\n\n<img width=\"689\" height=\"165\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c3281d7a-f961-4e02-89ea-39b92f267a24\" />\n\n3. `:new|quit|starti` then the cursor always go to the end of prompt\n\n<img width=\"689\" height=\"166\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/fa5bf1c9-4fcb-459e-ba39-958f86606ed4\" />\n\nExpected:\n\n<img width=\"692\" height=\"165\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/153591af-87f6-4708-ac02-62bb256a2372\" />\n\nOS: WSL2 Arch\nnvim: 0.11.6",
            "created_at": "2026-02-10T02:29:33Z",
            "html_url": "https://github.com/neovim/neovim/issues/37800#issuecomment-3874967688",
            "id": 3874967688,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37800",
            "node_id": "IC_kwDOAPphoM7m91CI",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874967688/reactions"
            },
            "updated_at": "2026-02-10T03:16:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3874967688",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/57262511?v=4",
                "events_url": "https://api.github.com/users/SheffeyG/events{/privacy}",
                "followers_url": "https://api.github.com/users/SheffeyG/followers",
                "following_url": "https://api.github.com/users/SheffeyG/following{/other_user}",
                "gists_url": "https://api.github.com/users/SheffeyG/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/SheffeyG",
                "id": 57262511,
                "login": "SheffeyG",
                "node_id": "MDQ6VXNlcjU3MjYyNTEx",
                "organizations_url": "https://api.github.com/users/SheffeyG/orgs",
                "received_events_url": "https://api.github.com/users/SheffeyG/received_events",
                "repos_url": "https://api.github.com/users/SheffeyG/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/SheffeyG/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/SheffeyG/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/SheffeyG",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Possibly related: #30116",
            "created_at": "2026-02-10T03:15:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/37800#issuecomment-3875085658",
            "id": 3875085658,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37800",
            "node_id": "IC_kwDOAPphoM7m-R1a",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3875085658/reactions"
            },
            "updated_at": "2026-02-10T03:15:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3875085658",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/37800/comments",
    "created_at": "2026-02-10T00:49:21Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/37800/events",
    "html_url": "https://github.com/neovim/neovim/issues/37800",
    "id": 3918871641,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "built-in :terminal or :shell, PTY",
            "id": 212696822,
            "name": "terminal",
            "node_id": "MDU6TGFiZWwyMTI2OTY4MjI=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/terminal"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "We need minimal steps to reproduce the issue",
            "id": 298863445,
            "name": "needs:repro",
            "node_id": "MDU6TGFiZWwyOTg4NjM0NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:repro"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/37800/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM7plTxZ",
    "number": 37800,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/37800/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/37800/timeline",
    "title": "terminal: wrong cursor position in prompt after closing window",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2026-02-10T03:16:04Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/37800",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/84649544?v=4",
        "events_url": "https://api.github.com/users/igorlfs/events{/privacy}",
        "followers_url": "https://api.github.com/users/igorlfs/followers",
        "following_url": "https://api.github.com/users/igorlfs/following{/other_user}",
        "gists_url": "https://api.github.com/users/igorlfs/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/igorlfs",
        "id": 84649544,
        "login": "igorlfs",
        "node_id": "MDQ6VXNlcjg0NjQ5NTQ0",
        "organizations_url": "https://api.github.com/users/igorlfs/orgs",
        "received_events_url": "https://api.github.com/users/igorlfs/received_events",
        "repos_url": "https://api.github.com/users/igorlfs/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/igorlfs/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/igorlfs/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/igorlfs",
        "user_view_type": "public"
    }
}
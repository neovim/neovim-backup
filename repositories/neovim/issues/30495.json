{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Problem\r\n\r\nParsing of snippet which contains \"tabstop like\" text inside placeholder fails with error when it should not.\r\n\r\n### Steps to reproduce\r\n\r\n1. `:lua vim.snippet.expand('a(${1:x$2})')`\r\n2. Observe the error: `E5108: Error executing lua .../usr/share/nvim/runtime/lua/vim/lsp/_snippet_grammar.lua:177: snippet parsing failed`\r\n\r\n### Expected behavior\r\n\r\nExpand into `a(x$2)`, i.e. parse `x$2` as regular text (as it says in [LSP spec grammar](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#snippet_syntax)).\r\n\r\n**Edit**: it is a bit more complicated than that and might depend on LSP specification version. See [this comment](https://github.com/neovim/neovim/issues/30495#issuecomment-2379408776).\r\n\r\n### Nvim version (nvim -v)\r\n\r\nNVIM v0.11.0-dev-771+g67d6b6f27\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nNo (doesn't have this functionality)\r\n\r\n### Operating system/version\r\n\r\nEndeavourOS Linux x86_64 (6.10.10-arch1-1)\r\n\r\n### Terminal name/version\r\n\r\nghostty\r\n\r\n### $TERM environment variable\r\n\r\nxterm-ghostty\r\n\r\n### Installation\r\n\r\nappimage",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "To be clear, the issue is the `x` before the `$`? Any placeholder that 1. contains a dollar but 2. doesn't start with it will trigger the error?\r\n\r\n",
            "created_at": "2024-09-24T13:01:23Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2371209790",
            "id": 2371209790,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6NVco-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2371209790/reactions"
            },
            "updated_at": "2024-09-24T13:01:23Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2371209790",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> ... Any placeholder that 1. contains a dollar but 2. doesn't start with it will trigger the error?\r\n\r\nI can't say that for certain, but it looks like it. Here are more examples which fail with same error:\r\n- `'a(${1:b$2})'`\r\n- `'a(${1:xxx$2xxx})'`\r\n- `'a(${1:x$x})'`\r\n- `'a(${1:x$})'`",
            "created_at": "2024-09-24T13:11:21Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2371234364",
            "id": 2371234364,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6NVio8",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2371234364/reactions"
            },
            "updated_at": "2024-09-24T13:11:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2371234364",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
                "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
                "followers_url": "https://api.github.com/users/echasnovski/followers",
                "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
                "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/echasnovski",
                "id": 24854248,
                "login": "echasnovski",
                "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
                "organizations_url": "https://api.github.com/users/echasnovski/orgs",
                "received_events_url": "https://api.github.com/users/echasnovski/received_events",
                "repos_url": "https://api.github.com/users/echasnovski/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/echasnovski",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Here are some other observations that cause same parsing error:\r\n\r\n- The `$` inside choice nodes. Example: `'a(${1|a$a|)'` .\r\n- The `\\\\` inside placeholder or choice nodes. Examples: ``'a(${1:a\\\\b})', `'a(${1|a\\\\b|})'`.\r\n    This might be up to the interpretation. Here is a quote from the spec:\r\n    ```\r\n    With `\\` (backslash), you can escape `$`, `}` and `\\`.\r\n    Within choice elements, the backslash also escapes comma and pipe characters.\r\n    Only the characters required to be escaped can be escaped,\r\n    so `$` should not be escaped within these constructs and\r\n    neither `$` nor `}` should be escaped inside choice constructs.\r\n    ```\r\n\r\n    The \"Only the characters required to be escaped can be escaped\" part reads to me that having a literal backslash (which is `\\\\` when part of Lua string) should be treated as regular character when it is not in front of special characters.\r\n    On the other hand, the fact that \"With `\\` ... you can escape ... `\\` ...\" might indicate that literal backslash should be escaped.\r\n\r\n    I'd personally think that literal backslash when not in front of special character should be treated as regular snippet. For example, they are used that way [in 'rafamadriz/friendly-snippets'](https://github.com/rafamadriz/friendly-snippets/blob/00ba9dd3df89509f95437b8d595553707c46d5ea/snippets/latex.json#L210) and LuaSnip treats them as literal backslashes.",
            "created_at": "2024-09-24T17:51:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2371938253",
            "id": 2371938253,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6NYOfN",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2371938253/reactions"
            },
            "updated_at": "2024-09-24T17:51:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2371938253",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
                "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
                "followers_url": "https://api.github.com/users/echasnovski/followers",
                "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
                "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/echasnovski",
                "id": 24854248,
                "login": "echasnovski",
                "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
                "organizations_url": "https://api.github.com/users/echasnovski/orgs",
                "received_events_url": "https://api.github.com/users/echasnovski/received_events",
                "repos_url": "https://api.github.com/users/echasnovski/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/echasnovski",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "After reading some more LSP specification I realized that the current snippet grammar probably implements [LSP specification version 3.18](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.18/specification/#snippet_syntax). It explicitly introduces how special characters should be handled in all types of nodes (`text`, `placeholder`, `choice`, etc.).\r\n\r\nAccording to it (as far as I can understand it):\r\n- The `a(${1:x$2})` body is illegal: it is a `placeholder` with `x$2` being `text` (as any other nodes should start with `$`). And `text` should have `$` escaped. So the correct snippet should be `a(${1:x\\$2})` (assuming written as Lua string with `[[]]` brackets).\r\n- For similar reasons `a(${1:a\\b})` is illegal and should be `a(${1:a\\\\b})`.\r\n- The `a(${1|a$a|})` body **is** legal: it is a `choice` and `choicetext` should not have `$` escaped.\r\n- The `a(${1|a\\b|})` body is illegal: it is a `choice` and `choicetext` should have `\\` escaped. The correct snippet is `a(${1|a\\\\b|})`.\r\n\r\nThe problem here is that version 3.18 is not yet current and [documentation says](https://github.com/neovim/neovim/blob/eea6b84a87fb72d66f83e8b5c440764ccbdf69b5/runtime/doc/lua.txt#L4413) that it implements the current version (a.k.a. 3.17). Within its grammar definition my interpretation is that all the cases above are legal, but I agree that it is debatable.\r\n\r\n------\r\n\r\nSo I guess the path forward depends on the decision about which LSP specification version to support. Supporting 3.18 is easier as its grammar is less ambiguous but I'd guess most snippets (as are snippet engines they are assumed to be used with) are written with 3.17 in mind.",
            "created_at": "2024-09-27T14:25:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379408776",
            "id": 2379408776,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N0uWI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379408776/reactions"
            },
            "updated_at": "2024-09-27T14:52:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379408776",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
                "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
                "followers_url": "https://api.github.com/users/echasnovski/followers",
                "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
                "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/echasnovski",
                "id": 24854248,
                "login": "echasnovski",
                "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
                "organizations_url": "https://api.github.com/users/echasnovski/orgs",
                "received_events_url": "https://api.github.com/users/echasnovski/received_events",
                "repos_url": "https://api.github.com/users/echasnovski/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/echasnovski",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "We will definitely support 3.18 as soon as it is released; I don't think it's a reasonable use of time to change to 3.17 now, only to change back. (I recall that the snippet module was explicitly and specifically written for LSP snippets; compatibility with external libraries is a nice bonus but not a primary goal. But one would hope that these would adapt eventually.)\r\n\r\nSo in the end this boils down to a documentation change? @MariaSolOs \r\n",
            "created_at": "2024-09-27T14:31:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379422674",
            "id": 2379422674,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N0xvS",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379422674/reactions"
            },
            "updated_at": "2024-09-27T14:31:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379422674",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I recall that the snippet module was explicitly and specifically written for LSP snippets; ...\r\n\r\nAnd I'd say that expecting that LSP servers implement current version (3.17) is more reasonable than they implement 3.18. While I also agree that switching back to 3.17 and forth to 3.18 is probably redundant.\r\n\r\n> So in the end this boils down to a documentation change?\r\n\r\nNot only. There is still a valid case of `$` inside choice node (like `a(${1|a$b|})`) which currently errors with `vim.snippet.expand()`.",
            "created_at": "2024-09-27T14:43:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379446952",
            "id": 2379446952,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N03qo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379446952/reactions"
            },
            "updated_at": "2024-09-27T14:53:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379446952",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
                "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
                "followers_url": "https://api.github.com/users/echasnovski/followers",
                "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
                "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/echasnovski",
                "id": 24854248,
                "login": "echasnovski",
                "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
                "organizations_url": "https://api.github.com/users/echasnovski/orgs",
                "received_events_url": "https://api.github.com/users/echasnovski/received_events",
                "repos_url": "https://api.github.com/users/echasnovski/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/echasnovski",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> And I'd say that expecting that LSP servers implement current version (3.17) is more reasonable than they implement 3.18.\r\n\r\nYes, but that's a _different_ argument, and one I would in fact counter with the redundancy. (In a perfect world, we'd support both. But especially since the snippet roadmap is not complete, it doesn't make sense to invest the duplicate effort.)\r\n\r\n> There is still a valid case of $ inside choice node (like a(${1|a$a|)) which currently errors with vim.snippet.expand().\r\n\r\nWould be interesting to see why -- the grammar is implemented pretty much 1:1, so there must be some specific error somewhere.",
            "created_at": "2024-09-27T14:50:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379459106",
            "id": 2379459106,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N06oi",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379459106/reactions"
            },
            "updated_at": "2024-09-27T14:51:44Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379459106",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> the grammar is implemented pretty much 1:1\r\n\r\nMaybe I'm misunderstanding—if so I apologize—but I think that the current snippet implementation in Neovim does not (yet) support the full LSP spec, even for 3.17. I'm thinking of this issue in particular: https://github.com/neovim/neovim/issues/29169.",
            "created_at": "2024-09-27T15:02:23Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379483893",
            "id": 2379483893,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N1Ar1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379483893/reactions"
            },
            "updated_at": "2024-09-27T15:04:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379483893",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62958?v=4",
                "events_url": "https://api.github.com/users/telemachus/events{/privacy}",
                "followers_url": "https://api.github.com/users/telemachus/followers",
                "following_url": "https://api.github.com/users/telemachus/following{/other_user}",
                "gists_url": "https://api.github.com/users/telemachus/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/telemachus",
                "id": 62958,
                "login": "telemachus",
                "node_id": "MDQ6VXNlcjYyOTU4",
                "organizations_url": "https://api.github.com/users/telemachus/orgs",
                "received_events_url": "https://api.github.com/users/telemachus/received_events",
                "repos_url": "https://api.github.com/users/telemachus/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/telemachus/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/telemachus/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/telemachus",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Targetting != fully supporting",
            "created_at": "2024-09-27T15:04:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379488695",
            "id": 2379488695,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N1B23",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379488695/reactions"
            },
            "updated_at": "2024-09-27T15:05:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379488695",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The changes made in 3.18 sound like fixes based on the PR descriptions: \r\n\r\n- https://github.com/microsoft/language-server-protocol/pull/1886\r\n- https://github.com/microsoft/language-server-protocol/pull/1868\r\n\r\nI'd also say target 3.18, no point in going back and forth",
            "created_at": "2024-09-27T18:01:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379796256",
            "id": 2379796256,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N2M8g",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 1,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379796256/reactions"
            },
            "updated_at": "2024-09-27T18:01:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379796256",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38700?v=4",
                "events_url": "https://api.github.com/users/mfussenegger/events{/privacy}",
                "followers_url": "https://api.github.com/users/mfussenegger/followers",
                "following_url": "https://api.github.com/users/mfussenegger/following{/other_user}",
                "gists_url": "https://api.github.com/users/mfussenegger/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mfussenegger",
                "id": 38700,
                "login": "mfussenegger",
                "node_id": "MDQ6VXNlcjM4NzAw",
                "organizations_url": "https://api.github.com/users/mfussenegger/orgs",
                "received_events_url": "https://api.github.com/users/mfussenegger/received_events",
                "repos_url": "https://api.github.com/users/mfussenegger/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mfussenegger/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mfussenegger/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mfussenegger",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@mfussenegger, thanks for finding these!\r\n\r\nIn particular, [this comment](https://github.com/microsoft/language-server-protocol/pull/1886#discussion_r1470011341) clarifies that `$` inside choice elements indeed should not be escaped.",
            "created_at": "2024-09-27T18:24:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2379831536",
            "id": 2379831536,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N2Vjw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379831536/reactions"
            },
            "updated_at": "2024-09-27T18:24:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2379831536",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
                "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
                "followers_url": "https://api.github.com/users/echasnovski/followers",
                "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
                "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/echasnovski",
                "id": 24854248,
                "login": "echasnovski",
                "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
                "organizations_url": "https://api.github.com/users/echasnovski/orgs",
                "received_events_url": "https://api.github.com/users/echasnovski/received_events",
                "repos_url": "https://api.github.com/users/echasnovski/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/echasnovski",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "There is also a matter of [this test](https://github.com/neovim/neovim/blob/d5f6f61879bac3ac90512efe05d68e3500125a08/test/functional/plugin/lsp/snippet_spec.lua#L157), which is the result of #25611.\r\n\r\nIf targeting 3.18 is the goal, then `}` should be explicitly escaped and the original (pre #25611 PR) behavior was the correct one. Having it depend on the context is easier for writing snippets, but is a deviation from the specification.",
            "created_at": "2024-09-28T12:03:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/30495#issuecomment-2380617454",
            "id": 2380617454,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30495",
            "node_id": "IC_kwDOAPphoM6N5Vbu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2380617454/reactions"
            },
            "updated_at": "2024-09-28T12:03:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2380617454",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
                "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
                "followers_url": "https://api.github.com/users/echasnovski/followers",
                "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
                "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/echasnovski",
                "id": 24854248,
                "login": "echasnovski",
                "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
                "organizations_url": "https://api.github.com/users/echasnovski/orgs",
                "received_events_url": "https://api.github.com/users/echasnovski/received_events",
                "repos_url": "https://api.github.com/users/echasnovski/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/echasnovski",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 12,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/30495/comments",
    "created_at": "2024-09-24T12:56:19Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/30495/events",
    "html_url": "https://github.com/neovim/neovim/issues/30495",
    "id": 2545333239,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "",
            "id": 6207355257,
            "name": "snippet",
            "node_id": "LA_kwDOAPphoM8AAAABcfy5eQ",
            "url": "https://api.github.com/repos/neovim/neovim/labels/snippet"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/30495/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 686,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 635,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-01-21T00:09:37Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM6XtrP3",
    "number": 30495,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/30495/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/30495/timeline",
    "title": "snippet: parsing error if placeholder or choice node contains special text",
    "updated_at": "2025-01-17T15:39:35Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/30495",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/24854248?v=4",
        "events_url": "https://api.github.com/users/echasnovski/events{/privacy}",
        "followers_url": "https://api.github.com/users/echasnovski/followers",
        "following_url": "https://api.github.com/users/echasnovski/following{/other_user}",
        "gists_url": "https://api.github.com/users/echasnovski/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/echasnovski",
        "id": 24854248,
        "login": "echasnovski",
        "node_id": "MDQ6VXNlcjI0ODU0MjQ4",
        "organizations_url": "https://api.github.com/users/echasnovski/orgs",
        "received_events_url": "https://api.github.com/users/echasnovski/received_events",
        "repos_url": "https://api.github.com/users/echasnovski/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/echasnovski/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/echasnovski/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/echasnovski",
        "user_view_type": "public"
    }
}
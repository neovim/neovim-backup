{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\ncurrently signature_help/hover windows always get closed automatically, but i sometimes want to make it a split window for larger and longer view.\n\n### Expected behavior\n\nuser can make signature_help/hover windows resident on demand, for me i'd like to make these windows get no auto-closed after split.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "`:h vim.lsp.util.open_floating_preview.Opts | /close_events`",
            "created_at": "2025-11-22T13:07:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3566696038",
            "id": 3566696038,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7Ul3Zm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3566696038/reactions"
            },
            "updated_at": "2025-11-22T13:07:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3566696038",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/154880267?v=4",
                "events_url": "https://api.github.com/users/nenahp/events{/privacy}",
                "followers_url": "https://api.github.com/users/nenahp/followers",
                "following_url": "https://api.github.com/users/nenahp/following{/other_user}",
                "gists_url": "https://api.github.com/users/nenahp/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nenahp",
                "id": 154880267,
                "login": "nenahp",
                "node_id": "U_kgDOCTtJCw",
                "organizations_url": "https://api.github.com/users/nenahp/orgs",
                "received_events_url": "https://api.github.com/users/nenahp/received_events",
                "repos_url": "https://api.github.com/users/nenahp/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nenahp/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nenahp/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nenahp",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "~~Seems that it is currently not possible~~ To transform a floating window into a split window:\n\n```\n:lua vim.api.nvim_win_set_config(0, {win=1000, split='left'})\n```\n\nOr alternatively, split the LSP doc hover buffer into a new window, then close the floatwin:\n\n```\n:lua vim.api.nvim_open_win(0, false, {split='left'})\n:close\n```\n\nRelated:\n\n- https://github.com/neovim/neovim/issues/33790\n\n## Proposal\n\n- Can/should we improve the ergonomics around this? Perhaps with a default mapping.\n    - It is not LSP-specific. Should work for all floatwins.\n    - In order for this to work, the floatwin should avoid aggressive \"cleanup\" like deleting the buffer when the window is closed. Our LSP code seems to be OK in this regard.",
            "created_at": "2025-11-22T22:30:37Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3567098717",
            "id": 3567098717,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7UnZtd",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567098717/reactions"
            },
            "updated_at": "2025-11-22T22:57:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567098717",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "You need to also specify `win`, not just `split`.",
            "created_at": "2025-11-22T22:37:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3567102514",
            "id": 3567102514,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7Unaoy",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567102514/reactions"
            },
            "updated_at": "2025-11-23T00:00:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567102514",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> You need to also specify `win`, not just `split`.\n\nThanks, updated the docs in https://github.com/neovim/neovim/pull/36610",
            "created_at": "2025-11-23T00:00:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3567165057",
            "id": 3567165057,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7Unp6B",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567165057/reactions"
            },
            "updated_at": "2025-11-23T00:01:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567165057",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "thanks for thinking on this! so it seems to me, i need to monkeypatch like this:\n\n```lua\nlocal origin = lsp.util.open_floating_preview\n\nlsp.util.open_floating_preview = function(...)\n    local bufnr, winid = origin(...)\n\n    local focus_id = opts.focus_id\n    ---for c-w-JKHL\n    keymap.set('n', '<c-w-J', function()\n        --split\n       vim.wo[winid].winfixheight/fixwidth = true\n        nvim_win_set_config(winid, split_side) -- or just feedkeys('<c-w-J>', 'n')\n        --make this win invisible\n        vim.wo[winid][focus_id] = nil\n        --make this buf resident\n        nvim_del_augroup_by_name('nvim.preview_window_' .. winnr)\n    end, {buffer=bufnr})\nend\n```\n",
            "created_at": "2025-11-23T00:15:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3567185960",
            "id": 3567185960,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7UnvAo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567185960/reactions"
            },
            "updated_at": "2025-11-25T06:33:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567185960",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6236829?v=4",
                "events_url": "https://api.github.com/users/haolian9/events{/privacy}",
                "followers_url": "https://api.github.com/users/haolian9/followers",
                "following_url": "https://api.github.com/users/haolian9/following{/other_user}",
                "gists_url": "https://api.github.com/users/haolian9/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/haolian9",
                "id": 6236829,
                "login": "haolian9",
                "node_id": "MDQ6VXNlcjYyMzY4Mjk=",
                "organizations_url": "https://api.github.com/users/haolian9/orgs",
                "received_events_url": "https://api.github.com/users/haolian9/received_events",
                "repos_url": "https://api.github.com/users/haolian9/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/haolian9/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/haolian9/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/haolian9",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "You don't need to monkeypatch anything, just define a mapping that calls `nvim_win_set_config`",
            "created_at": "2025-11-23T00:22:21Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3567196138",
            "id": 3567196138,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7Unxfq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567196138/reactions"
            },
            "updated_at": "2025-11-23T00:22:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3567196138",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This feels like something that would be interesting/tractable to add to _defaults. Mockup:\n\n```lua\nfor _, map in ipairs({ \"<C-w>e\", \"<C-w><C-e>\" }) do\n    vim.keymap.set(\"n\", map, function()\n        local config = vim.api.nvim_win_get_config(0) ---@type vim.api.keyset.win_config_ret\n        if not (config.relative and config.relative ~= \"\") then\n            vim.api.nvim_echo({ { \"Current window is not floating\" } }, false, {})\n            return\n        end\n\n        local buf = vim.api.nvim_win_get_buf(0) ---@type integer\n        vim.api.nvim_set_option_value(\"bufhidden\", \"\", { buf = buf })\n\n        ---@type integer\n        local to_split = config.relative == \"win\" and config.win or vim.fn.win_getid(1)\n        ---@type \"above\"|\"below\"|\"left\"|\"right\"\n        local split = vim.api.nvim_get_option_value(\"splitbelow\", {}) and \"below\" or \"above\"\n        vim.api.nvim_win_set_config(0, { win = to_split, focusable = true, split = split })\n    end)\nend\n```\n\nctrl-w_e feels patternful with ctrl-w_ge:\n\n```vimdoc\nCTRL-W ge\t\t\t\t\t\t*CTRL-W_ge*\n\t\tDetach the current window as an external window.\n\t\tOnly available when using a UI with |ui-multigrid| support.\n\nNote that the 'splitbelow' and 'splitright' options influence where a new\nwindow will appear.\n\t\t\t\t\t\t\t\t*E36*\nCreating a window will fail if there is not enough room.  Every window needs\nat least one screen line and column, sometimes more.   Options 'winminheight'\nand 'winminwidth' are relevant.\n```\n\nm, u, and y are also available\n\nQuestions:\n\n- How would other relative origins be handled? You could get fancy with it, but it might make the behavior too complicated. You could also figure out which window the float is closest to with pythagorean distance\n- What, if any, other modifications should be made to the buffer?\n- It would be cool if there was a way to control horizontal vs vertical split. Maybe with ctrl-e vs ctrl-E?",
            "created_at": "2025-11-25T05:55:08Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3573889098",
            "id": 3573889098,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7VBThK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3573889098/reactions"
            },
            "updated_at": "2025-11-25T05:55:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3573889098",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62523234?v=4",
                "events_url": "https://api.github.com/users/mikejmcguirk/events{/privacy}",
                "followers_url": "https://api.github.com/users/mikejmcguirk/followers",
                "following_url": "https://api.github.com/users/mikejmcguirk/following{/other_user}",
                "gists_url": "https://api.github.com/users/mikejmcguirk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mikejmcguirk",
                "id": 62523234,
                "login": "mikejmcguirk",
                "node_id": "MDQ6VXNlcjYyNTIzMjM0",
                "organizations_url": "https://api.github.com/users/mikejmcguirk/orgs",
                "received_events_url": "https://api.github.com/users/mikejmcguirk/received_events",
                "repos_url": "https://api.github.com/users/mikejmcguirk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mikejmcguirk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mikejmcguirk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mikejmcguirk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The discussion seems to be going out of hand. Don't the builtin Ctrl-W + H/J/K/L already do this? So you just need a `WinResized` autocommand to delete augroups etc..",
            "created_at": "2025-11-25T05:57:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3573893327",
            "id": 3573893327,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7VBUjP",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3573893327/reactions"
            },
            "updated_at": "2025-11-25T06:01:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3573893327",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Here is something that works (in the bit of testing that I have done).\n\nI set `vim.lsp.buf.hover` to a function that is exactly the same except it has an autocmd listening for the `WinResized` event:\n\n```lua\napi.nvim_create_autocmd(\"WinResized\", {\n  callback = function()\n    if vim.list_contains(vim.v.event.windows, winid) then\n      -- Delete the autocmds that close this window on certain events\n      vim.api.nvim_create_augroup(\"nvim.preview_window_\" .. winid, { clear = true })\n      return true\n    end\n  end,\n})\n```\n\nI think it is a little hacky, because I am assuming the name of the augroup, but it works.\n\nHere is the full code (you should be able to put it in a file and source it with `:so`, and the `K` command will work with the new behavior):\n\n```lua\nlocal api = vim.api\nlocal lsp = vim.lsp\nlocal ms = require(\"vim.lsp.protocol\").Methods\nlocal util = require(\"vim.lsp.util\")\n\nlocal hover_ns = api.nvim_create_namespace(\"nvim.lsp.hover_range\")\n\n--- @param params? table\n--- @return fun(client: vim.lsp.Client): lsp.TextDocumentPositionParams\nlocal function client_positional_params(params)\n  local win = api.nvim_get_current_win()\n  return function(client)\n    local ret = util.make_position_params(win, client.offset_encoding)\n    if params then\n      ret = vim.tbl_extend(\"force\", ret, params)\n    end\n    return ret\n  end\nend\n\n---@diagnostic disable-next-line: duplicate-set-field\nvim.lsp.buf.hover = function(config)\n  config = config or {}\n  config.focus_id = ms.textDocument_hover\n\n  lsp.buf_request_all(0, ms.textDocument_hover, client_positional_params(), function(results, ctx)\n    local bufnr = assert(ctx.bufnr)\n    if api.nvim_get_current_buf() ~= bufnr then\n      -- Ignore result since buffer changed. This happens for slow language servers.\n      return\n    end\n\n    -- Filter errors from results\n    local results1 = {} --- @type table<integer,lsp.Hover>\n\n    for client_id, resp in pairs(results) do\n      local err, result = resp.err, resp.result\n      if err then\n        lsp.log.error(err.code, err.message)\n      elseif result then\n        results1[client_id] = result\n      end\n    end\n\n    if vim.tbl_isempty(results1) then\n      if config.silent ~= true then\n        vim.notify(\"No information available\", vim.log.levels.INFO)\n      end\n      return\n    end\n\n    local contents = {} --- @type string[]\n\n    local nresults = #vim.tbl_keys(results1)\n\n    local format = \"markdown\"\n\n    for client_id, result in pairs(results1) do\n      local client = assert(lsp.get_client_by_id(client_id))\n      if nresults > 1 then\n        -- Show client name if there are multiple clients\n        contents[#contents + 1] = string.format(\"# %s\", client.name)\n      end\n      if type(result.contents) == \"table\" and result.contents.kind == \"plaintext\" then\n        if #results1 == 1 then\n          format = \"plaintext\"\n          contents = vim.split(result.contents.value or \"\", \"\\n\", { trimempty = true })\n        else\n          -- Surround plaintext with ``` to get correct formatting\n          contents[#contents + 1] = \"```\"\n          vim.list_extend(contents, vim.split(result.contents.value or \"\", \"\\n\", { trimempty = true }))\n          contents[#contents + 1] = \"```\"\n        end\n      else\n        vim.list_extend(contents, util.convert_input_to_markdown_lines(result.contents))\n      end\n      local range = result.range\n      if range then\n        local start = range.start\n        local end_ = range[\"end\"]\n        local start_idx = util._get_line_byte_from_position(bufnr, start, client.offset_encoding)\n        local end_idx = util._get_line_byte_from_position(bufnr, end_, client.offset_encoding)\n\n        vim.hl.range(bufnr, hover_ns, \"LspReferenceTarget\", { start.line, start_idx }, { end_.line, end_idx }, { priority = vim.hl.priorities.user })\n      end\n      contents[#contents + 1] = \"---\"\n    end\n\n    -- Remove last linebreak ('---')\n    contents[#contents] = nil\n\n    if vim.tbl_isempty(contents) then\n      if config.silent ~= true then\n        vim.notify(\"No information available\")\n      end\n      return\n    end\n\n    local _, winid = lsp.util.open_floating_preview(contents, format, config)\n\n    -- Change --\n    api.nvim_create_autocmd(\"WinResized\", {\n      callback = function()\n        if vim.list_contains(vim.v.event.windows, winid) then\n          -- Delete the autocmds that close this window on certain events\n          vim.api.nvim_create_augroup(\"nvim.preview_window_\" .. winid, { clear = true })\n          return true\n        end\n      end,\n    })\n    -- End change --\n    api.nvim_create_autocmd(\"WinClosed\", {\n      pattern = tostring(winid),\n      once = true,\n      callback = function()\n        api.nvim_buf_clear_namespace(bufnr, hover_ns, 0, -1)\n        return true\n      end,\n    })\n  end)\nend\n```",
            "created_at": "2025-11-26T00:40:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3578230199",
            "id": 3578230199,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7VR3W3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578230199/reactions"
            },
            "updated_at": "2025-11-26T00:47:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578230199",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/116777388?v=4",
                "events_url": "https://api.github.com/users/eamonburns/events{/privacy}",
                "followers_url": "https://api.github.com/users/eamonburns/followers",
                "following_url": "https://api.github.com/users/eamonburns/following{/other_user}",
                "gists_url": "https://api.github.com/users/eamonburns/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/eamonburns",
                "id": 116777388,
                "login": "eamonburns",
                "node_id": "U_kgDOBvXhrA",
                "organizations_url": "https://api.github.com/users/eamonburns/orgs",
                "received_events_url": "https://api.github.com/users/eamonburns/received_events",
                "repos_url": "https://api.github.com/users/eamonburns/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/eamonburns/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/eamonburns/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/eamonburns",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@eamonburns the code is [here](https://github.com/neovim/neovim/blob/410744210386c8305da047e1a0e91f798c2cac0c/runtime/lua/vim/lsp/util.lua#L1452-L1466) , you can make change and run it locally, and if you find something that makes sense as a core change, please send a PR.\n\nI am hoping that `util.lua` just needs an improvement to its default behavior, not a new option or anything.",
            "created_at": "2025-11-26T00:47:34Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3578248328",
            "id": 3578248328,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7VR7yI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578248328/reactions"
            },
            "updated_at": "2025-11-26T00:48:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578248328",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "In terms of util, I think everything you need is there. The autocmds can be manually deleted, and the lsp_floating_preview b:var can be manually set to nil.\n\nBut if you want to detach a K hover window, the hover_ns extmark needs to be cleared. hover_ns is local to the lsp.buf module. The only thing that touches it, from what I can see, is a WinClosed autocmd (doesn't help if you're trying to move the window).\n\nMaybe a function could be added that allows manually clearing the hover_ns extmarks, which could then be used in any autocmds.\n\n(EDIT: The same could also apply to sig_help_ns as well, which is also local to lsp.buf)\n\nFrom user scripting perspective, the current most straight forward way to handle this IMO is just setting bufhidden to \"\" and opening a new window, as it allows all the built-in close logic to flow through, and the new window sheds the option baggage of the previous one:\n\n```lua\nfor _, map in ipairs({ \"<C-w>e\", \"<C-w><C-e>\" }) do\n    vim.keymap.set(\"n\", map, function()\n        local win = api.nvim_get_current_win() ---@type integer\n        local config = vim.api.nvim_win_get_config(win) ---@type vim.api.keyset.win_config_ret\n        if not (config.relative and config.relative ~= \"\") then\n            vim.api.nvim_echo({ { \"Current window is not floating\" } }, false, {})\n            return\n        end\n\n        local buf = vim.api.nvim_win_get_buf(win) ---@type integer\n        vim.api.nvim_set_option_value(\"bufhidden\", \"\", { buf = buf })\n        local to_split = (function()\n            if vim.v.count > 0 then\n                local winnr = math.min(vim.v.count, fn.winnr(\"$\")) ---@type integer\n                return vim.fn.win_getid(winnr)\n            end\n\n            return config.relative == \"win\" and config.win or vim.fn.win_getid(1)\n        end)() ---@type integer\n\n        ---@type \"above\"|\"below\"|\"left\"|\"right\"\n        local split = vim.api.nvim_get_option_value(\"splitright\", {}) and \"right\" or \"left\"\n        api.nvim_win_close(win, true)\n        api.nvim_open_win(buf, true, { win = to_split, split = split })\n    end)\nend\n```",
            "created_at": "2025-11-26T02:09:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/36659#issuecomment-3578533529",
            "id": 3578533529,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36659",
            "node_id": "IC_kwDOAPphoM7VTBaZ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578533529/reactions"
            },
            "updated_at": "2025-11-26T03:00:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578533529",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62523234?v=4",
                "events_url": "https://api.github.com/users/mikejmcguirk/events{/privacy}",
                "followers_url": "https://api.github.com/users/mikejmcguirk/followers",
                "following_url": "https://api.github.com/users/mikejmcguirk/following{/other_user}",
                "gists_url": "https://api.github.com/users/mikejmcguirk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mikejmcguirk",
                "id": 62523234,
                "login": "mikejmcguirk",
                "node_id": "MDQ6VXNlcjYyNTIzMjM0",
                "organizations_url": "https://api.github.com/users/mikejmcguirk/orgs",
                "received_events_url": "https://api.github.com/users/mikejmcguirk/received_events",
                "repos_url": "https://api.github.com/users/mikejmcguirk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mikejmcguirk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mikejmcguirk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mikejmcguirk",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 11,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36659/comments",
    "created_at": "2025-11-22T12:46:16Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/36659/events",
    "html_url": "https://github.com/neovim/neovim/issues/36659",
    "id": 3654647109,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "BFDADC",
            "default": false,
            "description": "Low-risk, self-contained. Do NOT ask \"can I work on this\", just read CONTRIBUTING.md",
            "id": 407246773,
            "name": "complexity:low",
            "node_id": "MDU6TGFiZWw0MDcyNDY3NzM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/complexity:low"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue is not fixed but can be circumvented until then",
            "id": 435850181,
            "name": "has:workaround",
            "node_id": "MDU6TGFiZWw0MzU4NTAxODE=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:workaround"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/36659/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 756,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 641,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-12-01T18:18:59Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM7Z1X1F",
    "number": 36659,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/36659/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/36659/timeline",
    "title": "default mapping to convert floatwin to splitwin",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-11-26T03:00:40Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/36659",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/6236829?v=4",
        "events_url": "https://api.github.com/users/haolian9/events{/privacy}",
        "followers_url": "https://api.github.com/users/haolian9/followers",
        "following_url": "https://api.github.com/users/haolian9/following{/other_user}",
        "gists_url": "https://api.github.com/users/haolian9/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/haolian9",
        "id": 6236829,
        "login": "haolian9",
        "node_id": "MDQ6VXNlcjYyMzY4Mjk=",
        "organizations_url": "https://api.github.com/users/haolian9/orgs",
        "received_events_url": "https://api.github.com/users/haolian9/received_events",
        "repos_url": "https://api.github.com/users/haolian9/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/haolian9/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/haolian9/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/haolian9",
        "user_view_type": "public"
    }
}
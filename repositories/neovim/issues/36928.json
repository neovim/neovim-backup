{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nSummary\n\nAfter updating to recent commits on master, Neovim’s LSP subsystem begins flooding the log with repeated messages such as:\n\nCannot find request with id 24 whilst attempting to cancel\n\n\nThis affects multiple language servers (lua_ls, powershell_es, others) and occurs even with a minimal config. The issue does not occur on older commits — the last known good commit is:\n\ncdc6f85111 (2025-12-01)\n\n\nThe problem appears within the next ~123 commits after that.\n\nEnvironment\n\nOS: Windows 11 Pro (23H2) — also reproducible on WSL2 Ubuntu\n\nCompiler: MSVC (Build Tools 2022)\n\nBuild system: Ninja + CMake\n\nNeovim version where bug is present: any master commit after 2025-12-01\n\nNeovim version where bug is NOT present: cdc6f85111\n\nActual behavior\n\nThe log is filled with repeated errors such as:\n\n[LSP[lua_ls]] Cannot find request with id 18 whilst attempting to cancel\n[LSP[lua_ls]] Cannot find request with id 87 whilst attempting to cancel\n[LSP[powershell_es]] Cannot find request with id 14 whilst attempting to cancel\n\n\nThis can result in hundreds of lines within seconds.\nThe spam occurs even when Neovim is idle and across multiple LSP servers.\n\nAdditional notes\n\nRebuilding Neovim multiple times with fresh .deps confirmed it is not caused by stale dependencies.\n\nMinimal configurations show the same behavior.\n\nRegression window:\n\ngood: cdc6f85111 (2025-12-01)\nbad:  HEAD (2025-12-11)\ndistance: 123 commits after cdc6f85111\n\n\nThis may be related to recent changes in:\n\nLSP request lifecycle\n\nasync RPC scheduling\n\ncancellation token logic\n\nevent loop timing\n\nIf additional testing (Windows/WSL logs, bisection, or custom builds) is helpful, I can assist.\n\nThanks!\n\n### Steps to reproduce\n\nSteps to reproduce\n\nBuild Neovim from any master commit after 2025-12-01.\n\nLaunch Neovim with a minimal configuration:\n\nnvim --clean file.lua\n\n\nAllow an LSP to start (lua_ls, powershell_es, or any server).\n\nInteract briefly (move cursor, open/close buffers, trigger completion).\n\nOpen the LSP log:\n\n:LspLog\n\n### Expected behavior\n\nExpected behavior\n\nLSP cancellations should only target active requests.\n\nNeovim should not attempt to cancel nonexistent or already-finished requests.\n\nNo error spam or runaway log growth.\n\n### Nvim version (nvim -v)\n\nNVIM v0.12.0-dev (any recent commit after Dec 1)\n\n### Vim (not Nvim) behaves the same?\n\nNot applicable — Vim does not include the built-in LSP client. This issue is specific to Neovim’s LSP subsystem.\n\n### Operating system/version\n\nWindows 11 Pro (23H2), build 22631\n\n### Terminal name/version\n\nWezTerm 20251201-075747-d3b0fdad\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nBuild from source (MSVC + Ninja)",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Narrowing to the commit will help :)",
            "created_at": "2025-12-12T21:15:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/36928#issuecomment-3648164848",
            "id": 3648164848,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36928",
            "node_id": "IC_kwDOAPphoM7ZcpPw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3648164848/reactions"
            },
            "updated_at": "2025-12-12T21:15:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3648164848",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks — agreed. I’ve identified the last known good commit as cdc6f85111 (2025-12-01), with ~123 commits after that showing the issue. I haven’t bisected to the exact commit yet, but I can do that and follow up when I get some time.",
            "created_at": "2025-12-12T21:19:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/36928#issuecomment-3648175526",
            "id": 3648175526,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36928",
            "node_id": "IC_kwDOAPphoM7Zcr2m",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3648175526/reactions"
            },
            "updated_at": "2025-12-12T21:19:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3648175526",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/145024009?v=4",
                "events_url": "https://api.github.com/users/Masterkatt3n/events{/privacy}",
                "followers_url": "https://api.github.com/users/Masterkatt3n/followers",
                "following_url": "https://api.github.com/users/Masterkatt3n/following{/other_user}",
                "gists_url": "https://api.github.com/users/Masterkatt3n/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Masterkatt3n",
                "id": 145024009,
                "login": "Masterkatt3n",
                "node_id": "U_kgDOCKTkCQ",
                "organizations_url": "https://api.github.com/users/Masterkatt3n/orgs",
                "received_events_url": "https://api.github.com/users/Masterkatt3n/received_events",
                "repos_url": "https://api.github.com/users/Masterkatt3n/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Masterkatt3n/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Masterkatt3n/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Masterkatt3n",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Additional info:\nI can further narrow the regression window — the issue is present in commit e62dd13f83 (2025-12-03) and not present in cdc6f85111 (2025-12-01).\n\nThe behavior reproduces on Windows, WSL, and Linux, and appears to depend on LSP request cancellation timing rather than platform specifics.",
            "created_at": "2025-12-13T23:04:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/36928#issuecomment-3649899351",
            "id": 3649899351,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36928",
            "node_id": "IC_kwDOAPphoM7ZjQtX",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3649899351/reactions"
            },
            "updated_at": "2025-12-13T23:04:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3649899351",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/145024009?v=4",
                "events_url": "https://api.github.com/users/Masterkatt3n/events{/privacy}",
                "followers_url": "https://api.github.com/users/Masterkatt3n/followers",
                "following_url": "https://api.github.com/users/Masterkatt3n/following{/other_user}",
                "gists_url": "https://api.github.com/users/Masterkatt3n/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Masterkatt3n",
                "id": 145024009,
                "login": "Masterkatt3n",
                "node_id": "U_kgDOCKTkCQ",
                "organizations_url": "https://api.github.com/users/Masterkatt3n/orgs",
                "received_events_url": "https://api.github.com/users/Masterkatt3n/received_events",
                "repos_url": "https://api.github.com/users/Masterkatt3n/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Masterkatt3n/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Masterkatt3n/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Masterkatt3n",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36928/comments",
    "created_at": "2025-12-12T04:45:10Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/36928/events",
    "html_url": "https://github.com/neovim/neovim/issues/36928",
    "id": 3721935635,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "d4c5f9",
            "default": false,
            "description": null,
            "id": 109461219,
            "name": "platform:windows",
            "node_id": "MDU6TGFiZWwxMDk0NjEyMTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/platform:windows"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "OS processes, spawn",
            "id": 182884815,
            "name": "job-control",
            "node_id": "MDU6TGFiZWwxODI4ODQ4MTU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/job-control"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/36928/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 762,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 641,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-12-15T19:01:37Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM7d2DsT",
    "number": 36928,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/36928/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/36928/timeline",
    "title": "LSP spam: \"Cannot find request with id X whilst attempting to cancel\" after recent commits (Windows + WSL)",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-12-13T23:04:00Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/36928",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/145024009?v=4",
        "events_url": "https://api.github.com/users/Masterkatt3n/events{/privacy}",
        "followers_url": "https://api.github.com/users/Masterkatt3n/followers",
        "following_url": "https://api.github.com/users/Masterkatt3n/following{/other_user}",
        "gists_url": "https://api.github.com/users/Masterkatt3n/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Masterkatt3n",
        "id": 145024009,
        "login": "Masterkatt3n",
        "node_id": "U_kgDOCKTkCQ",
        "organizations_url": "https://api.github.com/users/Masterkatt3n/orgs",
        "received_events_url": "https://api.github.com/users/Masterkatt3n/received_events",
        "repos_url": "https://api.github.com/users/Masterkatt3n/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Masterkatt3n/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Masterkatt3n/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Masterkatt3n",
        "user_view_type": "public"
    }
}
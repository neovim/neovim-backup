{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "### Problem\r\n\r\nThe [Kitty keyboard protocol](https://sw.kovidgoyal.net/kitty/keyboard-protocol) supports sending press/repeat/release events for key presses. We currently do not enable this mode and termkey is not currently able to parse these events, but we certainly could.\r\n\r\nA possible use case for press/release events would be to show a floating window only while a key is held down (e.g. for LSP hover or diagnostics).\r\n\r\nAdding support to libtermkey is fairly straightforward (I already have a working prototype in a branch). The more difficult problem is plumbing this into Neovim's own event handling.\r\n\r\nAt least one question is how a press/release event should be represented. The TUI sends all key events to the core with `nvim_input`, so we need a way to represent the \"press\"/\"release\" event there. We should be able to leave \"press\" events as-is and only add special casing for \"release\" events (I'm not sure we need \"repeat\" events?).\r\n\r\nWe could limit press/release events only to the API (via `nvim_set_keymap`) so that we don't need to modify `:map` and friends.\r\n\r\nRelated: https://github.com/neovim/neovim/issues/14400",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> We should be able to leave \"press\" events as-is and only add special casing for \"release\" events\n\nCurrently if I hold down key `x` (without release) it emits the same keycode as if I press-and-release `x`.\n\nI suppose it makes sense for us to formally define that as [keydown](https://developer.mozilla.org/en-US/docs/Web/API/Element/keydown_event), and that doesn't really change the semantics of existing mappings/scripts, because there was never an expectation that a keycode implied press-and-release.\n\n[This comment](https://github.com/neovim/neovim/issues/3253#issuecomment-246112626) points out that units might be needed.",
            "created_at": "2024-02-18T16:25:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/27509#issuecomment-1951376755",
            "id": 1951376755,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27509",
            "node_id": "IC_kwDOAPphoM50T6Vz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1951376755/reactions"
            },
            "updated_at": "2025-01-02T01:35:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1951376755",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Curious - if press down&up is supported in keymaps, would it then be possible to produce \"key progression\" mappings?\r\n\r\ne.g.\r\n\r\n(press asdf one finger at a time until all 4 keys are pressed down and then let go of a s d then f one finger at a time)\r\n```lua\r\nvim.keymap.set(\r\n    \"n\",\r\n    \"<PDown>a<PDown>s<PDown>d<PDown>f<PUp>a<PUp>s<PUp>d<PUp>f\",\r\n    'echomsg \"hello\"', {}\r\n)\r\n```\r\n\r\nOr maybe even \"chord\" mappings?\r\n\r\n(press asdf down in any order [or at the same time] and then release in any order [or at the same time])\r\n```lua\r\nvim.keymap.set(\r\n    \"n\",\r\n    \"<PDownStart>asdf<PDownEnd><PUpStart>asdf<PUpEnd>\",\r\n    'echomsg \"hello\"', {}\r\n)\r\n```\r\n\r\nEdit: Just reread and saw the recommendation to use `nvim_set_keymap`. Anyway, the concepts I thought were still worth asking about.\r\n\r\nThe potential would be pretty interesting, assuming Terminal emulators support that kind of input. I have no idea though, terminal inner workings are pretty foreign to me.",
            "created_at": "2024-03-14T04:56:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/27509#issuecomment-1996462225",
            "id": 1996462225,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27509",
            "node_id": "IC_kwDOAPphoM52_5iR",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1996462225/reactions"
            },
            "updated_at": "2024-03-14T05:01:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1996462225",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10103049?v=4",
                "events_url": "https://api.github.com/users/ColinKennedy/events{/privacy}",
                "followers_url": "https://api.github.com/users/ColinKennedy/followers",
                "following_url": "https://api.github.com/users/ColinKennedy/following{/other_user}",
                "gists_url": "https://api.github.com/users/ColinKennedy/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ColinKennedy",
                "id": 10103049,
                "login": "ColinKennedy",
                "node_id": "MDQ6VXNlcjEwMTAzMDQ5",
                "organizations_url": "https://api.github.com/users/ColinKennedy/orgs",
                "received_events_url": "https://api.github.com/users/ColinKennedy/received_events",
                "repos_url": "https://api.github.com/users/ColinKennedy/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ColinKennedy/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ColinKennedy/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ColinKennedy",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "With https://github.com/neovim/neovim/pull/29805 merged, the next step for this is to figure out this part:\r\n\r\n>The more difficult problem is plumbing this into Neovim's own event handling.\r\n>\r\n>At least one question is how a press/release event should be represented. The TUI sends all key events to the core with nvim_input, so we need a way to represent the \"press\"/\"release\" event there.",
            "created_at": "2024-07-22T02:48:49Z",
            "html_url": "https://github.com/neovim/neovim/issues/27509#issuecomment-2241942060",
            "id": 2241942060,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27509",
            "node_id": "IC_kwDOAPphoM6FoVIs",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 1,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2241942060/reactions"
            },
            "updated_at": "2024-07-22T02:48:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2241942060",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27509/comments",
    "created_at": "2024-02-17T20:08:19Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27509/events",
    "html_url": "https://github.com/neovim/neovim/issues/27509",
    "id": 2140547018,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 396626349,
            "name": "input",
            "node_id": "MDU6TGFiZWwzOTY2MjYzNDk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/input"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "key bindings",
            "id": 3304938718,
            "name": "mappings",
            "node_id": "MDU6TGFiZWwzMzA0OTM4NzE4",
            "url": "https://api.github.com/repos/neovim/neovim/labels/mappings"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27509/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 686,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 635,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-01-21T00:09:37Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM5_lifK",
    "number": 27509,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 14,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 5,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 19,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27509/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27509/timeline",
    "title": "Press/release key event support",
    "updated_at": "2025-01-17T15:27:11Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27509",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
        "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
        "followers_url": "https://api.github.com/users/gpanders/followers",
        "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
        "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/gpanders",
        "id": 8965202,
        "login": "gpanders",
        "node_id": "MDQ6VXNlcjg5NjUyMDI=",
        "organizations_url": "https://api.github.com/users/gpanders/orgs",
        "received_events_url": "https://api.github.com/users/gpanders/received_events",
        "repos_url": "https://api.github.com/users/gpanders/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/gpanders",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nWith https://github.com/kovidgoyal/kitty/issues/8226, kitty now has the ability to display variable font sizes, and it's likely to be adopted by many other terminal emulators after the feedback phase. A good place to use this can be 'stl' or 'winbar', which are less important in the viewport and reducing their size will incur less visual noise and more space for the actual buffers.\n\n### Expected behavior\n\nProvide a way to set text size like hlgroups:\n```\nset stl = \"%^<settings>^<affected font>%$<normal font>\"\n```\nwhere settings are:\n```\nn=1:d=2;\n```\netc.\n\nAdditionally, a more general sulution is to support them being part of hlgroups, though that sounds a bit too ambitious right now...",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Variable line-height should be quite feasible. We can start with that. Would allow e.g. markdown headings to be shown at a different height.",
            "created_at": "2025-02-20T21:53:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/32539#issuecomment-2672772145",
            "id": 2672772145,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32539",
            "node_id": "IC_kwDOAPphoM6fT0Qx",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 7,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 7,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2672772145/reactions"
            },
            "updated_at": "2025-02-20T21:53:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2672772145",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> a more general sulution is to support them being part of hlgroups\n\nThis may be required to achieve variable font sizes for 'statusline' anyway.",
            "created_at": "2025-02-20T23:44:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/32539#issuecomment-2672960130",
            "id": 2672960130,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32539",
            "node_id": "IC_kwDOAPphoM6fUiKC",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2672960130/reactions"
            },
            "updated_at": "2025-02-21T00:05:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2672960130",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Feels like this could be very interesting for things like lsp inlay hints which can get quite noisy in terminal editors, in part because it's rendered with normal sized text.\n\nIIRC vscode uses a smaller font (among other differences) which ends up making things both visually distinct (what is actual text and what is a hint) and using less horizontal space.",
            "created_at": "2025-02-22T01:27:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/32539#issuecomment-2675917007",
            "id": 2675917007,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32539",
            "node_id": "IC_kwDOAPphoM6ff0DP",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 3,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 6,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2675917007/reactions"
            },
            "updated_at": "2025-02-22T01:28:10Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2675917007",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/15268706?v=4",
                "events_url": "https://api.github.com/users/algmyr/events{/privacy}",
                "followers_url": "https://api.github.com/users/algmyr/followers",
                "following_url": "https://api.github.com/users/algmyr/following{/other_user}",
                "gists_url": "https://api.github.com/users/algmyr/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/algmyr",
                "id": 15268706,
                "login": "algmyr",
                "node_id": "MDQ6VXNlcjE1MjY4NzA2",
                "organizations_url": "https://api.github.com/users/algmyr/orgs",
                "received_events_url": "https://api.github.com/users/algmyr/received_events",
                "repos_url": "https://api.github.com/users/algmyr/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/algmyr/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/algmyr/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/algmyr",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I have been thinking about this quite a bit from the perspective of Neovide, for a few years already actually. The highlight group already support different fonts https://neovim.io/doc/user/syntax.html#highlight-font, but unfortunately it's not very usable on its own due to different fonts needing different grid sizes. So Neovide has not taken that into use.\n\nEven a different font size for a single window would be very limited. First of all, it can only support monospaced fonts, since the actual grid size for line wrapping needs to be known. Secondly it would need `nvim_ui_try_resize_grid`, if the font is larger, which makes the window very hard to manage, and disables all built in layout functionality. If the font is smaller, then the line wrapping would not work.\n\nFor the general protocol, here are a few of the issues need to be resolved (there are more, but the list is kept brief here)\n1. What happens when you do j/k? Which column is selected, the one visually above it, or by the column number\n2. Even for the limit case that @justinmk describes, the line height needs to be transferred from the UI to Neovim, so that it can account for the actual height in its calculation. Only an UI implementation can provide this information, since it needs to be read from the font metrics.\n3. For the more generic case of variable width fonts, the UI is the one that needs to do the line wrapping, since again, it depends totally on the font and the font metrics. This also make the j/k (gj/gk) case even more complex\n4. The current UI protocols and extensions are totally grid based, so it's not possible for Neovim to send longer lines or more rows than the grid size.\n\nTherefore, I suggest that you start with a very limited new UI protocol for this. \n1. The variable text is sent with a new protocol, which allows the UI to take care of the wrapping, and rendering of it completely, not limited by the number of columns in the grid.\n2. You can't navigate to these lines, so they work like virtual text in that sense. In a markdown document for example, a plugin could switch to normal rendering when going to these lines, which bypasses problem 1.\n3. The UI should tell the actual box height / width of the rendered text. To avoid flickering, this should be done before it's actually drawn. Initially Neovim could always reserve full columns / rows for this, but eventually fractional ones should be supported. It's also possible that the UI can do some re-positioning of its own so that only full columns/rows are needed.\n4. Parts of this could share my suggestion about the image protocol. The variable text is attached to the buffer with an `extmark`, and the allocated spaces is reserved using virtual text.\n\nI think this should already support a great number of use cases, for example\n* Markdown headings\n* LSP documentation \n* LSP error information\n* LSP inlay hints\n* A debugger UI that doesn't take up the whole screen\n* A LSP symbols display that don't take up the whole screen with long C++ template names\n* A diff view that can fit on smaller screens\n\n",
            "created_at": "2025-02-26T07:43:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/32539#issuecomment-2684181079",
            "id": 2684181079,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32539",
            "node_id": "IC_kwDOAPphoM6f_VpX",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2684181079/reactions"
            },
            "updated_at": "2025-02-26T07:43:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2684181079",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/32539/comments",
    "created_at": "2025-02-20T20:46:32Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/32539/events",
    "html_url": "https://github.com/neovim/neovim/issues/32539",
    "id": 2867232810,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 103834742,
            "name": "gui",
            "node_id": "MDU6TGFiZWwxMDM4MzQ3NDI=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/gui"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 113026979,
            "name": "ui",
            "node_id": "MDU6TGFiZWwxMTMwMjY5Nzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "UI extensibility, events, protocol, externalized UI",
            "id": 640132777,
            "name": "ui-extensibility",
            "node_id": "MDU6TGFiZWw2NDAxMzI3Nzc=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui-extensibility"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "redraw, layout, presentation",
            "id": 718084050,
            "name": "display",
            "node_id": "MDU6TGFiZWw3MTgwODQwNTA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/display"
        },
        {
            "color": "F3A62E",
            "default": false,
            "description": "community: Google Summer of Code project",
            "id": 834483397,
            "name": "gsoc",
            "node_id": "MDU6TGFiZWw4MzQ0ODMzOTc=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/gsoc"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1786207367,
            "name": "highlight",
            "node_id": "MDU6TGFiZWwxNzg2MjA3MzY3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/highlight"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/32539/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 266,
        "created_at": "2014-11-26T22:13:11Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "We don't plan to work on this, but will accept high quality contributions from someone who will own the feature and follow up on bug reports.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/9",
        "id": 881978,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/9/labels",
        "node_id": "MDk6TWlsZXN0b25lODgxOTc4",
        "number": 9,
        "open_issues": 307,
        "state": "open",
        "title": "needs-owner",
        "updated_at": "2025-03-02T20:20:52Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/9"
    },
    "node_id": "I_kwDOAPphoM6q5oAq",
    "number": 32539,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/32539/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/32539/timeline",
    "title": "variable font sizes for 'statusline' and friends",
    "updated_at": "2025-02-26T07:43:41Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/32539",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/108414369?v=4",
        "events_url": "https://api.github.com/users/xiaoshihou514/events{/privacy}",
        "followers_url": "https://api.github.com/users/xiaoshihou514/followers",
        "following_url": "https://api.github.com/users/xiaoshihou514/following{/other_user}",
        "gists_url": "https://api.github.com/users/xiaoshihou514/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/xiaoshihou514",
        "id": 108414369,
        "login": "xiaoshihou514",
        "node_id": "U_kgDOBnZFoQ",
        "organizations_url": "https://api.github.com/users/xiaoshihou514/orgs",
        "received_events_url": "https://api.github.com/users/xiaoshihou514/received_events",
        "repos_url": "https://api.github.com/users/xiaoshihou514/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/xiaoshihou514/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/xiaoshihou514/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/xiaoshihou514",
        "user_view_type": "public"
    }
}
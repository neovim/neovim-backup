{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nThe documentation in `:help shell-powershell` should be updated to work correctly for majority of Windows/powershell users.\nhttps://github.com/neovim/neovim/blob/afdad5c76ec5a5ad1c3e3d21d168ed3d9349ba8c/runtime/doc/options.txt#L5226-L5232\n\nThis issues is intended to break out the part of the discussion in #32504  around the shell option values in the documentation for powershell into a more general issue and hopefully get feedback from other Windows/Powershell users about what these reccommended settings should be.\n\nFor non-windows/non-powershell users, I want to add the additional context about the two versions of powershell. \n- \"Windows Powershell\" is the default version of powershell on windows with last version being 5.1. The command to run it is \"powershell\". \n- \"PowerShell Core\" is the cross-platform version of powershell and it currently goes up to version 7.5. The command to run it is \"pwsh\". \n\nMany Windows users install PowerShell Core to get the latest features which is why `:help shell-powershell`  has the line `let &shell = executable('pwsh') ? 'pwsh' : 'powershell'`. The recommended settings in `:help shell-powershell` should ideally be valid for both versions.\n\nIssues with current documentation:\n- The `Remove-Alias -Force -ErrorAction SilentlyContinue tee;` part of `shellcmdflag`  causes an error for the `tee` usage in `shellpipe`. There are two solutions either remove the `Remove-Alias -Force -ErrorAction SilentlyContinue tee;` or replace the `tee` alias with it's command `Tee-Object`. Ideally both should be done.\n- The ` $PSStyle.OutputRendering=''plaintext'';` part of the shellcmdflag does not work on the default version of powershell of 5.1. I don't know what the intent was behind setting this value so I don't now if this should be entirely removed from the docs or not. At a minimum this should be noted so that users of the defualt 5.1 version don't use a shellcmdflag that causes errors. \n- IMO, most users probably don't need their powershell profile to run during shell commands started by neovim so the docs should probably mention that the user may want to add `-NoProfile` to the shellcmdflag option if they have a slow powershell profile. \n\nMaking the above changes it would look something like this:\n```vimscript\nlet &shell = executable('pwsh') ? 'pwsh' : 'powershell'\nlet &shellcmdflag = '-NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.UTF8Encoding]::new();$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\nlet &shellredir = '2>&1 | %%{ \"$_\" } | Out-File %s; exit $LastExitCode'\nlet &shellpipe  = '2>&1 | %%{ \"$_\" } | Tee-Object %s; exit $LastExitCode'\nset shellquote= shellxquote=\n```\n\nLastly, my personal config has used for a long time the lua version of the options I found from https://github.com/akinsho/toggleterm.nvim/wiki/Tips-and-Tricks. Those options do solve the issues listed above and are imo easier to read.\nIf we went with that version the docs would become: \n```vimscript\nlet &shell = executable('pwsh') ? 'pwsh' : 'powershell'\nlet &shellcmdflag = '-NoLogo -NoProfile -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;'\nlet &shellredir = '-RedirectStandardOutput %s -NoNewWindow -Wait'\nlet &shellpipe = '2>&1 | Out-File -Encoding UTF8 %s; exit $LastExitCode'\nset shellquote= shellxquote=\n```\n\n\n\n### Expected behavior\n\nThe documentation in `:help shell-powershell` should list shell option values that work for the majority of powershell users regardless of which version for powershell they use.",
    "closed_at": "2025-12-10T05:57:17Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "PR welcome, but please check the git history for this option and the related PR discussions to ensure that it doesn't regress the previous changes (or explain why they are worth regressing). This doc has seen a lot of changes because of various quirks that were noticed. It's not clear to me whether those previous changes were actually worthwhile or if they just complicated things.",
            "created_at": "2025-03-16T12:45:43Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-2727376693",
            "id": 2727376693,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM6ikHc1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2727376693/reactions"
            },
            "updated_at": "2025-03-16T12:45:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2727376693",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@crwebb85 I'm also now trying to figure out the best options for `powershell`/`pwsh` users. When you receive an error from a command do also still get the escape sequences? Please see example below,\n\n<img width=\"809\" height=\"102\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/47cffd8f-986c-4900-bb86-010d7c9e568f\" />\n\nI believe we don't want these and this is definitely related to setting the correct settings you list in this issue. I am using these settings on Neovim 0.11.5, \n\n```vim\nlet &shell = executable('pwsh') ? 'pwsh' : 'powershell'\nlet &shellcmdflag = '-NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.UTF8Encoding]::new();$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\nlet &shellredir = '2>&1 | %%{ \"$_\" } | Out-File %s; exit $LastExitCode'\nlet &shellpipe  = '2>&1 | %%{ \"$_\" } | Tee-Object %s; exit $LastExitCode'\nset shellquote= shellxquote=\n```\n\nI would like to contribute to this issue so any input you can give from your research would be beneficial.\n\nI've seen some other people do something like this,\n```lua\nvim.opt.shellcmdflag = \"-NoLogo -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSStyle.Formatting.Error = '';$PSStyle.Formatting.ErrorAccent = '';$PSStyle.Formatting.Warning = ''$PSStyle.OutputRendering = 'PlainText';\"\n```\nwhich overrides the local `$PSStyle` which is ok for `pwsh` users but not `powershell` users. Ideally there should be a universal approach. I've also tried to use `| Out-File -Encoding utf8 %s; exit $LastExitCode` but the escape codes still slip. Note that this does not happen on success which definitely implies some things!",
            "created_at": "2025-12-03T12:51:33Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3606711312",
            "id": 3606711312,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7W-gwQ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3606711312/reactions"
            },
            "updated_at": "2025-12-03T19:55:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3606711312",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The escape codes should be handled by `:!` , i.e. that's arguably a bug with `:!`. Though it could make sense to specify shell options to avoid that, for now.",
            "created_at": "2025-12-03T17:21:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3607952875",
            "id": 3607952875,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XDP3r",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3607952875/reactions"
            },
            "updated_at": "2025-12-03T17:21:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3607952875",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> When you receive an error from a command do also still get the escape sequences?\n\nInteresting, I also have it displaying the ansi sequences as characters when I run a terminal command even if it doesn't error.\n\nAlso, the main reason I haven't created a PR for this is that I was running into a weird issue that only affected me on my work computer. When I ran a powershell command with overseer.nvim on the terminal strategy (as in it runs in a terminal rather than jobstart) the output wouldn't output the correct linebreak characters so overseer was unable to correctly parse the output into the quickfix list when lines overflowed. This strangely only happens on my work computers, so it might be the specific version of Windows 11 that is the problem. I haven't yet had a chance to properly investigate why it happens, but it was enough to make me think I needed to spend some more time trying to better understand these options and what they may affect.\n\n",
            "created_at": "2025-12-03T17:27:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3607977626",
            "id": 3607977626,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XDV6a",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3607977626/reactions"
            },
            "updated_at": "2025-12-03T17:46:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3607977626",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Interesting, I also have it displaying the ansi sequences as characters when I run a terminal command even if it doesn't error.\n\nMy bad...I was checking so many settings I must've messed up my terminal environment without realising. Yes indeed it outputs escape codes on success and on error, but when using `$PSStyle.OutputRendering='plaintext'` it actually gets rid of the ones on success.\n\n> The escape codes should be handled by `:!` , i.e. that's arguably a bug with `:!`. Though it could make sense to specify shell options to avoid that, for now.\n\nI can't find a non-hacky way of doing it and I'm not familiar with how the `:!` functions so it may be worth looking into. I'm also not sure how `:!` works on other platforms, and if you also see escape codes when using other shells or if this is Windows/PowerShell specific issue that needs to be opened. Can someone confirm this functionality please?\n\nIt seems like this is evolving into a separate issue but I do think these docs should be updated. I do agree that everything listed in the issue should be changed. There should be notes on `-NoProfile` and using `$PSStyle.OutputRendering='plaintext'` since that won't work with `powershell`. Also maybe a note on `$Env:NO_COLOR=1` to remove colors (even though that doesn't seem to do much). I believe the settings below would be the best,\n\n```vim\nlet &shell = executable('pwsh') ? 'pwsh' : 'powershell'\nlet &shellcmdflag = '-NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\nlet &shellredir = '2>&1 | %%{ \"$_\" } | Out-File -Encoding utf8 %s; exit $LastExitCode'\nlet &shellpipe  = '2>&1 | %%{ \"$_\" } | Tee-Object -Encoding utf8 %s; exit $LastExitCode'\nset shellquote= shellxquote=\n```\n\nI prefer these ones rather than the toggleterm ones you mentioned because they seem more explicit/descriptive. Open to comments and opinions.\n",
            "created_at": "2025-12-03T18:29:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3608241368",
            "id": 3608241368,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XEWTY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608241368/reactions"
            },
            "updated_at": "2025-12-03T18:29:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608241368",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I'm also not sure how `:!` works on other platforms, and if you also see escape codes when using other shells or if this is Windows/PowerShell specific issue that needs to be opened\n\nNot Windows-specific. Generally, most commands detect whether they are in a terminal and will not emit escape codes if they aren't. \n\nAnyways, this is not really the point of this issue.",
            "created_at": "2025-12-03T19:54:43Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3608589389",
            "id": 3608589389,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XFrRN",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608589389/reactions"
            },
            "updated_at": "2025-12-03T19:54:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3608589389",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Turns out I need some more help because I'm having some trouble understanding how using `:!` commands through Neovim works. I didn't think it was good enough to leave it where it I had left it and thankfully I found some more things. \n\nSo there settings below are great for `powershell` and NOT `pwsh`. The escape codes get handled and nothing weird happens in this case,\n\n```vim\nlet &shell = 'powershell'\nlet &shellcmdflag = '-NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\nlet &shellredir = '2>&1 | %%{ \"$_\" } | Out-File -Encoding utf8 %s; exit $LastExitCode'\nlet &shellpipe  = '2>&1 | %%{ \"$_\" } | Tee-Object -Encoding utf8 %s; exit $LastExitCode'\nset shellquote= shellxquote=\n```\n\nNow for `pwsh` I'm a bit lost but I think with some help we can get there. Essentially if you look at the docs [here](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_ansi_terminals?view=powershell-7.5#redirecting-output-in-host-mode) it shows you what happens when redirecting inside of the command string, and that's what we want. The option `$PSStyle.OutputRendering = 'Host'` is already set so we don't have to mess with that. Also [here ](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_redirection?view=powershell-7.5#long-description)in the third bullet point it explains how `| Out-File out.txt` is the same as `> out.txt`.\n\nMy question now is, how does the `shell` and `shellredir` options work with each other? I've read the existing documentation but I just can't understand how they interact. It appears that they sandwich a command between them, but I don't think surrounding the `-Command` option in quotes like in the snippet below would work. We essentially want this command but somehow emulated within Neovim, with the `Get-ChildItem` command be any possible command. Notice the quotes surrounding the entire command string. Any ideas? Wish I knew more about this topic but unfortunately I'm learning as I go and as I discuss it here. \n\n```powershell\npwsh -NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command '[Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';Get-ChildItem  2>&1 | %{ \"$_\" } | Out-File out.txt'\n```\n\nAt least using `powershell` is fully sorted now lol",
            "created_at": "2025-12-03T22:56:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3609184373",
            "id": 3609184373,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XH8h1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3609184373/reactions"
            },
            "updated_at": "2025-12-03T22:56:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3609184373",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Also @crwebb85 have you seen [this commit](https://github.com/neovim/neovim/commit/d9f78b63361e00a7f623ebb5b869606ac653b180) regarding `tee`? What do you think?",
            "created_at": "2025-12-03T23:16:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3609234986",
            "id": 3609234986,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XII4q",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3609234986/reactions"
            },
            "updated_at": "2025-12-03T23:16:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3609234986",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> have you seen this commit regarding tee\n\nInteresting, I hadn't seen that. I'll need to try that out and see if Tee-Object still behaves that way. On a side note, I tried the new vendered tee.exe the other day and was surprised that it didn't strip ansi sequences from the output. I did call it from outside neovim, but I don't think that should make a difference.",
            "created_at": "2025-12-04T03:16:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3609863473",
            "id": 3609863473,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XKiUx",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3609863473/reactions"
            },
            "updated_at": "2025-12-04T03:25:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3609863473",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "It seems that you do need `tee.exe` since you get an error when using `Tee-Object` as described in the linked commit (see images below). Another previous error they made was using `Remove-Alias`, which isn't supported in `powershell`. I believe that if we use `tee.exe` it'll be fine because this is `powershell` and not the cross platform `pwsh`. Using `tee.exe` means that it'll look for the actual Windows executable and not the alias. I've been using the `tee.exe` from Vim since for some reason my dev build isn't making `tee.exe` but this should work regardless. That might also be the reason I'm seeing a [Byte Order Mark](https://en.wikipedia.org/wiki/Byte_order_mark). If someone can test this with the Neovim `tee.exe` that would be great. The current `powershell` options based on these discoveries are as follows,\n\n```vim\nlet &shell = 'powershell'\nlet &shellcmdflag = '-NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\nlet &shellredir = '2>&1 | %%{ \"$_\" } | Out-File -Encoding utf8 %s; exit $LastExitCode'\nlet &shellpipe  = '2>&1 | %%{ \"$_\" } | tee.exe %s; exit $LastExitCode'\nset shellquote= shellxquote=\n```\n\n<img width=\"680\" height=\"140\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/9e4f3073-576a-4155-856a-9e23d18de379\" />\n\n<img width=\"499\" height=\"103\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/22c17d67-c6c8-45e2-ac3b-a4a75ac864dc\" />\n\n`pwsh` related settings still need to be figured out!",
            "created_at": "2025-12-04T11:39:12Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3611745448",
            "id": 3611745448,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XRtyo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3611745448/reactions"
            },
            "updated_at": "2025-12-04T11:40:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3611745448",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I tried the new vendered tee.exe the other day and was surprised that it didn't strip ansi sequences from the output.\n\nif the input has ansi sequences then the output should have them. `tee` is not supposed to modify anything, it just redirects the stream",
            "created_at": "2025-12-04T17:26:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3613408340",
            "id": 3613408340,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XYDxU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3613408340/reactions"
            },
            "updated_at": "2025-12-04T17:26:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3613408340",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I wanted to leave another comment to sort of document the previous attempts for figuring out the settings, and to try to explain them somewhat so that they're not just scattered in different commits. Some changes were also done without much of an explanation so I think it would be beneficial for all if I write this down. This would also ensure we are progressing instead of regressing.\n\nSo the first major addition to this section of `options.txt` is in this commit: https://github.com/neovim/neovim/commit/8b0765390292961aa0ec22e9931885c6d947c5e6\nwhich adds most of the familiar settings we have now, with a mistake in `shellpipe` that gets fixed in another commit.\n\nNext one was this one here: https://github.com/neovim/neovim/commit/0b9664f5240be4d9e9d6882fcd398970fd3a9532\nThese options are the ones that were suggested in this issue at the bottom. Therefore we can assume that the toggleterm.nvim author(s) got them from Neovim. I don't understand why Neovim used `let &shellredir = '-RedirectStandardOutput %s -NoNewWindow -Wait'` since this option `-RedirectStandardOutput` is only used in the `Start-Process` cmdlet, ([docs](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/start-process?view=powershell-7.5#-redirectstandardoutput)) and it doesn't get called when invoking the shell (or does it?).\n\nAnyway, it gets changed again in this commit https://github.com/neovim/neovim/commit/b4d42bb9058308c38e3fe9d59458ce65b3f65eb0\nand it's a bit more familiar now. Nothing much to say about this one.\n\nThen in this commit here https://github.com/neovim/neovim/commit/ecc4d0e435d618828b938d78fbded7fbe1314760\nsomething more interesting happens, where the command result (both stdout/stderr in this case) get converted from PowerShell objects into strings using `%{ \"$_\" }`. The `%{}` is an alias for the [`FoForEach-Object`](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/foreach-object?view=powershell-7.5) cmdlet and the `$_` is an alias for `$PSItem` which contains the current object in the pipeline. This does appear to be the correct way of doing this, therefore this should stay.\n\nTo see the effect of this you can execute these two commands in `powershell` and observe the difference in the output,\n```powershell\nGet-ChildItem | %{ \"$_\" }\nGet-ChildItem\n```\n\nThe next commit for this is here https://github.com/neovim/neovim/commit/d9f78b63361e00a7f623ebb5b869606ac653b180\nand it is when it was realised that the `Tee-Object` cmdlet does not work in the same way `tee` works.\n\nLastly, the most recent commit https://github.com/neovim/neovim/commit/4c7f5032af6baca61764cde5122765b2ec684e4a\nand it is when there was a mistake thinking that `powershell` contains the `$PSStyle` variable. \n\nAnd that's all! \n\nI believe I am fully there with the `powershell` settings, but the `pwsh` settings might be slightly different. They are different shells unfortunately...\n",
            "created_at": "2025-12-04T17:32:31Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3613446130",
            "id": 3613446130,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XYM_y",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3613446130/reactions"
            },
            "updated_at": "2025-12-04T17:51:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3613446130",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@ymich9963 did you tried to set them like it's defined for the tests here?\n\nhttps://github.com/neovim/neovim/blob/master/test%2Ffunctional%2Ftestnvim.lua#L699\n\nI would really like to know if you still have issues then.\n\nWith `shelltemp=false` all you need is basically:\n\n```\nshellpipe  = '> %s 2>&1'\n```\n\nAt least this was working for the tests pretty good.\n\nNot entirely sure if you need to override `shellcmdflag` to set all the extra options that we set there.",
            "created_at": "2025-12-04T20:08:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3614138878",
            "id": 3614138878,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7Xa2H-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3614138878/reactions"
            },
            "updated_at": "2025-12-04T20:15:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3614138878",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7147208?v=4",
                "events_url": "https://api.github.com/users/616b2f/events{/privacy}",
                "followers_url": "https://api.github.com/users/616b2f/followers",
                "following_url": "https://api.github.com/users/616b2f/following{/other_user}",
                "gists_url": "https://api.github.com/users/616b2f/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/616b2f",
                "id": 7147208,
                "login": "616b2f",
                "node_id": "MDQ6VXNlcjcxNDcyMDg=",
                "organizations_url": "https://api.github.com/users/616b2f/orgs",
                "received_events_url": "https://api.github.com/users/616b2f/received_events",
                "repos_url": "https://api.github.com/users/616b2f/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/616b2f/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/616b2f/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/616b2f",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thanks for your reply. I will paste my findings below. Hopefully the images aren't too much and my reply is easy to follow. So you're referring to these lines here,\n\nhttps://github.com/neovim/neovim/blob/6383123326483db401c09a5e1f4dc99f11c900d6/test/functional/testnvim.lua#L699-L708\n\nand I believe I extracted them correctly as shown below,\n\n```vim\n    let &shell = executable('pwsh') ? 'pwsh' : 'powershell'\n    set shellquote= shellxquote=\n    let &shellcmdflag = '-NoLogo -NoProfile -ExecutionPolicy RemoteSigned -Command '\n    let &shellcmdflag .= '[Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.UTF8Encoding]::new();'\n    let &shellcmdflag .= '$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\n    let &shellcmdflag .= 'Remove-Item -Force alias:cat,alias:echo,alias:sleep,alias:sort,alias:tee;'\n    let &shellredir = '2>&1 | %%{ \"$_\" } | Out-File %s; exit $LastExitCode'\n    let &shellpipe  = '> %s 2>&1'\n```\n\nFor these I did 3 simple tests to sort of show the expected behaviour. First one is running `:!get-childitem` to get a succesful output, then it is `!:get-childitem -test` to get an error, then it is `:grep testxyz` (which is a string that doesn't exist), and setting `:set makeprg=echo\\ test` and then running `:make`. The images for these tests are at the very bottom of the reply so that it flows nicer.\n\nThe results below are the same when also adding `set noshelltemp` to the end of my snippet above. I expected these results tbh because the snippet will choose `pwsh` as the shell, which I've already mentioned to have issues with escape codes. The settings above work find with `powershell`, although it's interesting how no `tee` is mentioned in `shellpipe`. The tests weren't exhaustive by any means but it shows that commands like `:grep` and `:make` that use `shellpipe` don't need `tee.exe`! And that's great! Makes things feel less hacked together and more reliable for sure. I still have some doubt  regarding this and please feel free to comment.\n\nIs the `Remove-Item` line necessary? Those aliases don't really get used anywhere when calling the shell. Commands like `:!echo` still work...but they shouldn't I think? I'm all for not using `tee.exe` since it doesn't seem like it's needed, and I hope now the issue with `pwsh` is more clear. The issue is more visual than anything else and I think all commands would work fine. See my comment here https://github.com/neovim/neovim/issues/32921#issuecomment-3609184373 for a bit more of an explanation.\n\n---\n\n<img width=\"1000\" height=\"300\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/f5063ca9-d3be-4c1c-ac47-d8e30be38dd9\" />\n\n<img width=\"1000\" height=\"216\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/600161d1-3cb3-4fec-9e18-20ce6f41556e\" />\n\n<img width=\"1072\" height=\"171\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/2726c27b-61b9-495e-8ac2-cfd0f39ab502\" />\n\n<img width=\"880\" height=\"157\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/1deeb6c2-984f-4588-8a4b-75ab8a278dff\" />\n",
            "created_at": "2025-12-04T23:28:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3614726233",
            "id": 3614726233,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7XdFhZ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3614726233/reactions"
            },
            "updated_at": "2025-12-04T23:28:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3614726233",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Another comment just to summarise and to maybe get some opinions because I think I've exhausted all the different settings we can use to fix the ANSI codes on `pwsh`. Not sure if the next step after this would be to modify the code but that's a big task for me at this moment.\n\nSo for `powershell` these settings seem to work great\n```vim\nlet &shell = 'powershell'\nlet &shellcmdflag = '-NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\nlet &shellredir = '2>&1 | %%{ \"$_\" } | Out-File -Encoding utf8 %s; exit $LastExitCode'\nlet &shellpipe  = '> %s 2>&1'\nset shellquote= shellxquote=\n```\nbut I'm unsure if `'Remove-Item -Force alias:cat,alias:echo,alias:sleep,alias:sort,alias:tee;'` should also be added to `shellcmdflag`. It appears to be not necessary.\n\nFor `pwsh` as shown in the images above there are some issues with the escape codes showing. The same settings as `powershell` still apply and seem work with `:make` and `:grep` which is great. Setting `shellcmdflag` to this,\n```vim\nlet &shellcmdflag = '-NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';$PSStyle.OutputRendering=''PlainText'';'\n```\nwill remove the ANSI codes when the command succeeds, but not on failure. Some people fix this by modifying `$PSStyle` extensively like so,\n```powershell\n$PSStyle.Formatting.Error = '';$PSStyle.Formatting.ErrorAccent = '';$PSStyle.Formatting.Warning = '';$PSStyle.OutputRendering = 'PlainText';\"\n```\nbut I don't really like that approach even though it works I guess.\n\nI have a strong suspicion that the reason `pwsh` behaves like this is discussed in the MS docs here [Redirecting output in Host mode](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_ansi_terminals?view=powershell-7.5#redirecting-output-in-host-mode), which explains that the `-Command <cmd> > out.txt` the `<cmd> > out.txt` should be in quotes for ANSI codes to be removed. I don't think this is doable however without modifying the codebase since we want to use everything in the `-Command` option, which is `[Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';`. I've tried loosely testing with `shellquote` and `shellxquote` but I couldn't really get anywhere.\n\nHope this is a good summary that gives more insight and allows other people to help regarding this issue. I could make a PR for the `powershell` options and make a note that for `pwsh` you need to add the `$PSStyle.OutputRendering = 'PlainText';` to the `shellcmdflag` with other optional modiciations to `$PSStyle`.",
            "created_at": "2025-12-05T11:29:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3616502033",
            "id": 3616502033,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7Xj3ER",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3616502033/reactions"
            },
            "updated_at": "2025-12-05T13:04:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3616502033",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "you don't need `Remove-Item` and also `shellredir` (this one is only used with `shelltemp=true` which is deprecated and the plan is to remove it in future, because it uses a hacky implementation, default is now `shelltemp=false` and this is what everyone should be using, so we can rule out remaining issues).\n\nI definitely think we should add `PSStyle.OutputRendering = 'PlainText';` to `shellcmdflag`, I also think that this behavior is some kind of bug in `pwsh` and maybe worth opening an issue in pwsh repository (unless you can confirm that this one maybe is fixing it https://github.com/PowerShell/PowerShell/issues/17885, which seems related but I am not 100% sure).\n\nPS: A PR with those changes to the docs would be really great :) ",
            "created_at": "2025-12-06T13:28:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3620371111",
            "id": 3620371111,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7Xynqn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620371111/reactions"
            },
            "updated_at": "2025-12-06T13:29:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620371111",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7147208?v=4",
                "events_url": "https://api.github.com/users/616b2f/events{/privacy}",
                "followers_url": "https://api.github.com/users/616b2f/followers",
                "following_url": "https://api.github.com/users/616b2f/following{/other_user}",
                "gists_url": "https://api.github.com/users/616b2f/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/616b2f",
                "id": 7147208,
                "login": "616b2f",
                "node_id": "MDQ6VXNlcjcxNDcyMDg=",
                "organizations_url": "https://api.github.com/users/616b2f/orgs",
                "received_events_url": "https://api.github.com/users/616b2f/received_events",
                "repos_url": "https://api.github.com/users/616b2f/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/616b2f/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/616b2f/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/616b2f",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thanks for the insight! I will make a note on not using `shellredir` and `shelltemp = false`. \n\nRegarding the `pwsh` behaviour, I can't really replicate it outside of Neovim. For example, this command here,\n```powershell\npwsh -NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues['Out-File:Encoding']='utf8';$PSStyle.OutputRendering = 'PlainText'; Get-ChildItem -testxyz > log.txt 2>&1\n```\ndoes give a plaintext error message when outside Neovim, but when setting the corresponding `shellcmdflag` and `shellpipe` it's still not showing properly in Neovim itself. When using this command you can also see that the error doesn't get piped to `log.txt`, and this is because it is a terminating error, therefore even with the [`-ErrorAction`](https://learn.microsoft.com/en-gb/powershell/module/microsoft.powershell.core/about/about_commonparameters?view=powershell-7.5#-erroraction) parameter, the error will still get outputted before the pipeline finishes.\n\nI'm not sure why `powershell` outputs the terminating errors fine in Neovim...maybe I'm missing something. The following code would also capture the terminating errors and place them in a temp file. Unfortunately, I don't think it's possible to have this in Neovim.\n```powershell\npwsh -NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues['Out-File:Encoding']='utf8';$PSStyle.OutputRendering = 'PlainText'; try {$var = <COMMAND> OPTS} catch {$var = $_} $var > log.txt 2>&1\n```\n\nTo summarise, I can't replicate the error ANSI codes outside Neovim, so this implies that it is a Neovim issue, even though I can't see why this would happen. I will do a PR regarding the `powershell` settings and also about the `pwsh` options with some notes on what to expect and using `$PSStyle`. \n\nOne thing I would like to clarify is if want the PS Objects to be converted to strings. For example, running this snippet,\n```powershell\nGet-ChildItem | %{ \"$_\" }\n```\ngives this output,\n```\nC:\\Users\\user\\Desktop\nC:\\Users\\user\\Documents\nC:\\Users\\user\\Downloads\nC:\\Users\\user\\Favorites\n```\nwhereas\n```powershell\nGet-ChildItem\n```\ngives this output,\n```\n    Directory: C:\\Users\\user\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\ndar--          27/11/2025    15:25                Desktop\ndar--          04/12/2025    11:35                Documents\ndar--          05/12/2025    13:26                Downloads\ndar--          27/03/2025    13:36                Favorites\n```\nDo we care about this?",
            "created_at": "2025-12-08T11:14:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3626391605",
            "id": 3626391605,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7YJlg1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3626391605/reactions"
            },
            "updated_at": "2025-12-08T11:23:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3626391605",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> One thing I would like to clarify is if want the PS Objects to be converted to strings. For example, running this snippet...\n> Do we care about this?\n\nThat's a good question. I hadn't even considered that. I need to test things out to give in informed opinion.",
            "created_at": "2025-12-08T12:43:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3626757194",
            "id": 3626757194,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7YK-xK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3626757194/reactions"
            },
            "updated_at": "2025-12-08T12:43:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3626757194",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "\n> pwsh -NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues['Out-File:Encoding']='utf8';$PSStyle.OutputRendering = 'PlainText'; Get-ChildItem -testxyz > log.txt 2>&1\n\nYou can not replicate this because it's not the command that is executed in neovim, I looked into the code and wanna clarify one more thing, `shellpipe` is only used for `:make`, if you only do `:!Get-ChildItem` then only this portion will me appended after `shellcmdflag`, so the endcommand executed in your case inside neovim would be:\n\n```sh\npwsh -NoLogo -NoProfile -NonInteractive -ExecutionPolicy RemoteSigned -Command [Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.Encoding]::UTF8;$PSDefaultParameterValues['Out-File:Encoding']='utf8';$PSStyle.OutputRendering = 'PlainText'; Get-ChildItem -testxyz\n```\nBut there are also good news regarding the ANSI escapes in this case, you could also set the `NO_COLOR` and `__SuppressAnsiEscapeSequences` env vars inside neovim in your `init.lua` like this:\n\n```lua\nvim.env.NO_COLOR=1\nvim.env.__SuppressAnsiEscapeSequences=1\n```\n\nAt least it worked for me in linux pwsh. I still think it's `pwsh` issue, as it's the one decides when to emit escape sequences and upstream you find a bunch of issues related to this topic and a bunch of edge cases where it's still does output them even if `NO_COLOR` is explicitly was introduce to resolve that issue.\n\nAs for `Get-ChildItem` vs `Get-ChildItem | %{ \"$_\" }` I personally think that the outcome should be the same as if you would run it in the shell (so without `| %{ \"$_\" }`, because it's what I personally would expect), less magic, less confusion IMHO.\n",
            "created_at": "2025-12-08T23:25:23Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3629461535",
            "id": 3629461535,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7YVTAf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3629461535/reactions"
            },
            "updated_at": "2025-12-09T00:11:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3629461535",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7147208?v=4",
                "events_url": "https://api.github.com/users/616b2f/events{/privacy}",
                "followers_url": "https://api.github.com/users/616b2f/followers",
                "following_url": "https://api.github.com/users/616b2f/following{/other_user}",
                "gists_url": "https://api.github.com/users/616b2f/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/616b2f",
                "id": 7147208,
                "login": "616b2f",
                "node_id": "MDQ6VXNlcjcxNDcyMDg=",
                "organizations_url": "https://api.github.com/users/616b2f/orgs",
                "received_events_url": "https://api.github.com/users/616b2f/received_events",
                "repos_url": "https://api.github.com/users/616b2f/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/616b2f/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/616b2f/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/616b2f",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> `shellpipe` is only used for `:make`\n\nYup, and also `:grep`. \n\n> if you only do `:!Get-ChildItem` then only this portion will me appended after `shellcmdflag`, so the endcommand executed in your case inside neovim would be:\n\nYup you're right! I was just testing everything together. I should have isolated them though so thanks for letting me know.\n\n> But there are also good news regarding the ANSI escapes in this case, you could also set the `NO_COLOR` and `__SuppressAnsiEscapeSequences` env vars inside neovim in your `init.lua` like this:\n\nWow! This is great! `NO_COLOR` doesn't work unfortunately but `__SuppressAnsiEscapeSequences` does! I was also having issues with `NO_COLOR` even through using `pwsh` in the terminal. But at least this fixes our issue! ~Is this settable through Vimscript? I'm doing, X~\n~and it doesn't seem to be working. It works with `vim.env`.~\n\nEDIT: Nvm, it should be \n```vimscript\nlet $__SuppressAnsiEscapeSequences = 1\n```\n\n> I still think it's `pwsh` issue, as it's the one decides when to emit escape sequences and upstream you find a bunch of issues related to this topic and a bunch of edge cases where it's still does output them even if `NO_COLOR` is explicitly was introduce to resolve that issue.\n\nYes that has been my experience as well unfortunately. This is also evident when I set it above. You're probably right that it's a `pwsh` issue, as they have had 3-4 issues relating to `NO_COLOR`. I'm using the latest `pwsh` version so they should have been fixed. I'm not really interested in creating another issue over there at the moment since I'm not sure if they would like a \"`NO_COLOR` not respected in Neovim\" title lol.\n\n> As for `Get-ChildItem` vs `Get-ChildItem | %{ \"$_\" }` I personally think that the outcome should be the same as if you would run it in the shell (so without `| %{ \"$_\" }`, because it's what I personally would expect), less magic, less confusion IMHO.\n\nYup totally agree! \n\nAnother question I just realised is do we want the settings to use Vimscript like they currently are, or are we changing them to their `vim.opt` equivalents? I will also start a PR for this so we can finally close this issue. \n\nFinally, just to re-iterate, there will be separate sections for the two shells. One for `powershell` and one for `pwsh`.\n\n`powershell` options:\n```vim\n    let &shell = 'powershell'\n    let &shellcmdflag = '-NoLogo -NoProfile -ExecutionPolicy RemoteSigned -Command '\n    let &shellcmdflag .= '[Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.UTF8Encoding]::new();'\n    let &shellcmdflag .= '$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\n    let &shellpipe  = '> %s 2>&1'\n    set shellquote= shellxquote=\n    set noshelltemp\n```\n\n`pwsh` options:\nSame as above but with,\n\n```vim\n    let &shellcmdflag .= '$PSStyle.OutputRendering = ''PlainText'';'\n```\nand\n```lua\nvim.env.__SuppressAnsiEscapeSequences=1\n```\nthese could be combined in the current `:h shell-powershell` section like so,\n\n```vim\n    let &shell = executable('pwsh') ? 'pwsh' : 'powershell'\n    let &shellcmdflag = '-NoLogo -NoProfile -ExecutionPolicy RemoteSigned -Command '\n    let &shellcmdflag .= '[Console]::InputEncoding=[Console]::OutputEncoding=[System.Text.UTF8Encoding]::new();'\n    let &shellcmdflag .= '$PSDefaultParameterValues[''Out-File:Encoding'']=''utf8'';'\n    let &shellcmdflag .= executable('pwsh') ? '$PSStyle.OutputRendering = ''PlainText'';' ? ''\n    let &shellpipe  = '> %s 2>&1'\n    set shellquote= shellxquote=\n    set noshelltemp\n```\nbut I personally prefer them separate. Please let me know your thoughts.",
            "created_at": "2025-12-09T09:52:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3631327893",
            "id": 3631327893,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7YcaqV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 1,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3631327893/reactions"
            },
            "updated_at": "2025-12-09T12:54:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3631327893",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I personally prefer them separate.\n\nI agree. I think separating them makes sense.",
            "created_at": "2025-12-09T12:01:08Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3631894027",
            "id": 3631894027,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7Yek4L",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3631894027/reactions"
            },
            "updated_at": "2025-12-09T12:01:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3631894027",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
                "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
                "followers_url": "https://api.github.com/users/crwebb85/followers",
                "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
                "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/crwebb85",
                "id": 51029315,
                "login": "crwebb85",
                "node_id": "MDQ6VXNlcjUxMDI5MzE1",
                "organizations_url": "https://api.github.com/users/crwebb85/orgs",
                "received_events_url": "https://api.github.com/users/crwebb85/received_events",
                "repos_url": "https://api.github.com/users/crwebb85/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/crwebb85",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Made a PR for it. Feel free to comment on there for any other changes or modifications to what I've submitted",
            "created_at": "2025-12-09T13:09:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/32921#issuecomment-3632190213",
            "id": 3632190213,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32921",
            "node_id": "IC_kwDOAPphoM7YftMF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 2,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3632190213/reactions"
            },
            "updated_at": "2025-12-09T13:09:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3632190213",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/79522843?v=4",
                "events_url": "https://api.github.com/users/ymich9963/events{/privacy}",
                "followers_url": "https://api.github.com/users/ymich9963/followers",
                "following_url": "https://api.github.com/users/ymich9963/following{/other_user}",
                "gists_url": "https://api.github.com/users/ymich9963/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ymich9963",
                "id": 79522843,
                "login": "ymich9963",
                "node_id": "MDQ6VXNlcjc5NTIyODQz",
                "organizations_url": "https://api.github.com/users/ymich9963/orgs",
                "received_events_url": "https://api.github.com/users/ymich9963/received_events",
                "repos_url": "https://api.github.com/users/ymich9963/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ymich9963/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ymich9963/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ymich9963",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 22,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/32921/comments",
    "created_at": "2025-03-15T20:03:53Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/32921/events",
    "html_url": "https://github.com/neovim/neovim/issues/32921",
    "id": 2922503238,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "c5def5",
            "default": true,
            "description": "",
            "id": 84744038,
            "name": "documentation",
            "node_id": "MDU6TGFiZWw4NDc0NDAzOA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/documentation"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "user system environment (terminal, shell, tmux)",
            "id": 147354524,
            "name": "environment",
            "node_id": "MDU6TGFiZWwxNDczNTQ1MjQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/environment"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/32921/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6uMdxG",
    "number": 32921,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 2,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 3,
        "url": "https://api.github.com/repos/neovim/neovim/issues/32921/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/32921/timeline",
    "title": "Update documentation for `:help shell-powershell`",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-12-10T05:57:17Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/32921",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/51029315?v=4",
        "events_url": "https://api.github.com/users/crwebb85/events{/privacy}",
        "followers_url": "https://api.github.com/users/crwebb85/followers",
        "following_url": "https://api.github.com/users/crwebb85/following{/other_user}",
        "gists_url": "https://api.github.com/users/crwebb85/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/crwebb85",
        "id": 51029315,
        "login": "crwebb85",
        "node_id": "MDQ6VXNlcjUxMDI5MzE1",
        "organizations_url": "https://api.github.com/users/crwebb85/orgs",
        "received_events_url": "https://api.github.com/users/crwebb85/received_events",
        "repos_url": "https://api.github.com/users/crwebb85/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/crwebb85/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/crwebb85/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/crwebb85",
        "user_view_type": "public"
    }
}
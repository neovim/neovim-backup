{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "body": "Continued discussion from #32638 .\n\n### Problem\n\nThe codebase currently contains lots of different Lua files which are run with different environments. This is becoming difficult to manage as files can be spread and is prone to rot.\n\nI've seen this problem manifest in other projects which have python scripts dotted about the codebase, whereas python's tooling works best when there is a dedicated python package, at least when dependencies are involved. This is because these files all need to be launched in an environment, and if the files are too scattered, it makes having a consistent launcher much more difficult to manage.\n\nWe roughly have 4 different execution environments for any Lua code that is run in this repo.\n\n1). `nlua` in `src/gen/`: Used by most of the generator scripts to build the Nvim binary.\n2). `nvim_lua` in `src/gen/`: Used by gen_vimdoc, gen_eval_files and lintdoc\n3). `nvim` busted in `test/`\n4). `nvim` runtime in `runtime/`\n\n1). and 2). could be split into `gen` and `doc` but share files like `c_grammar.lua`\n\nTBD: [FULL SUMMARY OF FILES]\n\nHow can we improve/refine/simplify this layout going forward?\n\n---\n\n- `scripts/bump_deps.lua` update dependencies\n- `scripts/lintdoc.lua` Lint doc files, depends on `src/gen/gen_help_html.lua`\n- `scripts/lintcommit.lua` Lint commit messages\n- `scripts/vimpatch.lua` Script for vim patch automation\n- `src/gen/c_grammar.lua`\n  - Used by:\n    - `src/gen/gen_declarations.lua`\n    - `src/gen/gen_api_ui_events.lua`\n    - `src/gen/cdoc_parser.lua.lua`\n- `src/gen/cdoc_grammar.lua`\n- `src/gen/cdoc_parser.lua`\n- `src/gen/dump_bin_array.lua`\n  - Used by:\n    - `src/gen/gen_api_dispatch.lua`\n- `src/gen/gen_api_dispatch.lua`\n- `src/gen/gen_api_ui_events.lua`\n- `src/gen/gen_char_blob.lua`\n- `src/gen/gen_declarations.lua`\n- `src/gen/gen_eval.lua`\n- `src/gen/gen_eval_files.lua`\n- `src/gen/gen_events.lua`\n- `src/gen/gen_ex_cmds.lua`\n- `src/gen/gen_filetype.lua`\n- `src/gen/gen_help_html.lua`\n- `src/gen/gen_lsp.lua`\n- `src/gen/gen_options.lua`\n- `src/gen/gen_vimdoc.lua`\n- `src/gen/gen_vimvim.lua`\n- `src/gen/hashy.lua`\n  - Used by:\n    - `src/gen/gen_eval.lua`\n    - `src/gen/gen_options.lua`\n    - `src/gen/gen_api_dispatch.lua`\n    - `src/gen/gen_api_ui_events.lua`\n- `src/gen/luacats_grammar.lua`\n- `src/gen/luacats_parser.lua`\n- `src/gen/nvim_version.lua.in`\n- `src/gen/preload.lua`\n- `src/gen/preload_nlua.lua`\n- `src/gen/util.lua`\n  - Used by:\n    - `src/gen/gen_eval_files.lua`\n    - `src/gen/gen_vimdoc.lua`\n",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "In this issue, can you add the _current_ grouping (and include the one-off \"maintainer\" scripts)?\n\nAlso important to mention is that tooling is controlled by `.luarc.json`, which acts per directory/tree, which means mixing contexts in one directory makes it significantly harder to do that.",
            "created_at": "2025-02-26T15:29:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/32643#issuecomment-2685414398",
            "id": 2685414398,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32643",
            "node_id": "IC_kwDOAPphoM6gECv-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2685414398/reactions"
            },
            "updated_at": "2025-02-26T15:31:23Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2685414398",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I'm hoping to merge #32638 today ðŸ¤ž (unless there are objections). Then it will be the _current_ grouping.",
            "created_at": "2025-02-26T15:37:23Z",
            "html_url": "https://github.com/neovim/neovim/issues/32643#issuecomment-2685436955",
            "id": 2685436955,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32643",
            "node_id": "IC_kwDOAPphoM6gEIQb",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2685436955/reactions"
            },
            "updated_at": "2025-02-26T16:58:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2685436955",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/32643/comments",
    "created_at": "2025-02-26T15:23:35Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/32643/events",
    "html_url": "https://github.com/neovim/neovim/issues/32643",
    "id": 2881992132,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "building and installing Neovim using the provided scripts",
            "id": 84723321,
            "name": "build",
            "node_id": "MDU6TGFiZWw4NDcyMzMyMQ==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/build"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 114040313,
            "name": "robustness",
            "node_id": "MDU6TGFiZWwxMTQwNDAzMTM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/robustness"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "stdlib",
            "id": 573222693,
            "name": "lua",
            "node_id": "MDU6TGFiZWw1NzMyMjI2OTM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lua"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "Nvim core functionality or code",
            "id": 858327504,
            "name": "core",
            "node_id": "MDU6TGFiZWw4NTgzMjc1MDQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/core"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/32643/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 701,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 634,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-03-02T19:20:00Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "I_kwDOAPphoM6rx7XE",
    "number": 32643,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/32643/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/32643/timeline",
    "title": "Project file structure of Lua files and different execution contexts",
    "updated_at": "2025-02-26T19:05:52Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/32643",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
        "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
        "followers_url": "https://api.github.com/users/lewis6991/followers",
        "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
        "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/lewis6991",
        "id": 7904185,
        "login": "lewis6991",
        "node_id": "MDQ6VXNlcjc5MDQxODU=",
        "organizations_url": "https://api.github.com/users/lewis6991/orgs",
        "received_events_url": "https://api.github.com/users/lewis6991/received_events",
        "repos_url": "https://api.github.com/users/lewis6991/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/lewis6991",
        "user_view_type": "public"
    }
}
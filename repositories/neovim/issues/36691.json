{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nI noticed it on `IncSearch`:\n\n<img width=\"956\" height=\"245\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/c3081958-bd0c-4f86-9cee-70e24a141110\" />\n\nbut sometimes highlights are correctly applied:\n\n<img width=\"956\" height=\"245\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/20e0dfab-2766-4e75-b7a0-c601c49b7ce5\" />\n\n<img width=\"956\" height=\"245\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/2a1ca3c8-9b5d-4305-9e6e-ee36930359c9\" />\n\n### Steps to reproduce\n\n- `nvim --clean  --cmd 'set cmdheight=0' --cmd \"lua require('vim._extui').enable({enable = true, msg = {target = 'msg'}})\" -c hi`\n- `<C-w>w`\n- `:hi IncSearch`\n- `:hi TermCursor`\n\n### Expected behavior\n\nHiglights are correctly applied.\n\n### Nvim version (nvim -v)\n\nv0.12.0-dev-1689+g87bd16e470\n\n### Vim (not Nvim) behaves the same?\n\nn/a\n\n### Operating system/version\n\nDebian Sid\n\n### Terminal name/version\n\nalacritty\n\n### $TERM environment variable\n\nalacritty\n\n### Installation\n\nfrom repo",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "It seems the Cur/IncSearch highlight from 'winhighlight' is magically applied to `xxx`ðŸ¤¯, thus hiding the extmark highlight.",
            "created_at": "2025-11-26T00:02:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3578126228",
            "id": 3578126228,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7VRd-U",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578126228/reactions"
            },
            "updated_at": "2025-11-26T16:11:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3578126228",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Indeed, the window-local highlights causes this issue (commenting out is enough to show it).\n\nApparently using `nvim_set_hl` with `nvim_win_set_hl_ns` would require separate namespaces for each of the four windows (to avoid overriding hls within the same ns), but not sure if that was the solution (and not checked if could this complicate the use `nvim_buf_set_extmark`).",
            "created_at": "2025-11-26T15:32:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3581875038",
            "id": 3581875038,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7VfxNe",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3581875038/reactions"
            },
            "updated_at": "2025-11-26T16:11:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3581875038",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Yes I thought let's not pollute the namespaces further if we can avoid it using 'winhighlight'. But even `nvim_set_hl` results in the same behavior:\n```diff\ndiff --git a/runtime/lua/vim/_extui/shared.lua b/runtime/lua/vim/_extui/shared.lua\nindex 0c9908f12b..44f49318a4 100644\n--- a/runtime/lua/vim/_extui/shared.lua\n+++ b/runtime/lua/vim/_extui/shared.lua\n@@ -81,14 +81,16 @@ function M.check_targets()\n         api.nvim_set_option_value('bufhidden', 'hide', { scope = 'local' })\n         api.nvim_set_option_value('buftype', 'nofile', { scope = 'local' })\n         -- Use MsgArea except in the msg window. Hide Search highlighting except in the pager.\n-        local search_hide = 'Search:,CurSearch:,IncSearch:'\n-        local hl = 'Normal:MsgArea,' .. search_hide\n-        if type == 'pager' then\n-          hl = 'Normal:MsgArea'\n-        elseif type == 'msg' then\n-          hl = search_hide\n+        local ns = api.nvim_create_namespace(('nvim._extui.%s_hl'):format(type))\n+        api.nvim_win_set_hl_ns(M.wins[type], ns)\n+        if type ~= 'msg' then\n+          api.nvim_set_hl(ns, 'Normal', { link = 'MsgArea' })\n+        end\n+        if type ~= 'pager' then\n+          api.nvim_set_hl(ns, 'Search', {})\n+          api.nvim_set_hl(ns, 'IncSearch', {})\n+          api.nvim_set_hl(ns, 'CurSearch', {})\n         end\n-        api.nvim_set_option_value('winhighlight', hl, { scope = 'local' })\n       end)\n       api.nvim_buf_set_name(M.bufs[type], ('[%s]'):format(type:sub(1, 1):upper() .. type:sub(2)))\n       -- Fire FileType with window context to let the user reconfigure local options.\n```\n\nI cannot explain why `Inc/CurSearch` are being applied without a search command even being entered.",
            "created_at": "2025-11-26T15:55:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582015248",
            "id": 3582015248,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7VgTcQ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582015248/reactions"
            },
            "updated_at": "2025-11-26T16:11:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582015248",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Doesn't that change require using those namespaces appropriately in nvim_buf_set_extmarks?",
            "created_at": "2025-11-26T16:02:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582042338",
            "id": 3582042338,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7VgaDi",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582042338/reactions"
            },
            "updated_at": "2025-11-26T16:11:44Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582042338",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "No, `nvim_win_set_hl_ns()` activates the highlight namespace in the window.",
            "created_at": "2025-11-26T16:04:37Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582049651",
            "id": 3582049651,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7Vgb1z",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 1,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582049651/reactions"
            },
            "updated_at": "2025-11-26T16:11:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582049651",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Wait it's not magical at all, we're literally requesting the `IncSearch` highlight in the repro, not sure how I missed thatðŸ¤¦ðŸ»\n\nI guess the issue is that the user expects this command to show the highlight used in the global namespace...",
            "created_at": "2025-11-26T16:11:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582078565",
            "id": 3582078565,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7Vgi5l",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582078565/reactions"
            },
            "updated_at": "2025-11-26T16:11:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582078565",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I guess the issue is that the user expects this command to show the highlight used in the global namespace...\n\nDoes it mean that `nvim_buf_set_extmark` (the one that matters here) call should use (when needed) highlights from the global namespace (0 is not allowed, so some newly created ns instead)? ",
            "created_at": "2025-11-26T16:40:40Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582190908",
            "id": 3582190908,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7Vg-U8",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582190908/reactions"
            },
            "updated_at": "2025-11-26T16:41:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582190908",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> No, `nvim_win_set_hl_ns()` activates the highlight namespace in the window.\n\n```lua\nlocal api = vim.api\nlocal buf = api.nvim_create_buf(false, true)\napi.nvim_buf_set_lines(buf, 0, 0, true, {'the only line'})\nlocal ns = api.nvim_create_namespace('plugin')\nlocal winNs = api.nvim_create_namespace('win')\nlocal win = api.nvim_open_win(buf, false, {relative = 'editor', row = 0, col = 0, height = 2, width = 20})\napi.nvim_win_set_hl_ns(win, winNs)\napi.nvim_set_hl(winNs, 'Error', {link = 'Comment'})\napi.nvim_buf_set_extmark(buf, ns, 0, 4, {end_col = 8, hl_group = 'Error'})\n```\nI needed to see that (not sure if clearly documented) precedence on some minimal example. \n\nEdit: let's unhide for a while after fixing.",
            "created_at": "2025-11-26T17:04:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582316354",
            "id": 3582316354,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7Vhc9C",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582316354/reactions"
            },
            "updated_at": "2025-11-27T14:03:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582316354",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Does it mean that nvim_buf_set_extmark (the one that matters here) call should use (when needed) highlights from the global namespace\n\nThat is a solution yes, \"when needed\" specifically being the `:highlight` output here. More specifically we would have to create new highlight groups with the attributes from the group in the global namespace, for each the the highlights that are redefined in the window namespace. The namespace used in the `nvim_buf_set_extmark` call has nothing to do with the highlight namespace.",
            "created_at": "2025-11-26T17:07:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582338685",
            "id": 3582338685,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7VhiZ9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582338685/reactions"
            },
            "updated_at": "2025-11-26T17:08:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582338685",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "```lua\nlocal api = vim.api\nlocal buf = api.nvim_create_buf(false, true)\napi.nvim_buf_set_lines(buf, 0, 0, true, {'the only line'})\nlocal ns = api.nvim_create_namespace('plugin')\nlocal winNs = api.nvim_create_namespace('win')\nlocal win = api.nvim_open_win(buf, false, {relative = 'editor', row = 0, col = 0, height = 2, width = 20})\napi.nvim_win_set_hl_ns(win, winNs)\n\nlocal hls = {\n  IncSearch = {link = 'WarningMsg'},\n  CurSearch = {link = 'WarningMsg'},\n  Search = {link = 'WarningMsg'},\n}\n\nlocal defaultHls = setmetatable({}, {\n  __index = function (t, k)\n    return rawget(t, k) or k\n  end\n})\n\nfor group, hlDef in pairs(hls) do\n  local defaultHl = '_def.' .. group\n  api.nvim_set_hl(winNs, defaultHl, api.nvim_get_hl(0, {name = group, link = false}))\n  defaultHls[group] = defaultHl\n  api.nvim_set_hl(winNs, group, hlDef)\nend\n\napi.nvim_buf_set_extmark(buf, ns, 0, 4, {end_col = 8, hl_group = defaultHls['IncSearch']})\n```\n\n\nSomething like this minimal example?\n\n<img width=\"191\" height=\"231\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/cde4c1cc-1a56-4b9b-9c88-01cd24b350d5\" />",
            "created_at": "2025-11-26T18:56:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3582785385",
            "id": 3582785385,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7VjPdp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582785385/reactions"
            },
            "updated_at": "2025-11-26T18:56:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3582785385",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The magnitude of the problem is not clear. How many highlights does this affect and why is it important enough to justify all the code in https://github.com/neovim/neovim/pull/36717 ? ",
            "created_at": "2025-11-29T21:51:32Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3591963720",
            "id": 3591963720,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7WGQRI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3591963720/reactions"
            },
            "updated_at": "2025-11-29T21:51:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3591963720",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Maybe I should switch that PR to draft while the proposed (and not included there) create extmark API addition still waiting for the discussion to be resolved. ",
            "created_at": "2025-11-29T23:34:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/36691#issuecomment-3592024077",
            "id": 3592024077,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36691",
            "node_id": "IC_kwDOAPphoM7WGfAN",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3592024077/reactions"
            },
            "updated_at": "2025-11-29T23:34:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3592024077",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 12,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36691/comments",
    "created_at": "2025-11-25T22:37:28Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/36691/events",
    "html_url": "https://github.com/neovim/neovim/issues/36691",
    "id": 3664840629,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "FBCA04",
            "default": false,
            "description": "issue needs attention from an expert, or PR proposes significant changes to architecture or API",
            "id": 212680983,
            "name": "needs:discussion",
            "node_id": "MDU6TGFiZWwyMTI2ODA5ODM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:discussion"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "Nvim 0.12 mesages/dialog/pager/notifications based on the UI-ext protocol",
            "id": 8934685970,
            "name": "ui2",
            "node_id": "LA_kwDOAPphoM8AAAACFIx9Eg",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui2"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/36691/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 300,
        "created_at": "2014-11-26T22:13:11Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "We don't plan to work on this, but will accept high quality contributions from someone who will own the feature and follow up on bug reports.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/9",
        "id": 881978,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/9/labels",
        "node_id": "MDk6TWlsZXN0b25lODgxOTc4",
        "number": 9,
        "open_issues": 355,
        "state": "open",
        "title": "needs-owner",
        "updated_at": "2025-12-01T03:14:12Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/9"
    },
    "node_id": "I_kwDOAPphoM7acQe1",
    "number": 36691,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/36691/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/36691/timeline",
    "title": "ui2: highlight command output uses window-local highlights",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-11-30T16:17:38Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/36691",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
        "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
        "followers_url": "https://api.github.com/users/przepompownia/followers",
        "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
        "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/przepompownia",
        "id": 11404453,
        "login": "przepompownia",
        "node_id": "MDQ6VXNlcjExNDA0NDUz",
        "organizations_url": "https://api.github.com/users/przepompownia/orgs",
        "received_events_url": "https://api.github.com/users/przepompownia/received_events",
        "repos_url": "https://api.github.com/users/przepompownia/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/przepompownia",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nheyja :> \r\ni wrote on discourse asking about the lsp shutdown behavior. its basically the question that is the title of this issue. the link to the discourse thread is [here](https://neovim.discourse.group/t/lsp-shutdown-behavior-on-exit-not-triggered-on-q-is-this-intentional/4712)\r\nsomeone did point me to the autcommand help, and that generally gives of a ~vibe~ to me like \"handle your own shutdown lol\" but my reasonig or intuition would have been that the  lsp integration is a core feature of neovim, thus it would also integrate the part of exiting the lsps gracefully - thus calling the `on_exit` of every lsp it closes during shutdown. allthough i do get that this is users attaching any - be it default or custom - behavior to their lsp configs and thus that one could also expect the one writing the config to just attentively read the manual and then handle that the exits happen how they need them to or smth. allhthough i do still think just calling the `on_exit` on quitting is much more intuitive.  \r\n\r\nthis is somewhere between a design decision question, lsp bug and feature request so i didn't quite knew where to file :<\r\n\n\n### Expected behavior\n\ni expected the behavior that `on_exit` gets triggered by quitting the editor",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "I apologize if you already considered it but is there a specific reason why you are using `vim.lsp.start_client()` over [`h: vim.lsp.start()`](https://neovim.io/doc/user/lsp.html#vim.lsp.start()). That function already handles reusing the same client for multiple buffers.",
            "created_at": "2024-02-28T07:02:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/27648#issuecomment-1968354053",
            "id": 1968354053,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27648",
            "node_id": "IC_kwDOAPphoM51UrMF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1968354053/reactions"
            },
            "updated_at": "2024-02-28T07:02:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1968354053",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/71396679?v=4",
                "events_url": "https://api.github.com/users/Kibadda/events{/privacy}",
                "followers_url": "https://api.github.com/users/Kibadda/followers",
                "following_url": "https://api.github.com/users/Kibadda/following{/other_user}",
                "gists_url": "https://api.github.com/users/Kibadda/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Kibadda",
                "id": 71396679,
                "login": "Kibadda",
                "node_id": "MDQ6VXNlcjcxMzk2Njc5",
                "organizations_url": "https://api.github.com/users/Kibadda/orgs",
                "received_events_url": "https://api.github.com/users/Kibadda/received_events",
                "repos_url": "https://api.github.com/users/Kibadda/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Kibadda/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Kibadda/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Kibadda",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> I apologize if you already considered it but is there a specific reason why you are using `vim.lsp.start_client()` over [`h: vim.lsp.start()`](https://neovim.io/doc/user/lsp.html#vim.lsp.start()). That function already handles reusing the same client for multiple buffers.\n\nthanks for the recommendation that would be an improvement. \n\nmy concern here though is less of my concrete solution and more that this behavior of not calling `on_exit` of all clients seemed weird and i wanted to ask about the intentionality of that behavior. because i can see this being a bug or a feature (f.e. with how not calling `on_exit` interacts with multiple nvim instances where)",
            "created_at": "2024-02-28T09:03:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/27648#issuecomment-1968526506",
            "id": 1968526506,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/27648",
            "node_id": "IC_kwDOAPphoM51VVSq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1968526506/reactions"
            },
            "updated_at": "2024-02-28T09:03:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1968526506",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/103335462?v=4",
                "events_url": "https://api.github.com/users/git-girl/events{/privacy}",
                "followers_url": "https://api.github.com/users/git-girl/followers",
                "following_url": "https://api.github.com/users/git-girl/following{/other_user}",
                "gists_url": "https://api.github.com/users/git-girl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/git-girl",
                "id": 103335462,
                "login": "git-girl",
                "node_id": "U_kgDOBijGJg",
                "organizations_url": "https://api.github.com/users/git-girl/orgs",
                "received_events_url": "https://api.github.com/users/git-girl/received_events",
                "repos_url": "https://api.github.com/users/git-girl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/git-girl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/git-girl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/git-girl",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 2,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/27648/comments",
    "created_at": "2024-02-27T20:21:14Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/27648/events",
    "html_url": "https://github.com/neovim/neovim/issues/27648",
    "id": 2157534652,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/27648/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6AmV28",
    "number": 27648,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/27648/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/27648/timeline",
    "title": "Lsp shutdown behavior - `on_exit` not triggered on :quit",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-07-02T08:59:02Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/27648",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/103335462?v=4",
        "events_url": "https://api.github.com/users/git-girl/events{/privacy}",
        "followers_url": "https://api.github.com/users/git-girl/followers",
        "following_url": "https://api.github.com/users/git-girl/following{/other_user}",
        "gists_url": "https://api.github.com/users/git-girl/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/git-girl",
        "id": 103335462,
        "login": "git-girl",
        "node_id": "U_kgDOBijGJg",
        "organizations_url": "https://api.github.com/users/git-girl/orgs",
        "received_events_url": "https://api.github.com/users/git-girl/received_events",
        "repos_url": "https://api.github.com/users/git-girl/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/git-girl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/git-girl/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/git-girl",
        "user_view_type": "public"
    }
}
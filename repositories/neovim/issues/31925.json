{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nWith `au FileType help wincmd T` I get crash on `:help`.\n\n```cpp\n#0  use_tabpage (tp=0x0) at .../src/nvim/window.c:4028\n4028      topframe = curtab->tp_topframe;\n(gdb) bt\n#0  use_tabpage (tp=0x0) at .../src/nvim/window.c:4028\n#1  aucmd_prepbuf_win (aco=0x7fff285a1f70, buf=0x5562554ceef0, win=0x5562554cc450) at .../src/nvim/autocmd.c:1312\n#2  0x000055623d64d7d9 in apply_optionset_autocmd (errmsg=0x0, opt_idx=676994928, opt_flags=1033903008, oldval=..., oldval_g=..., oldval_l=..., newval=..., ctx=...) at .../src/nvim/option.c:1883\n#3  set_option_for (opt_idx=opt_idx@entry=kOptFiletype, value=..., ctx=..., opt_flags=opt_flags@entry=2, set_sid=set_sid@entry=0, direct=direct@entry=false, value_replaced=<optimized out>, errbuf=<optimized out>, errbuflen=<optimized out>)\n    at .../src/nvim/option.c:3787\n#4  0x000055623d64e99e in set_option_value_for (opt_idx=kOptFiletype, value=..., ctx=..., opt_flags=2) at .../src/nvim/option.c:3862\n#5  0x000055623d64eb20 in set_option_value (opt_idx=<optimized out>, value=..., opt_flags=<optimized out>) at .../src/nvim/option.c:3874\n#6  set_option_value_give_err (opt_idx=<optimized out>, value=..., opt_flags=<optimized out>) at .../src/nvim/option.c:3925\n#7  0x000055623d54a38d in ex_setfiletype (eap=0x7fff285a2990) at .../src/nvim/ex_docmd.c:7635\n#8  ex_setfiletype (eap=0x7fff285a2990) at .../src/nvim/ex_docmd.c:7624\n#9  0x000055623d78c3d5 in execute_cmd0.constprop.0 (retv=retv@entry=0x7fff285a2264, eap=eap@entry=0x7fff285a2990, errormsg=errormsg@entry=0x7fff285a2268, preview=preview@entry=false)\n    at .../src/nvim/ex_docmd.c:1711\n#10 0x000055623d53874b in execute_cmd (eap=0x7fff285a2990, cmdinfo=<optimized out>, preview=false) at .../src/nvim/ex_docmd.c:1793\n#11 0x000055623d43f39d in nvim_cmd (channel_id=9223372036854775809, cmd=<optimized out>, opts=0x7fff285a2c27, arena=0x7fff285a2c40, err=<optimized out>) at .../src/nvim/api/command.c:647\n#12 0x000055623d5a9f55 in nlua_api_nvim_cmd (lstate=0x7f6a962a6380) at .../build/src/nvim/auto/lua_api_c_bindings.generated.h:1780\n#13 0x000055623d80f366 in lj_BC_FUNCC ()\n#14 0x000055623d7fac1d in lua_pcall (L=L@entry=0x7f6a962a6380, nargs=nargs@entry=0, nresults=nresults@entry=-1, errfunc=errfunc@entry=0) at lj_api.c:1122\n#15 0x000055623d5d0d94 in nlua_with (L=0x7f6a962a6380) at .../src/nvim/lua/stdlib.c:629\n#16 0x000055623d80f366 in lj_BC_FUNCC ()\n#17 0x000055623d7fac1d in lua_pcall (L=L@entry=0x7f6a962a6380, nargs=nargs@entry=1, nresults=nresults@entry=1, errfunc=errfunc@entry=-3) at lj_api.c:1122\n#18 0x000055623d5bcf18 in nlua_pcall (lstate=0x7f6a962a6380, nargs=1, nresults=1) at .../src/nvim/lua/executor.c:175\n#19 0x000055623d5cc7e5 in nlua_call_ref_ctx (fast=false, ref=<optimized out>, name=<optimized out>, args=..., mode=kRetNilBool, arena=0x0, err=0x0) at .../src/nvim/lua/executor.c:1593\n#20 0x000055623d47a0da in nlua_call_ref (ref=<optimized out>, name=0x0, args=..., mode=kRetNilBool, arena=0x0, err=0x0) at .../src/nvim/lua/executor.c:1570\n#21 call_autocmd_callback (ac=ac@entry=0x5562554741e0, apc=apc@entry=0x7fff285a4d40) at .../src/nvim/autocmd.c:2108\n#22 0x000055623d47a36b in getnextac (c=c@entry=58, cookie=cookie@entry=0x7fff285a4d40, indent=<optimized out>, do_concat=do_concat@entry=true) at .../src/nvim/autocmd.c:2159\n#23 0x000055623d53c1aa in do_cmdline (cmdline=<optimized out>, fgetline=<optimized out>, cookie=<optimized out>, flags=<optimized out>) at .../src/nvim/ex_docmd.c:579\n#24 0x000055623d4785e0 in apply_autocmds_group (event=EVENT_BUFREADPOST, fname=<optimized out>, fname_io=<optimized out>, force=<optimized out>, group=<optimized out>, buf=<optimized out>, eap=0x0, data=0x0)\n    at .../src/nvim/autocmd.c:1892\n#25 0x000055623d56a903 in apply_autocmds_exarg (event=EVENT_BUFREADPOST, fname=0x0, fname_io=0x55625546f380 \"/home/arctgx/tmp/nvim/builds/from-src-dev/share/nvim/runtime/doc/help.txt\", force=false, buf=<optimized out>, eap=0x0)\n    at .../src/nvim/autocmd.c:1563\n#26 readfile (fname=<optimized out>, sfname=<optimized out>, from=<optimized out>, lines_to_skip=<optimized out>, lines_to_read=<optimized out>, eap=<optimized out>, flags=<optimized out>, silent=<optimized out>)\n    at .../src/nvim/fileio.c:1851\n#27 0x000055623d47e1a7 in open_buffer (read_stdin=false, eap=0x0, flags_arg=<optimized out>) at .../src/nvim/buffer.c:301\n#28 0x000055623d5303ee in do_ecmd (fnum=fnum@entry=0, ffname=<optimized out>, ffname@entry=0x5562554d7cd0 \"/home/arctgx/tmp/nvim/builds/from-src-dev/share/nvim/runtime/doc/help.txt\", sfname=<optimized out>,\n    sfname@entry=0x5562554d6cc0 \"/home/arctgx/tmp/nvim/builds/from-src-dev/share/nvim/runtime/doc/help.txt\", eap=eap@entry=0x0, newlnum=newlnum@entry=0, flags=1, oldwin=<optimized out>)\n    at .../src/nvim/ex_cmds.c:2577\n#29 0x000055623d530b1d in getfile (fnum=0, ffname_arg=<optimized out>, sfname_arg=<optimized out>, setpm=<optimized out>, lnum=<optimized out>, forceit=<optimized out>) at .../src/nvim/ex_cmds.c:2054\n#30 0x000055623d70cc7f in jumpto_tag (keep_help=true, lbuf_arg=<optimized out>, forceit=0) at .../src/nvim/tag.c:2883\n#31 do_tag (tag=<optimized out>, type=<optimized out>, count=<optimized out>, forceit=<optimized out>, verbose=<optimized out>) at .../src/nvim/tag.c:754\n#32 0x000055623d57ff0d in ex_help (eap=<optimized out>) at .../src/nvim/help.c:198\n#33 0x000055623d78c3d5 in execute_cmd0.constprop.0 (retv=retv@entry=0x7fff285a5b18, eap=eap@entry=0x7fff285a5ba0, errormsg=errormsg@entry=0x7fff285a5b10, preview=preview@entry=false)\n    at .../src/nvim/ex_docmd.c:1711\n#34 0x000055623d53df78 in do_one_cmd (cmdlinep=0x7fff285a5b08, flags=0, cstack=0x7fff285a5d60, fgetline=0x55623d552470 <getexline>, cookie=0x0) at .../src/nvim/ex_docmd.c:2355\n#35 do_cmdline (cmdline=<optimized out>, fgetline=<optimized out>, cookie=<optimized out>, flags=<optimized out>) at .../src/nvim/ex_docmd.c:666\n#36 0x000055623d622af0 in nv_colon (cap=0x7fff285a6410) at .../src/nvim/normal.c:3188\n#37 0x000055623d61fc24 in normal_execute (state=0x7fff285a63a0, key=<optimized out>) at .../src/nvim/normal.c:1244\n#38 0x000055623d6efa62 in state_enter (s=0x7fff285a63a0) at .../src/nvim/state.c:102\n#39 0x000055623d61cf04 in normal_enter (cmdwin=<optimized out>, noexmode=<optimized out>) at .../src/nvim/normal.c:522\n#40 0x000055623d433177 in main (argc=<optimized out>, argv=<optimized out>) at .../src/nvim/main.c:651\n```\n\nIt has place somewhere in 6257270040bc5c61a489f7fb9d4102223c36cf89 @famiu\n\n### Steps to reproduce\n\n- `nvim --clean -c 'au FileType help wincmd T'`\n- `:help`\n\n### Expected behavior\n\nNo crash\n\n### Nvim version (nvim -v)\n\nv0.11.0-dev-1505+g822313e42b\n\n### Vim (not Nvim) behaves the same?\n\nno\n\n### Operating system/version\n\nDebian Sid\n\n### Terminal name/version\n\nalacritty 0.15.0-dev (e79f4b22)\n\n### $TERM environment variable\n\nalacritty\n\n### Installation\n\nfrom repo",
    "closed_at": "2025-01-09T04:32:27Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
        "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
        "followers_url": "https://api.github.com/users/zeertzjq/followers",
        "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
        "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zeertzjq",
        "id": 35768171,
        "login": "zeertzjq",
        "node_id": "MDQ6VXNlcjM1NzY4MTcx",
        "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
        "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
        "repos_url": "https://api.github.com/users/zeertzjq/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zeertzjq",
        "user_view_type": "public"
    },
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/31925/comments",
    "created_at": "2025-01-09T02:07:38Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/31925/events",
    "html_url": "https://github.com/neovim/neovim/issues/31925",
    "id": 2776678487,
    "labels": [
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue has been tracked to a specific commit",
            "id": 1481421490,
            "name": "has:bisected",
            "node_id": "MDU6TGFiZWwxNDgxNDIxNDkw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:bisected"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/31925/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6lgMBX",
    "number": 31925,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/31925/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/31925/timeline",
    "title": "Crash on tab switching autocmd after refactor on options",
    "updated_at": "2025-01-09T04:32:27Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/31925",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
        "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
        "followers_url": "https://api.github.com/users/przepompownia/followers",
        "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
        "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/przepompownia",
        "id": 11404453,
        "login": "przepompownia",
        "node_id": "MDQ6VXNlcjExNDA0NDUz",
        "organizations_url": "https://api.github.com/users/przepompownia/orgs",
        "received_events_url": "https://api.github.com/users/przepompownia/received_events",
        "repos_url": "https://api.github.com/users/przepompownia/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/przepompownia",
        "user_view_type": "public"
    }
}
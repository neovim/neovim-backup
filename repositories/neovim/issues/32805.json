{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\n`statuscolumn&` resets the statuscolumn of the given window(expected behavior) but `statusline&` resets it globally.\n\n> Also, can we please get a way to actually reset the bars/lines for a window? ;(\n\n### Steps to reproduce\n\nnvim --clean\n:set statusline=abc statuscolumn=abc\n:sp\n:set statusline& statuscolumn&\n\n### Expected behavior\n\nOnly the current windows statuscolumn & statusline should be reset.\n\n### Nvim version (nvim -v)\n\nNVIM v0.10.4 Build type: Release LuaJIT 2.1.1731601260\n\n### Vim (not Nvim) behaves the same?\n\nYes, vim 9.1\n\n### Operating system/version\n\nAndroid 13\n\n### Terminal name/version\n\nTermux 0.119\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\npkg",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "'statusline' is a |global-local| option, 'statuscolumn' on the other hand is not (I can't remember/say whether there is a reason for this discrepancy).\n\n> Only the current windows statuscolumn & statusline should be reset.\n\nUse `:setlocal`?",
            "created_at": "2025-03-09T18:14:48Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2708997534",
            "id": 2708997534,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6heAWe",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2708997534/reactions"
            },
            "updated_at": "2025-03-09T18:14:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2708997534",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "No wonder, `:setlocal statusline&` doesn't do anything.\n\nSo, is this issue still valid?",
            "created_at": "2025-03-09T18:59:33Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2709018261",
            "id": 2709018261,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6heFaV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2709018261/reactions"
            },
            "updated_at": "2025-03-09T18:59:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2709018261",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/122956967?v=4",
                "events_url": "https://api.github.com/users/OXY2DEV/events{/privacy}",
                "followers_url": "https://api.github.com/users/OXY2DEV/followers",
                "following_url": "https://api.github.com/users/OXY2DEV/following{/other_user}",
                "gists_url": "https://api.github.com/users/OXY2DEV/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/OXY2DEV",
                "id": 122956967,
                "login": "OXY2DEV",
                "node_id": "U_kgDOB1Qspw",
                "organizations_url": "https://api.github.com/users/OXY2DEV/orgs",
                "received_events_url": "https://api.github.com/users/OXY2DEV/received_events",
                "repos_url": "https://api.github.com/users/OXY2DEV/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/OXY2DEV/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/OXY2DEV/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/OXY2DEV",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> No wonder, `:setlocal statusline&` doesn't do anything.\n\nIt does what is is documented to do: resetting the window-local value and thus applying the global value to the current window. If there is no local value the command does nothing.\n\n> So, is this issue still valid?\n\nMaybe to resolve why 'statuscolumn' is window-local as opposed to global-local.\n\n",
            "created_at": "2025-03-09T19:31:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2709032616",
            "id": 2709032616,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6heI6o",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2709032616/reactions"
            },
            "updated_at": "2025-03-09T19:31:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2709032616",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I can't remember/say whether there is a reason for this discrepancy\n\nIt stems from before the new proposed option was 'statuscolumn' but merely ['numberformat'](https://github.com/vim/vim/pull/11303):\n\n> I made it window-local because '(relative)number' is but this seems to be the first window-local userfunc callback option\n\nI don't think changing it to be window-global-local to mirror 'statusline/winbar' was ever considered when the option developed to the point of 'statuscolumn'.\nCould still consider changing that but it might cause more trouble than its worth at this point, IDK.",
            "created_at": "2025-03-09T19:53:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2709040758",
            "id": 2709040758,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6heK52",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2709040758/reactions"
            },
            "updated_at": "2025-03-09T20:10:36Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2709040758",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Hey, @luukvbaal.\n\nIs the index correct for virtual lines?\n\n## Reproduction steps,\n\n```shell\nnvim --clean\n```\n\nRun the following commands,\n\n```vim\n:lua vim.o.statuscolumn=\"%=%{v:lnum} | \"\n:set relative number\n```\n\nCreate a bunch of empty lines(I am creating 10).\n\nAdd extmarks to the 6th line.\n\n```vim\n:lua vim.api.nvim_buf_set_extmark(vim.api.nvim_get_current_buf(), vim.api.nvim_create_namespace(\"abc\"), 5, 0, { virt_lines_above = true, virt_lines = { { { \"Virt\" } } } })\n```\n\nThe virtual lines give the `lnum` of 5. Why?\n\nI thought lnum's were 1-indexed and lines(from `nvim_buf_set_extmarl()`) were 0-indexed.",
            "created_at": "2025-03-14T23:54:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2726025925",
            "id": 2726025925,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6ie9rF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726025925/reactions"
            },
            "updated_at": "2025-03-16T14:46:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726025925",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/122956967?v=4",
                "events_url": "https://api.github.com/users/OXY2DEV/events{/privacy}",
                "followers_url": "https://api.github.com/users/OXY2DEV/followers",
                "following_url": "https://api.github.com/users/OXY2DEV/following{/other_user}",
                "gists_url": "https://api.github.com/users/OXY2DEV/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/OXY2DEV",
                "id": 122956967,
                "login": "OXY2DEV",
                "node_id": "U_kgDOB1Qspw",
                "organizations_url": "https://api.github.com/users/OXY2DEV/orgs",
                "received_events_url": "https://api.github.com/users/OXY2DEV/received_events",
                "repos_url": "https://api.github.com/users/OXY2DEV/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/OXY2DEV/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/OXY2DEV/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/OXY2DEV",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "That's a consequence of how virtual lines are drawn internally. Namely always above a line so we end up drawing both `virt_lines_above == true` lines belonging to the currently drawn line, and `virt_lines_above = false` lines belonging to the line above.\n\nThen a best guess was made when evaluating the 'statuscolumn' to only increment the `v:lnum` when drawing the first non-virtual row. A related issue was fixed recently for the highlights applied to virtual statuscolumn lines in #32400. The same information could be used to properly update `v:lnum`.",
            "created_at": "2025-03-15T00:28:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2726057070",
            "id": 2726057070,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6ifFRu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726057070/reactions"
            },
            "updated_at": "2025-03-15T00:28:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726057070",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Is this the reason this happens?\n\n![Image](https://github.com/user-attachments/assets/0b2a0c37-60ff-4a16-b015-fc0a9fd446be)\n\n<sub>Virtual lines giving an lnum of 9 instead of 5</sub>",
            "created_at": "2025-03-15T00:35:11Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2726061879",
            "id": 2726061879,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6ifGc3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726061879/reactions"
            },
            "updated_at": "2025-03-16T14:45:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726061879",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/122956967?v=4",
                "events_url": "https://api.github.com/users/OXY2DEV/events{/privacy}",
                "followers_url": "https://api.github.com/users/OXY2DEV/followers",
                "following_url": "https://api.github.com/users/OXY2DEV/following{/other_user}",
                "gists_url": "https://api.github.com/users/OXY2DEV/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/OXY2DEV",
                "id": 122956967,
                "login": "OXY2DEV",
                "node_id": "U_kgDOB1Qspw",
                "organizations_url": "https://api.github.com/users/OXY2DEV/orgs",
                "received_events_url": "https://api.github.com/users/OXY2DEV/received_events",
                "repos_url": "https://api.github.com/users/OXY2DEV/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/OXY2DEV/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/OXY2DEV/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/OXY2DEV",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "That's also a consequence of this yes:\n\n> Then a best guess was made when evaluating the 'statuscolumn' to only increment v:lnum when drawing the first non-virtual row.\n\nIn your screenshot the last drawn line is line 9. So when you place the virtual line, a partial redraw is done only for that line, and `v:lnum` isn't updated until after drawing the virtual lines. \n\nI'll probably raise a PR tomorrow.",
            "created_at": "2025-03-15T00:42:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/32805#issuecomment-2726067029",
            "id": 2726067029,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32805",
            "node_id": "IC_kwDOAPphoM6ifHtV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726067029/reactions"
            },
            "updated_at": "2025-03-16T14:45:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2726067029",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 8,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/32805/comments",
    "created_at": "2025-03-09T17:41:36Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/32805/events",
    "html_url": "https://github.com/neovim/neovim/issues/32805",
    "id": 2905568397,
    "labels": [
        {
            "color": "c5def5",
            "default": true,
            "description": "",
            "id": 84744038,
            "name": "documentation",
            "node_id": "MDU6TGFiZWw4NDc0NDAzOA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/documentation"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "configuration, settings",
            "id": 4242493821,
            "name": "options",
            "node_id": "LA_kwDOAPphoM7831F9",
            "url": "https://api.github.com/repos/neovim/neovim/labels/options"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/32805/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6tL3SN",
    "number": 32805,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/32805/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/32805/timeline",
    "title": "`:set statusline&` & `:set statuscolumn&` behaves differently",
    "updated_at": "2025-03-16T14:46:07Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/32805",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/122956967?v=4",
        "events_url": "https://api.github.com/users/OXY2DEV/events{/privacy}",
        "followers_url": "https://api.github.com/users/OXY2DEV/followers",
        "following_url": "https://api.github.com/users/OXY2DEV/following{/other_user}",
        "gists_url": "https://api.github.com/users/OXY2DEV/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/OXY2DEV",
        "id": 122956967,
        "login": "OXY2DEV",
        "node_id": "U_kgDOB1Qspw",
        "organizations_url": "https://api.github.com/users/OXY2DEV/orgs",
        "received_events_url": "https://api.github.com/users/OXY2DEV/received_events",
        "repos_url": "https://api.github.com/users/OXY2DEV/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/OXY2DEV/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/OXY2DEV/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/OXY2DEV",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\ntl;dr: Fix the first compiler error first, then later ones will disappear on their own. Diagnostic virtual text shows _last_ error message and so is less helpful than it could be.\r\n\r\n---\r\n\r\nAt least for me, when programming Python with pyright LSP, the _first_ diagnostic message is much more likely to be the thing that needs to be fixed first, like \"x not defined\", and the last message, which is the one that displays, is likely to be a consequent error that will be resolved by addressing the first message, like \"type of x unknown\". Like with compiler errors, if you fix the first one many of the subsequent errors will disappear.\r\n\r\nIt would be great if there were the option in `vim.diagnostic.config.opts.virtual_text` to display the first message rather than the default last message, maybe `{ 'show': 'first' | 'last' (default) }` or something like that.\r\n\r\nAlternatively, perhaps the first line is just the better choice and should become the default, maybe that would be easier.\r\n\r\n### Expected behavior\r\n\r\nSetting `vim.diagnostic.config( { virtual_text: { show: 'first' } } )` causes the first message in the diagnostics list to be shown as virtual-text. Omitting the `show` member shows the last messages, as is currently the default.\r\n\r\n### NOTE\r\n\r\n* This is related to this resolved issue: https://github.com/neovim/neovim/issues/13929 in that the user experience problem is the same. That issue addressed it by sorting by severity, but consequent errors still hide root cause errors in virtual text.\r\n* From an initial review of the code in `runtime/lua/vim/diagnostic.lua` it appears this is because adding multiple virtual \"texts\" to a line stacks the next one on top of the previous one. Not sure but I got a whiff that this might be addressed or even resolved by the move from `nvim_buf_set_virtual_text()` to `nvim_buf_set_extmark()`.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "I wouldn't be against just reversing the diagnostics without adding configuration. The first error is always the most important.",
            "created_at": "2023-02-05T21:36:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/22122#issuecomment-1418271275",
            "id": 1418271275,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/22122",
            "node_id": "IC_kwDOAPphoM5UiRor",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 4,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 4,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1418271275/reactions"
            },
            "updated_at": "2023-02-05T21:36:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1418271275",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/22122/comments",
    "created_at": "2023-02-04T18:25:40Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/22122/events",
    "html_url": "https://github.com/neovim/neovim/issues/22122",
    "id": 1571065782,
    "labels": [
        {
            "color": "C5DEF5",
            "default": false,
            "description": "",
            "id": 3361645105,
            "name": "diagnostic",
            "node_id": "MDU6TGFiZWwzMzYxNjQ1MTA1",
            "url": "https://api.github.com/repos/neovim/neovim/labels/diagnostic"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/22122/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5dpI-2",
    "number": 22122,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 12,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 12,
        "url": "https://api.github.com/repos/neovim/neovim/issues/22122/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/22122/timeline",
    "title": "vim.diagnostic virtual_text option to show first message",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-07-02T09:00:20Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/22122",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/2062718?v=4",
        "events_url": "https://api.github.com/users/scanny/events{/privacy}",
        "followers_url": "https://api.github.com/users/scanny/followers",
        "following_url": "https://api.github.com/users/scanny/following{/other_user}",
        "gists_url": "https://api.github.com/users/scanny/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/scanny",
        "id": 2062718,
        "login": "scanny",
        "node_id": "MDQ6VXNlcjIwNjI3MTg=",
        "organizations_url": "https://api.github.com/users/scanny/orgs",
        "received_events_url": "https://api.github.com/users/scanny/received_events",
        "repos_url": "https://api.github.com/users/scanny/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/scanny/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scanny/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/scanny",
        "user_view_type": "public"
    }
}
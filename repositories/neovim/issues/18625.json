{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Feature already in Vim?\r\n\r\n_No response_\r\n\r\n### Feature description\r\n\r\nIt be cool if he could get a `PostFormatEvent` or something like:\r\n\r\n```lua\r\nvim.lsp.buf.format({ async = true, callback = function() end })\r\n```\r\n\r\nthat would allow us in a more natural way to format and save the file after async format is done\r\ni'm not aware of any alternative that allows for async formatting and auto save the file",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "we are not going to add events for every single LSP request.\r\n\r\nThere is `:help LspRequest` which is currently a User event, maybe it needs to graduate to a core event.",
            "created_at": "2022-05-18T20:28:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/18625#issuecomment-1130504199",
            "id": 1130504199,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18625",
            "node_id": "IC_kwDOAPphoM5DYiAH",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1130504199/reactions"
            },
            "updated_at": "2022-05-18T20:28:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1130504199",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Is there a reason you can't use the sync format version instead? You can't really make any changes to the buffer anyways between triggering the format and the format operation completing",
            "created_at": "2022-05-18T20:47:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/18625#issuecomment-1130524979",
            "id": 1130524979,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18625",
            "node_id": "IC_kwDOAPphoM5DYnEz",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1130524979/reactions"
            },
            "updated_at": "2022-05-18T20:47:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1130524979",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38700?v=4",
                "events_url": "https://api.github.com/users/mfussenegger/events{/privacy}",
                "followers_url": "https://api.github.com/users/mfussenegger/followers",
                "following_url": "https://api.github.com/users/mfussenegger/following{/other_user}",
                "gists_url": "https://api.github.com/users/mfussenegger/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mfussenegger",
                "id": 38700,
                "login": "mfussenegger",
                "node_id": "MDQ6VXNlcjM4NzAw",
                "organizations_url": "https://api.github.com/users/mfussenegger/orgs",
                "received_events_url": "https://api.github.com/users/mfussenegger/received_events",
                "repos_url": "https://api.github.com/users/mfussenegger/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mfussenegger/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mfussenegger/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mfussenegger",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This is (at least partially) related to https://github.com/neovim/neovim/pull/16206. Having some kind of callback would allow you to lock the buffer, format it async, then unlock when you're done. Today your only option is to use sync formatting I think, which locks up the editor if formatting takes a while.",
            "created_at": "2022-05-18T21:18:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/18625#issuecomment-1130562156",
            "id": 1130562156,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18625",
            "node_id": "IC_kwDOAPphoM5DYwJs",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1130562156/reactions"
            },
            "updated_at": "2022-05-18T21:18:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1130562156",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/86065?v=4",
                "events_url": "https://api.github.com/users/yorickpeterse/events{/privacy}",
                "followers_url": "https://api.github.com/users/yorickpeterse/followers",
                "following_url": "https://api.github.com/users/yorickpeterse/following{/other_user}",
                "gists_url": "https://api.github.com/users/yorickpeterse/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yorickpeterse",
                "id": 86065,
                "login": "yorickpeterse",
                "node_id": "MDQ6VXNlcjg2MDY1",
                "organizations_url": "https://api.github.com/users/yorickpeterse/orgs",
                "received_events_url": "https://api.github.com/users/yorickpeterse/received_events",
                "repos_url": "https://api.github.com/users/yorickpeterse/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yorickpeterse/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yorickpeterse/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yorickpeterse",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> Is there a reason you can't use the sync format version instead? You can't really make any changes to the buffer anyways between triggering the format and the format operation completing\r\n\r\nim working in big TS projects where for instance eslint will lock up for a fair amount of time if i use sync\r\nif that would be async i could still navigate code base and do other misc stuff though duo to not having a callback or event after format i have to manually trigger the save again which is a pain",
            "created_at": "2022-05-19T15:10:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/18625#issuecomment-1131850886",
            "id": 1131850886,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18625",
            "node_id": "IC_kwDOAPphoM5DdqyG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1131850886/reactions"
            },
            "updated_at": "2022-05-19T15:12:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1131850886",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4050749?v=4",
                "events_url": "https://api.github.com/users/danielnehrig/events{/privacy}",
                "followers_url": "https://api.github.com/users/danielnehrig/followers",
                "following_url": "https://api.github.com/users/danielnehrig/following{/other_user}",
                "gists_url": "https://api.github.com/users/danielnehrig/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/danielnehrig",
                "id": 4050749,
                "login": "danielnehrig",
                "node_id": "MDQ6VXNlcjQwNTA3NDk=",
                "organizations_url": "https://api.github.com/users/danielnehrig/orgs",
                "received_events_url": "https://api.github.com/users/danielnehrig/received_events",
                "repos_url": "https://api.github.com/users/danielnehrig/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/danielnehrig/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/danielnehrig/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/danielnehrig",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "ps: the solution does not have to be a event or callback like mentioned here but one solution should be in place for this use case of async formatting and then saving",
            "created_at": "2022-05-22T21:49:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/18625#issuecomment-1133991416",
            "id": 1133991416,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18625",
            "node_id": "IC_kwDOAPphoM5Dl1X4",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1133991416/reactions"
            },
            "updated_at": "2022-05-22T21:49:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1133991416",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4050749?v=4",
                "events_url": "https://api.github.com/users/danielnehrig/events{/privacy}",
                "followers_url": "https://api.github.com/users/danielnehrig/followers",
                "following_url": "https://api.github.com/users/danielnehrig/following{/other_user}",
                "gists_url": "https://api.github.com/users/danielnehrig/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/danielnehrig",
                "id": 4050749,
                "login": "danielnehrig",
                "node_id": "MDQ6VXNlcjQwNTA3NDk=",
                "organizations_url": "https://api.github.com/users/danielnehrig/orgs",
                "received_events_url": "https://api.github.com/users/danielnehrig/received_events",
                "repos_url": "https://api.github.com/users/danielnehrig/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/danielnehrig/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/danielnehrig/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/danielnehrig",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Any news about this feature? I'm trying to auto format on `BufLeave` and then save, I can use the sync formatting but it's make a small delay between switching buffers.\r\n`save_after_format` or a callback function would be great for `format`\r\n\r\n```lua\r\nvim.api.nvim_create_autocmd('BufLeave', {\r\n\tpattern = { '*.lua', '*.rs', '*.go' },\r\n\tcallback = function(params)\r\n\t\tvim.lsp.buf.format({ bufnr = params.buf, async = true })\r\n\tend\r\n})\r\n```",
            "created_at": "2022-09-20T10:52:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/18625#issuecomment-1252179689",
            "id": 1252179689,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/18625",
            "node_id": "IC_kwDOAPphoM5Kor7p",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1252179689/reactions"
            },
            "updated_at": "2022-09-20T10:52:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1252179689",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4954051?v=4",
                "events_url": "https://api.github.com/users/ofirgall/events{/privacy}",
                "followers_url": "https://api.github.com/users/ofirgall/followers",
                "following_url": "https://api.github.com/users/ofirgall/following{/other_user}",
                "gists_url": "https://api.github.com/users/ofirgall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ofirgall",
                "id": 4954051,
                "login": "ofirgall",
                "node_id": "MDQ6VXNlcjQ5NTQwNTE=",
                "organizations_url": "https://api.github.com/users/ofirgall/orgs",
                "received_events_url": "https://api.github.com/users/ofirgall/received_events",
                "repos_url": "https://api.github.com/users/ofirgall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ofirgall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ofirgall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ofirgall",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/18625/comments",
    "created_at": "2022-05-18T15:39:11Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/18625/events",
    "html_url": "https://github.com/neovim/neovim/issues/18625",
    "id": 1240152038,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/18625/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5J6zfm",
    "number": 18625,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/18625/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/18625/timeline",
    "title": "PreFormat / PostFormat Callback/Event",
    "updated_at": "2025-01-17T15:58:50Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/18625",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/4050749?v=4",
        "events_url": "https://api.github.com/users/danielnehrig/events{/privacy}",
        "followers_url": "https://api.github.com/users/danielnehrig/followers",
        "following_url": "https://api.github.com/users/danielnehrig/following{/other_user}",
        "gists_url": "https://api.github.com/users/danielnehrig/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/danielnehrig",
        "id": 4050749,
        "login": "danielnehrig",
        "node_id": "MDQ6VXNlcjQwNTA3NDk=",
        "organizations_url": "https://api.github.com/users/danielnehrig/orgs",
        "received_events_url": "https://api.github.com/users/danielnehrig/received_events",
        "repos_url": "https://api.github.com/users/danielnehrig/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/danielnehrig/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/danielnehrig/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/danielnehrig",
        "user_view_type": "public"
    }
}
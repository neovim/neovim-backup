{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nSometimes the screen can get quite cluttered and distracting with virtual text from diagnostics everywhere. It would be nice to show virtual text only in current line. I know I can create an autocmd on `CursorHold` to display diagnostics with `open_float()`, but that's not what I'm looking for. It's basically the same problem as https://github.com/neoclide/coc.nvim/issues/1667 \r\n\r\nBoth `coc.nvim` and `ale` have this option:\r\n\r\ncoc.nvim: https://github.com/neoclide/coc.nvim/commit/1e41adb9e615421ecf88ba266645df0713986cc0\r\nale: https://github.com/dense-analysis/ale/blob/9fe9f115213d7e7bf52d06ebdc69c6df38b1120b/doc/ale.txt#L2324\n\n### Expected behavior\n\nAdd option to `vim.diagnostic.config()` to show virtual text only in current line\r\n\r\n```lua\r\nvim.diagnostic.config({\r\n\tcurrent_line_virtual_text = boolean\r\n)}\r\n```",
    "closed_at": "2024-03-01T01:54:21Z",
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "I have implemented a small [plugin](https://github.com/luozhiya/lsp-virtual-improved.nvim) for this function. You can try it out if you are interested in it.\r\n",
            "created_at": "2023-05-09T01:57:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/23526#issuecomment-1539281726",
            "id": 1539281726,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23526",
            "node_id": "IC_kwDOAPphoM5bv5M-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 3,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539281726/reactions"
            },
            "updated_at": "2023-05-09T01:57:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539281726",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/90168447?v=4",
                "events_url": "https://api.github.com/users/luozhiya/events{/privacy}",
                "followers_url": "https://api.github.com/users/luozhiya/followers",
                "following_url": "https://api.github.com/users/luozhiya/following{/other_user}",
                "gists_url": "https://api.github.com/users/luozhiya/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luozhiya",
                "id": 90168447,
                "login": "luozhiya",
                "node_id": "MDQ6VXNlcjkwMTY4NDQ3",
                "organizations_url": "https://api.github.com/users/luozhiya/orgs",
                "received_events_url": "https://api.github.com/users/luozhiya/received_events",
                "repos_url": "https://api.github.com/users/luozhiya/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luozhiya/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luozhiya/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luozhiya"
            }
        },
        {
            "author_association": "NONE",
            "body": "@luozhiya Thanks! I just tried it and maybe I'm missing something but none of the options for `current_line` did what I'm looking for. \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t ",
            "created_at": "2023-05-09T02:46:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/23526#issuecomment-1539309668",
            "id": 1539309668,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23526",
            "node_id": "IC_kwDOAPphoM5bwABk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539309668/reactions"
            },
            "updated_at": "2023-05-09T02:46:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539309668",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/67771985?v=4",
                "events_url": "https://api.github.com/users/rafamadriz/events{/privacy}",
                "followers_url": "https://api.github.com/users/rafamadriz/followers",
                "following_url": "https://api.github.com/users/rafamadriz/following{/other_user}",
                "gists_url": "https://api.github.com/users/rafamadriz/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/rafamadriz",
                "id": 67771985,
                "login": "rafamadriz",
                "node_id": "MDQ6VXNlcjY3NzcxOTg1",
                "organizations_url": "https://api.github.com/users/rafamadriz/orgs",
                "received_events_url": "https://api.github.com/users/rafamadriz/received_events",
                "repos_url": "https://api.github.com/users/rafamadriz/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/rafamadriz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rafamadriz/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/rafamadriz"
            }
        },
        {
            "author_association": "NONE",
            "body": "@rafamadriz  Hi,  If I understand correctly, do you want to show diagnostics only current line? you can use the settings below\r\n```\r\nlocal diagnostics = {\r\n  virtual_text = false, -- Disable builtin virtual text diagnostic\r\n  virtual_improved = {\r\n    current_line = 'only',\r\n  },\r\n}\r\nvim.diagnostic.config(diagnostics)\r\n```\r\n",
            "created_at": "2023-05-09T03:36:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/23526#issuecomment-1539338960",
            "id": 1539338960,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23526",
            "node_id": "IC_kwDOAPphoM5bwHLQ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 1,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539338960/reactions"
            },
            "updated_at": "2023-05-09T03:46:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539338960",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/90168447?v=4",
                "events_url": "https://api.github.com/users/luozhiya/events{/privacy}",
                "followers_url": "https://api.github.com/users/luozhiya/followers",
                "following_url": "https://api.github.com/users/luozhiya/following{/other_user}",
                "gists_url": "https://api.github.com/users/luozhiya/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luozhiya",
                "id": 90168447,
                "login": "luozhiya",
                "node_id": "MDQ6VXNlcjkwMTY4NDQ3",
                "organizations_url": "https://api.github.com/users/luozhiya/orgs",
                "received_events_url": "https://api.github.com/users/luozhiya/received_events",
                "repos_url": "https://api.github.com/users/luozhiya/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luozhiya/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luozhiya/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luozhiya"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "```lua\r\nvim.diagnostic.config( {\r\n  virtual_text = false\r\n})\r\n\r\nlocal ns = vim.api.nvim_create_namespace('CurlineDiag')\r\nvim.opt.updatetime = 100\r\nvim.api.nvim_create_autocmd('LspAttach',{\r\n  callback = function(args)\r\n    vim.api.nvim_create_autocmd('CursorHold', {\r\n      buffer = args.buf,\r\n      callback = function()\r\n        pcall(vim.api.nvim_buf_clear_namespace,args.buf,ns, 0, -1)\r\n        local hi = { 'Error', 'Warn','Info','Hint'}\r\n        local curline = vim.api.nvim_win_get_cursor(0)[1]\r\n        local diagnostics = vim.diagnostic.get(args.buf, {lnum =curline - 1})\r\n        local virt_texts = { { (' '):rep(4) } }\r\n        for _, diag in ipairs(diagnostics) do\r\n          virt_texts[#virt_texts + 1] = {diag.message, 'Diagnostic'..hi[diag.severity]}\r\n        end\r\n        vim.api.nvim_buf_set_extmark(args.buf, ns, curline - 1, 0,{\r\n          virt_text = virt_texts,\r\n          hl_mode = 'combine'\r\n        })\r\n      end\r\n    })\r\n  end\r\n})\r\n```",
            "created_at": "2023-05-09T07:07:44Z",
            "html_url": "https://github.com/neovim/neovim/issues/23526#issuecomment-1539580310",
            "id": 1539580310,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23526",
            "node_id": "IC_kwDOAPphoM5bxCGW",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 4,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 4,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539580310/reactions"
            },
            "updated_at": "2023-05-09T07:07:44Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1539580310",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "cc @gpanders  how do you think",
            "created_at": "2023-05-10T07:10:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/23526#issuecomment-1541466711",
            "id": 1541466711,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23526",
            "node_id": "IC_kwDOAPphoM5b4OpX",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1541466711/reactions"
            },
            "updated_at": "2023-05-10T07:10:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1541466711",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/23526/comments",
    "created_at": "2023-05-07T16:03:41Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/23526/events",
    "html_url": "https://github.com/neovim/neovim/issues/23526",
    "id": 1699127067,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "",
            "id": 3361645105,
            "name": "diagnostic",
            "node_id": "MDU6TGFiZWwzMzYxNjQ1MTA1",
            "url": "https://api.github.com/repos/neovim/neovim/labels/diagnostic"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/23526/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5lRp8b",
    "number": 23526,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 7,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 7,
        "url": "https://api.github.com/repos/neovim/neovim/issues/23526/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/23526/timeline",
    "title": "Diagnostics option to display virtual text only in current line",
    "updated_at": "2024-03-01T01:54:21Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/23526",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/67771985?v=4",
        "events_url": "https://api.github.com/users/rafamadriz/events{/privacy}",
        "followers_url": "https://api.github.com/users/rafamadriz/followers",
        "following_url": "https://api.github.com/users/rafamadriz/following{/other_user}",
        "gists_url": "https://api.github.com/users/rafamadriz/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/rafamadriz",
        "id": 67771985,
        "login": "rafamadriz",
        "node_id": "MDQ6VXNlcjY3NzcxOTg1",
        "organizations_url": "https://api.github.com/users/rafamadriz/orgs",
        "received_events_url": "https://api.github.com/users/rafamadriz/received_events",
        "repos_url": "https://api.github.com/users/rafamadriz/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/rafamadriz/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rafamadriz/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/rafamadriz"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\nNeovim randomly crashes if any Telescope command is run as `+` command from the shell. \r\n\r\n```c++\r\n#0  finderrfunc (L=0x7fcc75317380) at lj_err.c:807\r\n#1  lj_err_run (L=L@entry=0x7fcc75317380) at lj_err.c:843\r\n#2  0x00005634e679727d in err_msgv (L=L@entry=0x7fcc75317380, em=em@entry=LJ_ERR_BADOPRV) at lj_err.c:882\r\n#3  0x00005634e6797405 in lj_err_optype (L=0x7fcc75317380, o=<optimized out>, opm=opm@entry=LJ_ERR_OPCALL)\r\n    at lj_err.c:918\r\n#4  0x00005634e67974e2 in lj_err_optype_call (L=L@entry=0x7fcc75317380, o=o@entry=0x7fcc75295ca0) at lj_err.c:946\r\n#5  0x00005634e67bd12f in lj_meta_call (L=0x7fcc75317380, func=0x7fcc75295ca0, top=0x7fcc75295cb8) at lj_meta.c:447\r\n#6  0x00005634e67b687e in lj_vmeta_call ()\r\n#7  0x00005634e67a23e5 in lua_pcall (L=0x7fcc75317380, nargs=<optimized out>, nresults=0, errfunc=<optimized out>)\r\n    at lj_api.c:1116\r\n#8  0x00005634e655b50f in nlua_pcall (lstate=0x7fcc75317380, nargs=1, nresults=0)\r\n    at .../neovim/src/nvim/lua/executor.c:164\r\n#9  0x00005634e656129e in nlua_do_ucmd (cmd=0x5634e7cf8490, eap=0x7ffe98998140, preview=false)\r\n    at .../neovim/src/nvim/lua/executor.c:2239\r\n#10 0x00005634e66e4e1d in do_ucmd (eap=0x7ffe98998140, preview=false)\r\n    at .../neovim/src/nvim/usercmd.c:1642\r\n#11 0x00005634e64eee39 in execute_cmd0 (retv=0x7ffe989980f8, eap=0x7ffe98998140, errormsg=0x7ffe98998110, \r\n    preview=false) at .../neovim/src/nvim/ex_docmd.c:1626\r\n#12 0x00005634e64f0d64 in do_one_cmd (cmdlinep=0x7ffe98998360, flags=11, cstack=0x7ffe98998470, fgetline=0x0, \r\n    cookie=0x0) at .../neovim/src/nvim/ex_docmd.c:2293\r\n#13 0x00005634e64ec8f5 in do_cmdline (cmdline=0x7ffe9899ab32 \"Telescope builtin\", fgetline=0x0, cookie=0x0, flags=11)\r\n    at .../neovim/src/nvim/ex_docmd.c:592\r\n#14 0x00005634e64ebec8 in do_cmdline_cmd (cmd=0x7ffe9899ab32 \"Telescope builtin\")\r\n    at .../neovim/src/nvim/ex_docmd.c:291\r\n#15 0x00005634e63ba6e8 in exe_commands (parmp=0x7ffe98998aa0) at .../neovim/src/nvim/main.c:1901\r\n#16 0x00005634e63b67c5 in main (argc=6, argv=0x7ffe98998d18) at .../neovim/src/nvim/main.c:579\r\n```\r\n\r\nPlugin versions:\r\n- plenary: 36aaceb6e93addd20b1b18f94d86aecc552f30c4\r\n- telescope: ffe35cb433192fcb5080b557c1aef14d37092035\r\n\r\nPlease change the title to something more accurate if you can minimize my example. \r\n\r\n### Steps to reproduce\r\n\r\n1. Create `telescope_crash.lua` with\r\n```lua\r\nlocal configDir = vim.fn.expand('<sfile>:p:h')\r\n\r\nvim.env['XDG_CONFIG_HOME'] = configDir\r\nvim.env['XDG_DATA_HOME'] = configDir .. '/.xdg/data'\r\nvim.env['XDG_STATE_HOME'] = configDir .. '/.xdg/state'\r\nvim.env['XDG_CACHE_HOME'] = configDir .. '/.xdg/cache'\r\nlocal stdPathConfig = vim.fn.stdpath('config')\r\n\r\nvim.opt.runtimepath:prepend(stdPathConfig)\r\nvim.opt.packpath:prepend(stdPathConfig)\r\nlocal plugins_path = vim.fn.fnamemodify('plugins/', ':p')\r\n\r\nfor name, url in pairs{\r\n  ['plenary.nvim'] = 'https://github.com/nvim-lua/plenary.nvim',\r\n  ['telescope.nvim'] = 'https://github.com/nvim-telescope/telescope.nvim',\r\n} do\r\n  local install_path = plugins_path .. name\r\n  if vim.fn.isdirectory(install_path) == 0 then\r\n    vim.fn.system { 'git', 'clone', '--depth=1', url, install_path }\r\n  end\r\n  vim.opt.runtimepath:append(install_path)\r\nend\r\n\r\nrequire('telescope').setup { }\r\n\r\nvim.wo.showbreak = '> '\r\nvim.go.foldlevelstart = 99\r\nvim.wo.foldcolumn = 'auto'\r\nvim.wo.foldmethod='expr'\r\nvim.wo.foldexpr = 'v:lua.vim.treesitter.foldexpr()'\r\n```\r\n2.  Make waiting for crash easier:\r\n```bash\r\ni=0; \r\ntrap '{ echo -e \"\\nInterrupted after successful $i attempts.\" ; exit 0; }' INT\r\nwhile true; do \r\n  ((i++));\r\n  nvim --clean -u telescope_crash.lua +Telescope\\ builtin +qa! || { echo ${i}-th: $?; break; };\r\n  sleep .2; \r\ndone\r\n```\r\n\r\nFor me, the loop above broke after between 1 and 14 starts. \r\n\r\n### Expected behavior\r\n\r\nNo crash.\r\n\r\n### Neovim version (nvim -v)\r\n\r\nNVIM v0.10.0-dev-567+g4dc86477b\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\n-\r\n\r\n### Operating system/version\r\n\r\nDebian Sid\r\n\r\n### Terminal name/version\r\n\r\ntmux 3.3a-4, kitty 0.26.5\r\n\r\n### $TERM environment variable\r\n\r\ntmux-256color\r\n\r\n### Installation\r\n\r\nbuild from repo\r\n\r\n\r\nEdited to minimize the config. The backtrace above comes from the first example with nvim-treesitter plugin. ",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "1. You should not need nvim-treesitter; if you can reproduce it with Lua files only, just add a `filetype` autocommand with `vim.treesitter.start()` to your `crash.lua`\r\n2. Make sure to test with `nvim --clean -u crash.lua` (order matters here).",
            "created_at": "2023-06-23T17:39:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1604612682",
            "id": 1604612682,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5fpHJK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604612682/reactions"
            },
            "updated_at": "2023-06-23T17:39:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604612682",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "- I added `--clean` and still can reproduce this bug. \r\n- with\r\n```lua\r\nlocal configDir = vim.fn.expand('<sfile>:p:h')\r\n\r\nvim.env['XDG_CONFIG_HOME'] = configDir\r\nvim.env['XDG_DATA_HOME'] = configDir .. '/.xdg/data'\r\nvim.env['XDG_STATE_HOME'] = configDir .. '/.xdg/state'\r\nvim.env['XDG_CACHE_HOME'] = configDir .. '/.xdg/cache'\r\nlocal stdPathConfig = vim.fn.stdpath('config')\r\n\r\nvim.opt.runtimepath:prepend(stdPathConfig)\r\nvim.opt.packpath:prepend(stdPathConfig)\r\nlocal plugins_path = vim.fn.fnamemodify('plugins/', ':p')\r\n\r\nfor name, url in pairs{\r\n  ['plenary.nvim'] = 'https://github.com/nvim-lua/plenary.nvim',\r\n  ['telescope.nvim'] = 'https://github.com/nvim-telescope/telescope.nvim',\r\n} do\r\n  local install_path = plugins_path .. name\r\n  if vim.fn.isdirectory(install_path) == 0 then\r\n    vim.fn.system { 'git', 'clone', '--depth=1', url, install_path }\r\n  end\r\n  vim.opt.runtimepath:append(install_path)\r\nend\r\n\r\nrequire('telescope').setup { }\r\n\r\nvim.o.showbreak = '> '\r\nvim.go.foldlevelstart = 99\r\nvim.wo.foldcolumn = 'auto'\r\nvim.opt.foldmethod='expr'\r\nvim.opt.foldexpr='nvim_treesitter#foldexpr()'\r\n\r\nvim.treesitter.language.add('lua')\r\nvim.api.nvim_create_autocmd('FileType', {\r\n  pattern = 'lua',\r\n  callback = function (args)\r\n    vim.notify('buf ' .. args.buf)\r\n    vim.treesitter.start(args.buf, 'lua')\r\n  end\r\n})\r\n```\r\nI cannot reproduce it. Autocommand is not fired on `FileType` event (maybe `noautocmd` is used somewhere in Telescope).",
            "created_at": "2023-06-23T18:25:06Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1604679029",
            "id": 1604679029,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5fpXV1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604679029/reactions"
            },
            "updated_at": "2023-06-23T18:25:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604679029",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        },
        {
            "author_association": "NONE",
            "body": "The latest config used `nvim_treesitter#foldexpr`. `vim.treesitter.foldexpr` can be used instead:\r\n\r\n```lua\r\nlocal configDir = vim.fn.expand('<sfile>:p:h')\r\n\r\nvim.env['XDG_CONFIG_HOME'] = configDir\r\nvim.env['XDG_DATA_HOME'] = configDir .. '/.xdg/data'\r\nvim.env['XDG_STATE_HOME'] = configDir .. '/.xdg/state'\r\nvim.env['XDG_CACHE_HOME'] = configDir .. '/.xdg/cache'\r\nlocal stdPathConfig = vim.fn.stdpath('config')\r\n\r\nvim.opt.runtimepath:prepend(stdPathConfig)\r\nvim.opt.packpath:prepend(stdPathConfig)\r\nlocal plugins_path = vim.fn.fnamemodify('plugins/', ':p')\r\n\r\nfor name, url in pairs{\r\n  ['plenary.nvim'] = 'https://github.com/nvim-lua/plenary.nvim',\r\n  ['telescope.nvim'] = 'https://github.com/nvim-telescope/telescope.nvim',\r\n} do\r\n  local install_path = plugins_path .. name\r\n  if vim.fn.isdirectory(install_path) == 0 then\r\n    vim.fn.system { 'git', 'clone', '--depth=1', url, install_path }\r\n  end\r\n  vim.opt.runtimepath:append(install_path)\r\nend\r\n\r\nrequire('telescope').setup { }\r\n\r\nvim.o.showbreak = '> '\r\nvim.go.foldlevelstart = 99\r\nvim.wo.foldcolumn = 'auto'\r\nvim.opt.foldmethod='expr'\r\nvim.wo.foldexpr = 'v:lua.vim.treesitter.foldexpr()'\r\n```",
            "created_at": "2023-06-23T19:50:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1604815666",
            "id": 1604815666,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5fp4sy",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604815666/reactions"
            },
            "updated_at": "2023-06-23T19:50:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604815666",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        },
        {
            "author_association": "NONE",
            "body": "Backtrace after reduce the minimal config:\r\n```c++\r\n#0  0x0000563e8c09008e in lj_vm_exit_interp ()\r\n#1  0x0000563e8c07a3e5 in lua_pcall (L=0x7fe56d6a4380, nargs=<optimized out>, nresults=0, errfunc=<optimized out>) at lj_api.c:1116\r\n#2  0x0000563e8be3350f in nlua_pcall (lstate=0x7fe56d6a4380, nargs=1, nresults=0)\r\n    at .../neovim/src/nvim/lua/executor.c:164\r\n#3  0x0000563e8be3929e in nlua_do_ucmd (cmd=0x563e8c3a6660, eap=0x7fff7d2ebb00, preview=false)\r\n    at .../neovim/src/nvim/lua/executor.c:2239\r\n#4  0x0000563e8bfbce1d in do_ucmd (eap=0x7fff7d2ebb00, preview=false) at .../neovim/src/nvim/usercmd.c:1642\r\n#5  0x0000563e8bdc6e39 in execute_cmd0 (retv=0x7fff7d2ebab8, eap=0x7fff7d2ebb00, errormsg=0x7fff7d2ebad0, preview=false)\r\n    at .../neovim/src/nvim/ex_docmd.c:1626\r\n#6  0x0000563e8bdc8d64 in do_one_cmd (cmdlinep=0x7fff7d2ebd20, flags=11, cstack=0x7fff7d2ebe30, fgetline=0x0, cookie=0x0)\r\n    at .../neovim/src/nvim/ex_docmd.c:2293\r\n#7  0x0000563e8bdc48f5 in do_cmdline (cmdline=0x7fff7d2eeb32 \"Telescope builtin\", fgetline=0x0, cookie=0x0, flags=11)\r\n    at .../neovim/src/nvim/ex_docmd.c:592\r\n#8  0x0000563e8bdc3ec8 in do_cmdline_cmd (cmd=0x7fff7d2eeb32 \"Telescope builtin\") at .../neovim/src/nvim/ex_docmd.c:291\r\n#9  0x0000563e8bc926e8 in exe_commands (parmp=0x7fff7d2ec460) at .../neovim/src/nvim/main.c:1901\r\n#10 0x0000563e8bc8e7c5 in main (argc=7, argv=0x7fff7d2ec6d8) at .../neovim/src/nvim/main.c:579\r\n```",
            "created_at": "2023-06-23T19:59:04Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1604856353",
            "id": 1604856353,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5fqCoh",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604856353/reactions"
            },
            "updated_at": "2023-06-23T19:59:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1604856353",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Cannot reproduce",
            "created_at": "2023-06-23T23:58:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1605162539",
            "id": 1605162539,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5frNYr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1605162539/reactions"
            },
            "updated_at": "2023-06-24T00:50:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1605162539",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "NONE",
            "body": "> Cannot reproduce\r\n\r\nEven in bash loop?",
            "created_at": "2023-06-24T00:04:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1605165828",
            "id": 1605165828,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5frOME",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1605165828/reactions"
            },
            "updated_at": "2023-06-24T00:04:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1605165828",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        },
        {
            "author_association": "NONE",
            "body": "```c++\r\n=================================================================\r\n==790506==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000020 (pc 0x55a32a82c28e bp 0x7f72ef63c048 sp 0x7ffef429acd0 T0)\r\n==790506==The signal is caused by a WRITE memory access.\r\n==790506==Hint: address points to the zero page.\r\n```\r\nNothing more in crash log in this case. ",
            "created_at": "2023-06-29T01:20:47Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1612300417",
            "id": 1612300417,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5gGcCB",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1612300417/reactions"
            },
            "updated_at": "2023-06-29T01:20:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1612300417",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        },
        {
            "author_association": "NONE",
            "body": "After skipping the command in favor of calling lua function\r\n```lua\r\nlocal configDir = vim.fn.expand('<sfile>:p:h')\r\n\r\nvim.env['XDG_CONFIG_HOME'] = configDir\r\nvim.env['XDG_DATA_HOME'] = configDir .. '/.xdg/data'\r\nvim.env['XDG_STATE_HOME'] = configDir .. '/.xdg/state'\r\nvim.env['XDG_CACHE_HOME'] = configDir .. '/.xdg/cache'\r\nlocal stdPathConfig = vim.fn.stdpath('config')\r\n\r\nvim.opt.runtimepath:prepend(stdPathConfig)\r\nvim.opt.packpath:prepend(stdPathConfig)\r\nlocal plugins_path = vim.fn.fnamemodify('plugins/', ':p')\r\n\r\nfor name, url in pairs{\r\n  ['plenary.nvim'] = 'https://github.com/nvim-lua/plenary.nvim',\r\n  ['telescope.nvim'] = 'https://github.com/nvim-telescope/telescope.nvim',\r\n} do\r\n  local install_path = plugins_path .. name\r\n  if vim.fn.isdirectory(install_path) == 0 then\r\n    vim.fn.system { 'git', 'clone', '--depth=1', url, install_path }\r\n  end\r\n  vim.opt.runtimepath:append(install_path)\r\nend\r\n\r\nrequire('telescope').setup { }\r\n\r\nvim.go.showbreak = '> '\r\nvim.go.foldlevelstart = 99\r\nvim.wo.foldmethod='expr'\r\nvim.wo.foldexpr = 'v:lua.vim.treesitter.foldexpr()'\r\nvim.wo.foldcolumn = 'auto'\r\n\r\nrequire('telescope.builtin').builtin()\r\nvim.cmd.quitall {bang = true}\r\n```\r\n\r\n```bash\r\n#!/usr/bin/env bash\r\ni=0\r\ntrap '{ echo -e \"\\nInterrupted after successful $i attempts.\" ; exit 0; }' INT\r\nwhile true; do\r\n    ((i++))\r\n    nvim --clean -u telescope_crash.lua || { echo ${i}-th: $?; break; }\r\n    sleep .2\r\ndone\r\n```\r\nI get a bit simpler backtrace:\r\n```c++\r\n#0  0x000056419b01552e in lj_vm_exit_interp ()\r\n#1  0x000056419afff885 in lua_pcall (L=0x7f8920d6e380, nargs=<optimized out>, nresults=0, errfunc=<optimized out>) at lj_api.c:1116\r\n#2  0x000056419adb87c6 in nlua_pcall (lstate=0x7f8920d6e380, nargs=0, nresults=0) at .../src/nvim/lua/executor.c:164\r\n#3  0x000056419adbcfcc in nlua_exec_file (path=0x56419b921e90 \".../telescope_crash.lua\") at .../src/nvim/lua/executor.c:1811\r\n#4  0x000056419aeab36b in do_source (fname=0x7ffeea3c2c52 \"telescope_crash.lua\", check_other=0, is_vimrc=0, ret_sid=0x0) at .../src/nvim/runtime.c:2142\r\n#5  0x000056419ac17f25 in source_startup_scripts (parmp=0x7ffeea3c19d0) at .../src/nvim/main.c:2105\r\n#6  0x000056419ac13480 in main (argc=5, argv=0x7ffeea3c1c48) at .../src/nvim/main.c:448\r\n```",
            "created_at": "2023-07-02T23:39:40Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1616997001",
            "id": 1616997001,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5gYWqJ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1616997001/reactions"
            },
            "updated_at": "2023-10-26T12:04:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1616997001",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        },
        {
            "author_association": "NONE",
            "body": "Similarly like in https://github.com/neovim/neovim/issues/25100#issuecomment-1772727478 deferring the crucial action after `UIEnter` saves nvim from entering a minefield:\r\n```lua\r\nvim.api.nvim_create_autocmd('UIEnter', {\r\n  once = true,\r\n  callback = function ()\r\n    require('telescope.builtin').builtin()\r\n  end\r\n})\r\n\r\n```",
            "created_at": "2023-10-26T12:11:26Z",
            "html_url": "https://github.com/neovim/neovim/issues/24136#issuecomment-1780988789",
            "id": 1780988789,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/24136",
            "node_id": "IC_kwDOAPphoM5qJ7t1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1780988789/reactions"
            },
            "updated_at": "2023-10-26T12:11:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1780988789",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia"
            }
        }
    ],
    "comments": 9,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/24136/comments",
    "created_at": "2023-06-23T17:30:27Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/24136/events",
    "html_url": "https://github.com/neovim/neovim/issues/24136",
    "id": 1771821561,
    "labels": [
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains minimal reproducing steps",
            "id": 435851959,
            "name": "has:repro",
            "node_id": "MDU6TGFiZWw0MzU4NTE5NTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:repro"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains a stacktrace/ASAN log",
            "id": 435854079,
            "name": "has:backtrace",
            "node_id": "MDU6TGFiZWw0MzU4NTQwNzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:backtrace"
        },
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/24136/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5pm9n5",
    "number": 24136,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/24136/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/24136/timeline",
    "title": "Crash: telescope, treesitter, fold settings, showbreak",
    "updated_at": "2023-10-26T12:11:27Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/24136",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
        "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
        "followers_url": "https://api.github.com/users/przepompownia/followers",
        "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
        "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/przepompownia",
        "id": 11404453,
        "login": "przepompownia",
        "node_id": "MDQ6VXNlcjExNDA0NDUz",
        "organizations_url": "https://api.github.com/users/przepompownia/orgs",
        "received_events_url": "https://api.github.com/users/przepompownia/received_events",
        "repos_url": "https://api.github.com/users/przepompownia/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/przepompownia"
    }
}
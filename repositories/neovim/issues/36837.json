{
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
        "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
        "followers_url": "https://api.github.com/users/zeertzjq/followers",
        "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
        "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zeertzjq",
        "id": 35768171,
        "login": "zeertzjq",
        "node_id": "MDQ6VXNlcjM1NzY4MTcx",
        "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
        "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
        "repos_url": "https://api.github.com/users/zeertzjq/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zeertzjq",
        "user_view_type": "public"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
            "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
            "followers_url": "https://api.github.com/users/zeertzjq/followers",
            "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
            "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/zeertzjq",
            "id": 35768171,
            "login": "zeertzjq",
            "node_id": "MDQ6VXNlcjM1NzY4MTcx",
            "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
            "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
            "repos_url": "https://api.github.com/users/zeertzjq/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/zeertzjq",
            "user_view_type": "public"
        }
    ],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nLines duplicate themselves and incorrectly reflect the state of the buffer.\n\nhttps://github.com/user-attachments/assets/0f76fe26-9f0c-4f23-ad1f-13630e808f27\n\nNotice how these lines get duplicated twice:\n```\n\n    local out = exec_lua(\n```\n\n### Steps to reproduce\n\n- Use this `init.lua`:\n  ```lua\n  vim.o.foldmethod = 'expr'\n  vim.o.foldexpr = 'v:lua.vim.treesitter.foldexpr()'\n  vim.o.foldlevelstart = 99\n  \n  vim.diagnostic.config {\n    virtual_text = {\n      current_line = false,\n      spacing = 1,\n    },\n    virtual_lines = {\n      current_line = true,\n    },\n    underline = true,\n    signs = false,\n  }\n  \n  vim.lsp.config('lua', {\n    cmd = { 'lua-language-server' },\n    filetypes = { 'lua' },\n    root_markers = {\n      '.luarc.json',\n      '.luarc.jsonc',\n      '.luacheckrc',\n      '.stylua.toml',\n      'stylua.toml',\n      'selene.toml',\n      'selene.yml',\n      '.git',\n    },\n  })\n  \n  vim.lsp.enable('lua')\n  ```\n- Open `test/functional/plugin/spellfile_spec.lua` in the neovim repo. I'm sure this can be triggered in any file under the right conditions, but I found this when editing that file.\n- [Wait until the LSP loads](https://github.com/neovim/neovim/issues/36837#issuecomment-3619148386). [It may be easier to use version 3.5.6](https://github.com/LuaLS/lua-language-server/issues/2961#issuecomment-3369157859). Press escape to exit the dialogue that it opens.\n- Perform the movement actions shown in the video.\n\n### Expected behavior\n\nNo duplicated lines.\n\n### Nvim version (nvim -v)\n\nNVIM v0.12.0-dev+1759-903335a6d\n\n### Vim (not Nvim) behaves the same?\n\nnot applicable (diagnostics, lsp, treesitter foldexpr)\n\n### Operating system/version\n\nFedora 43\n\n### Terminal name/version\n\nkitty 0.43.1\n\n### $TERM environment variable\n\nxterm-kitty\n\n### Installation\n\nFedora COPR",
    "closed_at": "2025-12-08T01:24:27Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
        "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
        "followers_url": "https://api.github.com/users/zeertzjq/followers",
        "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
        "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/zeertzjq",
        "id": 35768171,
        "login": "zeertzjq",
        "node_id": "MDQ6VXNlcjM1NzY4MTcx",
        "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
        "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
        "repos_url": "https://api.github.com/users/zeertzjq/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/zeertzjq",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Cannot reproduce",
            "created_at": "2025-12-05T23:54:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3618987444",
            "id": 3618987444,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7XtV20",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618987444/reactions"
            },
            "updated_at": "2025-12-05T23:54:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3618987444",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Interesting. I'll do some more testing and see if I can pinpoint if there's anything else that's required to reproduce. Anything you can gleam from just the video that might help?",
            "created_at": "2025-12-06T00:06:08Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3619003050",
            "id": 3619003050,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7XtZqq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619003050/reactions"
            },
            "updated_at": "2025-12-06T00:06:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619003050",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I figured it out! You also need to set `foldexpr`. Here is a complete `init.lua` which can be used to reproduce:\n\n```lua\nvim.o.foldmethod = 'expr'\nvim.o.foldexpr = 'v:lua.vim.treesitter.foldexpr()'\nvim.o.foldlevelstart = 99\n\nvim.diagnostic.config {\n  virtual_text = {\n    current_line = false,\n    spacing = 1,\n  },\n  virtual_lines = {\n    current_line = true,\n  },\n  underline = true,\n  signs = false,\n}\n\nvim.lsp.config('lua', {\n  cmd = { 'lua-language-server' },\n  filetypes = { 'lua' },\n  root_markers = {\n    '.luarc.json',\n    '.luarc.jsonc',\n    '.luacheckrc',\n    '.stylua.toml',\n    'stylua.toml',\n    'selene.toml',\n    'selene.yml',\n    '.git',\n  },\n})\n\nvim.lsp.enable('lua')\n```\n\nApologies for the incomplete reproduction steps to start with. I keep my diagnostics and folding options both in a file named `editor.lua`, so when displaying all of my plugins to make a minimal example, I accidentally kept folding enabled without realizing it was necessary.",
            "created_at": "2025-12-06T00:58:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3619091332",
            "id": 3619091332,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7XtvOE",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619091332/reactions"
            },
            "updated_at": "2025-12-06T01:04:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619091332",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This still doesn't look right. When using this config I can't see any diagnostic at all, even though LSP hover does work.",
            "created_at": "2025-12-06T01:39:52Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3619137556",
            "id": 3619137556,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7Xt6gU",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619137556/reactions"
            },
            "updated_at": "2025-12-06T01:39:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619137556",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> This still doesn't look right. When using this config I can't see any diagnostic at all, even though LSP hover does work.\n\nYou'll have to adjust your LSP configuration so the diagnostics appear. I'm not sure why it's not appearing. Once it does, you should be able to reproduce the bug.\n\nSometimes it takes a while for `lua-langauge-server` to finish starting up, and it also needs an update to display diagnostics. See https://github.com/LuaLS/lua-language-server/issues/2961.",
            "created_at": "2025-12-06T01:43:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3619148386",
            "id": 3619148386,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7Xt9Ji",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619148386/reactions"
            },
            "updated_at": "2025-12-06T01:43:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3619148386",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Could you actually gather all these settings into a `minimal.lua`, and then use only those to reproduce the issue? Otherwise, we can't be sure only those settings and plugins influence this behavior.\n\nFor example, your virtual lines have fold marks on each line, as if being folds themselves. I cannot reproduce that with the settings you provided. If those are wrongly considered to be buffer's folds, they could introduce problems with fold recounting, and lead to those visual bugs.\n\n---\n\nI assume bugs are purely visual because there are several duplications throughout the video, and they disappear at some point. It's hard to see what event causes them to recalculate, since `webm` is bad at backtracking when viewing in a frame-by-frame mode.",
            "created_at": "2025-12-06T11:52:40Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3620025818",
            "id": 3620025818,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7XxTXa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620025818/reactions"
            },
            "updated_at": "2025-12-06T11:52:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620025818",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/58133782?v=4",
                "events_url": "https://api.github.com/users/shushtain/events{/privacy}",
                "followers_url": "https://api.github.com/users/shushtain/followers",
                "following_url": "https://api.github.com/users/shushtain/following{/other_user}",
                "gists_url": "https://api.github.com/users/shushtain/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shushtain",
                "id": 58133782,
                "login": "shushtain",
                "node_id": "MDQ6VXNlcjU4MTMzNzgy",
                "organizations_url": "https://api.github.com/users/shushtain/orgs",
                "received_events_url": "https://api.github.com/users/shushtain/received_events",
                "repos_url": "https://api.github.com/users/shushtain/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shushtain/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shushtain/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shushtain",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Could you actually gather all these settings into a `minimal.lua`, and then use only those to reproduce the issue? Otherwise, we can't be sure only those settings and plugins influence this behavior.\n\n[That's what is here.](https://github.com/neovim/neovim/issues/36837#issuecomment-3619091332)\n\n> It's hard to see what event causes them to recalculate, since `webm` is bad at backtracking when viewing in a frame-by-frame mode.\n\nHere's a version using only the `minimal.lua` I provided, recorded with OBS this time, so the image is hopefully clearer:\n\nhttps://github.com/user-attachments/assets/0f76fe26-9f0c-4f23-ad1f-13630e808f27",
            "created_at": "2025-12-06T17:25:02Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3620727976",
            "id": 3620727976,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7Xz-yo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620727976/reactions"
            },
            "updated_at": "2025-12-06T17:25:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620727976",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Due to my original bad instructions for reproducing this bug, I have updated my original comment to be better.",
            "created_at": "2025-12-06T17:28:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3620735861",
            "id": 3620735861,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7X0At1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620735861/reactions"
            },
            "updated_at": "2025-12-06T17:28:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620735861",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "I think it's interesting that duplication seems to happen when virtual text that collapses belongs to the first visible line in the buffer. That makes me think the issue could be related to <https://github.com/neovim/neovim/issues/36739#issuecomment-3591465087>.\n\nI've just noticed that I don't have the same version of Neovim as you to try the following, but I'm curious whether the same bug would happen if one has something like `vim.o.scrolloff = 8` in their config. That's not a solution, but a good way to check if the issues are related, since all except the very first and last 8 lines will not become `w0` and `w$` ones.",
            "created_at": "2025-12-06T18:47:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3620914879",
            "id": 3620914879,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7X0sa_",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620914879/reactions"
            },
            "updated_at": "2025-12-06T18:47:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620914879",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/58133782?v=4",
                "events_url": "https://api.github.com/users/shushtain/events{/privacy}",
                "followers_url": "https://api.github.com/users/shushtain/followers",
                "following_url": "https://api.github.com/users/shushtain/following{/other_user}",
                "gists_url": "https://api.github.com/users/shushtain/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shushtain",
                "id": 58133782,
                "login": "shushtain",
                "node_id": "MDQ6VXNlcjU4MTMzNzgy",
                "organizations_url": "https://api.github.com/users/shushtain/orgs",
                "received_events_url": "https://api.github.com/users/shushtain/received_events",
                "repos_url": "https://api.github.com/users/shushtain/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shushtain/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shushtain/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shushtain",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Here are the specific states I'm talking about. The frames in the middle seem to prove that folds try to resolve before virtual lines have a chance to collapse properly.\n\n<img width=\"1620\" height=\"540\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/96adac7d-363b-4086-9681-7fe9dc243af7\" />\n\n<img width=\"1620\" height=\"540\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a6b1bd7b-26b7-46a1-917b-28f874dd1ff2\" />",
            "created_at": "2025-12-06T19:17:52Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3620987052",
            "id": 3620987052,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7X0-Cs",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620987052/reactions"
            },
            "updated_at": "2025-12-06T19:17:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3620987052",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/58133782?v=4",
                "events_url": "https://api.github.com/users/shushtain/events{/privacy}",
                "followers_url": "https://api.github.com/users/shushtain/followers",
                "following_url": "https://api.github.com/users/shushtain/following{/other_user}",
                "gists_url": "https://api.github.com/users/shushtain/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shushtain",
                "id": 58133782,
                "login": "shushtain",
                "node_id": "MDQ6VXNlcjU4MTMzNzgy",
                "organizations_url": "https://api.github.com/users/shushtain/orgs",
                "received_events_url": "https://api.github.com/users/shushtain/received_events",
                "repos_url": "https://api.github.com/users/shushtain/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shushtain/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shushtain/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shushtain",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I'm curious whether the same bug would happen if one has something like `vim.o.scrolloff = 8` in their config.\n\nHere's a video of that for you. I literally just added `vim.o.scrolloff = 8` to the top of the `minimal.lua`.\n\nhttps://github.com/user-attachments/assets/f14f34f7-05dd-43a7-969f-7eb1572add3d\n\n> Here are the specific states I'm talking about. The frames in the middle seem to prove that folds try to resolve before virtual lines have a chance to collapse properly.\n\nOh interesting! That's a very nice observation for why this is happening.",
            "created_at": "2025-12-06T20:01:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3621065204",
            "id": 3621065204,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7X1RH0",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621065204/reactions"
            },
            "updated_at": "2025-12-06T20:01:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621065204",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Okay, the two issues are unrelated then, since `scrolloff` doesn't prevent it.",
            "created_at": "2025-12-06T20:04:37Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3621067211",
            "id": 3621067211,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7X1RnL",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621067211/reactions"
            },
            "updated_at": "2025-12-06T20:04:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621067211",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/58133782?v=4",
                "events_url": "https://api.github.com/users/shushtain/events{/privacy}",
                "followers_url": "https://api.github.com/users/shushtain/followers",
                "following_url": "https://api.github.com/users/shushtain/following{/other_user}",
                "gists_url": "https://api.github.com/users/shushtain/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/shushtain",
                "id": 58133782,
                "login": "shushtain",
                "node_id": "MDQ6VXNlcjU4MTMzNzgy",
                "organizations_url": "https://api.github.com/users/shushtain/orgs",
                "received_events_url": "https://api.github.com/users/shushtain/received_events",
                "repos_url": "https://api.github.com/users/shushtain/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/shushtain/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shushtain/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/shushtain",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I can only reproduce this issue with `scrolloff=8`. It seems to happen when adding/removing virtual lines while scrolling.",
            "created_at": "2025-12-06T23:31:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3621365141",
            "id": 3621365141,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7X2aWV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621365141/reactions"
            },
            "updated_at": "2025-12-06T23:35:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621365141",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I can only reproduce this issue with `scrolloff=8`. It seems to happen when adding/removing virtual lines while scrolling.\n\nThat's interesting. I wonder why it wasn't triggering for you without it. Either way, I'm glad you were able to reproduce it.",
            "created_at": "2025-12-06T23:40:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3621371190",
            "id": 3621371190,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7X2b02",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621371190/reactions"
            },
            "updated_at": "2025-12-06T23:40:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3621371190",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I think it's fixed now. Please check if the issue still exists.",
            "created_at": "2025-12-08T01:34:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3624122601",
            "id": 3624122601,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7YA7jp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3624122601/reactions"
            },
            "updated_at": "2025-12-08T01:34:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3624122601",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Yep! You fixed it. Nice work; thank you.",
            "created_at": "2025-12-08T05:53:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/36837#issuecomment-3625111286",
            "id": 3625111286,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36837",
            "node_id": "IC_kwDOAPphoM7YEs72",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3625111286/reactions"
            },
            "updated_at": "2025-12-08T05:53:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3625111286",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 16,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36837/comments",
    "created_at": "2025-12-05T23:40:46Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/36837/events",
    "html_url": "https://github.com/neovim/neovim/issues/36837",
    "id": 3700649089,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "redraw, layout, presentation",
            "id": 718084050,
            "name": "display",
            "node_id": "MDU6TGFiZWw3MTgwODQwNTA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/display"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "marks, extmarks, decorations, virtual text",
            "id": 1680119719,
            "name": "marks",
            "node_id": "MDU6TGFiZWwxNjgwMTE5NzE5",
            "url": "https://api.github.com/repos/neovim/neovim/labels/marks"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/36837/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM7ck2yB",
    "number": 36837,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/36837/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/36837/timeline",
    "title": "editor: duplicated lines with diagnostics + foldexpr",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-12-08T05:53:20Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/36837",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
        "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
        "followers_url": "https://api.github.com/users/superatomic/followers",
        "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
        "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/superatomic",
        "id": 51250849,
        "login": "superatomic",
        "node_id": "MDQ6VXNlcjUxMjUwODQ5",
        "organizations_url": "https://api.github.com/users/superatomic/orgs",
        "received_events_url": "https://api.github.com/users/superatomic/received_events",
        "repos_url": "https://api.github.com/users/superatomic/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/superatomic",
        "user_view_type": "public"
    }
}
{
    "active_lock_reason": "off-topic",
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "- Neovim version: v0.1.3-293-g576c5f7\n- Operating system: Ubuntu Xenial beta\n- Terminal emulator: vte/gnome-terminal (git master)\n\nI have configured my gnome-terminal (in its Profile Preferences dialog) to use an I-Beam cursor. It also inherits from my global Gnome settings that the cursor is blinking.\n\nI have NVIM_TUI_ENABLE_CURSOR_SHAPE=1, so that supposedly the cursor is a rectangle in command mode, and I-Beam in insert mode.\n\nThis is true for the main lifetime of neovim, but is neither initialized correctly on startup, nor reverted correctly on exit.\n\nWhen I start up neovim, the cursor remains what it was before. That is, nvim (incorrectly) assumes it was a solid block, and does not issue the escape sequence that changes it to a block. The fix should be straightforward: initialize the cursor shape when neovim starts up.\n\nUpon exit I'm left with a solid block, and that's not what I want to have there, I'd like to get back to my generally preferred cursor shape. The fix here is trickier. There's no way to query or save/restore the cursor shape. In xterm it's probably impossible, since according to http://invisible-island.net/xterm/ctlseqs/ctlseqs.html (-> \"Set cursor style (DECSCUSR, VT520)\") you can only choose from 6 different modes, numbered from 0 to 6, whereas 0 and 1 are the same.\n\nVTE (gnome-terminal et al) intentionally differs here from xterm. Numbers 1-6 work just as in xterm: select a particular mode. However, number 0 means to revert to the terminal emulator's default, as specified in its profile preferences.\n\nOf course there's still no guarantee that someone didn't modify the cursor shape by some escape sequence prior to starting up neovim. However, setting mode 0 upon exit would be a nice step towards restoring the previous value in gnome-terminal, whereas it wouldn't hurt xterm. (Note: the parameter 0 can be omitted, \"\\e[ q\" and \"\\e[0 q\" are the same.)\n",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "also seeing the issue in iterm2-nightly (20160314), and latest neovim (NVIM v0.1.3-348-ge7a9c00) running inside tmux 2.1 on osx 10.10.5.\n",
            "created_at": "2016-03-14T14:10:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/4396#issuecomment-196323913",
            "id": 196323913,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/4396",
            "node_id": "MDEyOklzc3VlQ29tbWVudDE5NjMyMzkxMw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/196323913/reactions"
            },
            "updated_at": "2016-03-14T14:10:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/196323913",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/3678?v=4",
                "events_url": "https://api.github.com/users/megalithic/events{/privacy}",
                "followers_url": "https://api.github.com/users/megalithic/followers",
                "following_url": "https://api.github.com/users/megalithic/following{/other_user}",
                "gists_url": "https://api.github.com/users/megalithic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/megalithic",
                "id": 3678,
                "login": "megalithic",
                "node_id": "MDQ6VXNlcjM2Nzg=",
                "organizations_url": "https://api.github.com/users/megalithic/orgs",
                "received_events_url": "https://api.github.com/users/megalithic/received_events",
                "repos_url": "https://api.github.com/users/megalithic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/megalithic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/megalithic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/megalithic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This is now fully controllable via 'guicursor', see https://github.com/neovim/neovim/issues/4867#issuecomment-291249173\r\n\r\n> VTE (gnome-terminal et al) intentionally differs here from xterm. Numbers 1-6 work just as in xterm: select a particular mode. However, number 0 means to revert to the terminal emulator's default, as specified in its profile preferences.\r\n\r\nInteresting, that would be worth doing.",
            "created_at": "2017-05-21T15:57:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/4396#issuecomment-302945410",
            "id": 302945410,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/4396",
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjk0NTQxMA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/302945410/reactions"
            },
            "updated_at": "2017-05-21T15:57:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/302945410",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Just saw that, I now have a patch that reset the cursor shape/color for VTE based terminals.\r\nWhile looking into it I realized that recent vte support setting cursor foregound color so I will be adding that as well in https://github.com/neovim/neovim/pull/6566.",
            "created_at": "2017-05-22T14:56:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/4396#issuecomment-303124972",
            "id": 303124972,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/4396",
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzEyNDk3Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/303124972/reactions"
            },
            "updated_at": "2017-05-22T14:56:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/303124972",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/886074?v=4",
                "events_url": "https://api.github.com/users/teto/events{/privacy}",
                "followers_url": "https://api.github.com/users/teto/followers",
                "following_url": "https://api.github.com/users/teto/following{/other_user}",
                "gists_url": "https://api.github.com/users/teto/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/teto",
                "id": 886074,
                "login": "teto",
                "node_id": "MDQ6VXNlcjg4NjA3NA==",
                "organizations_url": "https://api.github.com/users/teto/orgs",
                "received_events_url": "https://api.github.com/users/teto/received_events",
                "repos_url": "https://api.github.com/users/teto/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/teto/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/teto/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/teto",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Bump? came here because I was experiencing this bug. positive its bug with neovim. I have alacritty, st and tilix configured to use an I-beam as the default cursor, and neovim configured to use an I-beam everywhere but normal mode, where its configured to use a block.\r\n\r\nWhen I exit neovim the what should be an I-beam is now a block. I'm finding this quite annoying, and I end up closing and reopening my terminal every time I exit neovim.\r\n\r\nPlease fix, no clue why this was marked as an \"enhancement\" when it's clearly a bug.",
            "created_at": "2020-01-18T11:45:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/4396#issuecomment-575891488",
            "id": 575891488,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/4396",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU3NTg5MTQ4OA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/575891488/reactions"
            },
            "updated_at": "2020-01-19T00:15:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/575891488",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/33004327?v=4",
                "events_url": "https://api.github.com/users/tealsnow/events{/privacy}",
                "followers_url": "https://api.github.com/users/tealsnow/followers",
                "following_url": "https://api.github.com/users/tealsnow/following{/other_user}",
                "gists_url": "https://api.github.com/users/tealsnow/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tealsnow",
                "id": 33004327,
                "login": "tealsnow",
                "node_id": "MDQ6VXNlcjMzMDA0MzI3",
                "organizations_url": "https://api.github.com/users/tealsnow/orgs",
                "received_events_url": "https://api.github.com/users/tealsnow/received_events",
                "repos_url": "https://api.github.com/users/tealsnow/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tealsnow/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tealsnow/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tealsnow",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@8bitkitkat Explained in https://github.com/neovim/neovim/issues/4867#issuecomment-250944435 . Workaround in https://github.com/neovim/neovim/issues/4867#issuecomment-291249173 .\r\n\r\n> why this was marked as an \"enhancement\" when it's clearly a bug\r\n\r\nUnless alacritty supports the feature described in this issue it's not possible to fix. The `VimLeave` handler mentioned in https://github.com/neovim/neovim/issues/4867#issuecomment-291249173 is a reasonable workaround.",
            "created_at": "2020-01-19T00:15:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/4396#issuecomment-575951032",
            "id": 575951032,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/4396",
            "node_id": "MDEyOklzc3VlQ29tbWVudDU3NTk1MTAzMg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/575951032/reactions"
            },
            "updated_at": "2020-01-19T00:15:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/575951032",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "I guess there are reasons behind not implementing this in NeoVIM as of now. But, could you please let me know how I can send ANSI escape sequences from within nvim?\n\nI want to send the escape sequence on VimLeave. I plan to use `\\033[ q` to reset the cursor when I quit.",
            "created_at": "2023-01-10T12:09:27Z",
            "html_url": "https://github.com/neovim/neovim/issues/4396#issuecomment-1377165425",
            "id": 1377165425,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/4396",
            "node_id": "IC_kwDOAPphoM5SFeBx",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377165425/reactions"
            },
            "updated_at": "2023-01-10T12:09:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377165425",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31820255?v=4",
                "events_url": "https://api.github.com/users/UtkarshVerma/events{/privacy}",
                "followers_url": "https://api.github.com/users/UtkarshVerma/followers",
                "following_url": "https://api.github.com/users/UtkarshVerma/following{/other_user}",
                "gists_url": "https://api.github.com/users/UtkarshVerma/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/UtkarshVerma",
                "id": 31820255,
                "login": "UtkarshVerma",
                "node_id": "MDQ6VXNlcjMxODIwMjU1",
                "organizations_url": "https://api.github.com/users/UtkarshVerma/orgs",
                "received_events_url": "https://api.github.com/users/UtkarshVerma/received_events",
                "repos_url": "https://api.github.com/users/UtkarshVerma/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/UtkarshVerma/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/UtkarshVerma/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/UtkarshVerma",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "```vim\r\n:autocmd VimLeave * set guicursor= | call chansend(v:stderr, \"\\x1b[ q\")\r\n```",
            "created_at": "2023-01-10T12:30:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/4396#issuecomment-1377191592",
            "id": 1377191592,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/4396",
            "node_id": "IC_kwDOAPphoM5SFkao",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 9,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 4,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 13,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377191592/reactions"
            },
            "updated_at": "2023-01-10T12:30:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1377191592",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/4396/comments",
    "created_at": "2016-03-02T18:40:52Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/4396/events",
    "html_url": "https://github.com/neovim/neovim/issues/4396",
    "id": 137956439,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "",
            "id": 606691254,
            "name": "has:plan",
            "node_id": "MDU6TGFiZWw2MDY2OTEyNTQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:plan"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/4396/labels{/name}",
    "locked": true,
    "milestone": {
        "closed_at": null,
        "closed_issues": 686,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 635,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-01-21T00:09:37Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "MDU6SXNzdWUxMzc5NTY0Mzk=",
    "number": 4396,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 5,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 5,
        "url": "https://api.github.com/repos/neovim/neovim/issues/4396/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/4396/timeline",
    "title": "TUI: cursor shape not correctly initialized and restored",
    "updated_at": "2025-01-17T16:05:51Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/4396",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/5750745?v=4",
        "events_url": "https://api.github.com/users/egmontkob/events{/privacy}",
        "followers_url": "https://api.github.com/users/egmontkob/followers",
        "following_url": "https://api.github.com/users/egmontkob/following{/other_user}",
        "gists_url": "https://api.github.com/users/egmontkob/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/egmontkob",
        "id": 5750745,
        "login": "egmontkob",
        "node_id": "MDQ6VXNlcjU3NTA3NDU=",
        "organizations_url": "https://api.github.com/users/egmontkob/orgs",
        "received_events_url": "https://api.github.com/users/egmontkob/received_events",
        "repos_url": "https://api.github.com/users/egmontkob/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/egmontkob/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/egmontkob/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/egmontkob",
        "user_view_type": "public"
    }
}
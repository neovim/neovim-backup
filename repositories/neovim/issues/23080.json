{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nCurrently if `vim.api.nvim_win_set_buf` is called from a user command-preview function it is not reset when the user leaves the commandline. This would be useful for global search or goto style commands.\r\n\r\nFor example `GotoDefinition` could peek the location of the definition. Or even simpler a `SwitchBuffer/SwitchFile` command that shows the buffer in the current window while choosing the buffer from the popupmenu. \r\n\r\nAdditionally there are some commands where showing some preview in a split/floating window makes a lot of sense even if `inccommand=nosplit`, I think allowing plugins to simply create windows (that are automatically destroyed when you leave the cmdline) could be useful. This could also be closely approximated by allowing the inccomand to be specified per command or even per invocation, if full window layout saving/restoring is too flexible/complex\n\n### Expected behavior\n\nExpanding the set of information/context that is saved before and restored after a command preview to include, in order of how useful I think this is\r\n\r\n- shown buffer in each window\r\n- existing windows and their configs\r\n\r\nAnother possibility that may allow more fine grained and efficient context saving and restoration is to add `before_preview`,  and `after_preview` callbacks where the plugin/user can save and restore whatever state it wants, including neovim editor state as well as its own. The downside of this is that a poorly implemented `after_preview` plugin could mess up the editor state. However it actually has another advantage besides being the most flexible: some expensive one-time computations can be done in the `before_preview` callback, such as treesitter queries, lsp requests, etc.",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [],
    "comments": 0,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/23080/comments",
    "created_at": "2023-04-14T06:43:37Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/23080/events",
    "html_url": "https://github.com/neovim/neovim/issues/23080",
    "id": 1667612070,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 7015104868,
            "name": "inccommand",
            "node_id": "LA_kwDOAPphoM8AAAABoiIBZA",
            "url": "https://api.github.com/repos/neovim/neovim/labels/inccommand"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/23080/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 260,
        "created_at": "2014-11-26T22:13:11Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "We don't plan to work on this, but will accept high quality contributions from someone who will own the feature and follow up on bug reports.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/9",
        "id": 881978,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/9/labels",
        "node_id": "MDk6TWlsZXN0b25lODgxOTc4",
        "number": 9,
        "open_issues": 297,
        "state": "open",
        "title": "needs-owner",
        "updated_at": "2025-01-20T17:56:23Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/9"
    },
    "node_id": "I_kwDOAPphoM5jZb2m",
    "number": 23080,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 2,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 2,
        "url": "https://api.github.com/repos/neovim/neovim/issues/23080/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/23080/timeline",
    "title": "inccommand (:command-preview): restore buffers/windows after preview",
    "updated_at": "2025-01-17T15:31:19Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/23080",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/5981889?v=4",
        "events_url": "https://api.github.com/users/IndianBoy42/events{/privacy}",
        "followers_url": "https://api.github.com/users/IndianBoy42/followers",
        "following_url": "https://api.github.com/users/IndianBoy42/following{/other_user}",
        "gists_url": "https://api.github.com/users/IndianBoy42/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/IndianBoy42",
        "id": 5981889,
        "login": "IndianBoy42",
        "node_id": "MDQ6VXNlcjU5ODE4ODk=",
        "organizations_url": "https://api.github.com/users/IndianBoy42/orgs",
        "received_events_url": "https://api.github.com/users/IndianBoy42/received_events",
        "repos_url": "https://api.github.com/users/IndianBoy42/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/IndianBoy42/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/IndianBoy42/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/IndianBoy42",
        "user_view_type": "public"
    }
}
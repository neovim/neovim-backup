{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\r\n\r\nHi there!\r\n\r\nI have a small problem when I'm using `CTRL-]` to jump-to-definition using a LSP. I noticed in some cases it's slightly inaccurate.\r\n\r\nFor context.. I have a Ruby on Rails app where we put our associations in another module e.g.\r\n\r\n```ruby\r\n# app/models/my_model.rb\r\nclass MyModel < ApplicationRecord\r\n  include MyModel::HasAssociations\r\nend\r\n```\r\n\r\n.. the problem is when I put my cursor on `HasAssociations` and press `Ctrl-]` to jump to definition, it jumps to the wrong location sometimes because it looks like neovim isn't calling the LSP quite right.\r\n\r\nI confirmed this by testing with the suggested minimal init.vim and looking in the `nvim/lsp.log` file:\r\n\r\n`:lua vim.lsp.set_log_level('DEBUG')`\r\n```\r\n[DEBUG][2024-08-28 10:30:30] ...m/lsp/client.lua:678\t\"LSP[ruby-lsp]\"\t\"client.request\"\t1\t\"workspace/symbol\"\t{  query = \"HasAssociations\"}\t<function 1>\t1\r\n[DEBUG][2024-08-28 10:30:30] .../vim/lsp/rpc.lua:286\t\"rpc.send\"\t{  id = 4,  jsonrpc = \"2.0\",  method = \"workspace/symbol\",  params = {    query = \"HasAssociations\"  }}\r\n```\r\n\r\nI can see it's using `workspace/symbol` with the query `HasAssociations` instead of using `textDocument/definition`, which ruby-lsp is able to work out the correct definition location using the fully qualified module name.\r\n\r\nThe documentation suggests it should work like I'm expecting:\r\nhttps://neovim.io/doc/user/lsp.html#vim.lsp.tagfunc()\r\n<img width=\"774\" alt=\"image\" src=\"https://github.com/user-attachments/assets/8210fa62-bea5-472c-818c-2fc9d00c6a78\">\r\n\r\nI put in some debugging inside the LSP tagfunc and I noticed that the flags being passed to the tagfunc might not be quite right:\r\n\r\nWhen I press `CTRL-]` with some debugging code inserted, I can see the `flags` argument being passed is empty, but the code looks like it's expecting it to be \"c\" for this to work as expected:\r\nhttps://github.com/neovim/neovim/blob/dad55f5e763f3f2f436a2ae4f4bb1f6c6442bb45/runtime/lua/vim/lsp/_tagfunc.lua#L76-L81\r\n\r\nWhen I look at the calling C code, I added some debugging to this file:\r\nhttps://github.com/neovim/neovim/blob/dad55f5e763f3f2f436a2ae4f4bb1f6c6442bb45/src/nvim/tag.c#L1246\r\n\r\n.. and I can confirm that `g_tag_at_cursor` is false when I press CTRL-], which is why the flags argument of `tagfunc` isn't being passed the \"c\".\r\n\r\nThat's where my  debugging skills have run out unfortunately and I need some help.. :-)\r\n\r\nIs it a bug? Or have I got something not quite right?\r\n\r\n---\r\n\r\nJust in case it's helpful, I checked the LSP server capabilities using `:lua =vim.lsp.get_clients()[1].server_capabilities` and I've attached the result.\r\n\r\n[capabilities.txt](https://github.com/user-attachments/files/16773639/capabilities.txt)\r\n\r\n### Steps to reproduce using \"nvim -u minimal_init.lua\"\r\n\r\n```\r\ngem install ruby-lsp\r\n```\r\n\r\n```ruby\r\n# app/models/my_model.rb\r\nclass MyModel < ApplicationRecord\r\n  include MyModel::HasAssociations # PROBLEM: CTRL-] with cursor on `HasAssociations` jumps to the `Aaa::HasAssociations` file.\r\nend\r\n\r\n# app/models/my_model/has_associations.rb\r\nclass MyModel\r\n  module HasAssociations\r\n  end\r\nend\r\n\r\n# app/models/aaa_model/has_associations.rb\r\nclass AaaModel\r\n  module HasAssociations\r\n  end\r\nend\r\n```\r\n\r\n```lua\r\n# minimal-init.vim\r\n--- CHANGE THESE\r\nlocal pattern = 'ruby'\r\nlocal cmd = {'ruby-lsp'}\r\n-- Add files/folders here that indicate the root of a project\r\nlocal root_markers = {'.git', '.editorconfig'}\r\n-- Change to table with settings if required\r\nlocal settings = vim.empty_dict()\r\n\r\nvim.api.nvim_create_autocmd('FileType', {\r\n  pattern = pattern,\r\n  callback = function(args)\r\n    local match = vim.fs.find(root_markers, { path = args.file, upward = true })[1]\r\n    local root_dir = match and vim.fn.fnamemodify(match, ':p:h') or nil\r\n    vim.lsp.start({\r\n      name = 'ruby-lsp',\r\n      cmd = cmd,\r\n      root_dir = root_dir,\r\n      settings = settings\r\n    })\r\n  end\r\n})\r\n```\r\n\r\n```\r\nnvim -u ~/minimal_init.lua app/models/my_model.rb\r\n```\r\n\r\nStep : Move cursor to `HasAssociations` and press `CTRL-]`\r\n\r\n### Expected behavior\r\n\r\nWhen I put my cursor on `HasAssociations` and press `Ctrl-]` to jump to definition, it jumps to the wrong location: `Aaa::HasAssociations` instead of the correct `MyModel::HasAssociations`.\r\n\r\nFrom what I can see.. it's because the LSP is called using \"workspace/symbol\" instead of \"textDocument/definition\"\r\n\r\n### Neovim version (nvim -v)\r\n\r\nTested on v0.10.1 and latest master (dad55f5e763f3f2f436a2ae4f4bb1f6c6442bb45)\r\n\r\n### Language server name/version\r\n\r\nruby_lsp\r\n\r\n### Operating system/version\r\n\r\nOSX 13.4\r\n\r\n### Log file\r\n\r\nhttps://gist.github.com/dhotson/20117e564c2e9d8678ce6eb498c9f3e5",
    "closed_at": "2024-08-29T04:08:33Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/21532?v=4",
        "events_url": "https://api.github.com/users/dhotson/events{/privacy}",
        "followers_url": "https://api.github.com/users/dhotson/followers",
        "following_url": "https://api.github.com/users/dhotson/following{/other_user}",
        "gists_url": "https://api.github.com/users/dhotson/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/dhotson",
        "id": 21532,
        "login": "dhotson",
        "node_id": "MDQ6VXNlcjIxNTMy",
        "organizations_url": "https://api.github.com/users/dhotson/orgs",
        "received_events_url": "https://api.github.com/users/dhotson/received_events",
        "repos_url": "https://api.github.com/users/dhotson/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/dhotson/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dhotson/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/dhotson",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "If it's helpful.. I built a Debug version of neovim and got a stack trace to try work out how the tagfunc is being called.\r\n\r\n```\r\n0   libsystem_kernel.dylib        \t       0x18d174724 __pthread_kill + 8\r\n1   libsystem_pthread.dylib       \t       0x18d1abc28 pthread_kill + 288\r\n2   libsystem_c.dylib             \t       0x18d0b9ae8 abort + 180\r\n3   nvim                          \t       0x1003da644 find_tagfunc_tags + 704 (tag.c:1251)\r\n4   nvim                          \t       0x1003d835c findtags_apply_tfu + 180 (tag.c:1517)\r\n5   nvim                          \t       0x1003d54d4 find_tags + 1188 (tag.c:2352)\r\n6   nvim                          \t       0x1003d4410 do_tag + 3492 (tag.c:602)\r\n7   nvim                          \t       0x100176538 ex_tag_cmd + 312 (ex_docmd.c:6875)\r\n8   nvim                          \t       0x100172730 ex_tag + 48 (ex_docmd.c:6835)\r\n9   nvim                          \t       0x10016896c execute_cmd0 + 1088 (ex_docmd.c:1714)\r\n10  nvim                          \t       0x100163964 do_one_cmd + 4912 (ex_docmd.c:2358)\r\n11  nvim                          \t       0x1001612c4 do_cmdline + 2840 (ex_docmd.c:667)\r\n12  nvim                          \t       0x1000e85b8 ex_execute + 872 (eval.c:7972)\r\n13  nvim                          \t       0x10016896c execute_cmd0 + 1088 (ex_docmd.c:1714)\r\n14  nvim                          \t       0x100163964 do_one_cmd + 4912 (ex_docmd.c:2358)\r\n15  nvim                          \t       0x1001612c4 do_cmdline + 2840 (ex_docmd.c:667)\r\n16  nvim                          \t       0x10029c148 nv_colon + 472 (normal.c:3173)\r\n17  nvim                          \t       0x100299320 normal_execute + 2388 (normal.c:1231)\r\n18  nvim                          \t       0x1003b1ab4 state_enter + 696 (state.c:101)\r\n19  nvim                          \t       0x100293ce8 normal_enter + 208 (normal.c:520)\r\n20  nvim                          \t       0x100222e98 main + 4728 (main.c:661)\r\n21  dyld                          \t       0x18ce53f28 start + 2236\r\n```\r\n\r\n\r\nCouple of things that stick out to me..\r\n\r\n- Why is it going via `nv_colon`? Isn't that for running colon commands?\r\n- Shouldn't it use `nv_ident` instead? I can see that would probably set the global correctly if it were being called that way:\r\n\r\n\r\n<img width=\"562\" alt=\"image\" src=\"https://github.com/user-attachments/assets/52307a20-9b29-43a5-a6d0-7147028b6ca2\">\r\n\r\n<img width=\"279\" alt=\"image\" src=\"https://github.com/user-attachments/assets/7dc736a6-7d17-452e-be9d-c0f740cf32a6\">\r\n",
            "created_at": "2024-08-28T04:37:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2314247686",
            "id": 2314247686,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6J8J4G",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314247686/reactions"
            },
            "updated_at": "2024-08-28T04:40:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314247686",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21532?v=4",
                "events_url": "https://api.github.com/users/dhotson/events{/privacy}",
                "followers_url": "https://api.github.com/users/dhotson/followers",
                "following_url": "https://api.github.com/users/dhotson/following{/other_user}",
                "gists_url": "https://api.github.com/users/dhotson/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dhotson",
                "id": 21532,
                "login": "dhotson",
                "node_id": "MDQ6VXNlcjIxNTMy",
                "organizations_url": "https://api.github.com/users/dhotson/orgs",
                "received_events_url": "https://api.github.com/users/dhotson/received_events",
                "repos_url": "https://api.github.com/users/dhotson/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dhotson/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dhotson/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dhotson",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Is `<C-]>` mapped to something else in that situation?",
            "created_at": "2024-08-28T04:40:36Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2314266373",
            "id": 2314266373,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6J8OcF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314266373/reactions"
            },
            "updated_at": "2024-08-28T04:40:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314266373",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Ahh interesting.. if I check using `:nmap` I can see this:\r\n```\r\nn  <C-]>       &@<SNR>79_:exe  v:count1.\"tag <SNR>79_<ctag>\"<SNR>79_tagzv<CR>\r\n```\r\n<img width=\"714\" alt=\"image\" src=\"https://github.com/user-attachments/assets/706bf090-19f9-47ed-ac48-c120ae6d3572\">\r\n\r\n\r\n.. I'm not sure what that is though, any ideas?",
            "created_at": "2024-08-28T04:49:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2314307768",
            "id": 2314307768,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6J8Yi4",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314307768/reactions"
            },
            "updated_at": "2024-08-28T04:56:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314307768",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21532?v=4",
                "events_url": "https://api.github.com/users/dhotson/events{/privacy}",
                "followers_url": "https://api.github.com/users/dhotson/followers",
                "following_url": "https://api.github.com/users/dhotson/following{/other_user}",
                "gists_url": "https://api.github.com/users/dhotson/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dhotson",
                "id": 21532,
                "login": "dhotson",
                "node_id": "MDQ6VXNlcjIxNTMy",
                "organizations_url": "https://api.github.com/users/dhotson/orgs",
                "received_events_url": "https://api.github.com/users/dhotson/received_events",
                "repos_url": "https://api.github.com/users/dhotson/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dhotson/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dhotson/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dhotson",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Maybe it's this default from the ruby plugin?\r\n\r\nhttps://github.com/neovim/neovim/blob/3bcd5624beec5d3fd90b9d7977fdc36a61ee1643/runtime/ftplugin/ruby.vim#L237\r\n```\r\n  call s:map('n', '<script><silent>', '<C-]>       <SID>:exe  v:count1.\"tag <SID><ctag>\"<SID>tagzv<CR>')\r\n  call s:map('n', '<script><silent>', 'g<C-]>      <SID>:exe         \"tjump <SID><ctag>\"<SID>tagzv<CR>')\r\n```",
            "created_at": "2024-08-28T04:57:47Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2314315968",
            "id": 2314315968,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6J8ajA",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 1,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314315968/reactions"
            },
            "updated_at": "2024-08-28T05:07:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314315968",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21532?v=4",
                "events_url": "https://api.github.com/users/dhotson/events{/privacy}",
                "followers_url": "https://api.github.com/users/dhotson/followers",
                "following_url": "https://api.github.com/users/dhotson/following{/other_user}",
                "gists_url": "https://api.github.com/users/dhotson/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dhotson",
                "id": 21532,
                "login": "dhotson",
                "node_id": "MDQ6VXNlcjIxNTMy",
                "organizations_url": "https://api.github.com/users/dhotson/orgs",
                "received_events_url": "https://api.github.com/users/dhotson/received_events",
                "repos_url": "https://api.github.com/users/dhotson/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dhotson/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dhotson/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dhotson",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Ok.. sure enough.. if I delete the mappings in the `ftplugin/ruby.vim` file everything starts working as expected:\r\n\r\n```\r\n[DEBUG][2024-08-28 15:04:00] ...m/lsp/client.lua:678\t\"LSP[ruby-lsp]\"\t\"client.request\"\t1\t\"textDocument/definition\"\t{  position = {    character = 21,    line = 1  },  textDocument = {    uri = \"file:///Users/dhotson/Desktop/test/app/models/my_model.rb\"  }}\t<function 1>\t1\r\n```\r\n\r\n.. back to using \"textDocument/definition\" 🙌 \r\n\r\nIs there someone that maintains the Ruby ftplugin that can help me understand why these mapping were added?\r\nI could make a pull request to remove this stuff, but maybe there's a way to conditionally apply it instead..?",
            "created_at": "2024-08-28T05:06:06Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2314324677",
            "id": 2314324677,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6J8crF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314324677/reactions"
            },
            "updated_at": "2024-08-28T05:15:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314324677",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21532?v=4",
                "events_url": "https://api.github.com/users/dhotson/events{/privacy}",
                "followers_url": "https://api.github.com/users/dhotson/followers",
                "following_url": "https://api.github.com/users/dhotson/following{/other_user}",
                "gists_url": "https://api.github.com/users/dhotson/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dhotson",
                "id": 21532,
                "login": "dhotson",
                "node_id": "MDQ6VXNlcjIxNTMy",
                "organizations_url": "https://api.github.com/users/dhotson/orgs",
                "received_events_url": "https://api.github.com/users/dhotson/received_events",
                "repos_url": "https://api.github.com/users/dhotson/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dhotson/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dhotson/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dhotson",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "You can map `<C-]>` to itself before the ftplugin is loaded (e.g. in init.lua), so that the ftplugin will not map `<C-]>`.",
            "created_at": "2024-08-28T05:41:22Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2314362030",
            "id": 2314362030,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6J8lyu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314362030/reactions"
            },
            "updated_at": "2024-08-28T05:42:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2314362030",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Ok, no worries, that's not a bad workaround—thanks for the help!\r\n\r\nI think neovim has the potential to really shine with modern ruby tools / LSP. I think there could be an opportunity to improve the vim-ruby defaults to avoid this pothole I ran into.. but I'm not sure if I have the skills to sort it out. Maybe another time.\r\n\r\nAnyway~! Appreciate the help. Cheers! 😄 ",
            "created_at": "2024-08-29T04:08:33Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2316674758",
            "id": 2316674758,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6KFabG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2316674758/reactions"
            },
            "updated_at": "2024-08-29T04:08:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2316674758",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21532?v=4",
                "events_url": "https://api.github.com/users/dhotson/events{/privacy}",
                "followers_url": "https://api.github.com/users/dhotson/followers",
                "following_url": "https://api.github.com/users/dhotson/following{/other_user}",
                "gists_url": "https://api.github.com/users/dhotson/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/dhotson",
                "id": 21532,
                "login": "dhotson",
                "node_id": "MDQ6VXNlcjIxNTMy",
                "organizations_url": "https://api.github.com/users/dhotson/orgs",
                "received_events_url": "https://api.github.com/users/dhotson/received_events",
                "repos_url": "https://api.github.com/users/dhotson/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/dhotson/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dhotson/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/dhotson",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "This has frustrated me with ruby, as well. I'm happy now to have found a solution (mapping `<C-]>` to itself, as suggested above), but wanted to second dhotson's suggestion that there may be a way to improve the default experience here, such as by making lsp-based lookups take priority over older methods when available.\n\nFor this specific case, another workaround is to set `vim.g.no_ruby_maps = true`. I'm testing this out right now; we'll see if there are other mappings from the ruby ftplugin that I don't want to lose.\n\nThanks dhotson for raising and investigating this, and zeertzjq for the workaround!",
            "created_at": "2025-01-15T17:29:07Z",
            "html_url": "https://github.com/neovim/neovim/issues/30160#issuecomment-2593541071",
            "id": 2593541071,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30160",
            "node_id": "IC_kwDOAPphoM6alkvP",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2593541071/reactions"
            },
            "updated_at": "2025-01-15T17:29:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2593541071",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/524994?v=4",
                "events_url": "https://api.github.com/users/mmirus/events{/privacy}",
                "followers_url": "https://api.github.com/users/mmirus/followers",
                "following_url": "https://api.github.com/users/mmirus/following{/other_user}",
                "gists_url": "https://api.github.com/users/mmirus/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mmirus",
                "id": 524994,
                "login": "mmirus",
                "node_id": "MDQ6VXNlcjUyNDk5NA==",
                "organizations_url": "https://api.github.com/users/mmirus/orgs",
                "received_events_url": "https://api.github.com/users/mmirus/received_events",
                "repos_url": "https://api.github.com/users/mmirus/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mmirus/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mmirus/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mmirus",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 8,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/30160/comments",
    "created_at": "2024-08-28T01:36:41Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/30160/events",
    "html_url": "https://github.com/neovim/neovim/issues/30160",
    "id": 2490687306,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/30160/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6UdN9K",
    "number": 30160,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/neovim/neovim/issues/30160/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/30160/timeline",
    "title": "LSP jump-to-definition using CTRL-] is slightly inaccurate when editing Ruby code",
    "updated_at": "2025-01-15T17:29:38Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/30160",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/21532?v=4",
        "events_url": "https://api.github.com/users/dhotson/events{/privacy}",
        "followers_url": "https://api.github.com/users/dhotson/followers",
        "following_url": "https://api.github.com/users/dhotson/following{/other_user}",
        "gists_url": "https://api.github.com/users/dhotson/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/dhotson",
        "id": 21532,
        "login": "dhotson",
        "node_id": "MDQ6VXNlcjIxNTMy",
        "organizations_url": "https://api.github.com/users/dhotson/orgs",
        "received_events_url": "https://api.github.com/users/dhotson/received_events",
        "repos_url": "https://api.github.com/users/dhotson/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/dhotson/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dhotson/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/dhotson",
        "user_view_type": "public"
    }
}
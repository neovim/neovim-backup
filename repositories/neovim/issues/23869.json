{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\r\n\r\n`listchar` highlight and `:syn` highlight are mixed up.\r\n\r\n### Steps to reproduce\r\n\r\n```\r\nnvim --clean -S <(tee <<'EOF'\r\n    set list listchars=trail:-\r\n    call setline(1, '   ')\r\n    syn match Bold \"^.*$\"\r\n    hi Bold cterm=bold\r\n    hi Whitespace cterm=NONE ctermfg=red ctermbg=NONE \" nvim uses this\r\n    hi SpecialKey cterm=NONE ctermfg=red ctermbg=NONE \" vim uses this\r\nEOF\r\n)\r\n```\r\nThe `-` characters for trailing whitespace are bold, while it shouldn't be.\r\n![image](https://github.com/neovim/neovim/assets/19489738/30715f55-8dca-44b8-b0ca-ece00dcc67c3)\r\n\r\n\r\n\r\n### Expected behavior\r\n\r\n![image](https://github.com/neovim/neovim/assets/19489738/4c00e09b-5e49-458c-92e8-42a3c99bb4df)\r\n(vim 9.0.1580)\r\n\r\n### Neovim version (nvim -v)\r\n\r\n0.10-dev 68e2d722959dadc596edb9320bcdede38659db07\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nno, vim 9.0.1580\r\n\r\n### Operating system/version\r\n\r\nubuntu 22.04\r\n\r\n### Terminal name/version\r\n\r\nGNOME Terminal 3.44.0 using VTE 0.68.0 +BIDI +GNUTLS +ICU +SYSTEMD\r\n\r\n### $TERM environment variable\r\n\r\ntmux-256color\r\n\r\n### Installation\r\n\r\nubuntu ppa",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Looks like this bug actually exists in versions as early as v0.2.2 and is not a recent regression.",
            "created_at": "2023-09-22T03:13:04Z",
            "html_url": "https://github.com/neovim/neovim/issues/23869#issuecomment-1730744077",
            "id": 1730744077,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23869",
            "node_id": "IC_kwDOAPphoM5nKQ8N",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730744077/reactions"
            },
            "updated_at": "2023-09-22T03:13:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730744077",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I think this is actually a regression from https://github.com/neovim/neovim/commit/33486c8ebd57074d9c92c4de06ea4dcab573c01e",
            "created_at": "2023-09-22T03:23:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/23869#issuecomment-1730749818",
            "id": 1730749818,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23869",
            "node_id": "IC_kwDOAPphoM5nKSV6",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730749818/reactions"
            },
            "updated_at": "2023-09-22T03:23:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730749818",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "There are other difference between Vim and Nvim in 'listchars' highlighting:\r\n- `Visual` highlight is combined with 'listchars' highlight instead of overriding it\r\n- `Search` highlight is combined with 'listchars' highlight instead of overriding it\r\n\r\nAnd those seem better. So is this really a problem?",
            "created_at": "2023-09-22T04:02:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/23869#issuecomment-1730770806",
            "id": 1730770806,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23869",
            "node_id": "IC_kwDOAPphoM5nKXd2",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730770806/reactions"
            },
            "updated_at": "2023-09-22T04:02:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730770806",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think combining makes sense for Visual/Search because otherwise the listchar text won't be distinguishable from normal text. But what about not showing listchars on a region when Visual/Search is active on that region? I think this at least makes sense for trail.\r\n\r\nRegarding the interaction with :syn (and extmark-based syntax highlighting), I personally prefer to have listchar highlight not affected by the context so that it's discernible on some colorschemes (e.g. builtin `quiet` scheme), but I don't strongly object to the other option. ",
            "created_at": "2023-09-22T05:37:54Z",
            "html_url": "https://github.com/neovim/neovim/issues/23869#issuecomment-1730828902",
            "id": 1730828902,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23869",
            "node_id": "IC_kwDOAPphoM5nKlpm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730828902/reactions"
            },
            "updated_at": "2023-09-22T05:37:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730828902",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/19489738?v=4",
                "events_url": "https://api.github.com/users/tomtomjhj/events{/privacy}",
                "followers_url": "https://api.github.com/users/tomtomjhj/followers",
                "following_url": "https://api.github.com/users/tomtomjhj/following{/other_user}",
                "gists_url": "https://api.github.com/users/tomtomjhj/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tomtomjhj",
                "id": 19489738,
                "login": "tomtomjhj",
                "node_id": "MDQ6VXNlcjE5NDg5NzM4",
                "organizations_url": "https://api.github.com/users/tomtomjhj/orgs",
                "received_events_url": "https://api.github.com/users/tomtomjhj/received_events",
                "repos_url": "https://api.github.com/users/tomtomjhj/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tomtomjhj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tomtomjhj/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tomtomjhj",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "not sure. if same as vim not combine syntax and extmar, this is enough :thinking: ?\r\n\r\n```diff\r\n           wlv.n_attr = 1;\r\n           wlv.extra_attr = win_hl_attr(wp, HLF_0);\r\n+          if (decor_attr) {\r\n+            wlv.char_attr = 0;\r\n+          }\r\n```\r\n",
            "created_at": "2023-09-22T06:01:32Z",
            "html_url": "https://github.com/neovim/neovim/issues/23869#issuecomment-1730846837",
            "id": 1730846837,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23869",
            "node_id": "IC_kwDOAPphoM5nKqB1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730846837/reactions"
            },
            "updated_at": "2023-09-22T06:01:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730846837",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Every place where `!attr_pri` is removed in https://github.com/neovim/neovim/commit/33486c8ebd57074d9c92c4de06ea4dcab573c01e should need this change then.\r\n\r\nBut this will also remove other types of highlighting (e.g. extmarks, Visual).\r\n\r\nPlus, the following may be a better place to change this behavior:\r\n```c\r\n    // Don't override visual selection highlighting.\r\n    if (wlv.n_attr > 0 && wlv.draw_state == WL_LINE && !search_attr_from_match) {\r\n      wlv.char_attr = hl_combine_attr(wlv.char_attr, wlv.extra_attr);\r\n      if (wlv.reset_extra_attr) {\r\n        wlv.reset_extra_attr = false;\r\n        wlv.extra_attr = 0;\r\n        // search_attr_from_match can be restored now that the extra_attr has been applied\r\n        search_attr_from_match = saved_search_attr_from_match;\r\n      }\r\n    }\r\n```",
            "created_at": "2023-09-22T06:11:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/23869#issuecomment-1730855109",
            "id": 1730855109,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23869",
            "node_id": "IC_kwDOAPphoM5nKsDF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730855109/reactions"
            },
            "updated_at": "2023-09-22T06:16:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730855109",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "not sure there should clean reset extra. `decor_attr` will set by `get_syntax_start` value is 66. vim use `syntax_attr` we use `decor_attr` for syntax and extmark right?  and another things is although it does not become bold in appearance, but the highlight group is become bold both on neovim and vim by using `echo map(synstack(line('.'), col('.')), 'synIDattr(v:val, \"name\")')`  :thinking: ",
            "created_at": "2023-09-22T06:37:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/23869#issuecomment-1730880718",
            "id": 1730880718,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/23869",
            "node_id": "IC_kwDOAPphoM5nKyTO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730880718/reactions"
            },
            "updated_at": "2023-09-22T06:37:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1730880718",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 7,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/23869/comments",
    "created_at": "2023-06-01T13:43:56Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/23869/events",
    "html_url": "https://github.com/neovim/neovim/issues/23869",
    "id": 1736362816,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "FBCA04",
            "default": false,
            "description": "issue needs attention from an expert, or PR proposes significant changes to architecture or API",
            "id": 212680983,
            "name": "needs:discussion",
            "node_id": "MDU6TGFiZWwyMTI2ODA5ODM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:discussion"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "regex syntax or non-regex parsing, lpeg, grammars",
            "id": 531600085,
            "name": "syntax",
            "node_id": "MDU6TGFiZWw1MzE2MDAwODU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/syntax"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1786207367,
            "name": "highlight",
            "node_id": "MDU6TGFiZWwxNzg2MjA3MzY3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/highlight"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/23869/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5nfstA",
    "number": 23869,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/23869/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/23869/timeline",
    "title": "`listchar` highlight and `:syn` highlight mixed up",
    "updated_at": "2025-01-19T11:32:33Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/23869",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/19489738?v=4",
        "events_url": "https://api.github.com/users/tomtomjhj/events{/privacy}",
        "followers_url": "https://api.github.com/users/tomtomjhj/followers",
        "following_url": "https://api.github.com/users/tomtomjhj/following{/other_user}",
        "gists_url": "https://api.github.com/users/tomtomjhj/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tomtomjhj",
        "id": 19489738,
        "login": "tomtomjhj",
        "node_id": "MDQ6VXNlcjE5NDg5NzM4",
        "organizations_url": "https://api.github.com/users/tomtomjhj/orgs",
        "received_events_url": "https://api.github.com/users/tomtomjhj/received_events",
        "repos_url": "https://api.github.com/users/tomtomjhj/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tomtomjhj/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tomtomjhj/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tomtomjhj",
        "user_view_type": "public"
    }
}
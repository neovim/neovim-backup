{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "Something that has always bothered me about vim is that when you undo you often do not get your previous cursor position back.  For example, given the following file (with the ^ character representing where the cursor is)\r\n\r\n```\r\nthis is a test\r\n   ^\r\n```\r\n\r\nIf you hit `diwu`, you get this:\r\n\r\n```\r\nthis is a test\r\n^\r\n```\r\n\r\nWhereas what I would expect is for the cursor to be back at the original position.  In many cases it does follow this behaviour but in many cases it does not.  For example, typing `itest<esc>u` preserves the cursor position but typing `atest<esc>u` does not.  Typing `Du` preserves position but typing `d^u` does not.  Maybe there is some logic behind this behaviour that I'm not seeing but to me it seems odd.\r\n\r\nIs this a change worth considering?  Or maybe this something better suited as a plugin?",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Doing this indiscriminately could break some plugins, but we could add `v:event` data to the `TextChanged[I]` event to make it trivial to get this behavior through a small script. One would need:\r\n\r\n- cursor position before the undo\r\n- dimensions (row, col) of the affected text\r\n\r\nWe should first write down what's missing from Vim that prevents this from being achieved. Are the `'[` and `']` marks not providing enough information? \r\n\r\nOne problem I can think of: The cursor position can be tracked on each TextChanged event already, but the script doesn't know if TextChanged was caused by `undo` or  a normal edit. So we could make a `v:event.undo` boolean available to the TextChanged event.\r\n\r\nWould anything more than that be needed?",
            "created_at": "2017-01-22T09:23:58Z",
            "html_url": "https://github.com/neovim/neovim/issues/5989#issuecomment-274319482",
            "id": 274319482,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/5989",
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDMxOTQ4Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 1,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/274319482/reactions"
            },
            "updated_at": "2017-01-22T09:24:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/274319482",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/5989/comments",
    "created_at": "2017-01-21T23:53:06Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/5989/events",
    "html_url": "https://github.com/neovim/neovim/issues/5989",
    "id": 202348041,
    "labels": [
        {
            "color": "C5DEF5",
            "default": false,
            "description": "text objects, normal commands",
            "id": 5826986707,
            "name": "normal-mode",
            "node_id": "LA_kwDOAPphoM8AAAABW1DC0w",
            "url": "https://api.github.com/repos/neovim/neovim/labels/normal-mode"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/5989/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 726,
        "created_at": "2014-05-10T20:43:04Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "Low priority items. We plan to work on this but don't have a target date.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/6",
        "id": 655037,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/6/labels",
        "node_id": "MDk6TWlsZXN0b25lNjU1MDM3",
        "number": 6,
        "open_issues": 630,
        "state": "open",
        "title": "backlog",
        "updated_at": "2025-07-07T03:51:31Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/6"
    },
    "node_id": "MDU6SXNzdWUyMDIzNDgwNDE=",
    "number": 5989,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 6,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 6,
        "url": "https://api.github.com/repos/neovim/neovim/issues/5989/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/5989/timeline",
    "title": "Restore cursor position when triggering undo",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-07-02T08:58:23Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/5989",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/810762?v=4",
        "events_url": "https://api.github.com/users/svermeulen/events{/privacy}",
        "followers_url": "https://api.github.com/users/svermeulen/followers",
        "following_url": "https://api.github.com/users/svermeulen/following{/other_user}",
        "gists_url": "https://api.github.com/users/svermeulen/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/svermeulen",
        "id": 810762,
        "login": "svermeulen",
        "node_id": "MDQ6VXNlcjgxMDc2Mg==",
        "organizations_url": "https://api.github.com/users/svermeulen/orgs",
        "received_events_url": "https://api.github.com/users/svermeulen/received_events",
        "repos_url": "https://api.github.com/users/svermeulen/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/svermeulen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/svermeulen/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/svermeulen",
        "user_view_type": "public"
    }
}
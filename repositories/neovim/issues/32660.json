{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nHi,\n\na few days ago I got this weird and hard to diagnose behavior, that the syntax highlighting (I think it's tree sitter, not LSP) starts to flicker really fast (as in with every draw call). Sometimes this also blocks neovim from reacting to user inputs, even though the CPU usage is pretty low.\n\n### Steps to reproduce\n\n(I will try and create a minimal repro later, right now I'm a bit pressed for time.)\n\n- have treesitter parser for `vue` and `typescript` or `javascript` installed\n- open a `.vue` file large enough to fill the editor viewport at least twice, vertically (ideally with the template section and the script section each taking up more space than the viewport)\n- split the buffer into a new window\n- scroll the second window, so that one window shows one injected language section and the other shows the other injected language section\n- observe flickering (do not do this, if you are suffering from epilepsy) \n\n### Expected behavior\n\nThe highlighting should not flicker and not block neovim from reacting at all.\n\n### Nvim version (nvim -v)\n\nNVIM v0.11.0-dev-1860+g877f3b7288\n\n### Vim (not Nvim) behaves the same?\n\nnot tested\n\n### Operating system/version\n\nWindows 11 24H2 26100.3194\n\n### Terminal name/version\n\nwezterm 20240203-110809-5046fc22\n\n### $TERM environment variable\n\nN/A\n\n### Installation\n\nwinget (nightly neovim)",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "Here is a recording of the problem. Again: You might not want to watch this, if you are suffering from epilepsy.\nhttps://github.com/user-attachments/assets/9ad7898a-1096-49a1-997e-fa5b9170297a\n\nThe flickering is even more pronounced when I run neovide instead, due to a higher frame rate.",
            "created_at": "2025-02-27T14:17:32Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2688095011",
            "id": 2688095011,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gORMj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2688095011/reactions"
            },
            "updated_at": "2025-02-27T16:18:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2688095011",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9497302?v=4",
                "events_url": "https://api.github.com/users/kmoschcau/events{/privacy}",
                "followers_url": "https://api.github.com/users/kmoschcau/followers",
                "following_url": "https://api.github.com/users/kmoschcau/following{/other_user}",
                "gists_url": "https://api.github.com/users/kmoschcau/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kmoschcau",
                "id": 9497302,
                "login": "kmoschcau",
                "node_id": "MDQ6VXNlcjk0OTczMDI=",
                "organizations_url": "https://api.github.com/users/kmoschcau/orgs",
                "received_events_url": "https://api.github.com/users/kmoschcau/received_events",
                "repos_url": "https://api.github.com/users/kmoschcau/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kmoschcau/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kmoschcau/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kmoschcau",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Need repro steps starting with `nvim --clean` .",
            "created_at": "2025-02-27T14:28:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2688125232",
            "id": 2688125232,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gOYkw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2688125232/reactions"
            },
            "updated_at": "2025-02-27T14:28:10Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2688125232",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This is likely because `LanguageTree._processed_injection_range` only holds a single range, and each parse attempt from the highlighter (for different windows) sets the range to that specific window's range. Maybe to allow multiple ranges, this property could be a list of ranges, or maybe something smarter like a tree that allows for efficient overlap queries",
            "created_at": "2025-02-28T06:10:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2689813636",
            "id": 2689813636,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gU0yE",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2689813636/reactions"
            },
            "updated_at": "2025-02-28T06:10:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2689813636",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@ribru17 do you still need me to come up with `nvim --clean` repro steps? You already seem to have an idea where to look.",
            "created_at": "2025-02-28T07:45:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2689955729",
            "id": 2689955729,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gVXeR",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2689955729/reactions"
            },
            "updated_at": "2025-02-28T07:45:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2689955729",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9497302?v=4",
                "events_url": "https://api.github.com/users/kmoschcau/events{/privacy}",
                "followers_url": "https://api.github.com/users/kmoschcau/followers",
                "following_url": "https://api.github.com/users/kmoschcau/following{/other_user}",
                "gists_url": "https://api.github.com/users/kmoschcau/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kmoschcau",
                "id": 9497302,
                "login": "kmoschcau",
                "node_id": "MDQ6VXNlcjk0OTczMDI=",
                "organizations_url": "https://api.github.com/users/kmoschcau/orgs",
                "received_events_url": "https://api.github.com/users/kmoschcau/received_events",
                "repos_url": "https://api.github.com/users/kmoschcau/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kmoschcau/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kmoschcau/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kmoschcau",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Maybe @justinmk would still prefer one for testing purposes👍I can try and reproduce without, so no rush from my end\n\nEdit: even just a minimal vue file that caused this would help",
            "created_at": "2025-02-28T14:54:50Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2690844873",
            "id": 2690844873,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gYwjJ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2690844873/reactions"
            },
            "updated_at": "2025-02-28T17:10:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2690844873",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Sure, I got it to trigger with the following file. Just split the window and scroll one window to the top and the other to the bottom of the file.\nThough side note: It triggers less often as with the actual files I'm working on. If this file isn't enough, I can see about cleaning one of the work files of proprietary information and posting that as well.\n\nIn order to add `nvim --clean` repro steps I first need to figure out how to install the vue parser without installing nvim-treesitter first.\n\n```vue\n<script setup lang=\"ts\">\nimport HelloWorld from \"./components/HelloWorld.vue\";\nimport TheWelcome from \"./components/TheWelcome.vue\";\n\nconst foo = [];\n\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\nfoo.push(1);\n</script>\n\n<template>\n  <header>\n    <img\n      alt=\"Vue logo\"\n      class=\"logo\"\n      src=\"./assets/logo.svg\"\n      width=\"125\"\n      height=\"125\"\n    />\n\n    <div class=\"wrapper\">\n      <HelloWorld msg=\"You did it!\" />\n    </div>\n  </header>\n\n  <main>\n    <TheWelcome />\n  </main>\n</template>\n\n<style scoped>\nheader {\n  line-height: 1.5;\n}\n\n.logo {\n  display: block;\n  margin: 0 auto 2rem;\n}\n\n@media (min-width: 1024px) {\n  header {\n    display: flex;\n    place-items: center;\n    padding-right: calc(var(--section-gap) / 2);\n  }\n\n  .logo {\n    margin: 0 2rem 0 0;\n  }\n\n  header .wrapper {\n    display: flex;\n    place-items: flex-start;\n    flex-wrap: wrap;\n  }\n}\n</style>\n```",
            "created_at": "2025-03-01T11:14:49Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692152619",
            "id": 2692152619,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gdv0r",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692152619/reactions"
            },
            "updated_at": "2025-03-01T11:16:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692152619",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9497302?v=4",
                "events_url": "https://api.github.com/users/kmoschcau/events{/privacy}",
                "followers_url": "https://api.github.com/users/kmoschcau/followers",
                "following_url": "https://api.github.com/users/kmoschcau/following{/other_user}",
                "gists_url": "https://api.github.com/users/kmoschcau/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kmoschcau",
                "id": 9497302,
                "login": "kmoschcau",
                "node_id": "MDQ6VXNlcjk0OTczMDI=",
                "organizations_url": "https://api.github.com/users/kmoschcau/orgs",
                "received_events_url": "https://api.github.com/users/kmoschcau/received_events",
                "repos_url": "https://api.github.com/users/kmoschcau/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kmoschcau/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kmoschcau/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kmoschcau",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "I can repro this exactly. Seeing with `kickstart.nvim` installed, though usually when scrolling up and down with the keyboard and only with window splits. Even when neovim is unfocussed and idle, the flicker still occasionally occurs in the lower pane. During the flicker text loses its colors and styling (bold, italic etc).\n\nSo far I've only seen this, at least obviously, with .vue SFC files.\n\nI've noticed that occasionally the flicker can 'freeze' in the uncolored/unformatted state when the which-key popup is waiting for input.\n\nFurther tests carried out:\n- running `nvim --clean` the problem disappears. With --clean am I correct in assuming that treesitter is not used and neovim defers back to regex based syntax parsing?\n- disabling all other plugins except treesitter and the problem remains\n- leaving kickstart.nvim as upstream and disabling treesitter alone the problem disappears\n- with treesitter enabled, removing the nightly build of neovim and replacing with 10.4 release build, the problem disappears\n\nIt seems the issue is a change since the 10.4 release that's causing an issue with treesitter either only or mostly visible with .vue SFC files.\n\nRunning neovim latest nightly on windows 10, testing with vanilla kickstart.nvim. Tested with Wezterm and latest MS Terminal preview (same result)\n\nCome to think of it I've only seen this issue appear over the last few weeks, and @ribru17 has made a number of commits eg. 0c9c140f91c97dfacf8648a5fee90b06d8c50bbc cbad2c662873bf791309505418407c804db219b7 to refactor/improve treesitter over that time. I don't have a nightly from a few weeks ago and don't have a build setup in windows, perhaps someone could wind back a few weeks to pinpoint? Everything is fine at neovim 10.4.",
            "created_at": "2025-03-01T22:45:19Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692454191",
            "id": 2692454191,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6ge5cv",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692454191/reactions"
            },
            "updated_at": "2025-03-01T23:36:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692454191",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4213509?v=4",
                "events_url": "https://api.github.com/users/qgates/events{/privacy}",
                "followers_url": "https://api.github.com/users/qgates/followers",
                "following_url": "https://api.github.com/users/qgates/following{/other_user}",
                "gists_url": "https://api.github.com/users/qgates/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/qgates",
                "id": 4213509,
                "login": "qgates",
                "node_id": "MDQ6VXNlcjQyMTM1MDk=",
                "organizations_url": "https://api.github.com/users/qgates/orgs",
                "received_events_url": "https://api.github.com/users/qgates/received_events",
                "repos_url": "https://api.github.com/users/qgates/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/qgates/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/qgates/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/qgates",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Yeah, this would be due to #32482",
            "created_at": "2025-03-02T00:10:00Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692480571",
            "id": 2692480571,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6ge_47",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692480571/reactions"
            },
            "updated_at": "2025-03-02T00:10:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692480571",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I think a good way to fix this would be to store all ranges for which injections have been processed in an interval tree. We can reset the tree as we do now, and when we run the injection query over a new region we can add that range to the tree for efficient lookups in future `is_valid()` calls. Can make use of the data structure in #32692",
            "created_at": "2025-03-02T07:38:16Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692603524",
            "id": 2692603524,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gfd6E",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692603524/reactions"
            },
            "updated_at": "2025-03-02T07:38:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692603524",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "I'm using `vim.g._ts_force_sync_parsing = true` as a temporary workaround.",
            "created_at": "2025-03-02T13:38:06Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692738191",
            "id": 2692738191,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gf-yP",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692738191/reactions"
            },
            "updated_at": "2025-03-02T13:38:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692738191",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2001232?v=4",
                "events_url": "https://api.github.com/users/mpal9000/events{/privacy}",
                "followers_url": "https://api.github.com/users/mpal9000/followers",
                "following_url": "https://api.github.com/users/mpal9000/following{/other_user}",
                "gists_url": "https://api.github.com/users/mpal9000/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mpal9000",
                "id": 2001232,
                "login": "mpal9000",
                "node_id": "MDQ6VXNlcjIwMDEyMzI=",
                "organizations_url": "https://api.github.com/users/mpal9000/orgs",
                "received_events_url": "https://api.github.com/users/mpal9000/received_events",
                "repos_url": "https://api.github.com/users/mpal9000/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mpal9000/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mpal9000/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mpal9000",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "@ribru17 I'm left wondering why this problem is particularly visible with vue files. I'm often splitting via Ctrl-W ] and only really see this issue working with them. Is this more visible in the case where different syntaxes are applied, eg. in vue files the template section being html flavoured but the script section being js/ts?",
            "created_at": "2025-03-02T17:19:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692824745",
            "id": 2692824745,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6ggT6p",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692824745/reactions"
            },
            "updated_at": "2025-03-02T17:19:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692824745",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4213509?v=4",
                "events_url": "https://api.github.com/users/qgates/events{/privacy}",
                "followers_url": "https://api.github.com/users/qgates/followers",
                "following_url": "https://api.github.com/users/qgates/following{/other_user}",
                "gists_url": "https://api.github.com/users/qgates/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/qgates",
                "id": 4213509,
                "login": "qgates",
                "node_id": "MDQ6VXNlcjQyMTM1MDk=",
                "organizations_url": "https://api.github.com/users/qgates/orgs",
                "received_events_url": "https://api.github.com/users/qgates/received_events",
                "repos_url": "https://api.github.com/users/qgates/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/qgates/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/qgates/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/qgates",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Good question, I think in general this is more likely to happen if the parse attempts take place across multiple event loop iterations (are slower). Having a lot of injections definitely doesn't help, and it may be the case that the vue parser has a lot of states which would make it slower",
            "created_at": "2025-03-02T17:32:34Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692828942",
            "id": 2692828942,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6ggU8O",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692828942/reactions"
            },
            "updated_at": "2025-03-02T17:32:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692828942",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Although I experience the same issue as described above, with markdown and injected syntaxes (i.e. flickering while scrolling, using splits that show different parts of a document), I see flickering also while typing (even without splits). Not sure if the cause is the same. Reproduction steps:\n\n1. run `nvim --clean`\n2. `:set ft=markdown`\n3. `:lua vim.treesitter.start()`\n4. paste the markdown content below, to the empty buffer\n5. duplicate the markdown content a few times (I can see the flickering easily, when the buffer contains ~300 lines)\n6. start typing at the bottom a new markdown paragraph\n\nNotes:\n\n- the flickering is more visible when opening the same buffer, in a split window\n- `:lua vim.g._ts_force_sync_parsing = true` prevents the flickering in this case as well\n- nvim: `v0.11.0-dev-1876+g86046c5a31`, tree-sitter: `v0.25.2`\n\nSample content:\n\n````md\n## Title\n\nLorem ipsum odor amet, consectetuer adipiscing elit. Sem pulvinar curae a eleifend feugiat. Potenti urna magna cursus placerat conubia gravida egestas nibh. Efficitur felis inceptos pulvinar; dapibus primis mi vivamus pharetra. Hendrerit molestie vehicula varius iaculis nisi orci porta convallis torquent. Mollis tortor fringilla non aliquet lobortis facilisi. Bibendum habitant urna quam donec posuere dis primis ad.\n\n```lua\nfunction greet(name)\n  print(\"Hello, \" .. name .. \"!\")\nend\n\ngreet(\"Alice\")\n\nperson = {\n  name = \"Bob\",\n  age = 25,\n}\n\nprint(\"Name: \" .. person.name)\nprint(\"Age: \" .. person.age)\n\nlocal sum = 0\nfor i = 1, 5 do\n  sum = sum + i\nend\nprint(\"Sum of numbers from 1 to 5: \" .. sum)\n\nlocal counter = 1\nwhile counter <= 5 do\n  print(\"Counter value: \" .. counter)\n  counter = counter + 1\nend\n```\n````",
            "created_at": "2025-03-02T19:40:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2692874194",
            "id": 2692874194,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6ggf_S",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692874194/reactions"
            },
            "updated_at": "2025-03-02T21:35:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2692874194",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2001232?v=4",
                "events_url": "https://api.github.com/users/mpal9000/events{/privacy}",
                "followers_url": "https://api.github.com/users/mpal9000/followers",
                "following_url": "https://api.github.com/users/mpal9000/following{/other_user}",
                "gists_url": "https://api.github.com/users/mpal9000/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mpal9000",
                "id": 2001232,
                "login": "mpal9000",
                "node_id": "MDQ6VXNlcjIwMDEyMzI=",
                "organizations_url": "https://api.github.com/users/mpal9000/orgs",
                "received_events_url": "https://api.github.com/users/mpal9000/received_events",
                "repos_url": "https://api.github.com/users/mpal9000/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mpal9000/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mpal9000/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mpal9000",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> I'm using `vim.g._ts_force_sync_parsing = true` as a temporary workaround.\n\nI can confirm that this works as a workaround for me as well.",
            "created_at": "2025-03-03T07:26:42Z",
            "html_url": "https://github.com/neovim/neovim/issues/32660#issuecomment-2693494954",
            "id": 2693494954,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32660",
            "node_id": "IC_kwDOAPphoM6gi3iq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2693494954/reactions"
            },
            "updated_at": "2025-03-03T07:26:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2693494954",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9497302?v=4",
                "events_url": "https://api.github.com/users/kmoschcau/events{/privacy}",
                "followers_url": "https://api.github.com/users/kmoschcau/followers",
                "following_url": "https://api.github.com/users/kmoschcau/following{/other_user}",
                "gists_url": "https://api.github.com/users/kmoschcau/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kmoschcau",
                "id": 9497302,
                "login": "kmoschcau",
                "node_id": "MDQ6VXNlcjk0OTczMDI=",
                "organizations_url": "https://api.github.com/users/kmoschcau/orgs",
                "received_events_url": "https://api.github.com/users/kmoschcau/received_events",
                "repos_url": "https://api.github.com/users/kmoschcau/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kmoschcau/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kmoschcau/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kmoschcau",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 14,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/32660/comments",
    "created_at": "2025-02-27T14:11:22Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/32660/events",
    "html_url": "https://github.com/neovim/neovim/issues/32660",
    "id": 2884640659,
    "labels": [
        {
            "color": "FBCA04",
            "default": false,
            "description": "We need minimal steps to reproduce the issue",
            "id": 298863445,
            "name": "needs:repro",
            "node_id": "MDU6TGFiZWwyOTg4NjM0NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:repro"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 1799626557,
            "name": "treesitter",
            "node_id": "MDU6TGFiZWwxNzk5NjI2NTU3",
            "url": "https://api.github.com/repos/neovim/neovim/labels/treesitter"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/32660/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6r8B-T",
    "number": 32660,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 4,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 4,
        "url": "https://api.github.com/repos/neovim/neovim/issues/32660/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/32660/timeline",
    "title": "Syntax highlight flicker when same buffer open in multiple windows at different scroll positions",
    "updated_at": "2025-03-03T07:26:55Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/32660",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/9497302?v=4",
        "events_url": "https://api.github.com/users/kmoschcau/events{/privacy}",
        "followers_url": "https://api.github.com/users/kmoschcau/followers",
        "following_url": "https://api.github.com/users/kmoschcau/following{/other_user}",
        "gists_url": "https://api.github.com/users/kmoschcau/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/kmoschcau",
        "id": 9497302,
        "login": "kmoschcau",
        "node_id": "MDQ6VXNlcjk0OTczMDI=",
        "organizations_url": "https://api.github.com/users/kmoschcau/orgs",
        "received_events_url": "https://api.github.com/users/kmoschcau/received_events",
        "repos_url": "https://api.github.com/users/kmoschcau/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/kmoschcau/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/kmoschcau/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/kmoschcau",
        "user_view_type": "public"
    }
}
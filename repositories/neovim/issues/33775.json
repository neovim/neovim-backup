{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nWhen using the new `require('vim._extui').enable({})` with `vim.o.cmdheight = 0` and entering the cmdline (with, for example, `:`), the cmdline + statusline sometimes covers the last line of the buffer and sometimes it pushes the buffer one line up. This happens with the new statusline and with a custom one, so I guess this is a bug related with `vim._extui`.\n\nApparently the change of behaviour depends on where the cursor is. If it's in the first half of the screen the cmd + statusline covers the last line, if the cursor is in the second half of the screen it pushes the buffer one line up.\n\n### Steps to reproduce\n\n1. Create repro.lua with\n```lua\nrequire('vim._extui').enable({})\nvim.o.cmdheight = 0\n```\n2. nvim --clean -u repro.lua file (must be a file that covers the whole screen)\n3. Press `:` in the first line of the buffer\n4. `<esc>` and press `:` again but at the end of the buffer (or the last visible line in the screen)\n\n### Expected behavior\n\nThe behaviour should be the same no matter where the cursor is located. My prefered option would be to just cover the last line, so to avoid moving the position of the code/text.\n\n### Nvim version (nvim -v)\n\nNVIM v0.12.0-dev-277+g3c7c824bdc\n\n### Vim (not Nvim) behaves the same?\n\nNot Vim related\n\n### Operating system/version\n\nWindows 10 and WSL Ubuntu\n\n### Terminal name/version\n\nWezterm\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nBuild from repo",
    "closed_at": "2025-05-02T17:46:32Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
        "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
        "followers_url": "https://api.github.com/users/luukvbaal/followers",
        "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
        "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/luukvbaal",
        "id": 31730729,
        "login": "luukvbaal",
        "node_id": "MDQ6VXNlcjMxNzMwNzI5",
        "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
        "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
        "repos_url": "https://api.github.com/users/luukvbaal/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/luukvbaal",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> My prefered option would be to just cover the last line, so to avoid moving the position of the code/text.\n\nThis can be achieved with `:set splitkeep=screen`, so I'm not sure if we need to handle this. Though it is a bit weird it happens in the lower part of the screen even if the cursor would not be hidden. I'll look into it, thanks for reporting.",
            "created_at": "2025-05-02T12:43:21Z",
            "html_url": "https://github.com/neovim/neovim/issues/33775#issuecomment-2847117583",
            "id": 2847117583,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33775",
            "node_id": "IC_kwDOAPphoM6ps5EP",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2847117583/reactions"
            },
            "updated_at": "2025-05-02T12:44:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2847117583",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Oh, I forgot to mention about `splitkeep`. I did try and doing `:set splitkeep=screen` fixes it to always cover the last line.\n\nI don't like that option when spliting my windows with `<C-w>s` (I always want to see my current line, so I use the default `splitkeep=cursor`). But in the case of the cmdline, as it is only one line and my current line is almost always not that one, I would prefer a `splitkeep=screen` behaviour there. I would think most will prefer that too.\n\nBut in any case that's not a bug, just a personal preference (and maybe it can be hacked with a custom keymap for spliting?).",
            "created_at": "2025-05-02T13:01:43Z",
            "html_url": "https://github.com/neovim/neovim/issues/33775#issuecomment-2847150398",
            "id": 2847150398,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33775",
            "node_id": "IC_kwDOAPphoM6ptBE-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2847150398/reactions"
            },
            "updated_at": "2025-05-02T13:01:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2847150398",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/33849340?v=4",
                "events_url": "https://api.github.com/users/SebasF1349/events{/privacy}",
                "followers_url": "https://api.github.com/users/SebasF1349/followers",
                "following_url": "https://api.github.com/users/SebasF1349/following{/other_user}",
                "gists_url": "https://api.github.com/users/SebasF1349/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/SebasF1349",
                "id": 33849340,
                "login": "SebasF1349",
                "node_id": "MDQ6VXNlcjMzODQ5MzQw",
                "organizations_url": "https://api.github.com/users/SebasF1349/orgs",
                "received_events_url": "https://api.github.com/users/SebasF1349/received_events",
                "repos_url": "https://api.github.com/users/SebasF1349/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/SebasF1349/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/SebasF1349/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/SebasF1349",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Though it is a bit weird it happens in the lower part of the screen even if the cursor would not be hidden.\n\nIt's not weird, that's exactly how `splitkeep=cursor` works (I've just been using `screen` for so long that I forgot). But yes I think it's fair to say that changing the 'cmdheight' to accommodate space for the new extui cmdline window should not change the cursor position. #33774 achieves that by temporarily setting `splitkeep` which seems like a fine solution.",
            "created_at": "2025-05-02T13:41:18Z",
            "html_url": "https://github.com/neovim/neovim/issues/33775#issuecomment-2847242274",
            "id": 2847242274,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33775",
            "node_id": "IC_kwDOAPphoM6ptXgi",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2847242274/reactions"
            },
            "updated_at": "2025-05-02T13:41:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2847242274",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/31730729?v=4",
                "events_url": "https://api.github.com/users/luukvbaal/events{/privacy}",
                "followers_url": "https://api.github.com/users/luukvbaal/followers",
                "following_url": "https://api.github.com/users/luukvbaal/following{/other_user}",
                "gists_url": "https://api.github.com/users/luukvbaal/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/luukvbaal",
                "id": 31730729,
                "login": "luukvbaal",
                "node_id": "MDQ6VXNlcjMxNzMwNzI5",
                "organizations_url": "https://api.github.com/users/luukvbaal/orgs",
                "received_events_url": "https://api.github.com/users/luukvbaal/received_events",
                "repos_url": "https://api.github.com/users/luukvbaal/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/luukvbaal/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/luukvbaal/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/luukvbaal",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/33775/comments",
    "created_at": "2025-05-02T12:38:15Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/33775/events",
    "html_url": "https://github.com/neovim/neovim/issues/33775",
    "id": 3035930866,
    "labels": [],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/33775/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM609KDy",
    "number": 33775,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/33775/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/33775/timeline",
    "title": "cmdheight = 0 with `vim._extui` not consistent",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-05-02T17:46:32Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/33775",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/33849340?v=4",
        "events_url": "https://api.github.com/users/SebasF1349/events{/privacy}",
        "followers_url": "https://api.github.com/users/SebasF1349/followers",
        "following_url": "https://api.github.com/users/SebasF1349/following{/other_user}",
        "gists_url": "https://api.github.com/users/SebasF1349/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/SebasF1349",
        "id": 33849340,
        "login": "SebasF1349",
        "node_id": "MDQ6VXNlcjMzODQ5MzQw",
        "organizations_url": "https://api.github.com/users/SebasF1349/orgs",
        "received_events_url": "https://api.github.com/users/SebasF1349/received_events",
        "repos_url": "https://api.github.com/users/SebasF1349/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/SebasF1349/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/SebasF1349/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/SebasF1349",
        "user_view_type": "public"
    }
}
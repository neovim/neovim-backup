{
    "active_lock_reason": null,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        }
    ],
    "author_association": "CONTRIBUTOR",
    "body": "## Problem\n\n`client.exit_timeout = false` signals for Nvim to wait forever for a language server to exit (and never force exit the server). However, during Nvim exit, Nvim will ignore this option and force stop the language server anyway. This is intentional behavior as to prevent Nvim from seeming to \"freeze\" when it is actually the language server's fault (https://github.com/neovim/neovim/issues/36752#issuecomment-3596017419). As of #37597, this inconsistency only occurs when `exit_timeout` is `false`; when it is a number, it now behaves as expected in all situations.\n\nSee #36752 for previous.\n\n## Possible Solutions\n\nAfter thinking this over, I have come up with three possibly solutions.\n\n### Fully respect `exit_timeout = false`\n\nNvim will wait to exit until all language servers have exited, waiting as long as needed. Since #37597 has been merged, Nvim will display an informative message if the server takes an abnormal time to exit. This will avoid the \"Nvim seems frozen\" effect, which was why this wasn't done to begin with.\n\nThis is my preferred fix.\n\nPros:\n- Fully consistent with `exit_timeout = false` in all other contexts, making this the most intuitive option.\n- Fully avoids force stopping a language server, which can lead to file corruption (https://github.com/neovim/neovim/pull/36783#issuecomment-3603340968).\n- Problems with bugged language servers are visible instead of being masked by Nvim.\n- Consistent behavior with what happens when `exit_timeout` is a number. In fact, `false` and `math.huge` become fully identical.\n\nCons:\n- User needs to hit `^C` to close Nvim if a language server hangs forever.\n\n### Fork off all non-stopped language servers on exit\n\nNvim will daemonize any language servers that fail to exit, allowing them to take as long as they need to exit without preventing Nvim itself from exiting.\n\nPros:\n- While it is an exception to the `exit_timeout` behavior, `exit_timeout = false` will still never force stop a language server (no file corruption).\n- Does not delay Nvim's shutdown.\n\nCons:\n- Frozen language servers will never be stopped and will potentially pile up. This would be a bug in the LSP and not in Nvim, but it's not ideal behavior.\n- `exit_timeout = false` behaves differently to `exit_timeout = math.huge`\n\n### Keep the current behavior, but make it official\n\nKeep the behavior as is, but explicitly document it as an exception to the `exit_timeout` rules.\n\nPros:\n- Nvim exit is kept as simple as possible: no messages, no daemonized processes, etc.\n\nCons:\n- Force stopping a language server can lead to file corruption, and defaulting to this behavior on Nvim exit is bad.\n- `exit_timeout = false` behaves differently to `exit_timeout = math.huge`.\n- Does the exact opposite of what `exit_timeout = false` represents.\n\n---\n\ncc @justinmk @mfussenegger @zeertzjq @phanen\n\n### Nvim version (nvim -v)\n\nNVIM v0.12.0-dev-2313+g7d8653575f",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "> client.exit_timeout = false signals for Nvim to wait forever for a language server to exit (and never force exit the server). However, during Nvim exit, Nvim will ignore this option and force stop the language server anyway. \n\nThis seems more of an interpretation issue than anything else? If you read it as \"no special timeout handling\" there's no inconsistency.\n\n> Fork off all non-stopped language servers on exit\n\nAfaik at least on linux process there's no need for that. If you quit nvim the tui closes, but the process group remains until all processes of it have terminated.\n\nThe behavior works - please don't fix what's not broken.\n\n",
            "created_at": "2026-02-16T06:17:25Z",
            "html_url": "https://github.com/neovim/neovim/issues/37887#issuecomment-3906654799",
            "id": 3906654799,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37887",
            "node_id": "IC_kwDOAPphoM7o2tJP",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3906654799/reactions"
            },
            "updated_at": "2026-02-16T06:17:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3906654799",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38700?v=4",
                "events_url": "https://api.github.com/users/mfussenegger/events{/privacy}",
                "followers_url": "https://api.github.com/users/mfussenegger/followers",
                "following_url": "https://api.github.com/users/mfussenegger/following{/other_user}",
                "gists_url": "https://api.github.com/users/mfussenegger/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mfussenegger",
                "id": 38700,
                "login": "mfussenegger",
                "node_id": "MDQ6VXNlcjM4NzAw",
                "organizations_url": "https://api.github.com/users/mfussenegger/orgs",
                "received_events_url": "https://api.github.com/users/mfussenegger/received_events",
                "repos_url": "https://api.github.com/users/mfussenegger/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mfussenegger/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mfussenegger/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mfussenegger",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> > client.exit_timeout = false signals for Nvim to wait forever for a language server to exit (and never force exit the server). However, during Nvim exit, Nvim will ignore this option and force stop the language server anyway.\n> \n> This seems more of an interpretation issue than anything else? If you read it as \"no special timeout handling\" there's no inconsistency.\n\nI see your point, but imo, should force-stopping a language server really be the default? `exit_timeout` defaults to `false` *because* it supposedly prevents any force-stopping by default. Not that I'm fully against this as long as it's clearly documented....\n\n> > Fork off all non-stopped language servers on exit\n> \n> Afaik at least on linux process there's no need for that. If you quit nvim the tui closes, but the process group remains until all processes of it have terminated.\n> \n> The behavior works - please don't fix what's not broken.\n\nI am on Linux and it does not behave like this. If it did, that would be great.",
            "created_at": "2026-02-16T06:30:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/37887#issuecomment-3906694585",
            "id": 3906694585,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37887",
            "node_id": "IC_kwDOAPphoM7o2225",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3906694585/reactions"
            },
            "updated_at": "2026-02-16T07:21:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3906694585",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> `client.exit_timeout = false` signals for Nvim to wait forever for a language server to exit (and never force exit the server)\n\nLet's be clearer about this phrasing. \"Wait forever\" is very different than the actual behavior and the intended semantics, which are: Nvim *takes no special action* to force-stop. That's different than \"wait forever\", which implies that on exit Nvim should wait.\n\n> Nvim will daemonize any language servers that fail to exit, allowing them to take as long as they need to exit without preventing Nvim itself from exiting.\n\nYes, this is the ideal behavior. But not 100% feasible, because of how stdio channels work.\n\n> Afaik at least on linux process there's no need for that. If you quit nvim the tui closes, but the process group remains until all processes of it have terminated.\n\nThat works as long as the channel is not stdio, *or* if the server gracefully handles the closed channel.\n\nSo I think we can resolve this by improving the documentation, which I will do.",
            "created_at": "2026-02-16T13:48:38Z",
            "html_url": "https://github.com/neovim/neovim/issues/37887#issuecomment-3908595227",
            "id": 3908595227,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37887",
            "node_id": "IC_kwDOAPphoM7o-G4b",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3908595227/reactions"
            },
            "updated_at": "2026-02-16T13:57:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3908595227",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Sounds good. Glad this is finally being cleared up in the docs.",
            "created_at": "2026-02-16T16:21:43Z",
            "html_url": "https://github.com/neovim/neovim/issues/37887#issuecomment-3909370641",
            "id": 3909370641,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/37887",
            "node_id": "IC_kwDOAPphoM7pBEMR",
            "performed_via_github_app": null,
            "pin": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3909370641/reactions"
            },
            "updated_at": "2026-02-16T16:21:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3909370641",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
                "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
                "followers_url": "https://api.github.com/users/superatomic/followers",
                "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
                "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/superatomic",
                "id": 51250849,
                "login": "superatomic",
                "node_id": "MDQ6VXNlcjUxMjUwODQ5",
                "organizations_url": "https://api.github.com/users/superatomic/orgs",
                "received_events_url": "https://api.github.com/users/superatomic/received_events",
                "repos_url": "https://api.github.com/users/superatomic/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/superatomic",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 4,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/37887/comments",
    "created_at": "2026-02-16T01:52:56Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/37887/events",
    "html_url": "https://github.com/neovim/neovim/issues/37887",
    "id": 3945479174,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "c5def5",
            "default": true,
            "description": "",
            "id": 84744038,
            "name": "documentation",
            "node_id": "MDU6TGFiZWw4NDc0NDAzOA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/documentation"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/37887/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM7rKzwG",
    "number": 37887,
    "performed_via_github_app": null,
    "pinned_comment": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/37887/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/37887/timeline",
    "title": "lsp: unexpected LSP behavior on Nvim exit when `exit_timeout=false`",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2026-02-16T16:21:43Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/37887",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/51250849?v=4",
        "events_url": "https://api.github.com/users/superatomic/events{/privacy}",
        "followers_url": "https://api.github.com/users/superatomic/followers",
        "following_url": "https://api.github.com/users/superatomic/following{/other_user}",
        "gists_url": "https://api.github.com/users/superatomic/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/superatomic",
        "id": 51250849,
        "login": "superatomic",
        "node_id": "MDQ6VXNlcjUxMjUwODQ5",
        "organizations_url": "https://api.github.com/users/superatomic/orgs",
        "received_events_url": "https://api.github.com/users/superatomic/received_events",
        "repos_url": "https://api.github.com/users/superatomic/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/superatomic/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/superatomic/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/superatomic",
        "user_view_type": "public"
    }
}
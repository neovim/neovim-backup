{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nI'm trying to setup some lua tests for a neovim plugin following [this](https://hiphish.github.io/blog/2024/01/29/testing-neovim-plugins-with-busted/).\r\n\r\nThis resulted in me running into a NULL pointer deref:\r\n\r\n```\r\n(gdb) bt\r\n#0  0x00000000005d3cbb in grid_del_lines ()\r\n#1  0x0000000000671cb0 in msg_scroll_up ()\r\n#2  0x00000000006761ba in msg_start ()\r\n#3  0x0000000000674ef4 in msg_attr_keep ()\r\n#4  0x00000000006754e9 in emsg_multiline ()\r\n#5  0x0000000000676dbd in semsg_multiline ()\r\n#6  0x0000000000623eb0 in nlua_error ()\r\n#7  0x000000000062ddcd in nlua_exec_file ()\r\n#8  0x0000000000459a93 in main ()\r\n(gdb) \r\n(gdb) x/i $pc\r\n=> 0x5d3cbb <grid_del_lines+587>:       mov    (%rdx),%rdi\r\n(gdb) i r\r\nrax            0x0                 0\r\nrbx            0x1                 1\r\nrcx            0x1                 1\r\nrdx            0x0                 0\r\nrsi            0x0                 0\r\nrdi            0x966a80            9857664\r\nrbp            0x1                 0x1\r\nrsp            0x7ffedab7b660      0x7ffedab7b660\r\nr8             0x0                 0\r\nr9             0x0                 0\r\nr10            0x0                 0\r\nr11            0x1                 1\r\nr12            0x0                 0\r\nr13            0x0                 0\r\nr14            0xffffffff          4294967295\r\nr15            0x966a80            9857664\r\nrip            0x5d3cbb            0x5d3cbb <grid_del_lines+587>\r\n(gdb) x/20i $pc-25\r\n   0x5d3ca2 <grid_del_lines+562>:       pop    %rbp\r\n   0x5d3ca3 <grid_del_lines+563>:       pop    %r14\r\n   0x5d3ca5 <grid_del_lines+565>:       pop    %r15\r\n   0x5d3ca7 <grid_del_lines+567>:       ret\r\n   0x5d3ca8 <grid_del_lines+568>:       nopl   0x0(%rax,%rax,1)\r\n   0x5d3cb0 <grid_del_lines+576>:       mov    0x20(%r15),%rsi\r\n   0x5d3cb4 <grid_del_lines+580>:       movslq %r10d,%rdx\r\n   0x5d3cb7 <grid_del_lines+583>:       lea    (%rsi,%rdx,8),%rdx\r\n=> 0x5d3cbb <grid_del_lines+587>:       mov    (%rdx),%rdi\r\n   0x5d3cbe <grid_del_lines+590>:       cmp    %r11d,%r14d\r\n   0x5d3cc1 <grid_del_lines+593>:       jl     0x5d3ce9 <grid_del_lines+633>\r\n   0x5d3cc3 <grid_del_lines+595>:       cmp    $0x1,%ebp\r\n   0x5d3cc6 <grid_del_lines+598>:       jne    0x5d3fb0 <grid_del_lines+1344>\r\n   0x5d3ccc <grid_del_lines+604>:       nopl   0x0(%rax)\r\n   0x5d3cd0 <grid_del_lines+608>:       movslq %ebx,%rdx\r\n   0x5d3cd3 <grid_del_lines+611>:       lea    (%rsi,%rdx,8),%rdx\r\n   0x5d3cd7 <grid_del_lines+615>:       mov    (%rdx),%rcx\r\n   0x5d3cda <grid_del_lines+618>:       mov    %rcx,(%rsi,%rax,8)\r\n   0x5d3cde <grid_del_lines+622>:       movslq %ebx,%rax\r\n   0x5d3ce1 <grid_del_lines+625>:       add    $0x1,%ebx\r\n```\r\n\r\nThere has been at least 2 different cases where this function has had crashes in the past maybe #20316 and #10031, but they are both pre 0.10.0.\r\n\r\nThere is one other open issue #22278 that has `grid_del_lines` in the stacktrace, but is not the same issue as it's not the crashing function.\n\n### Steps to reproduce\n\nI'm running `busted --run unit` with the following setup:\r\n\r\n```\r\n❯ bat -p .busted\r\nreturn {\r\n    _all = {\r\n        lua = './test/nvim-shim.sh'\r\n    },\r\n    unit = {\r\n        ROOT = {'./test/unit/'},\r\n    },\r\n}\r\n```\r\n\r\n```\r\n❯ bat -p ./test/nvim-shim.sh\r\n#!/usr/bin/env bash\r\nset -euo pipefail\r\n\r\nexport XDG_CONFIG_HOME='test/xdg/config/'\r\nexport XDG_STATE_HOME='test/xdg/local/state/'\r\nexport XDG_DATA_HOME='test/xdg/local/share/'\r\n\r\nmkdir -p ${XDG_CONFIG_HOME} ${XDG_STATE_HOME} ${XDG_DATA_HOME}\r\nmkdir -p ${XDG_DATA_HOME}/nvim/site/pack/testing/start || true\r\n# XXX - Expects to be in cursorless.nvim, so we should force cd here\r\nln -sf \"${PWD}\" ${XDG_DATA_HOME}/nvim/site/pack/testing/start/cursorless.nvim\r\n\r\nNVIM='nvim'\r\nif type -a ${NVIM} | grep 'is an alias'; then\r\n  NVIM=$(type -p nvim)\r\nfi\r\n# shellcheck disable=SC2068\r\necho $@\r\n${NVIM} --cmd 'set loadplugins' -l $@\r\nexit_code=$?\r\nrm ${XDG_DATA_HOME}/nvim/site/pack/testing/start/cursorless.nvim 2>/dev/null || true\r\n\r\nexit $exit_code\r\n```\r\n\r\n```\r\n❯ bat -p test/unit/buffer_selection_spec.lua\r\ndescribe(\"cursorless buffer selection\", function()\r\n  describe(\"Basic selection\", function()\r\n    before_each(function()\r\n      local pos = vim.api.nvim_win_get_cursor(0)[2]\r\n      local line = vim.api.nvim_get_current_line()\r\n      local nline = line:sub(0, pos) .. \"hello\" .. line:sub(pos + 1)\r\n      vim.api.nvim_set_current_line(nline)\r\n    end)\r\n\r\n    it(\"Can read visible lines\", function()\r\n      print(\"foo\")\r\n      assert.is_true(true)\r\n    end)\r\n  end)\r\nend)\r\n```\r\n\r\nIf I have `print(\"foo\")` in the above `buffer_selection_spec.lua` file:\r\n\r\n```\r\n❯ busted --run unit\r\n/nix/store/w1wjplk0znvid1y1kljz1a1nqm2dc24q-luajit2.1-busted-2.2.0-1/busted-2.2.0-1-rocks/busted/2.2.0-1/bin/busted --ignore-lua --run unit\r\n./test/nvim-shim.sh: line 19: 1640715 Segmentation fault      (core dumped) ${NVIM} --cmd 'set loadplugins' -l $@\r\nerror: Recipe `test` failed on line 5 with exit code 1\r\n```\r\n\r\nIf I comment out the print:\r\n\r\n```\r\n❯ busted --run unit\r\n/nix/store/w1wjplk0znvid1y1kljz1a1nqm2dc24q-luajit2.1-busted-2.2.0-1/busted-2.2.0-1-rocks/busted/2.2.0-1/bin/busted --ignore-lua --run unit\r\n●\r\n1 success / 0 failures / 0 errors / 0 pending : 0.000675 seconds\r\n```\r\n\n\n### Expected behavior\n\nDon't crash.\n\n### Neovim version (nvim -v)\n\n❯ /home/aa/.nix-profile/bin/nvim --version NVIM v0.10.0 Build type: Release LuaJIT 2.1.1693350652\n\n### Vim (not Nvim) behaves the same?\n\ndon't know, not sure how to reproduce given my repro relies on lua test\n\n### Operating system/version\n\nnixos 24.05\n\n### Terminal name/version\n\nwezterm\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nnixpkgs",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Can you reproduce this using a Debug build and provide a backtrace with line numbers?",
            "created_at": "2024-06-17T07:38:37Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-2172522834",
            "id": 2172522834,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM6BfhFS",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172522834/reactions"
            },
            "updated_at": "2024-06-17T07:38:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172522834",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I cannot reproduce this crash with Nvim 0.10.0 and busted 2.2.0 on Arch Linux:\r\n```\r\n/usr/lib/luarocks/rocks-5.4/busted/2.2.0-1/bin/busted --ignore-lua --run unit\r\nfoo●\r\n1 success / 0 failures / 0 errors / 0 pending : 0.000427 seconds\r\n```",
            "created_at": "2024-06-17T08:01:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-2172568692",
            "id": 2172568692,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM6BfsR0",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172568692/reactions"
            },
            "updated_at": "2024-06-17T08:01:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172568692",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Interestingly I can't reproduce it with a debug version of 0.10.0 built from nixpkgs unstable:\r\n\r\n```\r\nbusted/2.2.0-1/bin/busted --ignore-lua --run unit\r\nfoo●\r\n1 success / 0 failures / 0 errors / 0 pending : 0.000478 seconds\r\n```\r\n\r\nI tested with neovim from 24.05, which is 0.9.5, and it also doesn't repro.\r\n\r\nThen I remembered the neovim binary I use on my system is built using [nixvim](https://github.com/nix-community/nixvim/), so is actually passing in additional commands in a wrapper, which is including my whole init script (which I was trying to avoid with the busted tests, so happy this bug made me realize lol):\r\n\r\nthe wrapper is adding:\r\n\r\n```\r\n--cmd \\\"lua vim.g.node_host_prog='/nix/store/n94b5rwrmhimk467ijgpzncdck48bk2z-neovim-0.10.0/bin/nvim-node';vim.g.loaded_perl_provider=0;vim.g.loaded_python_provider=0;vim.g.python3_host_prog='/nix/store/n94b5rwrmhimk467ijgpzncdck48bk2z-neovim-0.10.0/bin/nvim-python3';vim.g.ruby_host_prog='/nix/store/n94b5rwrmhimk467ijgpzncdck48bk2z-neovim-0.10.0/bin/nvim-ruby'\\\" --cmd \\\"set packpath^=/nix/store/2ks1w6jpw6fxdpca3a5yyxq291cx54fc-vim-pack-dir\\\" --cmd \\\"set rtp^=/nix/store/2ks1w6jpw6fxdpca3a5yyxq291cx54fc-vim-pack-dir\\\" -u /nix/store/ywydszddljnsg6s48vhdlfpf5nj80a5h-init.lua\"\r\n```\r\n\r\nSo that's gonna make a simple repro a bit harder, but I'll take a look afterwards.\r\n\r\n```\r\n(gdb) bt\r\n#0  0x00005556dc1d212f in grid_del_lines (grid=grid@entry=0x5556dc491228 <msg_grid>, row=row@entry=0, line_count=line_count@entry=1, end=0, col=col@entry=0, width=0) at /build/source/src/nvim/grid.c:1056\r\n#1  0x00005556dc24dddb in msg_scroll_up (may_throttle=<optimized out>, zerocmd=<optimized out>) at /build/source/src/nvim/message.c:2364\r\n#2  0x00005556dc24b170 in msg_start () at /build/source/src/nvim/message.c:1447\r\n#3  0x00005556dc24a912 in msg_attr_keep (s=s@entry=0x5556dd5f0b90 \"Error detected while processing /nix/store/ywydszddljnsg6s48vhdlfpf5nj80a5h-init.lua:\", attr=attr@entry=1, keep=false, multiline=false)\r\n    at /build/source/src/nvim/message.c:341\r\n#4  0x00005556dc24bafd in msg (s=0x5556dd5f0b90 \"Error detected while processing /nix/store/ywydszddljnsg6s48vhdlfpf5nj80a5h-init.lua:\", attr=1) at /build/source/src/nvim/message.c:246\r\n#5  msg_source (attr=attr@entry=1) at /build/source/src/nvim/message.c:606\r\n#6  0x00005556dc24c20b in emsg_multiline (\r\n    s=s@entry=0x5556dc4a3d10 <semsg_multiline[errbuf]> \"E5113: Error while calling lua chunk: vim/_editor.lua:0: /nix/store/ywydszddljnsg6s48vhdlfpf5nj80a5h-init.lua..nvim_exec2() called at /nix/store/ywydszddljnsg6s48vhdlfpf\r\n5nj80a5h-init.lua:0: Vim(colors\"..., multiline=<optimized out>) at /build/source/src/nvim/message.c:752\r\n#7  0x00005556dc24c81f in semsg_multiline (fmt=fmt@entry=0x5556dc3b05a5 \"E5113: Error while calling lua chunk: %.*s\") at /build/source/src/nvim/message.c:807\r\n#8  0x00005556dc20e8f1 in nlua_error (lstate=lstate@entry=0x7fd586d5f380, msg=0x5556dc3b05a5 \"E5113: Error while calling lua chunk: %.*s\") at /build/source/src/nvim/lua/executor.c:156\r\n#9  0x00005556dc20f3ef in nlua_exec_file (path=path@entry=0x5556dd5e6ae0 \"/nix/store/ywydszddljnsg6s48vhdlfpf5nj80a5h-init.lua\") at /build/source/src/nvim/lua/executor.c:1854\r\n#10 0x00005556dc2e3ad4 in do_source (fname=fname@entry=0x7ffd2d12f930 \"/nix/store/ywydszddljnsg6s48vhdlfpf5nj80a5h-init.lua\", check_other=check_other@entry=0, is_vimrc=is_vimrc@entry=0, ret_sid=ret_sid@entry=0x0)\r\n    at /build/source/src/nvim/runtime.c:2223\r\n#11 0x00005556dc21c19a in source_startup_scripts (parmp=0x7ffd2d12d7f8) at /build/source/src/nvim/main.c:2098\r\n#12 main (argc=<optimized out>, argv=<optimized out>) at /build/source/src/nvim/main.c:465\r\n(gdb) x/i $pc\r\n=> 0x5556dc1d212f <grid_del_lines+287>: mov    (%rax,%rcx,8),%r15d\r\n(gdb) i r\r\nrax            0x0                 0\r\nrbx            0x0                 0\r\nrcx            0x0                 0\r\nrdx            0x0                 0\r\nrsi            0x0                 0\r\nrdi            0xffffffff          4294967295\r\nrbp            0x0                 0x0\r\nrsp            0x7ffd2d12d1a0      0x7ffd2d12d1a0\r\nr8             0x0                 0\r\nr9             0x0                 0\r\nr10            0x7                 7\r\nr11            0x5556dd5e2720      93831569483552\r\nr12            0x5556dc491228      93831551324712\r\nr13            0x1                 1\r\nr14            0x0                 0\r\nr15            0x5556dc49e2e4      93831551378148\r\nrip            0x5556dc1d212f      0x5556dc1d212f <grid_del_lines+287>\r\neflags         0x10246             [ PF ZF IF RF ]\r\ncs             0x33                51\r\nss             0x2b                43\r\nds             0x0                 0\r\nes             0x0                 0\r\nfs             0x0                 0\r\ngs             0x0                 0\r\nfs_base        0x7fd586d88b80      140555067100032\r\ngs_base        0x0  \r\n(gdb) p/x *grid\r\n$2 = {handle = 0x3, chars = 0x0, attrs = 0x0, vcols = 0x0, line_offset = 0x0, dirty_col = 0x0, rows = 0x0, cols = 0x0, valid = 0x0, throttled = 0x0, row_offset = 0x0, col_offset = 0x0, target = 0x0, blending = 0x0, \r\n  focusable = 0x1, zindex = 0x0, comp_row = 0x0, comp_col = 0x0, comp_width = 0x0, comp_height = 0x0, comp_index = 0x0, comp_disabled = 0x0}\r\n(gdb) list\r\n1051          j -= line_count;\r\n1052          grid_clear_line(grid, grid->line_offset[j] + (size_t)col, width, false);\r\n1053        } else {\r\n1054          // whole width, moving the line pointers is faster\r\n1055          j = row + i;\r\n1056          temp = (unsigned)grid->line_offset[j];\r\n1057          while ((j += line_count) <= end - 1) {\r\n1058            grid->line_offset[j - line_count] = grid->line_offset[j];\r\n1059          }\r\n1060          grid->line_offset[j - line_count] = temp;\r\n```\r\n\r\nCrash is on `temp = (unsigned)grid->line_offset[j];`, which the above shows `grid->line_offset` is `NULL`.",
            "created_at": "2024-06-17T09:37:08Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-2172876937",
            "id": 2172876937,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM6Bg3iJ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172876937/reactions"
            },
            "updated_at": "2024-06-17T09:37:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172876937",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/13679876?v=4",
                "events_url": "https://api.github.com/users/fidgetingbits/events{/privacy}",
                "followers_url": "https://api.github.com/users/fidgetingbits/followers",
                "following_url": "https://api.github.com/users/fidgetingbits/following{/other_user}",
                "gists_url": "https://api.github.com/users/fidgetingbits/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fidgetingbits",
                "id": 13679876,
                "login": "fidgetingbits",
                "node_id": "MDQ6VXNlcjEzNjc5ODc2",
                "organizations_url": "https://api.github.com/users/fidgetingbits/orgs",
                "received_events_url": "https://api.github.com/users/fidgetingbits/received_events",
                "repos_url": "https://api.github.com/users/fidgetingbits/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fidgetingbits/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fidgetingbits/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fidgetingbits",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Hmm, I think this is as simple as this:\r\n```sh\r\nprintf 'vim.o.cmdheight = 0\\nprint(\"foo\")\\n' | nvim --clean -l -\r\n```",
            "created_at": "2024-06-17T10:00:30Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-2172941628",
            "id": 2172941628,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM6BhHU8",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172941628/reactions"
            },
            "updated_at": "2024-06-17T10:00:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172941628",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Yep that does it.",
            "created_at": "2024-06-17T10:19:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-2172980957",
            "id": 2172980957,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM6BhQ7d",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172980957/reactions"
            },
            "updated_at": "2024-06-17T10:19:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2172980957",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/13679876?v=4",
                "events_url": "https://api.github.com/users/fidgetingbits/events{/privacy}",
                "followers_url": "https://api.github.com/users/fidgetingbits/followers",
                "following_url": "https://api.github.com/users/fidgetingbits/following{/other_user}",
                "gists_url": "https://api.github.com/users/fidgetingbits/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fidgetingbits",
                "id": 13679876,
                "login": "fidgetingbits",
                "node_id": "MDQ6VXNlcjEzNjc5ODc2",
                "organizations_url": "https://api.github.com/users/fidgetingbits/orgs",
                "received_events_url": "https://api.github.com/users/fidgetingbits/received_events",
                "repos_url": "https://api.github.com/users/fidgetingbits/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fidgetingbits/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fidgetingbits/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fidgetingbits",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Should Nvim perform any UI code when started with `-l`?",
            "created_at": "2024-10-16T13:14:34Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-2416809100",
            "id": 2416809100,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM6QDZSM",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416809100/reactions"
            },
            "updated_at": "2024-10-16T13:14:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416809100",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I got the same bug in my user environment. While we have no fix for it, we can defer setting `cmdheight` after `UIEnter`:\n```lua\nvim.api.nvim_create_autocmd('UIEnter', {\n  callback = function ()\n    vim.o.cmdheight = 0\n  end\n})\n```",
            "created_at": "2024-10-16T13:27:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-2416842884",
            "id": 2416842884,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM6QDhiE",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416842884/reactions"
            },
            "updated_at": "2024-10-16T13:28:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2416842884",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11404453?v=4",
                "events_url": "https://api.github.com/users/przepompownia/events{/privacy}",
                "followers_url": "https://api.github.com/users/przepompownia/followers",
                "following_url": "https://api.github.com/users/przepompownia/following{/other_user}",
                "gists_url": "https://api.github.com/users/przepompownia/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/przepompownia",
                "id": 11404453,
                "login": "przepompownia",
                "node_id": "MDQ6VXNlcjExNDA0NDUz",
                "organizations_url": "https://api.github.com/users/przepompownia/orgs",
                "received_events_url": "https://api.github.com/users/przepompownia/received_events",
                "repos_url": "https://api.github.com/users/przepompownia/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/przepompownia/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/przepompownia/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/przepompownia",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Hmm, I think this is as simple as this:\n> \n> printf 'vim.o.cmdheight = 0\\nprint(\"foo\")\\n' | nvim --clean -l -\n\nThis seems to no longer crash. Does the original bug still exist?",
            "created_at": "2026-01-18T00:10:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/29373#issuecomment-3764511459",
            "id": 3764511459,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/29373",
            "node_id": "IC_kwDOAPphoM7gYeLj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3764511459/reactions"
            },
            "updated_at": "2026-01-18T00:10:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3764511459",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 8,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/29373/comments",
    "created_at": "2024-06-17T07:19:30Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/29373/events",
    "html_url": "https://github.com/neovim/neovim/issues/29373",
    "id": 2356580127,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "FBCA04",
            "default": false,
            "description": "waiting for reply from the author",
            "id": 248229439,
            "name": "needs:response",
            "node_id": "MDU6TGFiZWwyNDgyMjk0Mzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/needs:response"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains a stacktrace/ASAN log",
            "id": 435854079,
            "name": "has:backtrace",
            "node_id": "MDU6TGFiZWw0MzU4NTQwNzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:backtrace"
        },
        {
            "color": "F9D0C4",
            "default": false,
            "description": "issue reporting a crash or segfault",
            "id": 435854234,
            "name": "bug-crash",
            "node_id": "MDU6TGFiZWw0MzU4NTQyMzQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug-crash"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "startup, shutdown, attach, detach",
            "id": 870629450,
            "name": "lifecycle",
            "node_id": "MDU6TGFiZWw4NzA2Mjk0NTA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lifecycle"
        },
        {
            "color": "C5DEF5",
            "default": false,
            "description": "UI messages, log messages, dialogs, progress, errors, warnings, feedback",
            "id": 5637083595,
            "name": "messages",
            "node_id": "LA_kwDOAPphoM8AAAABT_8Ryw",
            "url": "https://api.github.com/repos/neovim/neovim/labels/messages"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/29373/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6Mdo8f",
    "number": 29373,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/29373/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/29373/timeline",
    "title": "cmdheight=0: NULL dereference in grid_del_lines()",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2026-01-18T00:10:48Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/29373",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/13679876?v=4",
        "events_url": "https://api.github.com/users/fidgetingbits/events{/privacy}",
        "followers_url": "https://api.github.com/users/fidgetingbits/followers",
        "following_url": "https://api.github.com/users/fidgetingbits/following{/other_user}",
        "gists_url": "https://api.github.com/users/fidgetingbits/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/fidgetingbits",
        "id": 13679876,
        "login": "fidgetingbits",
        "node_id": "MDQ6VXNlcjEzNjc5ODc2",
        "organizations_url": "https://api.github.com/users/fidgetingbits/orgs",
        "received_events_url": "https://api.github.com/users/fidgetingbits/received_events",
        "repos_url": "https://api.github.com/users/fidgetingbits/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/fidgetingbits/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fidgetingbits/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/fidgetingbits",
        "user_view_type": "public"
    }
}
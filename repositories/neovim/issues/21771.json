{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Describe the bug\n\ntmux can no longer read the CWD from neovim, and this was something which has \"worked\" until https://github.com/neovim/neovim/pull/18375 (found using git-bisect)\r\n\r\nThis was tested against with different `$TERM` values: `alacritty`, `xterm-256color`, `tmux-256color`.\n\n### Steps to reproduce\n\n- `nvim -u NONE`\r\n- `:pwd`\r\n- execute this tmux command `display -p '#{pane_current_path}'` and check that it matches the previous result\r\n- `:cd build`\r\n- re-run the tmux command and see a mismatch\n\n### Expected behavior\n\ntmux is able to read the CWD using `nvim-0.8.2`\n\n### Neovim version (nvim -v)\n\n2aabe9b85870912b9eb8fe2ced0c21544de66f58\n\n### Vim (not Nvim) behaves the same?\n\nNA\n\n### Operating system/version\n\nLinux\n\n### Terminal name/version\n\nAlacritty 0.11.0\n\n### $TERM environment variable\n\n`alacritty`, `xterm-256color` and `tmux-256color`\n\n### Installation\n\nbuild from repo",
    "closed_at": "2024-01-19T20:51:11Z",
    "comment_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "probably related to https://github.com/neovim/neovim/issues/21636",
            "created_at": "2023-01-12T12:01:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1380224602",
            "id": 1380224602,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5SRI5a",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380224602/reactions"
            },
            "updated_at": "2023-01-12T12:01:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380224602",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/59826753?v=4",
                "events_url": "https://api.github.com/users/kylo252/events{/privacy}",
                "followers_url": "https://api.github.com/users/kylo252/followers",
                "following_url": "https://api.github.com/users/kylo252/following{/other_user}",
                "gists_url": "https://api.github.com/users/kylo252/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kylo252",
                "id": 59826753,
                "login": "kylo252",
                "node_id": "MDQ6VXNlcjU5ODI2NzUz",
                "organizations_url": "https://api.github.com/users/kylo252/orgs",
                "received_events_url": "https://api.github.com/users/kylo252/received_events",
                "repos_url": "https://api.github.com/users/kylo252/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kylo252/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kylo252/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kylo252"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "That plugin is for the clipboard. What was the mechanism for forwarding cwd? I find nothing relevant in tui/tui.c (in the \"working\" version). Is it another plugin?",
            "created_at": "2023-01-12T14:59:51Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1380506567",
            "id": 1380506567,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5SSNvH",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380506567/reactions"
            },
            "updated_at": "2023-01-12T14:59:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380506567",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I think that clipboard issue is irrelevant. tmux probably does something like `pwdx` (checks `/proc/X/cwd`), but TUI is now a separate process and I doubt changing the directory is forwarded to the TUI process from the server.",
            "created_at": "2023-01-12T15:51:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1380600635",
            "id": 1380600635,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5SSks7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380600635/reactions"
            },
            "updated_at": "2023-01-12T15:53:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380600635",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/59243201?v=4",
                "events_url": "https://api.github.com/users/ii14/events{/privacy}",
                "followers_url": "https://api.github.com/users/ii14/followers",
                "following_url": "https://api.github.com/users/ii14/following{/other_user}",
                "gists_url": "https://api.github.com/users/ii14/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ii14",
                "id": 59243201,
                "login": "ii14",
                "node_id": "MDQ6VXNlcjU5MjQzMjAx",
                "organizations_url": "https://api.github.com/users/ii14/orgs",
                "received_events_url": "https://api.github.com/users/ii14/received_events",
                "repos_url": "https://api.github.com/users/ii14/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ii14/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ii14/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ii14"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Yes, when you change directory with `:cd`, the directory changes only on the server process. TUI process stays on the directory it was opened in, and I assume that is what tmux sees.",
            "created_at": "2023-01-12T15:57:45Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1380608790",
            "id": 1380608790,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5SSmsW",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380608790/reactions"
            },
            "updated_at": "2023-01-12T15:57:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380608790",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/59243201?v=4",
                "events_url": "https://api.github.com/users/ii14/events{/privacy}",
                "followers_url": "https://api.github.com/users/ii14/followers",
                "following_url": "https://api.github.com/users/ii14/following{/other_user}",
                "gists_url": "https://api.github.com/users/ii14/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ii14",
                "id": 59243201,
                "login": "ii14",
                "node_id": "MDQ6VXNlcjU5MjQzMjAx",
                "organizations_url": "https://api.github.com/users/ii14/orgs",
                "received_events_url": "https://api.github.com/users/ii14/received_events",
                "repos_url": "https://api.github.com/users/ii14/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ii14/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ii14/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ii14"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Would emitting OSC 7 on `DirChanged` fix this? https://github.com/neovim/neovim/pull/16740 does this for `:terminal` but Nvim could also do this by default.\r\n\r\nMeanwhile, user config can do : \r\n\r\n    :autocmd DirChanged * call chansend(v:stderr, ...)",
            "created_at": "2023-01-12T17:12:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1380741053",
            "id": 1380741053,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5STG-9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380741053/reactions"
            },
            "updated_at": "2023-01-12T17:12:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380741053",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "if it is just `/proc/` shenanigans, the TUI could of course change its cwd as well. That would require an ui event for changed cwd, but that might be a reasonable pattern anyway. ",
            "created_at": "2023-01-12T17:32:35Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1380764341",
            "id": 1380764341,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5STMq1",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380764341/reactions"
            },
            "updated_at": "2023-01-12T17:32:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1380764341",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks for the tip, @justinmk!\r\n\r\nThis worked for me:\r\n```vim\r\nautocmd DirChanged * call chansend(v:stderr, printf(\"\\033]7;file://%s\\033\\\\\", v:event.cwd))\r\n```\r\nalong with the following bindings for tmux which I use to create splits in the current directory:\r\n```tmux\r\nbind-key | split-window -h -c '#{?pane_path,#{pane_path},#{pane_current_path}}'\r\nbind-key - split-window -v -c '#{?pane_path,#{pane_path},#{pane_current_path}}'\r\n```\r\n(OSC7 sets `#{pane_path}`, not `#{pane_current_path}` which is set from `/proc/${PID}/cwd`)\r\n\r\nNote: on 0.8.2 I didn't need the `autocmd` and I just had these bindings for `tmux`:\r\n```tmux\r\nbind-key | split-window -h -c '#{pane_current_path}'\r\nbind-key - split-window -v -c '#{pane_current_path}'\r\n```\r\nsince `tmux` happily picked up the current path from `/proc/${PID}/cwd` for the single process.",
            "created_at": "2023-01-13T03:56:48Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1381284566",
            "id": 1381284566,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5SVLrW",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 6,
                "laugh": 0,
                "rocket": 0,
                "total_count": 6,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1381284566/reactions"
            },
            "updated_at": "2023-04-29T08:56:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1381284566",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/878107?v=4",
                "events_url": "https://api.github.com/users/joshbode/events{/privacy}",
                "followers_url": "https://api.github.com/users/joshbode/followers",
                "following_url": "https://api.github.com/users/joshbode/following{/other_user}",
                "gists_url": "https://api.github.com/users/joshbode/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/joshbode",
                "id": 878107,
                "login": "joshbode",
                "node_id": "MDQ6VXNlcjg3ODEwNw==",
                "organizations_url": "https://api.github.com/users/joshbode/orgs",
                "received_events_url": "https://api.github.com/users/joshbode/received_events",
                "repos_url": "https://api.github.com/users/joshbode/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/joshbode/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joshbode/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/joshbode"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think the same issue is affecting `kitty` as well.\r\n\r\nOpening a new tab in the same cwd isn't picking up the latest change.\r\n\r\n---\r\n\r\n> (OSC7 sets `#{pane_path}`, not `#{pane_current_path}` which is set from `/proc/${PID}/cwd`)\r\n\r\n@joshbode, thanks! That did the trick for tmux.\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
            "created_at": "2023-02-17T09:16:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1434358711",
            "id": 1434358711,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5VfpO3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 1,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1434358711/reactions"
            },
            "updated_at": "2023-02-17T09:16:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1434358711",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/59826753?v=4",
                "events_url": "https://api.github.com/users/kylo252/events{/privacy}",
                "followers_url": "https://api.github.com/users/kylo252/followers",
                "following_url": "https://api.github.com/users/kylo252/following{/other_user}",
                "gists_url": "https://api.github.com/users/kylo252/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/kylo252",
                "id": 59826753,
                "login": "kylo252",
                "node_id": "MDQ6VXNlcjU5ODI2NzUz",
                "organizations_url": "https://api.github.com/users/kylo252/orgs",
                "received_events_url": "https://api.github.com/users/kylo252/received_events",
                "repos_url": "https://api.github.com/users/kylo252/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/kylo252/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kylo252/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/kylo252"
            }
        },
        {
            "author_association": "NONE",
            "body": "This is also affecting kitty. The workaround sending `OSC 7` does not work for kitty since it doesn't support `OSC 7` (https://github.com/kovidgoyal/kitty/issues/3024#issuecomment-930352975).\r\n\r\nThe author of kitty outlines how things should work (in his opinion) [here](https://github.com/kovidgoyal/kitty/discussions/4869).",
            "created_at": "2023-03-09T08:05:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1461520497",
            "id": 1461520497,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5XHQhx",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461520497/reactions"
            },
            "updated_at": "2023-03-09T08:05:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461520497",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/19842517?v=4",
                "events_url": "https://api.github.com/users/ces42/events{/privacy}",
                "followers_url": "https://api.github.com/users/ces42/followers",
                "following_url": "https://api.github.com/users/ces42/following{/other_user}",
                "gists_url": "https://api.github.com/users/ces42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ces42",
                "id": 19842517,
                "login": "ces42",
                "node_id": "MDQ6VXNlcjE5ODQyNTE3",
                "organizations_url": "https://api.github.com/users/ces42/orgs",
                "received_events_url": "https://api.github.com/users/ces42/received_events",
                "repos_url": "https://api.github.com/users/ces42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ces42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ces42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ces42"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Hmm, I don't think that's the same problem. This fixes the problem for kitty but not for tmux:\r\n```diff\r\ndiff --git a/src/nvim/event/libuv_process.c b/src/nvim/event/libuv_process.c\r\nindex e528d21a7..5f310193b 100644\r\n--- a/src/nvim/event/libuv_process.c\r\n+++ b/src/nvim/event/libuv_process.c\r\n@@ -37,8 +37,6 @@ int libuv_process_spawn(LibuvProcess *uvproc)\r\n     uvproc->uvopts.flags |= UV_PROCESS_DETACHED;\r\n   }\r\n #else\r\n-  // Always setsid() on unix-likes. #8107\r\n-  uvproc->uvopts.flags |= UV_PROCESS_DETACHED;\r\n #endif\r\n   uvproc->uvopts.exit_cb = exit_cb;\r\n   uvproc->uvopts.cwd = proc->cwd;\r\n```",
            "created_at": "2023-03-09T08:20:49Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1461542220",
            "id": 1461542220,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5XHV1M",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461542220/reactions"
            },
            "updated_at": "2023-03-09T08:21:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461542220",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq"
            }
        },
        {
            "author_association": "NONE",
            "body": "I don't really know how setsid works, but the author of kitty says that kitty looks at the child process with the highest pid associated to the terminal, which would be `nvim --embed` if it didn't call `setsid()` (I'm assuming the code you suggest removeing makes the `nvim --embed` process call `setsid()`?). tmux probably just used the first child process, so having the `nvim --embed` process attached/detached from the terminal does not make a difference.\r\n\r\nIn sum I guess both bugs are caused by the same thing (remote TUI) but might need a different fix.",
            "created_at": "2023-03-09T09:22:56Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1461640213",
            "id": 1461640213,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5XHtwV",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461640213/reactions"
            },
            "updated_at": "2023-07-01T12:01:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461640213",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/19842517?v=4",
                "events_url": "https://api.github.com/users/ces42/events{/privacy}",
                "followers_url": "https://api.github.com/users/ces42/followers",
                "following_url": "https://api.github.com/users/ces42/following{/other_user}",
                "gists_url": "https://api.github.com/users/ces42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ces42",
                "id": 19842517,
                "login": "ces42",
                "node_id": "MDQ6VXNlcjE5ODQyNTE3",
                "organizations_url": "https://api.github.com/users/ces42/orgs",
                "received_events_url": "https://api.github.com/users/ces42/received_events",
                "repos_url": "https://api.github.com/users/ces42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ces42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ces42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ces42"
            }
        },
        {
            "author_association": "NONE",
            "body": "It turns out kitty *did* add support for `OSC 7` in https://github.com/kovidgoyal/kitty/commit/afa6128155630e7506f4ad229eccb84bbd8731fb and https://github.com/kovidgoyal/kitty/commit/e33bf110123b8715a1399240c54e622456d9a374, if you use `launch` with `--cwd=last_reported`. With that, @joshbode's workaround \r\n```vim\r\nautocmd DirChanged * call chansend(v:stderr, printf(\"\\033]7;file://%s\\033\\\\\", v:event.cwd))\r\n```\r\nworks with kitty.",
            "created_at": "2023-03-09T10:03:36Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1461710157",
            "id": 1461710157,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5XH-1N",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461710157/reactions"
            },
            "updated_at": "2023-07-01T11:27:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1461710157",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/19842517?v=4",
                "events_url": "https://api.github.com/users/ces42/events{/privacy}",
                "followers_url": "https://api.github.com/users/ces42/followers",
                "following_url": "https://api.github.com/users/ces42/following{/other_user}",
                "gists_url": "https://api.github.com/users/ces42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ces42",
                "id": 19842517,
                "login": "ces42",
                "node_id": "MDQ6VXNlcjE5ODQyNTE3",
                "organizations_url": "https://api.github.com/users/ces42/orgs",
                "received_events_url": "https://api.github.com/users/ces42/received_events",
                "repos_url": "https://api.github.com/users/ces42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ces42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ces42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ces42"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@ces42 that looks like the same line @joshbode originally wrote - am I missing a difference that was needed to make it work with kitty (other than also using `--cwd=last_reported`)?",
            "created_at": "2023-07-01T11:24:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1615857669",
            "id": 1615857669,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5gUAgF",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1615857669/reactions"
            },
            "updated_at": "2023-07-01T11:24:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1615857669",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/802511?v=4",
                "events_url": "https://api.github.com/users/ddickstein/events{/privacy}",
                "followers_url": "https://api.github.com/users/ddickstein/followers",
                "following_url": "https://api.github.com/users/ddickstein/following{/other_user}",
                "gists_url": "https://api.github.com/users/ddickstein/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ddickstein",
                "id": 802511,
                "login": "ddickstein",
                "node_id": "MDQ6VXNlcjgwMjUxMQ==",
                "organizations_url": "https://api.github.com/users/ddickstein/orgs",
                "received_events_url": "https://api.github.com/users/ddickstein/received_events",
                "repos_url": "https://api.github.com/users/ddickstein/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ddickstein/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ddickstein/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ddickstein"
            }
        },
        {
            "author_association": "NONE",
            "body": "You're right. I thought that another change was needed but I checked my config and it just has @joshbode's line",
            "created_at": "2023-07-01T11:29:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1615859631",
            "id": 1615859631,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5gUA-v",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1615859631/reactions"
            },
            "updated_at": "2023-07-01T11:29:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1615859631",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/19842517?v=4",
                "events_url": "https://api.github.com/users/ces42/events{/privacy}",
                "followers_url": "https://api.github.com/users/ces42/followers",
                "following_url": "https://api.github.com/users/ces42/following{/other_user}",
                "gists_url": "https://api.github.com/users/ces42/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ces42",
                "id": 19842517,
                "login": "ces42",
                "node_id": "MDQ6VXNlcjE5ODQyNTE3",
                "organizations_url": "https://api.github.com/users/ces42/orgs",
                "received_events_url": "https://api.github.com/users/ces42/received_events",
                "repos_url": "https://api.github.com/users/ces42/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ces42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ces42/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ces42"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "For display purposes, it may be helpful to adjust the recommended tmux line to do a regex strip of the \"file://\" prefix:\r\n\r\n```\r\n#{?pane_path,#{pane_path},#{pane_current_path}}\r\n```\r\nbecomes\r\n```\r\n\"#{?pane_path,#{s@^file.//@@:pane_path},#{pane_current_path}}\"\r\n```\r\n(this suggestion is taken from https://github.com/tmux/tmux/issues/2506)\r\n\r\nI also need this command to unset `#{pane_path}` when Neovim exits so that the last set value isn't stuck:\r\n```\r\nautocmd VimLeave * call chansend(v:stderr, \"\\033]7;\\033\\\\\")\r\n```",
            "created_at": "2023-07-01T12:49:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1615894467",
            "id": 1615894467,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5gUJfD",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 1,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1615894467/reactions"
            },
            "updated_at": "2023-07-01T16:29:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1615894467",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/802511?v=4",
                "events_url": "https://api.github.com/users/ddickstein/events{/privacy}",
                "followers_url": "https://api.github.com/users/ddickstein/followers",
                "following_url": "https://api.github.com/users/ddickstein/following{/other_user}",
                "gists_url": "https://api.github.com/users/ddickstein/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ddickstein",
                "id": 802511,
                "login": "ddickstein",
                "node_id": "MDQ6VXNlcjgwMjUxMQ==",
                "organizations_url": "https://api.github.com/users/ddickstein/orgs",
                "received_events_url": "https://api.github.com/users/ddickstein/received_events",
                "repos_url": "https://api.github.com/users/ddickstein/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ddickstein/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ddickstein/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ddickstein"
            }
        },
        {
            "author_association": "NONE",
            "body": "Unfortunately the workaround doesn't seem to work for terminals like alacritty that haven't implemented OSC 7 (https://github.com/alacritty/alacritty/pull/2937). Hopefully a long-term solution to this issue would be to change the TUI's cwd rather than only emitting OSC 7, though I understand why this isn't prioritized given the workaround seems to work for most people.",
            "created_at": "2024-01-17T19:10:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1896467336",
            "id": 1896467336,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5xCcuI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1896467336/reactions"
            },
            "updated_at": "2024-01-17T19:10:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1896467336",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38380316?v=4",
                "events_url": "https://api.github.com/users/gadanidis/events{/privacy}",
                "followers_url": "https://api.github.com/users/gadanidis/followers",
                "following_url": "https://api.github.com/users/gadanidis/following{/other_user}",
                "gists_url": "https://api.github.com/users/gadanidis/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gadanidis",
                "id": 38380316,
                "login": "gadanidis",
                "node_id": "MDQ6VXNlcjM4MzgwMzE2",
                "organizations_url": "https://api.github.com/users/gadanidis/orgs",
                "received_events_url": "https://api.github.com/users/gadanidis/received_events",
                "repos_url": "https://api.github.com/users/gadanidis/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gadanidis/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gadanidis/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gadanidis"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Changing the TUIâ€™s pwd is (imo) the better solution anyway. OSC 7 for this purpose strikes me as a bit of a hack",
            "created_at": "2024-01-18T00:19:40Z",
            "html_url": "https://github.com/neovim/neovim/issues/21771#issuecomment-1897542576",
            "id": 1897542576,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21771",
            "node_id": "IC_kwDOAPphoM5xGjOw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1897542576/reactions"
            },
            "updated_at": "2024-01-18T00:19:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1897542576",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders"
            }
        }
    ],
    "comments": 17,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/21771/comments",
    "created_at": "2023-01-12T11:58:42Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/21771/events",
    "html_url": "https://github.com/neovim/neovim/issues/21771",
    "id": 1530588841,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue is not fixed but can be circumvented until then",
            "id": 435850181,
            "name": "has:workaround",
            "node_id": "MDU6TGFiZWw0MzU4NTAxODE=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:workaround"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/21771/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 252,
        "created_at": "2023-02-02T14:11:43Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
            "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
            "followers_url": "https://api.github.com/users/bfredl/followers",
            "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
            "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/bfredl",
            "id": 1363104,
            "login": "bfredl",
            "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
            "organizations_url": "https://api.github.com/users/bfredl/orgs",
            "received_events_url": "https://api.github.com/users/bfredl/received_events",
            "repos_url": "https://api.github.com/users/bfredl/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/bfredl"
        },
        "description": "",
        "due_on": "2024-03-01T08:00:00Z",
        "html_url": "https://github.com/neovim/neovim/milestone/36",
        "id": 8997654,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/36/labels",
        "node_id": "MI_kwDOAPphoM4AiUsW",
        "number": 36,
        "open_issues": 134,
        "state": "open",
        "title": "0.10",
        "updated_at": "2024-01-22T22:15:07Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/36"
    },
    "node_id": "I_kwDOAPphoM5bOu6p",
    "number": 21771,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 6,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 6,
        "url": "https://api.github.com/repos/neovim/neovim/issues/21771/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/21771/timeline",
    "title": "tui: tmux can no longer read the CWD (regression)",
    "updated_at": "2024-01-19T22:45:12Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/21771",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/59826753?v=4",
        "events_url": "https://api.github.com/users/kylo252/events{/privacy}",
        "followers_url": "https://api.github.com/users/kylo252/followers",
        "following_url": "https://api.github.com/users/kylo252/following{/other_user}",
        "gists_url": "https://api.github.com/users/kylo252/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/kylo252",
        "id": 59826753,
        "login": "kylo252",
        "node_id": "MDQ6VXNlcjU5ODI2NzUz",
        "organizations_url": "https://api.github.com/users/kylo252/orgs",
        "received_events_url": "https://api.github.com/users/kylo252/received_events",
        "repos_url": "https://api.github.com/users/kylo252/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/kylo252/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/kylo252/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/kylo252"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nWhen using --remote-ui through SSH tunnels to connect to headless daemons, OSC 52 clipboard sequences fail to reach the local terminal due to SSH's limitations in forwarding terminal escape sequences. Requesting a mechanism to make OSC 52 work in tunneled environments.\n\nSteps to describe the behavior:\n1. Set up a headless Neovim daemon as a systemd user service on remote host\n```\n# ~/.config/systemd/user/nvim-daemon.service\n[Service]\nExecStart=/usr/bin/nvim --headless --listen 127.0.0.1:22222\nRestart=always\n```\n2. Start the service: `systemctl --user enable --now nvim-daemon.service` on remote host\n3. Create SSH tunnel on local client: `ssh -L 9999:localhost:22222 remote-host`\n4. Connect with remote UI from local client to remote host: `nvim --server 127.0.0.1:9999 --remote-ui`\n5. Attempt to yank text in Neovim - OSC 52 sequences are generated but don't reach local clipboard\n\nI think the following points are noteworthy:\n- The Neovim daemon runs without a TTY (headless systemd service)\n- OSC 52 sequences are still generated by Neovim\n- Direct SSH sessions work: `ssh -t remote-host nvim --remote-ui` handles OSC 52 correctly\n- The issue specifically affects port-forwarded connections (-L) to headless daemons\n\nI've verified that OSC 52 is working in the terminal itself (kitty) with `echo -ne '\\e]52;c;'$(echo \"test\" | base64)'\\a'` which copies `test` to the system clipboard.\n\nI've verified that OSC 52 is working over SSH directly via `ssh work-wsl -t 'echo -ne \"\\e]52;c;'$(echo \"ssh-test\" | base64)'\\a\"'` which copies `ssh-test` to the system clipboard.\n\nI've verified that my minimal nvim config on the remote host (see below along with version) has OSC 52 support enabled and that it works as expected when ssh'ing directly into my remote server and yanking from the ssh session (successfully copies to the system clipboard).\n\nnvim version info:\nNVIM v0.12.0-dev-1263+g04f476733c\nBuild type: RelWithDebInfo\nLuaJIT 2.1.1753364724\n\n```\n-- minimal config/nvim/init.lua\nvim.opt.clipboard = \"unnamedplus\"\nvim.g.clipboard = \"osc52\"\n```\n\nDirectly ssh'ing into the remote server and with OSC 52 enabled in nvim, the system clipboard is populated on yank when in a bare shell (bash) and also when in a tmux session (with the following config options set in tmux.conf)\n\n```\nset -g allow-passthrough on\nset -g set-clipboard on\n```\n\nLastly here's my .ssh/config setup I'm using for the tunnel\n\n```\nHost work-wsl\n    HostName x.x.x.x\n    User myremoteuser\n    Port 22222\n    ControlMaster auto\n    ControlPath ~/.ssh/control-%r@%h:%p\n```\n\nApologies in advance if this makes no sense as I've struggled with best way to report or request this because there are so many interconnected parts here that are just outside of my frame of understanding. \n\nThis may or may not be related to #28792 and/or #35481\n\n\n\n### Expected behavior\n\nOSC 52 sequence detection and proxy system for ssh tunneled connections",
    "closed_at": "2025-09-20T19:27:29Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "This is a great report in terms of clarity/analysis, but yes it's a duplicate of https://github.com/neovim/neovim/issues/28792 / https://github.com/neovim/neovim/issues/35481 .\n\n> Direct SSH sessions work: `ssh -t remote-host nvim --remote-ui` handles OSC 52 correctly\n\nIn that case, the Nvim UI (which is running on the remote system) has terminal a PTY to work with (by definition of `ssh -t`). \n\nIn the `ssh -L` case, the remote `nvim` server does not have a PTY to emit to. It only has the msgpack-rpc channel, which is why https://github.com/neovim/neovim/issues/35481 is relevant (structured events instead of terminal sequences). So \"enhanced OSC 52\" is a non-sequitur.\n\nbtw, can you check the output of this in both cases (specifically the `stdout_tty` and `stdin_tty` fields:\n\n    :echo nvim_list_uis()\n",
            "created_at": "2025-09-20T19:27:16Z",
            "html_url": "https://github.com/neovim/neovim/issues/35848#issuecomment-3315189732",
            "id": 3315189732,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35848",
            "node_id": "IC_kwDOAPphoM7Fmcfk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3315189732/reactions"
            },
            "updated_at": "2025-09-20T19:29:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3315189732",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thank you for the graceful and detailed explanation, @justinmk. It really helped clear up my confusion.\n\n> btw, can you check the output of this in both cases (specifically the `stdout_tty` and `stdin_tty` fields:\n> \n> ```\n> :echo nvim_list_uis()\n> ```\n\nOf course, here's the output from the ssh -L case::\n\n```\n[{'ext_multigrid': v:false, 'term_name': 'xterm-kitty', 'height': 36, 'stdout_tty': v:false, 'chan': 3, 'ext_wildmenu': v:false, 'ext_popupmenu': v:false, 'width': 174, 'rgb': v:false, 'override': v:false, 'ext_hlstate': v:false, 'ext_messages': v:false, 'ext_termcolors': v:true, 'ext_tabline': v:false, 'ext_linegrid': v:true, 'term_background': '', 'ext_cmdline': v:false, 'stdin_tty': v:false, 'term_colors': 256}]\n```\n\nAnd here's the output from the ssh -t case (exact command run was `ssh -t work-wsl 'NVIM_APPNAME=nvim-minimal-repro nvim --server 127.0.0.1:22222 --remote-ui'` \n\nIn the tmux session (with the minimal tmux.conf from OP), OSC 52 works and populates the system clipboard. In a regular terminal session, the clipboard was not populated on yank.\n\n```\n--tmux sesssion\n[{'ext_multigrid': v:false, 'term_name': 'tmux-256color', 'height': 35, 'stdout_tty': v:true, 'chan': 1, 'ext_wildmenu': v:false, 'ext_popupmenu': v:false, 'width': 174, 'rgb': v:false, 'override': v:false, 'ext_hlstate': v:false, 'ext_messages': v:false, 'ext_termcolors': v:true, 'ext_tabline': v:false, 'ext_linegrid': v:true, 'term_background': '', 'ext_cmdline': v:false, 'stdin_tty': v:true, 'term_colors': 256}]\n```\n\n```\n--non tmux session\n[{'ext_multigrid': v:false, 'term_name': 'xterm-kitty', 'height': 36, 'stdout_tty': v:false, 'chan': 3, 'ext_wildmenu': v:false, 'ext_popupmenu': v:false, 'width': 174, 'rgb': v:false, 'override': v:false, 'ext_hlstate': v:false, 'ext_messages': v:false, 'ext_termcolors': v:true, 'ext_tabline': v:false, 'ext_linegrid': v:true, 'term_background': '', 'ext_cmdline': v:false, 'stdin_tty': v:false, 'term_colors': 256}]\n```",
            "created_at": "2025-09-21T01:17:48Z",
            "html_url": "https://github.com/neovim/neovim/issues/35848#issuecomment-3315416097",
            "id": 3315416097,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35848",
            "node_id": "IC_kwDOAPphoM7FnTwh",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3315416097/reactions"
            },
            "updated_at": "2025-09-21T01:17:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3315416097",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/21365869?v=4",
                "events_url": "https://api.github.com/users/CarbonChauvinist/events{/privacy}",
                "followers_url": "https://api.github.com/users/CarbonChauvinist/followers",
                "following_url": "https://api.github.com/users/CarbonChauvinist/following{/other_user}",
                "gists_url": "https://api.github.com/users/CarbonChauvinist/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/CarbonChauvinist",
                "id": 21365869,
                "login": "CarbonChauvinist",
                "node_id": "MDQ6VXNlcjIxMzY1ODY5",
                "organizations_url": "https://api.github.com/users/CarbonChauvinist/orgs",
                "received_events_url": "https://api.github.com/users/CarbonChauvinist/received_events",
                "repos_url": "https://api.github.com/users/CarbonChauvinist/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/CarbonChauvinist/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/CarbonChauvinist/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/CarbonChauvinist",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "So clipboard works in cases where `stdin_*=true`, else not.\n\n> In the tmux session (with the minimal tmux.conf from OP), OSC 52 works and populates the system clipboard. In a regular terminal session, the clipboard was not populated on yank.\n\nThis reminds me of something I noticed, which is that OSC 52 is broken after *reattaching* to a server, even from the same host-terminal. \n\n```\nnvim --listen ./foo +'let g:clipboard=\"osc52\"'\n:detach\nnvim --remote-ui --server ./foo\n# clipboard is broken after this\n```\n\nThat might be the same root cause as what you are seeing, and same as https://github.com/neovim/neovim/issues/28792 \n\n",
            "created_at": "2025-09-21T03:40:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/35848#issuecomment-3315474401",
            "id": 3315474401,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35848",
            "node_id": "IC_kwDOAPphoM7Fnh_h",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3315474401/reactions"
            },
            "updated_at": "2025-09-21T03:42:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3315474401",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 3,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/35848/comments",
    "created_at": "2025-09-20T18:43:15Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/35848/events",
    "html_url": "https://github.com/neovim/neovim/issues/35848",
    "id": 3437405349,
    "issue_dependencies_summary": {
        "blocked_by": 0,
        "blocking": 0,
        "total_blocked_by": 0,
        "total_blocking": 0
    },
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 113026979,
            "name": "ui",
            "node_id": "MDU6TGFiZWwxMTMwMjY5Nzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "clipboard, paste",
            "id": 186192409,
            "name": "clipboard",
            "node_id": "MDU6TGFiZWwxODYxOTI0MDk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/clipboard"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "remote UI, --remote commands, p2p / peer-to-peer",
            "id": 2269137131,
            "name": "remote",
            "node_id": "MDU6TGFiZWwyMjY5MTM3MTMx",
            "url": "https://api.github.com/repos/neovim/neovim/labels/remote"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/35848/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM7M4qSl",
    "number": 35848,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/35848/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "duplicate",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/35848/timeline",
    "title": "Enhanced OSC 52 clipboard support for --remote-ui over SSH tunnels",
    "type": {
        "color": "blue",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "A request, idea, or new functionality",
        "id": 597167,
        "is_enabled": true,
        "name": "Enhancement",
        "node_id": "IT_kwDOAGK_Pc4ACRyv",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-09-21T03:42:39Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/35848",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/21365869?v=4",
        "events_url": "https://api.github.com/users/CarbonChauvinist/events{/privacy}",
        "followers_url": "https://api.github.com/users/CarbonChauvinist/followers",
        "following_url": "https://api.github.com/users/CarbonChauvinist/following{/other_user}",
        "gists_url": "https://api.github.com/users/CarbonChauvinist/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/CarbonChauvinist",
        "id": 21365869,
        "login": "CarbonChauvinist",
        "node_id": "MDQ6VXNlcjIxMzY1ODY5",
        "organizations_url": "https://api.github.com/users/CarbonChauvinist/orgs",
        "received_events_url": "https://api.github.com/users/CarbonChauvinist/received_events",
        "repos_url": "https://api.github.com/users/CarbonChauvinist/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/CarbonChauvinist/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/CarbonChauvinist/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/CarbonChauvinist",
        "user_view_type": "public"
    }
}
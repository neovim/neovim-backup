{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\nI invoke Man as a $MANPAGER from a terminal within neovim.\r\nI do this by using [neovim-remote](https://github.com/mhinz/neovim-remote) plugin and setting `MANPAGER=\"nvr +'Man!' -\"`\r\n`init_pager` in `man.lua` crashes if there's already an open buffer for the man pages.\r\n\r\nThe line responsible for the error is this one:\r\n`vim.cmd.file({ 'man://' .. fn.fnameescape(ref):lower(), mods = { silent = true } })`\r\nIt tries to rename the buffer to a name that's already taken.\r\n\r\nSuggested solution:\r\nCheck if there's already a buffer with that name and go to that existing buffer if so. \r\n\n\n### Steps to reproduce\n\n* Add [neovim-remote](https://github.com/mhinz/neovim-remote) plugin.\r\n* Add this line to your **init.vim**: `let $MANPAGER=\"nvr +'Man!' -\"`\r\n* Start a terminal: `:term`\r\n* Run `man ls`\r\n* Go back to the terminal\r\n* Run `man ls` again\r\n\r\nI don't know if it's possible to use neovim's builtin remote functionality for $MANPAGER. If it is possible, then the error could be reproduced without any plugins.\n\n### Expected behavior\n\nDon't crash and go to the existing buffer instead\n\n### Neovim version (nvim -v)\n\n0.9.5\n\n### Vim (not Nvim) behaves the same?\n\nNo Man in vim\n\n### Operating system/version\n\nN/A\n\n### Terminal name/version\n\nN/A\n\n### $TERM environment variable\n\nN/A\n\n### Installation\n\nN/A",
    "closed_at": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "You should just use `nvim --server $NVIM --remote`. Also, please use the latest version (0.10.1), at least for testing.\r\n",
            "created_at": "2024-08-24T10:35:32Z",
            "html_url": "https://github.com/neovim/neovim/issues/30132#issuecomment-2308338141",
            "id": 2308338141,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30132",
            "node_id": "IC_kwDOAPphoM6JlnHd",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2308338141/reactions"
            },
            "updated_at": "2024-08-24T10:38:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2308338141",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason"
            }
        },
        {
            "author_association": "NONE",
            "body": "> You should just use nvim --server $NVIM --remote\r\n\r\nI tried `let $MANPAGER=\"nvim --server $NVIM --remote\"`. It starts neovim from the terminal within neovim\r\n\r\n> Also, please use the latest version (0.10.1), at least for testing\r\n\r\nPretty sure version is irrelevant as the code responsible hasn't changed",
            "created_at": "2024-08-24T10:57:20Z",
            "html_url": "https://github.com/neovim/neovim/issues/30132#issuecomment-2308354135",
            "id": 2308354135,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30132",
            "node_id": "IC_kwDOAPphoM6JlrBX",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2308354135/reactions"
            },
            "updated_at": "2024-08-29T16:26:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2308354135",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/136635201?v=4",
                "events_url": "https://api.github.com/users/Mo-tmd/events{/privacy}",
                "followers_url": "https://api.github.com/users/Mo-tmd/followers",
                "following_url": "https://api.github.com/users/Mo-tmd/following{/other_user}",
                "gists_url": "https://api.github.com/users/Mo-tmd/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Mo-tmd",
                "id": 136635201,
                "login": "Mo-tmd",
                "node_id": "U_kgDOCCTjQQ",
                "organizations_url": "https://api.github.com/users/Mo-tmd/orgs",
                "received_events_url": "https://api.github.com/users/Mo-tmd/received_events",
                "repos_url": "https://api.github.com/users/Mo-tmd/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Mo-tmd/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Mo-tmd/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Mo-tmd"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Are you sure you're seeing a crash? I think the following steps should reproduce what you see, but there's no crash, only an error message:\r\n```vim\r\n:new\r\n:r!man -Pcat printf\r\n:Man!\r\n:new\r\n:r!man -Pcat printf\r\n:Man!\r\n```\r\nThis prints:\r\n```\r\nError executing Lua callback: /tmp/.mount_nvimMpq0c5/usr/share/nvim/runtime/lua/man.lua:675: Vim:E95: Buffer with this name already exists\r\nstack traceback:\r\n        [C]: in function 'file'\r\n        /tmp/.mount_nvimMpq0c5/usr/share/nvim/runtime/lua/man.lua:675: in function 'init_pager'\r\n        .../.mount_nvimMpq0c5/usr/share/nvim/runtime/plugin/man.lua:9: in function <.../.mount_nvimMpq0c5/usr/share/nvim/runtime/plugin/man.lua:6>\r\n```\r\nWhich is pretty reasonable IMO.",
            "created_at": "2024-08-26T14:07:28Z",
            "html_url": "https://github.com/neovim/neovim/issues/30132#issuecomment-2310308413",
            "id": 2310308413,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30132",
            "node_id": "IC_kwDOAPphoM6JtII9",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2310308413/reactions"
            },
            "updated_at": "2024-08-26T14:08:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2310308413",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11534587?v=4",
                "events_url": "https://api.github.com/users/glacambre/events{/privacy}",
                "followers_url": "https://api.github.com/users/glacambre/followers",
                "following_url": "https://api.github.com/users/glacambre/following{/other_user}",
                "gists_url": "https://api.github.com/users/glacambre/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glacambre",
                "id": 11534587,
                "login": "glacambre",
                "node_id": "MDQ6VXNlcjExNTM0NTg3",
                "organizations_url": "https://api.github.com/users/glacambre/orgs",
                "received_events_url": "https://api.github.com/users/glacambre/received_events",
                "repos_url": "https://api.github.com/users/glacambre/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glacambre/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glacambre/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glacambre"
            }
        },
        {
            "author_association": "NONE",
            "body": "@glacambre, yes that's the error I see, thank you and sorry for my confusing terminology.\r\n\r\nNot sure it's reasonable to get an error when there's a forgotten buffer for that MAN page. It should either go to existing buffer (and wipe out the temporary one), or it should make unique buffer names (e.g. by prefixing with buffer number)\r\n\r\nAlso when using Man as a general $PAGER or $GIT_PAGER, you can get the same buffer name but with different content depending on the command. But perhaps Man plugin wasn't designed for such use cases though.",
            "created_at": "2024-08-26T17:54:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/30132#issuecomment-2310752729",
            "id": 2310752729,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30132",
            "node_id": "IC_kwDOAPphoM6Ju0nZ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2310752729/reactions"
            },
            "updated_at": "2024-08-26T17:54:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2310752729",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/136635201?v=4",
                "events_url": "https://api.github.com/users/Mo-tmd/events{/privacy}",
                "followers_url": "https://api.github.com/users/Mo-tmd/followers",
                "following_url": "https://api.github.com/users/Mo-tmd/following{/other_user}",
                "gists_url": "https://api.github.com/users/Mo-tmd/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Mo-tmd",
                "id": 136635201,
                "login": "Mo-tmd",
                "node_id": "U_kgDOCCTjQQ",
                "organizations_url": "https://api.github.com/users/Mo-tmd/orgs",
                "received_events_url": "https://api.github.com/users/Mo-tmd/received_events",
                "repos_url": "https://api.github.com/users/Mo-tmd/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Mo-tmd/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Mo-tmd/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Mo-tmd"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">It should either go to existing buffer\r\n\r\nI'm not sure this is possible, since two buffers for `printf` could have different contents.\r\n\r\n>it should make unique buffer names\r\n\r\nThat sounds like a reasonable enhancement. Hopefully there aren't any plugins relying either on the current naming scheme of `man://` buffers or on catching the errors.",
            "created_at": "2024-08-26T19:07:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/30132#issuecomment-2310882286",
            "id": 2310882286,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30132",
            "node_id": "IC_kwDOAPphoM6JvUPu",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2310882286/reactions"
            },
            "updated_at": "2024-08-26T19:07:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2310882286",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/11534587?v=4",
                "events_url": "https://api.github.com/users/glacambre/events{/privacy}",
                "followers_url": "https://api.github.com/users/glacambre/followers",
                "following_url": "https://api.github.com/users/glacambre/following{/other_user}",
                "gists_url": "https://api.github.com/users/glacambre/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glacambre",
                "id": 11534587,
                "login": "glacambre",
                "node_id": "MDQ6VXNlcjExNTM0NTg3",
                "organizations_url": "https://api.github.com/users/glacambre/orgs",
                "received_events_url": "https://api.github.com/users/glacambre/received_events",
                "repos_url": "https://api.github.com/users/glacambre/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glacambre/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glacambre/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glacambre"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> That sounds like a reasonable enhancement. Hopefully there aren't any plugins relying either on the current naming scheme of `man://` buffers or on catching the errors.\r\n\r\nWe don't need to change the naming scheme. We can special-case this scenario and choose a non-existing buf name to support this edge case.\r\n\r\nChanging the `man://` URI format is out of scope.",
            "created_at": "2024-08-29T16:30:03Z",
            "html_url": "https://github.com/neovim/neovim/issues/30132#issuecomment-2318303064",
            "id": 2318303064,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/30132",
            "node_id": "IC_kwDOAPphoM6KLn9Y",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2318303064/reactions"
            },
            "updated_at": "2024-08-29T16:30:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2318303064",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/30132/comments",
    "created_at": "2024-08-24T10:33:48Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/30132/events",
    "html_url": "https://github.com/neovim/neovim/issues/30132",
    "id": 2484487419,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "plugins and Vim \"pack\"",
            "id": 117905553,
            "name": "plugin",
            "node_id": "MDU6TGFiZWwxMTc5MDU1NTM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/plugin"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "funtime",
            "id": 120251370,
            "name": "runtime",
            "node_id": "MDU6TGFiZWwxMjAyNTEzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/runtime"
        },
        {
            "color": "BFDADC",
            "default": false,
            "description": "Low-risk, self-contained. Do NOT ask \"can I work on this\", just read CONTRIBUTING.md",
            "id": 407246773,
            "name": "complexity:low",
            "node_id": "MDU6TGFiZWw0MDcyNDY3NzM=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/complexity:low"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/30132/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 233,
        "created_at": "2014-11-26T22:13:11Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk"
        },
        "description": "Zero priority; no timeline. Promote an item from this state by taking ownership of it.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/9",
        "id": 881978,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/9/labels",
        "node_id": "MDk6TWlsZXN0b25lODgxOTc4",
        "number": 9,
        "open_issues": 260,
        "state": "open",
        "title": "unplanned",
        "updated_at": "2024-09-02T19:45:33Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/9"
    },
    "node_id": "I_kwDOAPphoM6UFkT7",
    "number": 30132,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/30132/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/30132/timeline",
    "title": "\"E95: Buffer already exists\" when raw manpage contents piped into :Man",
    "updated_at": "2024-08-29T16:30:04Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/30132",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/136635201?v=4",
        "events_url": "https://api.github.com/users/Mo-tmd/events{/privacy}",
        "followers_url": "https://api.github.com/users/Mo-tmd/followers",
        "following_url": "https://api.github.com/users/Mo-tmd/following{/other_user}",
        "gists_url": "https://api.github.com/users/Mo-tmd/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/Mo-tmd",
        "id": 136635201,
        "login": "Mo-tmd",
        "node_id": "U_kgDOCCTjQQ",
        "organizations_url": "https://api.github.com/users/Mo-tmd/orgs",
        "received_events_url": "https://api.github.com/users/Mo-tmd/received_events",
        "repos_url": "https://api.github.com/users/Mo-tmd/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/Mo-tmd/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Mo-tmd/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/Mo-tmd"
    }
}
{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Problem\n\n[lsp_lines.nvim](https://git.sr.ht/~whynothugo/lsp_lines.nvim) uses `nvim_buf_set_extmark` to create extmarks in a buffer. These extmarks use `virtual_lines` with some spaces on the left so that the properly align with the position of a diagnostic on the line above.\n\nWhen I scroll to the right on buffer, the extmarks remain anchored in position relative to the _window_, not to the buffer. As a result, the extmarks are not properly positioned relative to the buffer, and the overflowing portion of the extmarks are unreadable.\n\nextmarks and their position are declared for buffers, so their position should be relative to buffers, not windows.\n\nGiven that multiple windows can render the same buffer, I cannot take the scroll offset into account when rendering the extmarks, because one the \"correct\" value varies per-window.\n\n### Steps to reproduce\n\nAdd this to your `init.lua`:\n\n```lua\nvim.keymap.set(\"n\", \"<Leader>x\", function()\n  local ns = vim.api.nvim_create_namespace(\"test\")\n  local line = {\n    \"hello, this is just some test text. It should be anchored under first line\",\n  }\n  local virt_lines = { { line } }\n\n  vim.api.nvim_buf_set_extmark(0, ns, 0, 0, {\n    virt_lines = virt_lines,\n  })\nend)\n```\n\nOpen some file and press `250ix`, then press <kbd>Esc</kbd> and <kbd>Leader</kbd><kbd>x</kbd>.\n\nScroll to the right.\n\nThe virtual text will maintain its absolute position relative to the window, not relative to the buffer.\n\n### Expected behavior\n\nWhen scrolling to the right, the virtual line should scroll too, keeping its position relative to the buffer.\n\n### Nvim version (nvim -v)\n\nNVIM v0.10.2\n\n### Vim (not Nvim) behaves the same?\n\nn/a\n\n### Operating system/version\n\nAlpine Linux\n\n### Terminal name/version\n\nfoot\n\n### $TERM environment variable\n\nfoot\n\n### Installation\n\nAlpine packages (edge)",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "A related problem https://github.com/windwp/nvim-autopairs/pull/474",
            "created_at": "2024-10-31T02:22:26Z",
            "html_url": "https://github.com/neovim/neovim/issues/31000#issuecomment-2448889315",
            "id": 2448889315,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31000",
            "node_id": "IC_kwDOAPphoM6R9xXj",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2448889315/reactions"
            },
            "updated_at": "2024-10-31T02:22:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2448889315",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/97848247?v=4",
                "events_url": "https://api.github.com/users/xzbdmw/events{/privacy}",
                "followers_url": "https://api.github.com/users/xzbdmw/followers",
                "following_url": "https://api.github.com/users/xzbdmw/following{/other_user}",
                "gists_url": "https://api.github.com/users/xzbdmw/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/xzbdmw",
                "id": 97848247,
                "login": "xzbdmw",
                "node_id": "U_kgDOBdULtw",
                "organizations_url": "https://api.github.com/users/xzbdmw/orgs",
                "received_events_url": "https://api.github.com/users/xzbdmw/received_events",
                "repos_url": "https://api.github.com/users/xzbdmw/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/xzbdmw/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/xzbdmw/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/xzbdmw",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 1,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/31000/comments",
    "created_at": "2024-10-30T19:33:40Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/31000/events",
    "html_url": "https://github.com/neovim/neovim/issues/31000",
    "id": 2625144899,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "marks, extmarks, decorations, virtual text, namespaces",
            "id": 1680119719,
            "name": "marks",
            "node_id": "MDU6TGFiZWwxNjgwMTE5NzE5",
            "url": "https://api.github.com/repos/neovim/neovim/labels/marks"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/31000/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 260,
        "created_at": "2014-11-26T22:13:11Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        },
        "description": "We don't plan to work on this, but will accept high quality contributions from someone who will own the feature and follow up on bug reports.",
        "due_on": null,
        "html_url": "https://github.com/neovim/neovim/milestone/9",
        "id": 881978,
        "labels_url": "https://api.github.com/repos/neovim/neovim/milestones/9/labels",
        "node_id": "MDk6TWlsZXN0b25lODgxOTc4",
        "number": 9,
        "open_issues": 297,
        "state": "open",
        "title": "needs-owner",
        "updated_at": "2025-01-20T17:56:23Z",
        "url": "https://api.github.com/repos/neovim/neovim/milestones/9"
    },
    "node_id": "I_kwDOAPphoM6ceIhD",
    "number": 31000,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/neovim/neovim/issues/31000/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/31000/timeline",
    "title": "virt_lines doesn't scroll horizontally",
    "updated_at": "2025-01-17T15:26:09Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/31000",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/730811?v=4",
        "events_url": "https://api.github.com/users/WhyNotHugo/events{/privacy}",
        "followers_url": "https://api.github.com/users/WhyNotHugo/followers",
        "following_url": "https://api.github.com/users/WhyNotHugo/following{/other_user}",
        "gists_url": "https://api.github.com/users/WhyNotHugo/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/WhyNotHugo",
        "id": 730811,
        "login": "WhyNotHugo",
        "node_id": "MDQ6VXNlcjczMDgxMQ==",
        "organizations_url": "https://api.github.com/users/WhyNotHugo/orgs",
        "received_events_url": "https://api.github.com/users/WhyNotHugo/received_events",
        "repos_url": "https://api.github.com/users/WhyNotHugo/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/WhyNotHugo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/WhyNotHugo/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/WhyNotHugo",
        "user_view_type": "public"
    }
}
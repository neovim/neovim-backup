{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "`getwininfo()` returns the line one above the bottom line as `botline` when the last line is wrapped.\r\n\r\n- `nvim --version`: NVIM v0.5.0-dev+1226-g370469be2\r\n- `vim -u DEFAULTS` (version: VIM - Vi IMproved 8.2) behaves differently?\r\nNeovim shows the line and appends `@@@`, while vim shows only `@@@` in place of the entire line, both report the same line number.\r\n- Operating system/version: 5.11.11-arch1-1\r\n- Terminal name/version: foot version: 1.7.1-15-ge299b1d\r\n- `$TERM`: foot\r\n\r\n### Steps to reproduce using `nvim -u NORC`\r\n\r\n`nvim -u NORC` [wrapfile.log](https://github.com/neovim/neovim/files/6272208/wrapfile.log)\r\n```\r\ndecrease window-width until the last line wraps\r\nG<C-Y>\r\n:echo getwininfo()\r\n```\r\n\r\n### Actual behaviour\r\n`botline` is 108\r\n### Expected behaviour\r\n`botline` is 109 or `botline` is 10{8,9} and some flag that indicates a wrapped last line is set.\r\n\r\nAn actual problem that results from `getwininfo()` not returning the correct botline would be [hop.nvim](https://github.com/phaazon/hop.nvim), which uses it to determine which region of the buffer to highlight.\r\n![wrapped](https://user-images.githubusercontent.com/41961280/113882634-c1be0100-97bd-11eb-947f-fa7ba0b5bcbd.png)\r\n",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "Have you read the doc on `getwininfo()`, the doc says:\r\n\r\n> \t\tEach List item is a Dictionary with the following entries:\r\n>\t\t\tbotline\t\tlast displayed buffer line\r\n\r\nIIUIC, `botline` is the last displayed line (line 108), not last line of the buffer. I think the output is exactly the same as what the documentation says.\r\n\r\n",
            "created_at": "2021-04-07T15:22:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815003208",
            "id": 815003208,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTAwMzIwOA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815003208/reactions"
            },
            "updated_at": "2021-04-07T15:22:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815003208",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/16662357?v=4",
                "events_url": "https://api.github.com/users/jdhao/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdhao/followers",
                "following_url": "https://api.github.com/users/jdhao/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdhao/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdhao",
                "id": 16662357,
                "login": "jdhao",
                "node_id": "MDQ6VXNlcjE2NjYyMzU3",
                "organizations_url": "https://api.github.com/users/jdhao/orgs",
                "received_events_url": "https://api.github.com/users/jdhao/received_events",
                "repos_url": "https://api.github.com/users/jdhao/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdhao/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdhao/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdhao",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think the example-file is bit misleading, srry for that.\r\nIf you look at the screenshot above, `getwininfo()` returns 69+24 as `botline`, whereas, with 'last displayed buffer line', I would have expected 69+25 or 69+24 and some flag like 'last_line_wrapped' to be set, so that one can tell that 69+25 is actually visible.",
            "created_at": "2021-04-07T15:42:41Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815018386",
            "id": 815018386,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTAxODM4Ng==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815018386/reactions"
            },
            "updated_at": "2021-04-07T15:42:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815018386",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Then update your issue, and give your complete reproduce steps.",
            "created_at": "2021-04-07T15:47:29Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815021779",
            "id": 815021779,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTAyMTc3OQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815021779/reactions"
            },
            "updated_at": "2021-04-07T15:47:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815021779",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/16662357?v=4",
                "events_url": "https://api.github.com/users/jdhao/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdhao/followers",
                "following_url": "https://api.github.com/users/jdhao/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdhao/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdhao",
                "id": 16662357,
                "login": "jdhao",
                "node_id": "MDQ6VXNlcjE2NjYyMzU3",
                "organizations_url": "https://api.github.com/users/jdhao/orgs",
                "received_events_url": "https://api.github.com/users/jdhao/received_events",
                "repos_url": "https://api.github.com/users/jdhao/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdhao/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdhao/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdhao",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Srry, should've mentioned that the last line ofc. has to wrap.",
            "created_at": "2021-04-07T16:01:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815032489",
            "id": 815032489,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTAzMjQ4OQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815032489/reactions"
            },
            "updated_at": "2021-04-07T16:01:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815032489",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "can you please show a screenshot with simple numbering turned on? That makes it much easier to see the issue I think",
            "created_at": "2021-04-07T16:02:59Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815033262",
            "id": 815033262,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTAzMzI2Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815033262/reactions"
            },
            "updated_at": "2021-04-07T16:02:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815033262",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/244927?v=4",
                "events_url": "https://api.github.com/users/chrisbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/chrisbra/followers",
                "following_url": "https://api.github.com/users/chrisbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/chrisbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/chrisbra",
                "id": 244927,
                "login": "chrisbra",
                "node_id": "MDQ6VXNlcjI0NDkyNw==",
                "organizations_url": "https://api.github.com/users/chrisbra/orgs",
                "received_events_url": "https://api.github.com/users/chrisbra/received_events",
                "repos_url": "https://api.github.com/users/chrisbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/chrisbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/chrisbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/chrisbra",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Can not reproduce with a file with wrap on. The botline is reported correctly. \r\n\r\nnvim version: latest master.",
            "created_at": "2021-04-07T16:15:06Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815042251",
            "id": 815042251,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA0MjI1MQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815042251/reactions"
            },
            "updated_at": "2021-04-07T16:15:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815042251",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/16662357?v=4",
                "events_url": "https://api.github.com/users/jdhao/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdhao/followers",
                "following_url": "https://api.github.com/users/jdhao/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdhao/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdhao",
                "id": 16662357,
                "login": "jdhao",
                "node_id": "MDQ6VXNlcjE2NjYyMzU3",
                "organizations_url": "https://api.github.com/users/jdhao/orgs",
                "received_events_url": "https://api.github.com/users/jdhao/received_events",
                "repos_url": "https://api.github.com/users/jdhao/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdhao/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdhao/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdhao",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "![screen](https://user-images.githubusercontent.com/41961280/113900135-cf7b8280-97cd-11eb-9c2b-cb5779071c79.png)\r\n`getwininfo()` reports `botline` as 108, but line 109 is visible. I don't necessarily think that 108 is wrong, but there should be a way to tell that 109 is visible.\r\nVersion is NVIM v0.5.0-dev+1226-g370469be2.",
            "created_at": "2021-04-07T16:22:24Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815047697",
            "id": 815047697,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA0NzY5Nw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815047697/reactions"
            },
            "updated_at": "2021-04-07T16:23:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815047697",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Yeah, it looks like botline is the last line *completely* displayed in the window.\r\n\r\nI think we would need a doc patch like this:\r\n```patch\r\ndiff --git a/runtime/doc/eval.txt b/runtime/doc/eval.txt\r\nindex 97c968c74..603780056 100644\r\n--- a/runtime/doc/eval.txt\r\n+++ b/runtime/doc/eval.txt\r\n@@ -6087,7 +6087,7 @@ getwininfo([{winid}])                                     *getwininfo()*\r\n                tab pages is returned.\r\n\r\n                Each List item is a |Dictionary| with the following entries:\r\n-                       botline         last displayed buffer line\r\n+                       botline         last complete displayed buffer line\r\n                        bufnr           number of buffer in the window\r\n                        height          window height (excluding winbar)\r\n                        loclist         1 if showing a location list\r\n```\r\n\r\nping @brammool",
            "created_at": "2021-04-07T16:30:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815053819",
            "id": 815053819,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA1MzgxOQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815053819/reactions"
            },
            "updated_at": "2021-04-07T16:30:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815053819",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/244927?v=4",
                "events_url": "https://api.github.com/users/chrisbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/chrisbra/followers",
                "following_url": "https://api.github.com/users/chrisbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/chrisbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/chrisbra",
                "id": 244927,
                "login": "chrisbra",
                "node_id": "MDQ6VXNlcjI0NDkyNw==",
                "organizations_url": "https://api.github.com/users/chrisbra/orgs",
                "received_events_url": "https://api.github.com/users/chrisbra/received_events",
                "repos_url": "https://api.github.com/users/chrisbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/chrisbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/chrisbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/chrisbra",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "In that case, how would I be able to tell that line 109 is visible?",
            "created_at": "2021-04-07T16:33:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815055385",
            "id": 815055385,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA1NTM4NQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815055385/reactions"
            },
            "updated_at": "2021-04-07T16:33:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815055385",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I suppose something like `getwininfo()[0].topline + line('w$')`",
            "created_at": "2021-04-07T17:09:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815079582",
            "id": 815079582,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA3OTU4Mg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815079582/reactions"
            },
            "updated_at": "2021-04-07T17:09:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815079582",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/244927?v=4",
                "events_url": "https://api.github.com/users/chrisbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/chrisbra/followers",
                "following_url": "https://api.github.com/users/chrisbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/chrisbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/chrisbra",
                "id": 244927,
                "login": "chrisbra",
                "node_id": "MDQ6VXNlcjI0NDkyNw==",
                "organizations_url": "https://api.github.com/users/chrisbra/orgs",
                "received_events_url": "https://api.github.com/users/chrisbra/received_events",
                "repos_url": "https://api.github.com/users/chrisbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/chrisbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/chrisbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/chrisbra",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "`line('w$')` also returns 108 :/",
            "created_at": "2021-04-07T17:16:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815084001",
            "id": 815084001,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA4NDAwMQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815084001/reactions"
            },
            "updated_at": "2021-04-07T17:16:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815084001",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "oh, it worked for my minimal test. Hm, indeed, sometimes one needs to subtract one and sometimes one doesn't. Hm, how about: \r\n\r\n    echo getwininfo()[0].topline + winheight(0) -1",
            "created_at": "2021-04-07T17:24:57Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815089706",
            "id": 815089706,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA4OTcwNg==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815089706/reactions"
            },
            "updated_at": "2021-04-07T17:24:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815089706",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/244927?v=4",
                "events_url": "https://api.github.com/users/chrisbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/chrisbra/followers",
                "following_url": "https://api.github.com/users/chrisbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/chrisbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/chrisbra",
                "id": 244927,
                "login": "chrisbra",
                "node_id": "MDQ6VXNlcjI0NDkyNw==",
                "organizations_url": "https://api.github.com/users/chrisbra/orgs",
                "received_events_url": "https://api.github.com/users/chrisbra/received_events",
                "repos_url": "https://api.github.com/users/chrisbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/chrisbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/chrisbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/chrisbra",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This works only as long as there are no other wrapped lines above.\r\nIs there any way to determine whether a line is wrapped?",
            "created_at": "2021-04-07T17:28:14Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815091770",
            "id": 815091770,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA5MTc3MA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815091770/reactions"
            },
            "updated_at": "2021-04-07T17:28:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815091770",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Perhaps we should add a field that indicates how many screen lines at the bottom are used for an incomplete line?",
            "created_at": "2021-04-07T17:33:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815094854",
            "id": 815094854,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA5NDg1NA==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815094854/reactions"
            },
            "updated_at": "2021-04-07T17:33:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815094854",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8530623?v=4",
                "events_url": "https://api.github.com/users/brammool/events{/privacy}",
                "followers_url": "https://api.github.com/users/brammool/followers",
                "following_url": "https://api.github.com/users/brammool/following{/other_user}",
                "gists_url": "https://api.github.com/users/brammool/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brammool",
                "id": 8530623,
                "login": "brammool",
                "node_id": "MDQ6VXNlcjg1MzA2MjM=",
                "organizations_url": "https://api.github.com/users/brammool/orgs",
                "received_events_url": "https://api.github.com/users/brammool/received_events",
                "repos_url": "https://api.github.com/users/brammool/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brammool/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brammool/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brammool",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "\r\n> This works only as long as there are no other wrapped lines above.\r\n> Is there any way to determine whether a line is wrapped?\r\n\r\nOkay, I guess one could compare linelength and winwidth for `getwininfo()[0].botline+1`, but that would lead to the linenumber being one off if there is a wrapping line below the last visible line.",
            "created_at": "2021-04-07T17:35:46Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815096653",
            "id": 815096653,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA5NjY1Mw==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815096653/reactions"
            },
            "updated_at": "2021-04-07T17:35:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815096653",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> This works only as long as there are no other wrapped lines above.\r\nIs there any way to determine whether a line is wrapped?\r\n\r\nNot easily. Possibly store the window view using `winsaveview()`, position the cursor on the bottom line (`z-`) and return that line using `line('.')` and then restore the view using `winrestview()`.\r\n\r\nMight be easier to add an additional property, mentioning the number of partial visible screen lines.",
            "created_at": "2021-04-07T17:37:55Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815097929",
            "id": 815097929,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA5NzkyOQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815097929/reactions"
            },
            "updated_at": "2021-04-07T17:43:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815097929",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/244927?v=4",
                "events_url": "https://api.github.com/users/chrisbra/events{/privacy}",
                "followers_url": "https://api.github.com/users/chrisbra/followers",
                "following_url": "https://api.github.com/users/chrisbra/following{/other_user}",
                "gists_url": "https://api.github.com/users/chrisbra/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/chrisbra",
                "id": 244927,
                "login": "chrisbra",
                "node_id": "MDQ6VXNlcjI0NDkyNw==",
                "organizations_url": "https://api.github.com/users/chrisbra/orgs",
                "received_events_url": "https://api.github.com/users/chrisbra/received_events",
                "repos_url": "https://api.github.com/users/chrisbra/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/chrisbra/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/chrisbra/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/chrisbra",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Perhaps we should add a field that indicates how many screen lines at the bottom are used for an incomplete line?\r\n\r\nIn this case that would mean `botline` = 108 and (something like) `incomplete_lines_bottom` = 1?",
            "created_at": "2021-04-07T17:38:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/14312#issuecomment-815098095",
            "id": 815098095,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/14312",
            "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTA5ODA5NQ==",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815098095/reactions"
            },
            "updated_at": "2021-04-07T17:38:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/815098095",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
                "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
                "followers_url": "https://api.github.com/users/L3MON4D3/followers",
                "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
                "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/L3MON4D3",
                "id": 41961280,
                "login": "L3MON4D3",
                "node_id": "MDQ6VXNlcjQxOTYxMjgw",
                "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
                "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
                "repos_url": "https://api.github.com/users/L3MON4D3/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/L3MON4D3",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 17,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/14312/comments",
    "created_at": "2021-04-07T14:08:46Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/14312/events",
    "html_url": "https://github.com/neovim/neovim/issues/14312",
    "id": 852449330,
    "labels": [
        {
            "color": "c2e0c6",
            "default": true,
            "description": "feature request",
            "id": 77997476,
            "name": "enhancement",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3Ng==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/enhancement"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/14312/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "MDU6SXNzdWU4NTI0NDkzMzA=",
    "number": 14312,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/14312/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/14312/timeline",
    "title": "`getwininfo()` can only report last complete displayed buffer line",
    "updated_at": "2025-01-17T16:00:24Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/14312",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/41961280?v=4",
        "events_url": "https://api.github.com/users/L3MON4D3/events{/privacy}",
        "followers_url": "https://api.github.com/users/L3MON4D3/followers",
        "following_url": "https://api.github.com/users/L3MON4D3/following{/other_user}",
        "gists_url": "https://api.github.com/users/L3MON4D3/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/L3MON4D3",
        "id": 41961280,
        "login": "L3MON4D3",
        "node_id": "MDQ6VXNlcjQxOTYxMjgw",
        "organizations_url": "https://api.github.com/users/L3MON4D3/orgs",
        "received_events_url": "https://api.github.com/users/L3MON4D3/received_events",
        "repos_url": "https://api.github.com/users/L3MON4D3/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/L3MON4D3/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/L3MON4D3/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/L3MON4D3",
        "user_view_type": "public"
    }
}
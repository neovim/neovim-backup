{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "### Neovim version (nvim -v)\r\n\r\nNVIM v0.8.1\r\n\r\n### Vim (not Nvim) behaves the same?\r\n\r\nno\r\n\r\n### Operating system/version\r\n\r\narchlinux\r\n\r\n### Terminal name/version\r\n\r\nst 0.8.5\r\n\r\n### $TERM environment variable\r\n\r\ntmux-256color\r\n\r\n### Installation\r\n\r\nsystem package manager\r\n\r\n### How to reproduce the issue\r\n\r\n* `nvim --clean`\r\n* case 1 `:lua vim.api.nvim_cmd(vim.api.nvim_parse_cmd('copen', {}), {})`\r\n* case 2 `copen`\r\n* case 3 `:lua vim.api.nvim_cmd({cmd = \"copen\"}, {})`\r\n* case 4 `:lua vim.api.nvim_cmd({cmd = \"copen\", args = {10}}, {})`\r\n\r\n### Expected behavior\r\n\r\ncase 1, 2, 3 will open the quickfix window with height 10.\r\nfor the case 4, i would expect it worked just like `:copen 10`\r\n\r\n### Actual behavior\r\n\r\ncase 1 opens quickfix window with height `1`;\r\ncase 4 failed to run;",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "Looks like this is because `nvim_parse_cmd` has `count = 0` in the returned table, which when passed to `nvim_cmd` causes the height of the window to be 1.",
            "created_at": "2022-12-06T20:14:49Z",
            "html_url": "https://github.com/neovim/neovim/issues/21313#issuecomment-1339951652",
            "id": 1339951652,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21313",
            "node_id": "IC_kwDOAPphoM5P3gok",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1339951652/reactions"
            },
            "updated_at": "2022-12-07T00:13:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1339951652",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "thanks for considering this issue. with more tests, I added the 4th case.",
            "created_at": "2022-12-06T21:10:06Z",
            "html_url": "https://github.com/neovim/neovim/issues/21313#issuecomment-1340009450",
            "id": 1340009450,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21313",
            "node_id": "IC_kwDOAPphoM5P3uvq",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1340009450/reactions"
            },
            "updated_at": "2022-12-06T21:10:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1340009450",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6236829?v=4",
                "events_url": "https://api.github.com/users/haolian9/events{/privacy}",
                "followers_url": "https://api.github.com/users/haolian9/followers",
                "following_url": "https://api.github.com/users/haolian9/following{/other_user}",
                "gists_url": "https://api.github.com/users/haolian9/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/haolian9",
                "id": 6236829,
                "login": "haolian9",
                "node_id": "MDQ6VXNlcjYyMzY4Mjk=",
                "organizations_url": "https://api.github.com/users/haolian9/orgs",
                "received_events_url": "https://api.github.com/users/haolian9/received_events",
                "repos_url": "https://api.github.com/users/haolian9/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/haolian9/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/haolian9/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/haolian9",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "not sure if it is related but there's also a weird behavior using `vim.cmd` copen fail when an argument is provided\r\n```lua\r\nvim.cmd.copen() -- works\r\nvim.cmd.copen(1) -- fails\r\nvim.cmd.copen('1') -- fails\r\n\r\nvim.cmd {cmd = 'copen'} -- works\r\nvim.cmd { cmd = 'copen', args = {1} } -- fails\r\nvim.cmd { cmd = 'copen', args = {'1'} } -- fails\r\n\r\n```",
            "created_at": "2022-12-09T10:30:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/21313#issuecomment-1344130188",
            "id": 1344130188,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21313",
            "node_id": "IC_kwDOAPphoM5QHcyM",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1344130188/reactions"
            },
            "updated_at": "2022-12-21T09:46:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1344130188",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4576770?v=4",
                "events_url": "https://api.github.com/users/mike325/events{/privacy}",
                "followers_url": "https://api.github.com/users/mike325/followers",
                "following_url": "https://api.github.com/users/mike325/following{/other_user}",
                "gists_url": "https://api.github.com/users/mike325/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mike325",
                "id": 4576770,
                "login": "mike325",
                "node_id": "MDQ6VXNlcjQ1NzY3NzA=",
                "organizations_url": "https://api.github.com/users/mike325/orgs",
                "received_events_url": "https://api.github.com/users/mike325/received_events",
                "repos_url": "https://api.github.com/users/mike325/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mike325/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mike325/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mike325",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "`nvim_cmd` has a completely different implementation to `nvim_exec` (that I've been trying to unify), which would explain any differences and bugs.",
            "created_at": "2022-12-09T11:49:10Z",
            "html_url": "https://github.com/neovim/neovim/issues/21313#issuecomment-1344210840",
            "id": 1344210840,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21313",
            "node_id": "IC_kwDOAPphoM5QHweY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1344210840/reactions"
            },
            "updated_at": "2022-12-09T11:49:10Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/1344210840",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "i found a similar issue, as it also uses `nvim_cmd(nvim_parse_cmd())` combination, so i put it here.\r\n\r\nsteps to reproduce:\r\n* `nvim --clean test.lua`\r\n* `:source`\r\n* '#E444 Cannot close last win'\r\n\r\nthe test.lua\r\n```lua\r\nlocal api = vim.api\r\n\r\nlocal winid = api.nvim_open_win(0, true, { relative = \"win\", row = 3, col = 3, width = 12, height = 3 })\r\nassert(winid == api.nvim_get_current_win())\r\n\r\napi.nvim_cmd(api.nvim_parse_cmd(\"quit\", {}), {})\r\n```\r\n\r\nthe last line i suppose would work the same as `vim.cmd.quit()`.\r\n",
            "created_at": "2024-04-07T06:54:05Z",
            "html_url": "https://github.com/neovim/neovim/issues/21313#issuecomment-2041340862",
            "id": 2041340862,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/21313",
            "node_id": "IC_kwDOAPphoM55rGO-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2041340862/reactions"
            },
            "updated_at": "2024-04-07T06:54:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2041340862",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6236829?v=4",
                "events_url": "https://api.github.com/users/haolian9/events{/privacy}",
                "followers_url": "https://api.github.com/users/haolian9/followers",
                "following_url": "https://api.github.com/users/haolian9/following{/other_user}",
                "gists_url": "https://api.github.com/users/haolian9/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/haolian9",
                "id": 6236829,
                "login": "haolian9",
                "node_id": "MDQ6VXNlcjYyMzY4Mjk=",
                "organizations_url": "https://api.github.com/users/haolian9/orgs",
                "received_events_url": "https://api.github.com/users/haolian9/received_events",
                "repos_url": "https://api.github.com/users/haolian9/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/haolian9/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/haolian9/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/haolian9",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 5,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/21313/comments",
    "created_at": "2022-12-06T17:52:18Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/21313/events",
    "html_url": "https://github.com/neovim/neovim/issues/21313",
    "id": 1479758981,
    "labels": [
        {
            "color": "f9d0c4",
            "default": true,
            "description": "issues reporting wrong behavior",
            "id": 77997474,
            "name": "bug",
            "node_id": "MDU6TGFiZWw3Nzk5NzQ3NA==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/bug"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "libnvim, Nvim RPC API",
            "id": 103819671,
            "name": "api",
            "node_id": "MDU6TGFiZWwxMDM4MTk2NzE=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/api"
        },
        {
            "color": "0E8A16",
            "default": false,
            "description": "issue contains minimal reproducing steps",
            "id": 435851959,
            "name": "has:repro",
            "node_id": "MDU6TGFiZWw0MzU4NTE5NTk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/has:repro"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/21313/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM5YM1SF",
    "number": 21313,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/neovim/neovim/issues/21313/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/21313/timeline",
    "title": "inconsistent behavior for nvim_cmd to run parsed \"copen\"",
    "updated_at": "2025-01-19T11:27:28Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/21313",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/6236829?v=4",
        "events_url": "https://api.github.com/users/haolian9/events{/privacy}",
        "followers_url": "https://api.github.com/users/haolian9/followers",
        "following_url": "https://api.github.com/users/haolian9/following{/other_user}",
        "gists_url": "https://api.github.com/users/haolian9/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/haolian9",
        "id": 6236829,
        "login": "haolian9",
        "node_id": "MDQ6VXNlcjYyMzY4Mjk=",
        "organizations_url": "https://api.github.com/users/haolian9/orgs",
        "received_events_url": "https://api.github.com/users/haolian9/received_events",
        "repos_url": "https://api.github.com/users/haolian9/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/haolian9/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/haolian9/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/haolian9",
        "user_view_type": "public"
    }
}
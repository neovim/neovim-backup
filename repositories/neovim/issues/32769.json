{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "body": "### Problem\n\nSometimes quickly I realize I open the wrong file, and close nvim very fast. Rarely this will emit some escapes to the terminal:\n```console\nthink:~$ nvim --clean -c 'q!'\nthink:~$ nvim --clean -c 'q!'\nthink:~$ nvim --clean -c 'q!'\n^[[48;58;213;1044;1917tthink:~$ 8;58;213;1044;1917t\n```\n\nIt doesn't reproduce every time with the `foot` terminal, but if repeated enough, it happens for me regardless of `TERM` value: `foot`, `xterm-256color`, etc.\n\n\n### Steps to reproduce\n\n# you may need to loop this:\nnvim --clean -c 'q!'\n\n\n### Expected behavior\n\nterminal output is clean after exit\n\n### Nvim version (nvim -v)\n\nNVIM v0.11.0-dev-1912+g0c0352783f\n\n### Vim (not Nvim) behaves the same?\n\nI can't reproduce with vim-git from the AUR but I'm not confident on this.\n\n### Operating system/version\n\nlinux 6.13.4\n\n### Terminal name/version\n\nfoot version: 1.20.2 +pgo +ime +graphemes +toplevel-icon -assertions\n\n### $TERM environment variable\n\nxterm-256color\n\n### Installation\n\nAUR",
    "closed_at": "2025-04-22T12:18:36Z",
    "closed_by": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    },
    "comment_data": [
        {
            "author_association": "MEMBER",
            "body": "(continued from https://github.com/neovim/neovim/issues/32758#issuecomment-2706274196 )",
            "created_at": "2025-03-07T12:55:53Z",
            "html_url": "https://github.com/neovim/neovim/issues/32769#issuecomment-2706392768",
            "id": 2706392768,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32769",
            "node_id": "IC_kwDOAPphoM6hUEbA",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2706392768/reactions"
            },
            "updated_at": "2025-03-07T12:55:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2706392768",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Related: https://github.com/neovim/neovim/issues/31885",
            "created_at": "2025-03-07T13:19:04Z",
            "html_url": "https://github.com/neovim/neovim/issues/32769#issuecomment-2706438094",
            "id": 2706438094,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32769",
            "node_id": "IC_kwDOAPphoM6hUPfO",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2706438094/reactions"
            },
            "updated_at": "2025-03-07T13:19:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2706438094",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "[Quoting bfredl from the other issue](https://github.com/neovim/neovim/issues/32758#issuecomment-2706291969):\n\n> The TUI does not wait for any pending potential responses when it is asked to exit early. It could do so, but then there would be an extra X ms delay for `nvim --clean -c 'q!'` in the cases the terminal does _not_ respond and we need to wait for a timeout. Might still make sense for some sensible value of X.\n\nI think this is probably the right approach, and is similar to what I started working on in https://github.com/neovim/neovim/pull/32151 to address #31885.\n\nThe idea is that after we disable all of the different terminal modes that cause the terminal to send us escape sequences (terminal resize notifications, theme update notifications, kitty keyboard, etc.) we write one final request (e.g. device attributes request, DA1) and wait for the response to that. Once that response has arrived we can be sure the terminal has received and processed the prior requests, at which point it should not send any more responses. As bfredl mentioned this needs to be done with a timeout though, to avoid Nvim appearing to hang on exit.",
            "created_at": "2025-03-07T18:22:17Z",
            "html_url": "https://github.com/neovim/neovim/issues/32769#issuecomment-2707111734",
            "id": 2707111734,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32769",
            "node_id": "IC_kwDOAPphoM6hWz82",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2707111734/reactions"
            },
            "updated_at": "2025-03-07T18:22:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2707111734",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Hey @gpanders , can I start working on this?",
            "created_at": "2025-03-11T03:49:29Z",
            "html_url": "https://github.com/neovim/neovim/issues/32769#issuecomment-2712511050",
            "id": 2712511050,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32769",
            "node_id": "IC_kwDOAPphoM6hraJK",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2712511050/reactions"
            },
            "updated_at": "2025-03-11T13:55:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2712511050",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/119438857?v=4",
                "events_url": "https://api.github.com/users/Sadaf-A/events{/privacy}",
                "followers_url": "https://api.github.com/users/Sadaf-A/followers",
                "following_url": "https://api.github.com/users/Sadaf-A/following{/other_user}",
                "gists_url": "https://api.github.com/users/Sadaf-A/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Sadaf-A",
                "id": 119438857,
                "login": "Sadaf-A",
                "node_id": "U_kgDOBx5-CQ",
                "organizations_url": "https://api.github.com/users/Sadaf-A/orgs",
                "received_events_url": "https://api.github.com/users/Sadaf-A/received_events",
                "repos_url": "https://api.github.com/users/Sadaf-A/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Sadaf-A/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Sadaf-A/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Sadaf-A",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Hey [@gpanders](https://github.com/gpanders) , can I start working on this?\n\nGo ahead!",
            "created_at": "2025-03-11T13:53:39Z",
            "html_url": "https://github.com/neovim/neovim/issues/32769#issuecomment-2714379917",
            "id": 2714379917,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32769",
            "node_id": "IC_kwDOAPphoM6hyiaN",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2714379917/reactions"
            },
            "updated_at": "2025-03-11T13:55:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2714379917",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "https://github.com/neovim/neovim/pull/32151",
            "created_at": "2025-04-17T13:41:09Z",
            "html_url": "https://github.com/neovim/neovim/issues/32769#issuecomment-2812973542",
            "id": 2812973542,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32769",
            "node_id": "IC_kwDOAPphoM6nqpHm",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2812973542/reactions"
            },
            "updated_at": "2025-04-17T13:41:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2812973542",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 6,
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/32769/comments",
    "created_at": "2025-03-07T12:51:46Z",
    "events_url": "https://api.github.com/repos/neovim/neovim/issues/32769/events",
    "html_url": "https://github.com/neovim/neovim/issues/32769",
    "id": 2902936763,
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 197254545,
            "name": "tui",
            "node_id": "MDU6TGFiZWwxOTcyNTQ1NDU=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/tui"
        }
    ],
    "labels_url": "https://api.github.com/repos/neovim/neovim/issues/32769/labels{/name}",
    "locked": false,
    "milestone": null,
    "node_id": "I_kwDOAPphoM6tB0y7",
    "number": 32769,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 1,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 1,
        "url": "https://api.github.com/repos/neovim/neovim/issues/32769/reactions"
    },
    "repository_url": "https://api.github.com/repos/neovim/neovim",
    "state": "closed",
    "state_reason": "completed",
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/neovim/neovim/issues/32769/timeline",
    "title": "terminal escapes output to shell if nvim is closed too quickly (race?)",
    "type": {
        "color": "red",
        "created_at": "2024-01-25T10:10:19Z",
        "description": "An unexpected problem or behavior",
        "id": 597163,
        "is_enabled": true,
        "name": "Bug",
        "node_id": "IT_kwDOAGK_Pc4ACRyr",
        "updated_at": "2024-07-26T10:12:30Z"
    },
    "updated_at": "2025-04-22T12:18:36Z",
    "url": "https://api.github.com/repos/neovim/neovim/issues/32769",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/504194?v=4",
        "events_url": "https://api.github.com/users/rmuir/events{/privacy}",
        "followers_url": "https://api.github.com/users/rmuir/followers",
        "following_url": "https://api.github.com/users/rmuir/following{/other_user}",
        "gists_url": "https://api.github.com/users/rmuir/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/rmuir",
        "id": 504194,
        "login": "rmuir",
        "node_id": "MDQ6VXNlcjUwNDE5NA==",
        "organizations_url": "https://api.github.com/users/rmuir/orgs",
        "received_events_url": "https://api.github.com/users/rmuir/received_events",
        "repos_url": "https://api.github.com/users/rmuir/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/rmuir/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rmuir/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/rmuir",
        "user_view_type": "public"
    }
}
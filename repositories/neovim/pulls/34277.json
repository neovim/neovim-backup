{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/34277/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/34277/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/34277"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/34277"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/34277/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/b384bf3f766c4b3f3d37cb42880bd0c53b264d8d"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 6505,
            "forks_count": 6505,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 2077,
            "open_issues_count": 2077,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2026-01-06T00:34:51Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 367191,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 95440,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2026-01-06T02:49:38Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 95440,
            "watchers_count": 95440,
            "web_commit_signoff_required": false
        },
        "sha": "5f22cf5af3425fb0d461bf82220a633bebe10932",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "Problem:\r\nTags are manually parsed in C which is not flexible and prone to errors. For example, switching the format of help files to e.g. markdown would require a large rewrite, while with this PR it would only require a TS query update. See #36249.\r\n\r\nSolution:\r\nUse the power of treesitter to extract the tags from helpfiles.",
    "closed_at": null,
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2120931783"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120931783"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "This should probably have its own typename, but I'm not sure what it should be. TagsTriplet, TagsFormat, TagsLine? No clue.",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-02T11:57:07Z",
            "diff_hunk": "@@ -0,0 +1,106 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+\n+local query = ts.query.parse('vimdoc', [[\n+    (tag (word) @tagname)\n+]])\n+\n+--- Find all helptags in a single file.\n+--- @param filename string helpfile with tags\n+--- @return { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2120931783",
            "id": 2120931783,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5-atnH",
            "original_commit_id": "9eaabc04f73b6c22d921769466403b9b04dfc359",
            "original_line": 11,
            "original_position": 11,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2888066925,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120931783/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-02T11:57:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120931783",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2120940763"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120940763"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Not sure if this is the right approach of reporting a Vim-style error",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-02T12:01:03Z",
            "diff_hunk": "@@ -0,0 +1,106 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+\n+local query = ts.query.parse('vimdoc', [[\n+    (tag (word) @tagname)\n+]])\n+\n+--- Find all helptags in a single file.\n+--- @param filename string helpfile with tags\n+--- @return { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+local function extract_file_tags(filename)\n+  local file = assert(io.open(filename, 'r'))\n+  local source = file:read('*a')\n+  file:close()\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = string.gsub(tagname, '[\\\\/]', '\\\\%0')\n+        local searchcmd = tagname == 'help-tags' and '1' or ('/*%s*'):format(escaped)\n+        table.insert(tags, { tagname, filename, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+--- @param tags { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+--- @return boolean true if there are duplicate tags\n+local function check_duplicate_tags(tags)\n+  local found = false\n+\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.api.nvim_echo({\n+        { ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn) }\n+      }, true, { err = true })",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2120940763",
            "id": 2120940763,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5-avzb",
            "original_commit_id": "9eaabc04f73b6c22d921769466403b9b04dfc359",
            "original_line": 49,
            "original_position": 49,
            "original_start_line": 47,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2888080333,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120940763/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-06-02T12:03:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120940763",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2120942767"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120942767"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Is `assert()` fine here or should this report a Vim-style error to the user (E40)? Or ignore? ",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-02T12:02:22Z",
            "diff_hunk": "@@ -0,0 +1,106 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+\n+local query = ts.query.parse('vimdoc', [[\n+    (tag (word) @tagname)\n+]])\n+\n+--- Find all helptags in a single file.\n+--- @param filename string helpfile with tags\n+--- @return { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+local function extract_file_tags(filename)\n+  local file = assert(io.open(filename, 'r'))\n+  local source = file:read('*a')\n+  file:close()",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2120942767",
            "id": 2120942767,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5-awSv",
            "original_commit_id": "9eaabc04f73b6c22d921769466403b9b04dfc359",
            "original_line": 15,
            "original_position": 15,
            "original_start_line": 13,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2888080333,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120942767/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-06-02T12:03:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120942767",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2120943917"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120943917"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "See comment above: what to do on error?",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-02T12:03:00Z",
            "diff_hunk": "@@ -0,0 +1,106 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+\n+local query = ts.query.parse('vimdoc', [[\n+    (tag (word) @tagname)\n+]])\n+\n+--- Find all helptags in a single file.\n+--- @param filename string helpfile with tags\n+--- @return { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+local function extract_file_tags(filename)\n+  local file = assert(io.open(filename, 'r'))\n+  local source = file:read('*a')\n+  file:close()\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = string.gsub(tagname, '[\\\\/]', '\\\\%0')\n+        local searchcmd = tagname == 'help-tags' and '1' or ('/*%s*'):format(escaped)\n+        table.insert(tags, { tagname, filename, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+--- @param tags { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+--- @return boolean true if there are duplicate tags\n+local function check_duplicate_tags(tags)\n+  local found = false\n+\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.api.nvim_echo({\n+        { ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn) }\n+      }, true, { err = true })\n+    end\n+\n+    prevtag = curtag\n+    prevfn = curfn\n+  end\n+\n+  return found\n+end\n+\n+--- Generate a tags file for a directory and its subdirectories.\n+--- @param dir string\n+local function helptags_in_dir(dir, include_helptags_tag)\n+  local files = vim.fs.find(function(name, _)\n+    return vim.endswith(name, '.txt')\n+  end, { path = dir, type = 'file', limit = math.huge })\n+\n+  local tags = {}\n+  for _, filename in ipairs(files) do\n+    local filetags = extract_file_tags(filename)\n+    vim.list_extend(tags, filetags)\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if not check_duplicate_tags(tags) then\n+    local tagsfile = vim.fs.joinpath(dir, 'tags')\n+    local f = assert(io.open(tagsfile, 'w'))",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2120943917",
            "id": 2120943917,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5-awkt",
            "original_commit_id": "9eaabc04f73b6c22d921769466403b9b04dfc359",
            "original_line": 82,
            "original_position": 82,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2888080333,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120943917/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-02T12:03:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2120943917",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2139477148"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2139477148"
                }
            },
            "author_association": "MEMBER",
            "body": "Why not use `nvim_get_runtime_file` directly?",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-11T08:02:17Z",
            "diff_hunk": "@@ -0,0 +1,178 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias TagLocation { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+--- Find all helptags in a single file.\n+---\n+--- @param filename string helpfile with tags\n+--- @return TagLocation[] # empty if file is not readable\n+local function extract_file_tags(filename)\n+  local f, err = io.open(filename, 'r')\n+  if f == nil or err then\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return {}\n+  end\n+  local source = f:read('*a')\n+  f:close()\n+  local fn = vim.fs.basename(filename)\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+        local searchcmd = '/*' .. escaped .. '*'\n+        table.insert(tags, { tagname, fn, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+---\n+--- @param tags TagLocation[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.notify(\n+        ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn),\n+        vim.log.levels.WARN\n+      )\n+    end\n+    prevtag = curtag\n+    prevfn = curfn\n+  end\n+  return found\n+end\n+\n+--- Extract tags from a list of helpfiles.\n+---\n+--- @param helpfiles string[] list of helpfiles\n+--- @param tagsfile string the filename of the 'tags' file\n+--- @param include_helptags_tag boolean true if the 'tags' tag should be included\n+local function create_tags_from_files(helpfiles, tagsfile, include_helptags_tag)\n+  ---@type TagLocation\n+  local tags = {}\n+  local i = 1\n+  local function process_helpfile(co)\n+    if i > #helpfiles then\n+      coroutine.resume(co, true)\n+      return\n+    end\n+\n+    local filename = helpfiles[i]\n+    i = i + 1\n+\n+    vim.schedule(function()\n+      local filetags = extract_file_tags(filename)\n+      vim.list_extend(tags, filetags)\n+      process_helpfile(co)\n+    end)\n+  end\n+\n+  coroutine.wrap(function()\n+    process_helpfile(coroutine.running())\n+    coroutine.yield()\n+\n+    if include_helptags_tag then\n+      table.insert(tags, { 'help-tags', 'tags', '1' })\n+    end\n+\n+    table.sort(tags, function(a, b)\n+      return a[1] < b[1]\n+    end)\n+\n+    if vim.tbl_isempty(tags) or not duplicate_tags(tags) then\n+      return\n+    end\n+\n+    local f, err = io.open(tagsfile, 'w')\n+    if f == nil or err then\n+      vim.notify(('E152: Cannot open %s for writing'):format(tagsfile), vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    local lines = vim\n+      .iter(tags)\n+      :map(function(v)\n+        return table.concat(v, '\\t')\n+      end)\n+      :join('\\n')\n+\n+    f:write(lines, '\\n')\n+\n+    f:close()\n+  end)()\n+end\n+\n+--- Returns a list of all existing \"doc\" subdirectories in the runtimepath.",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2139477148",
            "id": 2139477148,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5_hdSc",
            "original_commit_id": "12aa06a375184e64a4a7892e1115a693c5b2d6c2",
            "original_line": 122,
            "original_position": 122,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2916072762,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2139477148/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-11T08:02:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2139477148",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2140888853"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2140888853"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Great suggestion! Didn't know about the function.",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-11T19:09:45Z",
            "diff_hunk": "@@ -0,0 +1,178 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias TagLocation { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+--- Find all helptags in a single file.\n+---\n+--- @param filename string helpfile with tags\n+--- @return TagLocation[] # empty if file is not readable\n+local function extract_file_tags(filename)\n+  local f, err = io.open(filename, 'r')\n+  if f == nil or err then\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return {}\n+  end\n+  local source = f:read('*a')\n+  f:close()\n+  local fn = vim.fs.basename(filename)\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+        local searchcmd = '/*' .. escaped .. '*'\n+        table.insert(tags, { tagname, fn, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+---\n+--- @param tags TagLocation[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.notify(\n+        ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn),\n+        vim.log.levels.WARN\n+      )\n+    end\n+    prevtag = curtag\n+    prevfn = curfn\n+  end\n+  return found\n+end\n+\n+--- Extract tags from a list of helpfiles.\n+---\n+--- @param helpfiles string[] list of helpfiles\n+--- @param tagsfile string the filename of the 'tags' file\n+--- @param include_helptags_tag boolean true if the 'tags' tag should be included\n+local function create_tags_from_files(helpfiles, tagsfile, include_helptags_tag)\n+  ---@type TagLocation\n+  local tags = {}\n+  local i = 1\n+  local function process_helpfile(co)\n+    if i > #helpfiles then\n+      coroutine.resume(co, true)\n+      return\n+    end\n+\n+    local filename = helpfiles[i]\n+    i = i + 1\n+\n+    vim.schedule(function()\n+      local filetags = extract_file_tags(filename)\n+      vim.list_extend(tags, filetags)\n+      process_helpfile(co)\n+    end)\n+  end\n+\n+  coroutine.wrap(function()\n+    process_helpfile(coroutine.running())\n+    coroutine.yield()\n+\n+    if include_helptags_tag then\n+      table.insert(tags, { 'help-tags', 'tags', '1' })\n+    end\n+\n+    table.sort(tags, function(a, b)\n+      return a[1] < b[1]\n+    end)\n+\n+    if vim.tbl_isempty(tags) or not duplicate_tags(tags) then\n+      return\n+    end\n+\n+    local f, err = io.open(tagsfile, 'w')\n+    if f == nil or err then\n+      vim.notify(('E152: Cannot open %s for writing'):format(tagsfile), vim.log.levels.ERROR)\n+      return\n+    end\n+\n+    local lines = vim\n+      .iter(tags)\n+      :map(function(v)\n+        return table.concat(v, '\\t')\n+      end)\n+      :join('\\n')\n+\n+    f:write(lines, '\\n')\n+\n+    f:close()\n+  end)()\n+end\n+\n+--- Returns a list of all existing \"doc\" subdirectories in the runtimepath.",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2140888853",
            "id": 2140888853,
            "in_reply_to_id": 2139477148,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5_m18V",
            "original_commit_id": "12aa06a375184e64a4a7892e1115a693c5b2d6c2",
            "original_line": 122,
            "original_position": 122,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2918392423,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2140888853/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-11T19:09:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2140888853",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2141953068"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2141953068"
                }
            },
            "author_association": "MEMBER",
            "body": "I don't think we should add manual async at this point since we're already considering a `vim.async` module based on @lewis6991 work. Please look at #34009 and https://github.com/lewis6991/async.nvim, and pull in whatever you need from that into a `vim._async` module (that we'll merge with the one from #34009).",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-12T07:43:19Z",
            "diff_hunk": "@@ -0,0 +1,164 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias TagLocation { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+--- Find all helptags in a single file.\n+---\n+--- @param filename string helpfile with tags\n+--- @return TagLocation[] # empty if file is not readable\n+local function extract_file_tags(filename)\n+  local f, err = io.open(filename, 'r')\n+  if f == nil or err then\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return {}\n+  end\n+  local source = f:read('*a')\n+  f:close()\n+  local fn = vim.fs.basename(filename)\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+        local searchcmd = '/*' .. escaped .. '*'\n+        table.insert(tags, { tagname, fn, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+---\n+--- @param tags TagLocation[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.notify(\n+        ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn),\n+        vim.log.levels.WARN\n+      )\n+    end\n+    prevtag = curtag\n+    prevfn = curfn\n+  end\n+  return found\n+end\n+\n+--- Extract tags from a list of helpfiles.\n+---\n+--- @param helpfiles string[] list of helpfiles\n+--- @param tagsfile string the filename of the 'tags' file\n+--- @param include_helptags_tag boolean true if the 'tags' tag should be included\n+local function create_tags_from_files(helpfiles, tagsfile, include_helptags_tag)\n+  ---@type TagLocation\n+  local tags = {}\n+  local i = 1\n+  local function process_helpfile(co)\n+    if i > #helpfiles then\n+      coroutine.resume(co, true)\n+      return\n+    end\n+\n+    local filename = helpfiles[i]\n+    i = i + 1\n+\n+    vim.schedule(function()\n+      local filetags = extract_file_tags(filename)\n+      vim.list_extend(tags, filetags)\n+      process_helpfile(co)\n+    end)\n+  end\n+\n+  coroutine.wrap(function()",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2141953068",
            "id": 2141953068,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5_q5ws",
            "original_commit_id": "c42e386cd1b0dcda8a67368bc4ccce5226be618f",
            "original_line": 87,
            "original_position": 87,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2919914018,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2141953068/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-12T07:43:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2141953068",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2142062094"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142062094"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Ah yes I indeed knew about the efforts for creating a vim.async module, but thought I wouldn't be a able to make use of them here. For now, I'll just pull in the vim._async module from the vim.pack PR",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-12T08:34:06Z",
            "diff_hunk": "@@ -0,0 +1,164 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias TagLocation { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+--- Find all helptags in a single file.\n+---\n+--- @param filename string helpfile with tags\n+--- @return TagLocation[] # empty if file is not readable\n+local function extract_file_tags(filename)\n+  local f, err = io.open(filename, 'r')\n+  if f == nil or err then\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return {}\n+  end\n+  local source = f:read('*a')\n+  f:close()\n+  local fn = vim.fs.basename(filename)\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+        local searchcmd = '/*' .. escaped .. '*'\n+        table.insert(tags, { tagname, fn, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+---\n+--- @param tags TagLocation[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.notify(\n+        ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn),\n+        vim.log.levels.WARN\n+      )\n+    end\n+    prevtag = curtag\n+    prevfn = curfn\n+  end\n+  return found\n+end\n+\n+--- Extract tags from a list of helpfiles.\n+---\n+--- @param helpfiles string[] list of helpfiles\n+--- @param tagsfile string the filename of the 'tags' file\n+--- @param include_helptags_tag boolean true if the 'tags' tag should be included\n+local function create_tags_from_files(helpfiles, tagsfile, include_helptags_tag)\n+  ---@type TagLocation\n+  local tags = {}\n+  local i = 1\n+  local function process_helpfile(co)\n+    if i > #helpfiles then\n+      coroutine.resume(co, true)\n+      return\n+    end\n+\n+    local filename = helpfiles[i]\n+    i = i + 1\n+\n+    vim.schedule(function()\n+      local filetags = extract_file_tags(filename)\n+      vim.list_extend(tags, filetags)\n+      process_helpfile(co)\n+    end)\n+  end\n+\n+  coroutine.wrap(function()",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2142062094",
            "id": 2142062094,
            "in_reply_to_id": 2141953068,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5_rUYO",
            "original_commit_id": "c42e386cd1b0dcda8a67368bc4ccce5226be618f",
            "original_line": 87,
            "original_position": 87,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2920080722,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142062094/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-12T08:34:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142062094",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2142097491"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142097491"
                }
            },
            "author_association": "MEMBER",
            "body": "The potential of `vim.async` shouldn't restrict the use of coroutines. `vim.async` is just a very generalized layer on top of coroutines, but if the requirements are small (like) here, then I don't see a problem with using coroutines. I still think coroutines are important for generator functions (functions that return iterators).\r\n\r\nThe usage here is contained within ~30LOC, if anything this is might be preferable to using `vim.async`.\r\n\r\nThough I'm not quite sure why coroutines are being used here (needs a comment). It looks like it's to not eat up the main loop, in which case `vim.async` + `uv.fs_open` might help in the future.\r\n\r\nWhat is the effect if no coroutines where used here? Does creating tags from helpfiles cause lots of lag or something?",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-12T08:53:14Z",
            "diff_hunk": "@@ -0,0 +1,164 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias TagLocation { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+--- Find all helptags in a single file.\n+---\n+--- @param filename string helpfile with tags\n+--- @return TagLocation[] # empty if file is not readable\n+local function extract_file_tags(filename)\n+  local f, err = io.open(filename, 'r')\n+  if f == nil or err then\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return {}\n+  end\n+  local source = f:read('*a')\n+  f:close()\n+  local fn = vim.fs.basename(filename)\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+        local searchcmd = '/*' .. escaped .. '*'\n+        table.insert(tags, { tagname, fn, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+---\n+--- @param tags TagLocation[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.notify(\n+        ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn),\n+        vim.log.levels.WARN\n+      )\n+    end\n+    prevtag = curtag\n+    prevfn = curfn\n+  end\n+  return found\n+end\n+\n+--- Extract tags from a list of helpfiles.\n+---\n+--- @param helpfiles string[] list of helpfiles\n+--- @param tagsfile string the filename of the 'tags' file\n+--- @param include_helptags_tag boolean true if the 'tags' tag should be included\n+local function create_tags_from_files(helpfiles, tagsfile, include_helptags_tag)\n+  ---@type TagLocation\n+  local tags = {}\n+  local i = 1\n+  local function process_helpfile(co)\n+    if i > #helpfiles then\n+      coroutine.resume(co, true)\n+      return\n+    end\n+\n+    local filename = helpfiles[i]\n+    i = i + 1\n+\n+    vim.schedule(function()\n+      local filetags = extract_file_tags(filename)\n+      vim.list_extend(tags, filetags)\n+      process_helpfile(co)\n+    end)\n+  end\n+\n+  coroutine.wrap(function()",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2142097491",
            "id": 2142097491,
            "in_reply_to_id": 2141953068,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5_rdBT",
            "original_commit_id": "c42e386cd1b0dcda8a67368bc4ccce5226be618f",
            "original_line": 87,
            "original_position": 87,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2920137185,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142097491/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-12T08:53:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142097491",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/7904185?v=4",
                "events_url": "https://api.github.com/users/lewis6991/events{/privacy}",
                "followers_url": "https://api.github.com/users/lewis6991/followers",
                "following_url": "https://api.github.com/users/lewis6991/following{/other_user}",
                "gists_url": "https://api.github.com/users/lewis6991/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/lewis6991",
                "id": 7904185,
                "login": "lewis6991",
                "node_id": "MDQ6VXNlcjc5MDQxODU=",
                "organizations_url": "https://api.github.com/users/lewis6991/orgs",
                "received_events_url": "https://api.github.com/users/lewis6991/received_events",
                "repos_url": "https://api.github.com/users/lewis6991/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/lewis6991/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lewis6991/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/lewis6991",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2142135454"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142135454"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I noticed it blocked the editor (~2 secs for the runtimedir). Although maybe vim.schedule will be enough for this. \n\nI added coroutines because I was looking for parallelization, as extracting tags for every file is a task that can be parallelized very efficiently. But I learned that coroutines all run on a single thread and file reads are blocking. Still, this implementation felt 'snappier' and faster to me than the fully sync approach. I'll try vim.schedule (+ uv.fs_open)",
            "commit_id": "135d4e969e698af37759afcab15a1e86c8ef3665",
            "created_at": "2025-06-12T09:12:37Z",
            "diff_hunk": "@@ -0,0 +1,164 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias TagLocation { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+--- Find all helptags in a single file.\n+---\n+--- @param filename string helpfile with tags\n+--- @return TagLocation[] # empty if file is not readable\n+local function extract_file_tags(filename)\n+  local f, err = io.open(filename, 'r')\n+  if f == nil or err then\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return {}\n+  end\n+  local source = f:read('*a')\n+  f:close()\n+  local fn = vim.fs.basename(filename)\n+\n+  local tags = {}\n+  local tree = ts.get_string_parser(source, 'vimdoc'):parse()[1]:root()\n+\n+  for _, match in query:iter_matches(tree, source) do\n+    for id, node in pairs(match) do\n+      if query.captures[id] == 'tagname' then\n+        local tagname = ts.get_node_text(node[1], source)\n+        local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+        local searchcmd = '/*' .. escaped .. '*'\n+        table.insert(tags, { tagname, fn, searchcmd })\n+      end\n+    end\n+  end\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags.\n+---\n+--- @param tags TagLocation[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  local prevtag, prevfn\n+  for _, tag in ipairs(tags) do\n+    local curtag, curfn, _ = unpack(tag)\n+    if curtag == prevtag then\n+      found = true\n+      local other_fn = prevfn ~= curfn and (' and ' .. prevfn) or ''\n+      vim.notify(\n+        ('E154: Duplicate tag \"%s\" in %s%s'):format(curtag, curfn, other_fn),\n+        vim.log.levels.WARN\n+      )\n+    end\n+    prevtag = curtag\n+    prevfn = curfn\n+  end\n+  return found\n+end\n+\n+--- Extract tags from a list of helpfiles.\n+---\n+--- @param helpfiles string[] list of helpfiles\n+--- @param tagsfile string the filename of the 'tags' file\n+--- @param include_helptags_tag boolean true if the 'tags' tag should be included\n+local function create_tags_from_files(helpfiles, tagsfile, include_helptags_tag)\n+  ---@type TagLocation\n+  local tags = {}\n+  local i = 1\n+  local function process_helpfile(co)\n+    if i > #helpfiles then\n+      coroutine.resume(co, true)\n+      return\n+    end\n+\n+    local filename = helpfiles[i]\n+    i = i + 1\n+\n+    vim.schedule(function()\n+      local filetags = extract_file_tags(filename)\n+      vim.list_extend(tags, filetags)\n+      process_helpfile(co)\n+    end)\n+  end\n+\n+  coroutine.wrap(function()",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2142135454",
            "id": 2142135454,
            "in_reply_to_id": 2141953068,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM5_rmSe",
            "original_commit_id": "c42e386cd1b0dcda8a67368bc4ccce5226be618f",
            "original_line": 87,
            "original_position": 87,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 2920198583,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142135454/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-06-12T09:12:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2142135454",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2455801008"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455801008"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Mostly added for headless runs, as otherwise Nvim quits before the async tasks finish. Is there another / better way?",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-10-23T16:06:58Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end\n+\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s'):format(outpath))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- Function is asynchronous. To run synchronously, set `wait` to true.\n+--- @param dir string Directory to generate help tag file for.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+--- @param wait? boolean (default: false) Run synchronously.\n+function M.generate(dir, include_helptags, wait)\n+  vim.validate('dir', dir, 'string')\n+  vim.validate('include_helptags_tag', include_helptags, 'boolean', true)\n+  vim.validate('wait', wait, 'boolean', true)\n+\n+  local dirs = { vim.fs.normalize(dir) }\n+  if dir == 'ALL' then\n+    dirs = vim.api.nvim_get_runtime_file('doc', true)\n+  end\n+\n+  local vimruntime = vim.fs.normalize(vim.env.VIMRUNTIME)\n+\n+  local tasks = {}\n+  for _, directory in ipairs(dirs) do\n+    -- always include the help-tags tag for the $VIMRUNTIME\n+    include_helptags = include_helptags or directory == vimruntime\n+\n+    local files = vim.fs.find(function(name, _)\n+      return vim.endswith(name, '.txt')\n+    end, { path = directory, type = 'file', limit = math.huge })\n+\n+    local outpath = vim.fs.joinpath(directory, 'tags')\n+    local t1 = async.run(create_tags_from_files, files, outpath, include_helptags)\n+    table.insert(tasks, t1)\n+\n+    -- handle translated help files per language\n+    local translated = vim.fs.find(function(name, _)\n+      -- \"*.[a-z][a-z]x\", see :help help-translated\n+      return name:match('%.%l%lx', -4)\n+    end, { path = directory, type = 'file', limit = math.huge })\n+\n+    -- categorize translated files per two-letter language code\n+    ---@type table<string, string[]>\n+    local per_lang = {}\n+    for _, file in ipairs(translated) do\n+      -- \"plugin.nlx\" --> \"nl\"\n+      local lang = file:sub(-3, -2)\n+      per_lang[lang] = per_lang[lang] or {}\n+      table.insert(per_lang[lang], file)\n+    end\n+\n+    for lang, langfiles in pairs(per_lang) do\n+      local tagsfile = vim.fs.joinpath(directory, 'tags-' .. lang)\n+      local t2 = async.run(create_tags_from_files, langfiles, tagsfile, include_helptags)\n+      table.insert(tasks, t2)\n+    end\n+  end\n+  if wait then\n+    async.run(function()\n+      async.join(tasks)\n+    end):wait()\n+  end",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2455801008",
            "id": 2455801008,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6SYIyw",
            "original_commit_id": "3e016c14610b9c9173e5e6cbf84ab9daeb31e807",
            "original_line": 181,
            "original_position": 195,
            "original_start_line": 191,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3370869897,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455801008/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-23T16:06:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455801008",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2455824058"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455824058"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "should this be handled in `ex_helptags()`, and that this function runs on all runtime/doc paths if dir == nil?",
            "commit_id": "b384bf3f766c4b3f3d37cb42880bd0c53b264d8d",
            "created_at": "2025-10-23T16:10:56Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end\n+\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s'):format(outpath))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- Function is asynchronous. To run synchronously, set `wait` to true.\n+--- @param dir string Directory to generate help tag file for.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+--- @param wait? boolean (default: false) Run synchronously.\n+function M.generate(dir, include_helptags, wait)\n+  vim.validate('dir', dir, 'string')\n+  vim.validate('include_helptags_tag', include_helptags, 'boolean', true)\n+  vim.validate('wait', wait, 'boolean', true)\n+\n+  local dirs = { vim.fs.normalize(dir) }\n+  if dir == 'ALL' then",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2455824058",
            "id": 2455824058,
            "line": 94,
            "node_id": "PRRC_kwDOAPphoM6SYOa6",
            "original_commit_id": "2259a3a1bfd6dc8ab28d55037653414d8380268a",
            "original_line": 134,
            "original_position": 150,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 94,
            "pull_request_review_id": 3370901139,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455824058/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-04T19:14:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455824058",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2455828242"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455828242"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "this is what the original code did. I can also just `assert` that the file is read if that's preferred.",
            "commit_id": "5d558635612c924ab51a878582908f0de08a186d",
            "created_at": "2025-10-23T16:11:52Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2455828242",
            "id": 2455828242,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6SYPcS",
            "original_commit_id": "2259a3a1bfd6dc8ab28d55037653414d8380268a",
            "original_line": 46,
            "original_position": 46,
            "original_start_line": 42,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 3370906983,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455828242/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-23T16:11:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455828242",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2455834918"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455834918"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Previous code didn't write the tags file on duplicate tags. Should that behaviour change to only notify the user but still write the file?",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-10-23T16:12:53Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2455834918",
            "id": 2455834918,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6SYREm",
            "original_commit_id": "2259a3a1bfd6dc8ab28d55037653414d8380268a",
            "original_line": 106,
            "original_position": 123,
            "original_start_line": 121,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 3370915499,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455834918/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-10-23T16:12:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455834918",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2455871112"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455871112"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Should this function that creates async tasks return a `:cancel()` method to cancel all running tasks? Similar to the suggestion on #34140?",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-10-23T16:19:48Z",
            "diff_hunk": "@@ -0,0 +1,200 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end\n+\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s'):format(outpath))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- Function is asynchronous. To run synchronously, set `wait` to true.\n+--- @param dir string Directory to generate help tag file for.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+--- @param wait? boolean (default: false) Run synchronously.\n+function M.generate(dir, include_helptags, wait)",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2455871112",
            "id": 2455871112,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6SYZ6I",
            "original_commit_id": "5d558635612c924ab51a878582908f0de08a186d",
            "original_line": 128,
            "original_position": 144,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 3370962386,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455871112/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-04T19:15:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2455871112",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2525637110"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525637110"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n  NLUA_EXEC_STATIC(\"require('vim._core/help').gen_tags(...)\", args,\n```",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-11-14T03:33:53Z",
            "diff_hunk": "@@ -1119,18 +833,12 @@ void ex_helptags(exarg_T *eap)\n     eap->arg = skipwhite(eap->arg + 3);\n   }\n \n-  if (strcmp(eap->arg, \"ALL\") == 0) {\n-    do_in_path(p_rtp, \"\", \"doc\", DIP_ALL + DIP_DIR, helptags_cb, &add_help_tags);\n-  } else {\n-    ExpandInit(&xpc);\n-    xpc.xp_context = EXPAND_DIRECTORIES;\n-    char *dirname =\n-      ExpandOne(&xpc, eap->arg, NULL, WILD_LIST_NOTFOUND|WILD_SILENT, WILD_EXPAND_FREE);\n-    if (dirname == NULL || !os_isdir(dirname)) {\n-      semsg(_(\"E150: Not a directory: %s\"), eap->arg);\n-    } else {\n-      do_helptags(dirname, add_help_tags, false);\n-    }\n-    xfree(dirname);\n-  }\n+  MAXSIZE_TEMP_ARRAY(args, 2);\n+  ADD_C(args, CSTR_AS_OBJ(eap->arg));\n+  ADD_C(args, BOOLEAN_OBJ(add_help_tags));\n+\n+  Error err = ERROR_INIT;\n+  NLUA_EXEC_STATIC(\"require('vim._helptags').generate(...)\", args,",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2525637110",
            "id": 2525637110,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6Wiin2",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 841,
            "original_position": 328,
            "original_start_line": null,
            "path": "src/nvim/help.c",
            "position": 1,
            "pull_request_review_id": 3462625549,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525637110/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-14T03:33:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525637110",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2525639875"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525639875"
                }
            },
            "author_association": "MEMBER",
            "body": "not needed if it's moved to `_core` ... oh, i need to merge https://github.com/neovim/neovim/pull/35150  \n",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-11-14T03:36:26Z",
            "diff_hunk": "@@ -624,6 +625,7 @@ add_custom_command(\n       ${LUA_FILETYPE_MODULE_SOURCE} \"vim.filetype\"\n       ${LUA_FS_MODULE_SOURCE} \"vim.fs\"\n       ${LUA_F_MODULE_SOURCE} \"vim.F\"\n+      ${LUA_HELPTAGS_MODULE_SOURCE} \"vim._helptags\"",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2525639875",
            "id": 2525639875,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6WijTD",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 628,
            "original_position": 12,
            "original_start_line": null,
            "path": "src/nvim/CMakeLists.txt",
            "position": 1,
            "pull_request_review_id": 3462632141,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525639875/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-14T03:36:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525639875",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2525642005"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525642005"
                }
            },
            "author_association": "MEMBER",
            "body": "it's internal so can do whatever works best for now. we haven't settled on async patterns (except a few things mentioned in `:help dev-patterns`), and `async.lua` is very much WIP.",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-11-14T03:38:19Z",
            "diff_hunk": "@@ -0,0 +1,200 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end\n+\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s'):format(outpath))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- Function is asynchronous. To run synchronously, set `wait` to true.\n+--- @param dir string Directory to generate help tag file for.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+--- @param wait? boolean (default: false) Run synchronously.\n+function M.generate(dir, include_helptags, wait)",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2525642005",
            "id": 2525642005,
            "in_reply_to_id": 2455871112,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6Wij0V",
            "original_commit_id": "5d558635612c924ab51a878582908f0de08a186d",
            "original_line": 128,
            "original_position": 144,
            "original_start_line": null,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 3462635977,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525642005/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-14T03:38:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525642005",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2525642638"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525642638"
                }
            },
            "author_association": "MEMBER",
            "body": "which way is more obvious and less surprising?",
            "commit_id": "b384bf3f766c4b3f3d37cb42880bd0c53b264d8d",
            "created_at": "2025-11-14T03:38:54Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end\n+\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s'):format(outpath))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- Function is asynchronous. To run synchronously, set `wait` to true.\n+--- @param dir string Directory to generate help tag file for.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+--- @param wait? boolean (default: false) Run synchronously.\n+function M.generate(dir, include_helptags, wait)\n+  vim.validate('dir', dir, 'string')\n+  vim.validate('include_helptags_tag', include_helptags, 'boolean', true)\n+  vim.validate('wait', wait, 'boolean', true)\n+\n+  local dirs = { vim.fs.normalize(dir) }\n+  if dir == 'ALL' then",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2525642638",
            "id": 2525642638,
            "in_reply_to_id": 2455824058,
            "line": 94,
            "node_id": "PRRC_kwDOAPphoM6Wij-O",
            "original_commit_id": "2259a3a1bfd6dc8ab28d55037653414d8380268a",
            "original_line": 134,
            "original_position": 150,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 94,
            "pull_request_review_id": 3462636790,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525642638/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-14T03:38:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525642638",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2525643545"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525643545"
                }
            },
            "author_association": "MEMBER",
            "body": "seems fine. are you trying to avoid the `wait` arg?\n\ninternal functions can be ugly :)",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-11-14T03:39:44Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end\n+\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s'):format(outpath))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- Function is asynchronous. To run synchronously, set `wait` to true.\n+--- @param dir string Directory to generate help tag file for.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+--- @param wait? boolean (default: false) Run synchronously.\n+function M.generate(dir, include_helptags, wait)\n+  vim.validate('dir', dir, 'string')\n+  vim.validate('include_helptags_tag', include_helptags, 'boolean', true)\n+  vim.validate('wait', wait, 'boolean', true)\n+\n+  local dirs = { vim.fs.normalize(dir) }\n+  if dir == 'ALL' then\n+    dirs = vim.api.nvim_get_runtime_file('doc', true)\n+  end\n+\n+  local vimruntime = vim.fs.normalize(vim.env.VIMRUNTIME)\n+\n+  local tasks = {}\n+  for _, directory in ipairs(dirs) do\n+    -- always include the help-tags tag for the $VIMRUNTIME\n+    include_helptags = include_helptags or directory == vimruntime\n+\n+    local files = vim.fs.find(function(name, _)\n+      return vim.endswith(name, '.txt')\n+    end, { path = directory, type = 'file', limit = math.huge })\n+\n+    local outpath = vim.fs.joinpath(directory, 'tags')\n+    local t1 = async.run(create_tags_from_files, files, outpath, include_helptags)\n+    table.insert(tasks, t1)\n+\n+    -- handle translated help files per language\n+    local translated = vim.fs.find(function(name, _)\n+      -- \"*.[a-z][a-z]x\", see :help help-translated\n+      return name:match('%.%l%lx', -4)\n+    end, { path = directory, type = 'file', limit = math.huge })\n+\n+    -- categorize translated files per two-letter language code\n+    ---@type table<string, string[]>\n+    local per_lang = {}\n+    for _, file in ipairs(translated) do\n+      -- \"plugin.nlx\" --> \"nl\"\n+      local lang = file:sub(-3, -2)\n+      per_lang[lang] = per_lang[lang] or {}\n+      table.insert(per_lang[lang], file)\n+    end\n+\n+    for lang, langfiles in pairs(per_lang) do\n+      local tagsfile = vim.fs.joinpath(directory, 'tags-' .. lang)\n+      local t2 = async.run(create_tags_from_files, langfiles, tagsfile, include_helptags)\n+      table.insert(tasks, t2)\n+    end\n+  end\n+  if wait then\n+    async.run(function()\n+      async.join(tasks)\n+    end):wait()\n+  end",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2525643545",
            "id": 2525643545,
            "in_reply_to_id": 2455801008,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6WikMZ",
            "original_commit_id": "3e016c14610b9c9173e5e6cbf84ab9daeb31e807",
            "original_line": 181,
            "original_position": 195,
            "original_start_line": 191,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3462638222,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525643545/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-11-14T03:39:44Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525643545",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2525644050"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525644050"
                }
            },
            "author_association": "MEMBER",
            "body": "this can be dropped, right? this module is used by `vim.pack` already",
            "commit_id": "df4252339c5ae6bb6073f4b3274bffacfc751286",
            "created_at": "2025-11-14T03:40:13Z",
            "diff_hunk": "",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2525644050",
            "id": 2525644050,
            "line": 1,
            "node_id": "PRRC_kwDOAPphoM6WikUS",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 1,
            "original_position": 1,
            "original_start_line": null,
            "path": "runtime/lua/vim/_async.lua",
            "position": 1,
            "pull_request_review_id": 3462638793,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525644050/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "file",
            "updated_at": "2025-11-14T03:40:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2525644050",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2526113600"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2526113600"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Yes thought there might be a more idiomatic way then the wait arg. Will leave it like this for now. ",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-11-14T07:22:53Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end\n+\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s'):format(outpath))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- Function is asynchronous. To run synchronously, set `wait` to true.\n+--- @param dir string Directory to generate help tag file for.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+--- @param wait? boolean (default: false) Run synchronously.\n+function M.generate(dir, include_helptags, wait)\n+  vim.validate('dir', dir, 'string')\n+  vim.validate('include_helptags_tag', include_helptags, 'boolean', true)\n+  vim.validate('wait', wait, 'boolean', true)\n+\n+  local dirs = { vim.fs.normalize(dir) }\n+  if dir == 'ALL' then\n+    dirs = vim.api.nvim_get_runtime_file('doc', true)\n+  end\n+\n+  local vimruntime = vim.fs.normalize(vim.env.VIMRUNTIME)\n+\n+  local tasks = {}\n+  for _, directory in ipairs(dirs) do\n+    -- always include the help-tags tag for the $VIMRUNTIME\n+    include_helptags = include_helptags or directory == vimruntime\n+\n+    local files = vim.fs.find(function(name, _)\n+      return vim.endswith(name, '.txt')\n+    end, { path = directory, type = 'file', limit = math.huge })\n+\n+    local outpath = vim.fs.joinpath(directory, 'tags')\n+    local t1 = async.run(create_tags_from_files, files, outpath, include_helptags)\n+    table.insert(tasks, t1)\n+\n+    -- handle translated help files per language\n+    local translated = vim.fs.find(function(name, _)\n+      -- \"*.[a-z][a-z]x\", see :help help-translated\n+      return name:match('%.%l%lx', -4)\n+    end, { path = directory, type = 'file', limit = math.huge })\n+\n+    -- categorize translated files per two-letter language code\n+    ---@type table<string, string[]>\n+    local per_lang = {}\n+    for _, file in ipairs(translated) do\n+      -- \"plugin.nlx\" --> \"nl\"\n+      local lang = file:sub(-3, -2)\n+      per_lang[lang] = per_lang[lang] or {}\n+      table.insert(per_lang[lang], file)\n+    end\n+\n+    for lang, langfiles in pairs(per_lang) do\n+      local tagsfile = vim.fs.joinpath(directory, 'tags-' .. lang)\n+      local t2 = async.run(create_tags_from_files, langfiles, tagsfile, include_helptags)\n+      table.insert(tasks, t2)\n+    end\n+  end\n+  if wait then\n+    async.run(function()\n+      async.join(tasks)\n+    end):wait()\n+  end",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2526113600",
            "id": 2526113600,
            "in_reply_to_id": 2455801008,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6WkW9A",
            "original_commit_id": "3e016c14610b9c9173e5e6cbf84ab9daeb31e807",
            "original_line": 181,
            "original_position": 195,
            "original_start_line": 191,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3463219990,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2526113600/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-11-14T07:22:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2526113600",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2527226344"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2527226344"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "`vim.pack` seems to use a very slimmed-down version of _async.lua that only includes what is needed. This version is the latest from the async PR that for example can pass arguments to the async function:\r\n\r\n```lua\r\nasync.run(func, arg1, arg2)\r\n-- vs:\r\nasync.run(function()\r\n  return func(arg1, arg2)\r\nend)\r\n```\r\n\r\nI'll see if I can rewrite it to work with the slimmer version",
            "commit_id": "df4252339c5ae6bb6073f4b3274bffacfc751286",
            "created_at": "2025-11-14T11:50:08Z",
            "diff_hunk": "",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2527226344",
            "id": 2527226344,
            "in_reply_to_id": 2525644050,
            "line": 1,
            "node_id": "PRRC_kwDOAPphoM6Womno",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 1,
            "original_position": 1,
            "original_start_line": null,
            "path": "runtime/lua/vim/_async.lua",
            "position": 1,
            "pull_request_review_id": 3464586837,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2527226344/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "file",
            "updated_at": "2025-11-14T11:52:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2527226344",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2527239399"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2527239399"
                }
            },
            "author_association": "MEMBER",
            "body": "Or we could try to get the `vim.async` PR merged. As long as the core interface is stable, the remaining open points may be iterated on later?",
            "commit_id": "df4252339c5ae6bb6073f4b3274bffacfc751286",
            "created_at": "2025-11-14T11:55:15Z",
            "diff_hunk": "",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2527239399",
            "id": 2527239399,
            "in_reply_to_id": 2525644050,
            "line": 1,
            "node_id": "PRRC_kwDOAPphoM6Wopzn",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 1,
            "original_position": 1,
            "original_start_line": null,
            "path": "runtime/lua/vim/_async.lua",
            "position": 1,
            "pull_request_review_id": 3464601369,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 1,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2527239399/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "file",
            "updated_at": "2025-11-14T11:55:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2527239399",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2529043839"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529043839"
                }
            },
            "author_association": "MEMBER",
            "body": "can we use `:echoerr` or `error()` instead of notify()\r\n\r\nassert() also seems preferable",
            "commit_id": "5d558635612c924ab51a878582908f0de08a186d",
            "created_at": "2025-11-14T21:44:39Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2529043839",
            "id": 2529043839,
            "in_reply_to_id": 2455828242,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6WviV_",
            "original_commit_id": "2259a3a1bfd6dc8ab28d55037653414d8380268a",
            "original_line": 46,
            "original_position": 46,
            "original_start_line": 42,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 3466943728,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529043839/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-11-14T21:44:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529043839",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2529047761"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529047761"
                }
            },
            "author_association": "MEMBER",
            "body": "we have lint checks that use the duplicate tag functionality to fail CI if duplicate tags are found. so we need to preserve that, i.e. `nvim` should exit nonzero ",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-11-14T21:45:49Z",
            "diff_hunk": "@@ -0,0 +1,198 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param callback fun(string?, string?): string?, string?\n+local function read_file_uv(path, callback)\n+  vim.uv.fs_open(path, 'r', 438, function(err_open, fd)\n+    if err_open then\n+      return callback(nil, err_open)\n+    end\n+\n+    vim.uv.fs_fstat(fd, function(err_stat, stat)\n+      if err_stat then\n+        vim.uv.fs_close(fd)\n+        return callback(nil, err_stat)\n+      end\n+\n+      vim.uv.fs_read(fd, stat.size, 0, function(err_read, data)\n+        vim.uv.fs_close(fd)\n+        if err_read then\n+          return callback(nil, err_read)\n+        end\n+        callback(data, nil)\n+      end)\n+    end)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param filename string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_file_tags(filename)\n+  local tags = {}\n+  local source, err = async.await(2, read_file_uv, filename)\n+  if err or source == nil then\n+    async.await(vim.schedule)\n+    vim.notify(('E153: Unable to open %s for reading'):format(filename), vim.log.levels.ERROR)\n+    return tags\n+  end\n+  local fn = vim.fs.basename(filename)\n+\n+  async.await(vim.schedule_wrap(function(done)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+    parser:parse(false, function(err2, tree)\n+      if not err2 then\n+        local root = tree[1]:root()\n+        for _, match in query:iter_matches(root, source) do\n+          for id, node in pairs(match) do\n+            if query.captures[id] == 'tagname' then\n+              local tagname = ts.get_node_text(node[1], source)\n+              local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+              local searchcmd = '/*' .. escaped .. '*'\n+              table.insert(tags, { tagname, fn, searchcmd })\n+            end\n+          end\n+        end\n+      end\n+      parser:destroy()\n+      done()\n+    end)\n+  end))\n+\n+  return tags\n+end\n+\n+--- Report duplicate tags. Assumes the tags are alphabetically sorted.\n+--- @param tags Tag[]\n+--- @return boolean # true if there are duplicate tags\n+local function duplicate_tags(tags)\n+  local found = false\n+  for i = 1, #tags - 1 do\n+    local curtag, curfn, _ = unpack(tags[i])\n+    local prevtag, prevfn, _ = unpack(tags[i + 1])\n+    if curtag == prevtag then\n+      found = true\n+      if prevfn ~= curfn then\n+        curfn = ('%s and %s'):format(curfn, prevfn)\n+      end\n+      vim.schedule(function()\n+        vim.notify(('E154: Duplicate tag \"%s\" in %s'):format(curtag, curfn), vim.log.levels.WARN)\n+      end)\n+    end\n+  end\n+  return found\n+end\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @async\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function create_tags_from_files(helpfiles, outpath, include_helptags_tag)\n+  local tasks = {}\n+  for i, file in ipairs(helpfiles) do\n+    tasks[i] = async.run(extract_file_tags, file)\n+  end\n+\n+  ---@type { [1]: string?, [2]: Tag[]}[]\n+  local results = async.join(tasks)\n+\n+  local tags = {}\n+  for _, res in ipairs(results) do\n+    vim.list_extend(tags, res[2])\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  if vim.tbl_isempty(tags) or duplicate_tags(tags) then\n+    return\n+  end",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2529047761",
            "id": 2529047761,
            "in_reply_to_id": 2455834918,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6WvjTR",
            "original_commit_id": "2259a3a1bfd6dc8ab28d55037653414d8380268a",
            "original_line": 106,
            "original_position": 123,
            "original_start_line": 121,
            "path": "runtime/lua/vim/_helptags.lua",
            "position": 1,
            "pull_request_review_id": 3466948679,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529047761/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-11-14T21:45:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529047761",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2529050585"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529050585"
                }
            },
            "author_association": "MEMBER",
            "body": "lets keep this comment unresolved and raise the priority of https://github.com/neovim/neovim/pull/35150",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-11-14T21:46:38Z",
            "diff_hunk": "@@ -624,6 +625,7 @@ add_custom_command(\n       ${LUA_FILETYPE_MODULE_SOURCE} \"vim.filetype\"\n       ${LUA_FS_MODULE_SOURCE} \"vim.fs\"\n       ${LUA_F_MODULE_SOURCE} \"vim.F\"\n+      ${LUA_HELPTAGS_MODULE_SOURCE} \"vim._helptags\"",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2529050585",
            "id": 2529050585,
            "in_reply_to_id": 2525639875,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6Wvj_Z",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 628,
            "original_position": 12,
            "original_start_line": null,
            "path": "src/nvim/CMakeLists.txt",
            "position": 1,
            "pull_request_review_id": 3466951878,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529050585/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-14T21:46:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529050585",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2529053779"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529053779"
                }
            },
            "author_association": "MEMBER",
            "body": "> Or we could try to get the `vim.async` PR merged. As long as the core interface is stable\r\n\r\nit is not ready to be merged. i raised a few issues in https://github.com/lewis6991/async.nvim and AFAICT there are still some pretty serious interface questions to resolve\r\n\r\n> I'll see if I can rewrite it to work with the slimmer version\r\n\r\n ",
            "commit_id": "df4252339c5ae6bb6073f4b3274bffacfc751286",
            "created_at": "2025-11-14T21:47:30Z",
            "diff_hunk": "",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2529053779",
            "id": 2529053779,
            "in_reply_to_id": 2525644050,
            "line": 1,
            "node_id": "PRRC_kwDOAPphoM6WvkxT",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 1,
            "original_position": 1,
            "original_start_line": null,
            "path": "runtime/lua/vim/_async.lua",
            "position": 1,
            "pull_request_review_id": 3466955820,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529053779/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "file",
            "updated_at": "2025-11-14T21:49:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2529053779",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2621890221"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621890221"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n |:helptags| is now implemented with Treesitter.\n```",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T05:53:10Z",
            "diff_hunk": "@@ -418,6 +418,7 @@ These existing features changed their behavior.\n  'scrollback' maximum value increased from 100000 to 1000000\n  |matchfuzzy()| and |matchfuzzypos()| use an improved fuzzy matching algorithm\n   (same as fzy).\n+ |:helptags| generates the help tags file(s) using Treesitter.",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2621890221",
            "id": 2621890221,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cRt6t",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 421,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/doc/news.txt",
            "position": 1,
            "pull_request_review_id": 3581432820,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621890221/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T05:53:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621890221",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2621897768"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621897768"
                }
            },
            "author_association": "MEMBER",
            "body": "Is async actually needed? Wasn't needed with the C version...\n\nWe should avoid using async module unless there is a strong reason. There may be major changes to it, it's not stable. And it complicates code.",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T05:57:16Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2621897768",
            "id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cRvwo",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3581441292,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621897768/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T05:57:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621897768",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2621902443"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621902443"
                }
            },
            "author_association": "MEMBER",
            "body": "was reverted: https://github.com/neovim/neovim/pull/36964",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T05:59:18Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+---Read file in libuv callback-style\n+---@param path string\n+---@param cb fun(string?, string?): string?, string?\n+local function uv_read(path, cb)\n+  local fd = assert(vim.uv.fs_open(path, 'r', 438))\n+  local stat = assert(vim.uv.fs_fstat(fd))\n+  vim.uv.fs_read(fd, stat.size, 0, function(err, data)\n+    vim.uv.fs_close(fd)\n+    cb(data, err)\n+  end)\n+end\n+\n+--- Extract all tag definitions from a help file.\n+--- @async\n+--- @param path string Help file with tags.\n+--- @return Tag[] # List of tags. Empty if file is not readable.\n+local function extract_tags(path)\n+  local tags = {}\n+  local source = assert(async.await(2, uv_read, path))\n+\n+  -- FIX(yochem): creates many scratch buffers, which is slow. Destroying",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2621902443",
            "id": 2621902443,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cRw5r",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 29,
            "original_position": 29,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3581447283,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621902443/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T05:59:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2621902443",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2622280347"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2622280347"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Otherwise the editor is blocked for ~10s. In one of the first versions I implemented it using coroutines but that was much harder to read IMO. I can probably try to see if simply using the (callback style) async TS parsing and some vim.schedule's solve it, but I'm not sure. \n\nIt's just a repetitive process with lot's of larger blocking actions: reading every help file from disk, parsing it using treesitter and finding the captures. ",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T08:25:06Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2622280347",
            "id": 2622280347,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cTNKb",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3581890516,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2622280347/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T08:25:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2622280347",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624322374"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624322374"
                }
            },
            "author_association": "MEMBER",
            "body": "I'm not suggesting coroutines, I am suggesting simple synchronous code. If it takes 10s that is a regression vs the current C routine. Why does it take 10s?",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T18:31:01Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624322374",
            "id": 2624322374,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6ca_tG",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3584456223,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624322374/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T18:31:10Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624322374",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624349424"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624349424"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Due to the TS parsing, mostly. It's a trade off, a regression in speed in order to get higher correctness and the possibility to extend it easily to other filetypes. If that's not wanted, I can close this PR. \n\nI'll investigate some more where the bottlenecks are, but I'm pretty sure from earlier tests that it's simply the TS parsing. ",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T18:39:55Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624349424",
            "id": 2624349424,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cbGTw",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3584488075,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624349424/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T18:39:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624349424",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624464886"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624464886"
                }
            },
            "author_association": "MEMBER",
            "body": "Yeah, `gen_help_html.validate()` takes about 5-10s :( I wonder if there are shortcuts that can make it faster. Or maybe treesitter isn't the right approach just for getting helptags, since helptags is a very limited part of the vimdoc grammar. Though moving stuff to Lua is still potentially useful.",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T19:22:31Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624464886",
            "id": 2624464886,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cbif2",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3584617588,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624464886/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T19:22:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624464886",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624484087"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624484087"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Is it mainly CI that you're concerned about execution speed? Because 10s without blocking the editor shouldn't be much of a problem for end users. But it's probably not ideal to slow every CI build with 10s... I'll probably close this PR then if I can't find a way to make it faster. ",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T19:29:35Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624484087",
            "id": 2624484087,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cbnL3",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3584639841,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624484087/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T19:29:36Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624484087",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624503895"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624503895"
                }
            },
            "author_association": "MEMBER",
            "body": "No I'm more concerned about code complexity. If we move to a concurrent approach to workaround treesitter performance, it is not such a clear gain to eliminate the old C code, which had no performance issue.",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T19:36:54Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624503895",
            "id": 2624503895,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cbsBX",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3584662475,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624503895/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T19:36:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624503895",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624789082"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624789082"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "It's now sync again (2c1a7b55614f22364d9437ae419ca422f3418b51) and weirdly enough it now takes only _2 seconds_! It blocks the editor currently though. Seems like the synchronous path is definitely possible.",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T21:24:55Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624789082",
            "id": 2624789082,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6ccxpa",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3584997599,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624789082/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T21:24:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624789082",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624792191"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624792191"
                }
            },
            "author_association": "MEMBER",
            "body": "Funny how tree-sitter improvements leverage ;)\n",
            "commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "created_at": "2025-12-16T21:26:07Z",
            "diff_hunk": "@@ -0,0 +1,184 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local async = vim._async",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624792191",
            "id": 2624792191,
            "in_reply_to_id": 2621897768,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6ccyZ_",
            "original_commit_id": "30c2d24e8f08132d355a53b222b3143f283da29f",
            "original_line": 4,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3585002178,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624792191/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-16T21:26:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624792191",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2624793239"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624793239"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "`module 'vim._core.help' not found`. Is this related to #36870?",
            "commit_id": "2c1a7b55614f22364d9437ae419ca422f3418b51",
            "created_at": "2025-12-16T21:26:32Z",
            "diff_hunk": "@@ -1119,18 +835,14 @@ void ex_helptags(exarg_T *eap)\n     eap->arg = skipwhite(eap->arg + 3);\n   }\n \n-  if (strcmp(eap->arg, \"ALL\") == 0) {\n-    do_in_path(p_rtp, \"\", \"doc\", DIP_ALL + DIP_DIR, helptags_cb, &add_help_tags);\n-  } else {\n-    ExpandInit(&xpc);\n-    xpc.xp_context = EXPAND_DIRECTORIES;\n-    char *dirname =\n-      ExpandOne(&xpc, eap->arg, NULL, WILD_LIST_NOTFOUND|WILD_SILENT, WILD_EXPAND_FREE);\n-    if (dirname == NULL || !os_isdir(dirname)) {\n-      semsg(_(\"E150: Not a directory: %s\"), eap->arg);\n-    } else {\n-      do_helptags(dirname, add_help_tags, false);\n-    }\n-    xfree(dirname);\n+  MAXSIZE_TEMP_ARRAY(args, 2);\n+  ADD_C(args, CSTR_AS_OBJ(eap->arg));\n+  ADD_C(args, BOOLEAN_OBJ(add_help_tags));\n+\n+  Error err = ERROR_INIT;\n+  // NLUA_EXEC_STATIC(\"require('vim._core.help').gen_tags(...)\", args,\n+  //                  kRetNilBool, NULL, &err);",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2624793239",
            "id": 2624793239,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6ccyqX",
            "original_commit_id": "2c1a7b55614f22364d9437ae419ca422f3418b51",
            "original_line": 844,
            "original_position": 342,
            "original_start_line": 843,
            "path": "src/nvim/help.c",
            "position": 1,
            "pull_request_review_id": 3585003616,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624793239/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-16T21:26:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2624793239",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2625438753"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2625438753"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n  vim.validate('include_helptags', include_helptags, 'boolean', true)\n```",
            "commit_id": "2c1a7b55614f22364d9437ae419ca422f3418b51",
            "created_at": "2025-12-17T03:12:58Z",
            "diff_hunk": "@@ -0,0 +1,132 @@\n+local M = {}\n+\n+local ts = vim.treesitter\n+local query = ts.query.parse('vimdoc', '(tag (word) @tagname)')\n+\n+--- @alias Tag { [1]: string, [2]: string, [3]: string}[] tuple of tag, file, and search command\n+\n+--- Extract tags from helpfiles and combine in a single 'tags' file.\n+--- @param helpfiles string[] list of helpfiles\n+--- @param outpath string path to write the 'tags' file to.\n+--- @param include_helptags_tag boolean true if the 'help-tags' tag should be included\n+local function gen_tagsfile(helpfiles, outpath, include_helptags_tag)\n+  local t = vim.uv.hrtime()\n+  ---@type Tag[]\n+  local tags = {}\n+\n+  -- (1) extract tags from all files\n+  for _, file in ipairs(helpfiles) do\n+    local filename = vim.fs.basename(file)\n+    local source = vim.fn.readblob(file)\n+    local parser = ts.get_string_parser(source, 'vimdoc')\n+\n+    local tree = assert(parser:parse())\n+    local root = tree[1]:root()\n+    for _, match in query:iter_matches(root, source) do\n+      for id, node in pairs(match) do\n+        if query.captures[id] == 'tagname' then\n+          local tagname = ts.get_node_text(node[1], source)\n+          local escaped = tagname:gsub('[\\\\/]', '\\\\%0')\n+          local searchcmd = '/*' .. escaped .. '*'\n+          table.insert(tags, { tagname, filename, searchcmd })\n+        end\n+      end\n+    end\n+  end\n+\n+  if include_helptags_tag then\n+    table.insert(tags, { 'help-tags', 'tags', '1' })\n+  end\n+\n+  if vim.tbl_isempty(tags) then\n+    return\n+  end\n+\n+  -- (2) sort alphabetically on tag name\n+  table.sort(tags, function(a, b)\n+    return a[1] < b[1]\n+  end)\n+\n+  -- (3) check duplicates\n+  do\n+    local prevtag, prevfn, has_duplicates\n+    for _, tagline in ipairs(tags) do\n+      local curtag, curfn, _ = unpack(tagline)\n+      if curtag == prevtag then\n+        has_duplicates = true\n+        local filenames = prevfn ~= curfn and (curfn .. ' and ' .. prevfn) or curfn\n+        local msg = ('E154: Duplicate tag \"%s\" in %s'):format(curtag, filenames)\n+        vim.api.nvim_echo({ { msg } }, false, { err = true })\n+      end\n+\n+      prevtag = curtag\n+      prevfn = curfn\n+    end\n+    if has_duplicates then\n+      error('duplicate tags')\n+    end\n+  end\n+\n+  -- (4) write tags to file\n+  local f = assert(io.open(outpath, 'w'))\n+  for _, tag in ipairs(tags) do\n+    f:write(table.concat(tag, '\\t') .. '\\n')\n+  end\n+  f:close()\n+\n+  print(('Helptags written to %s in %f seconds'):format(outpath, (vim.uv.hrtime() - t) / 1e9))\n+end\n+\n+--- Create a \"tags\" file for all help files in the given directory.\n+---\n+--- The directory {dir} is generally a \"doc\" directory that contains \"*.txt\"\n+--- helpfiles. If dir is `ALL`, create tags file for every \"doc\" directory in\n+--- runtimepath.\n+---\n+--- @param dir string Path to directory with help files. If `nil`, use every\n+--- 'doc' directory in the runtimepath.\n+--- @param include_helptags? boolean (default: false) Whether to include the \"help-tags\" tag.\n+function M.gen_tags(dir, include_helptags)\n+  vim.validate('dir', dir, 'string')\n+  vim.validate('include_helptags_tag', include_helptags, 'boolean', true)",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2625438753",
            "id": 2625438753,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cfQQh",
            "original_commit_id": "2c1a7b55614f22364d9437ae419ca422f3418b51",
            "original_line": 91,
            "original_position": 91,
            "original_start_line": null,
            "path": "runtime/lua/vim/_core/help.lua",
            "position": 1,
            "pull_request_review_id": 3585827792,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2625438753/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-17T03:12:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2625438753",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2625444532"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2625444532"
                }
            },
            "author_association": "MEMBER",
            "body": "If it is called with `nvim -ll` or `nvim -u NONE` then probably. ",
            "commit_id": "2c1a7b55614f22364d9437ae419ca422f3418b51",
            "created_at": "2025-12-17T03:16:58Z",
            "diff_hunk": "@@ -1119,18 +835,14 @@ void ex_helptags(exarg_T *eap)\n     eap->arg = skipwhite(eap->arg + 3);\n   }\n \n-  if (strcmp(eap->arg, \"ALL\") == 0) {\n-    do_in_path(p_rtp, \"\", \"doc\", DIP_ALL + DIP_DIR, helptags_cb, &add_help_tags);\n-  } else {\n-    ExpandInit(&xpc);\n-    xpc.xp_context = EXPAND_DIRECTORIES;\n-    char *dirname =\n-      ExpandOne(&xpc, eap->arg, NULL, WILD_LIST_NOTFOUND|WILD_SILENT, WILD_EXPAND_FREE);\n-    if (dirname == NULL || !os_isdir(dirname)) {\n-      semsg(_(\"E150: Not a directory: %s\"), eap->arg);\n-    } else {\n-      do_helptags(dirname, add_help_tags, false);\n-    }\n-    xfree(dirname);\n+  MAXSIZE_TEMP_ARRAY(args, 2);\n+  ADD_C(args, CSTR_AS_OBJ(eap->arg));\n+  ADD_C(args, BOOLEAN_OBJ(add_help_tags));\n+\n+  Error err = ERROR_INIT;\n+  // NLUA_EXEC_STATIC(\"require('vim._core.help').gen_tags(...)\", args,\n+  //                  kRetNilBool, NULL, &err);",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2625444532",
            "id": 2625444532,
            "in_reply_to_id": 2624793239,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cfRq0",
            "original_commit_id": "2c1a7b55614f22364d9437ae419ca422f3418b51",
            "original_line": 844,
            "original_position": 342,
            "original_start_line": 843,
            "path": "src/nvim/help.c",
            "position": 1,
            "pull_request_review_id": 3585834871,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2625444532/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-17T03:16:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2625444532",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/34277#discussion_r2652376531"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/34277"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2652376531"
                }
            },
            "author_association": "MEMBER",
            "body": "https://github.com/neovim/neovim/pull/36870 was merged ",
            "commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "created_at": "2025-12-30T07:11:38Z",
            "diff_hunk": "@@ -624,6 +625,7 @@ add_custom_command(\n       ${LUA_FILETYPE_MODULE_SOURCE} \"vim.filetype\"\n       ${LUA_FS_MODULE_SOURCE} \"vim.fs\"\n       ${LUA_F_MODULE_SOURCE} \"vim.F\"\n+      ${LUA_HELPTAGS_MODULE_SOURCE} \"vim._helptags\"",
            "html_url": "https://github.com/neovim/neovim/pull/34277#discussion_r2652376531",
            "id": 2652376531,
            "in_reply_to_id": 2525639875,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6eGA3T",
            "original_commit_id": "8f3481f0d27ec8c6d001e4e810e5cfdf1b85c174",
            "original_line": 628,
            "original_position": 12,
            "original_start_line": null,
            "path": "src/nvim/CMakeLists.txt",
            "position": 1,
            "pull_request_review_id": 3617435728,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2652376531/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-30T07:11:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2652376531",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "I have added coroutines to make the process of generating the tags file non-blocking and faster. Translated help files are also supported now.\r\n\r\nBefore adding docs and tests I want to be able to call the lua code from core. How can I do this? Looking through the source I couldn't find an example of calls to (lua) runtime files.",
            "created_at": "2025-06-10T12:07:20Z",
            "html_url": "https://github.com/neovim/neovim/pull/34277#issuecomment-2958952029",
            "id": 2958952029,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/34277",
            "node_id": "IC_kwDOAPphoM6wXgZd",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2958952029/reactions"
            },
            "updated_at": "2025-06-10T12:07:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2958952029",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Look at `src/nvim/eval/funcs.c`, `has_wsl`.",
            "created_at": "2025-06-10T12:10:06Z",
            "html_url": "https://github.com/neovim/neovim/pull/34277#issuecomment-2958961595",
            "id": 2958961595,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/34277",
            "node_id": "IC_kwDOAPphoM6wXiu7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2958961595/reactions"
            },
            "updated_at": "2025-06-10T12:12:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2958961595",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2361214?v=4",
                "events_url": "https://api.github.com/users/clason/events{/privacy}",
                "followers_url": "https://api.github.com/users/clason/followers",
                "following_url": "https://api.github.com/users/clason/following{/other_user}",
                "gists_url": "https://api.github.com/users/clason/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/clason",
                "id": 2361214,
                "login": "clason",
                "node_id": "MDQ6VXNlcjIzNjEyMTQ=",
                "organizations_url": "https://api.github.com/users/clason/orgs",
                "received_events_url": "https://api.github.com/users/clason/received_events",
                "repos_url": "https://api.github.com/users/clason/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/clason/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/clason/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/clason",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thanks, I got it working by adding the module to `src/nvim/CMakelist.txt`, hope this is the right approach.\r\n\r\nI think this is ready for (a first round of) reviews!\r\n\r\nDisclosure: the TS approach is slower than the manual parsing that help.c performs. Generating the help tags file for the runtime directory takes about 2 seconds on my machine (prev. 0.5s). It's probably not an issue for end users, as the editor is not blocked. If there are any tips for increasing performance, I'm all ears. It would especially be perfect for parallelization, but afaik that's not easy from Lua/Nvim. Do let me know if I'm wrong.  ",
            "created_at": "2025-06-10T15:13:08Z",
            "html_url": "https://github.com/neovim/neovim/pull/34277#issuecomment-2959646524",
            "id": 2959646524,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/34277",
            "node_id": "IC_kwDOAPphoM6waJ88",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2959646524/reactions"
            },
            "updated_at": "2025-06-10T15:13:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2959646524",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/34277/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/34277/commits",
    "created_at": "2025-06-02T11:52:46Z",
    "diff_url": "https://github.com/neovim/neovim/pull/34277.diff",
    "draft": false,
    "head": {
        "label": "yochem:helptags-lua",
        "ref": "helptags-lua",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/yochem/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/yochem/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/yochem/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/yochem/neovim/branches{/branch}",
            "clone_url": "https://github.com/yochem/neovim.git",
            "collaborators_url": "https://api.github.com/repos/yochem/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/yochem/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/yochem/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/yochem/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/yochem/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/yochem/neovim/contributors",
            "created_at": "2023-03-13T14:39:08Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/yochem/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/yochem/neovim/downloads",
            "events_url": "https://api.github.com/repos/yochem/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/yochem/neovim/forks",
            "full_name": "yochem/neovim",
            "git_commits_url": "https://api.github.com/repos/yochem/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/yochem/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/yochem/neovim/git/tags{/sha}",
            "git_url": "git://github.com/yochem/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/yochem/neovim/hooks",
            "html_url": "https://github.com/yochem/neovim",
            "id": 613421928,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/yochem/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/yochem/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/yochem/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/yochem/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/yochem/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/yochem/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/yochem/neovim/merges",
            "milestones_url": "https://api.github.com/repos/yochem/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOJJATaA",
            "notifications_url": "https://api.github.com/repos/yochem/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
                "events_url": "https://api.github.com/users/yochem/events{/privacy}",
                "followers_url": "https://api.github.com/users/yochem/followers",
                "following_url": "https://api.github.com/users/yochem/following{/other_user}",
                "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/yochem",
                "id": 23235841,
                "login": "yochem",
                "node_id": "MDQ6VXNlcjIzMjM1ODQx",
                "organizations_url": "https://api.github.com/users/yochem/orgs",
                "received_events_url": "https://api.github.com/users/yochem/received_events",
                "repos_url": "https://api.github.com/users/yochem/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/yochem",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/yochem/neovim/pulls{/number}",
            "pushed_at": "2026-01-04T12:36:36Z",
            "releases_url": "https://api.github.com/repos/yochem/neovim/releases{/id}",
            "size": 365873,
            "ssh_url": "git@github.com:yochem/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/yochem/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/yochem/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/yochem/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/yochem/neovim/subscription",
            "svn_url": "https://github.com/yochem/neovim",
            "tags_url": "https://api.github.com/repos/yochem/neovim/tags",
            "teams_url": "https://api.github.com/repos/yochem/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/yochem/neovim/git/trees{/sha}",
            "updated_at": "2025-12-27T14:14:43Z",
            "url": "https://api.github.com/repos/yochem/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "b384bf3f766c4b3f3d37cb42880bd0c53b264d8d",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
            "events_url": "https://api.github.com/users/yochem/events{/privacy}",
            "followers_url": "https://api.github.com/users/yochem/followers",
            "following_url": "https://api.github.com/users/yochem/following{/other_user}",
            "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/yochem",
            "id": 23235841,
            "login": "yochem",
            "node_id": "MDQ6VXNlcjIzMjM1ODQx",
            "organizations_url": "https://api.github.com/users/yochem/orgs",
            "received_events_url": "https://api.github.com/users/yochem/received_events",
            "repos_url": "https://api.github.com/users/yochem/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/yochem",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/34277",
    "id": 2560368921,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/34277",
    "labels": [],
    "locked": false,
    "merge_commit_sha": null,
    "merged_at": null,
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6YnCEZ",
    "number": 34277,
    "patch_url": "https://github.com/neovim/neovim/pull/34277.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/34277/comments",
    "state": "open",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/b384bf3f766c4b3f3d37cb42880bd0c53b264d8d",
    "title": "feat(help):  `:helptags` in Lua (+Treesitter)",
    "updated_at": "2025-12-30T07:11:38Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/34277",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/23235841?v=4",
        "events_url": "https://api.github.com/users/yochem/events{/privacy}",
        "followers_url": "https://api.github.com/users/yochem/followers",
        "following_url": "https://api.github.com/users/yochem/following{/other_user}",
        "gists_url": "https://api.github.com/users/yochem/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/yochem",
        "id": 23235841,
        "login": "yochem",
        "node_id": "MDQ6VXNlcjIzMjM1ODQx",
        "organizations_url": "https://api.github.com/users/yochem/orgs",
        "received_events_url": "https://api.github.com/users/yochem/received_events",
        "repos_url": "https://api.github.com/users/yochem/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/yochem/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/yochem/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/yochem",
        "user_view_type": "public"
    }
}
{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/31837/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/31837/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/31837"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/31837"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/31837/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/f29856d0344435347a5032a5a1fda3dcb5618c1b"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 6037,
            "forks_count": 6037,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 1913,
            "open_issues_count": 1913,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-04-21T23:49:28Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 318183,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 88840,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-04-22T02:39:42Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 88840,
            "watchers_count": 88840,
            "web_commit_signoff_required": false
        },
        "sha": "c58c650adf443f126c575ca7c60400c2ac15d255",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "### Problem\r\nThe UI multigrid protocol does not include enough information to render the UI like the TUI. Both the rendering order and position information are missing.  Furthermore, the lack of position information breaks basic functionality like `screenchar(), screenstring() and getmousepos()`, so many plugins are broken. Especially, the lack of mouse support is quite embarrassing for a GUI and have bothered the Neovide maintainers for a long time.\r\n\r\n### Solution\r\nPartially run the compositor, and include the compositor information in the protocol, `compindex`, `abs_row`, and `abs_col` are included. You can also pass grid 0 to `nvim_input_mouse`, to let nvim determine the grid. \r\n\r\nThe usage of this information is optional, and UIs are still allowed to position the floating windows as they like. But in that case, they still have to pass the grid id to `nvim_input_mouse`, and of course `getmousepos()` and similar does not work in that case.\r\n\r\n**NOTE:** This includes the following, which need to be merged first, so only the last commit in this PR is relevant for reviewing\r\n* https://github.com/neovim/neovim/pull/32440\r\n* https://github.com/neovim/neovim/pull/32470\r\n\r\nThis fixes the following issues\r\n* fixes https://github.com/neovim/neovim/issues/30586\r\n* fixes https://github.com/neovim/neovim/issues/30581\r\n* fixes https://github.com/neovim/neovim/issues/24801\r\n\r\n**The information below is not relevant anymore**: The testing functionality and actual fixes for `screenchar` and `getmousepos` have been removed from this PR, and will be added in follow up PR\r\n\r\n\r\nIn order to be able to test this, a new test variable `NVIM_TEST_FORCE_MULTIGRID` has been added. This forces `nvim` to run with multigrid enabled, but the code in `screen.lua` emulates the non-multigrid mode, so that almost the whole test suite can be run. Note that this is a manual option for now, but I suppose it could be added to the CI at some point. The whole test suite passes with `NVIM_TEST_FORCE_MULTIGRID=1`, but some tests are disabled due to the following known bugs: #24802, #31811,  #24705. Additionally, there's an unreported bug that the multgrid UI fails to resize when a message is showing.\r\n\r\nAnd some minor behaviour differences have been dealt with using conditionals. For example, in multigrid the cursor moves when the window is moved, while it stays in place in the TUI. And the TUI clears the command-line when it's resized in one of the tests, which to me looks like a bug.\r\n\r\nSome additional test framework fixes were also done:\r\n* make testing of ext_cmdline optional\r\n* reset of cmdline abort state only when the expectation has finished\r\n\r\n\r\nThese changes also lay the foundation for running both multigrid and non-multigrid at the same time, or even to deprecate everything else than multigrid in the future. I'm not sure what's missing, I have not tested, but to me it looks very close. Almost all the multigrid specific code is now a simple `if ui_has(kUIMultigrid)` rather than `if/else`. One difference is `ext_cmdline`, which reports different grid ids and offsets depending on if multigrid is enabled or not. I did not want to fix that, since it's a breaking change.\r\n\r\nThis has been tested on the Neovide side here: https://github.com/neovide/neovide/pull/2919\r\n\r\nOther attempts to partially fix some of these issuses\r\n* https://github.com/neovim/neovim/pull/31788\r\n* https://github.com/neovim/neovim/pull/29316",
    "closed_at": "2025-04-15T09:56:39Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1901976299"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1901976299"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Couldn't the anchor position be updated when the anchor moves, instead of providing screen col/row? Isn't that the same thing?",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T16:51:15Z",
            "diff_hunk": "@@ -610,12 +610,31 @@ tabs.\n \tsize). If the window was previously hidden, it should now be shown\n \tagain.\n \n-[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex] ~\n-\tDisplay or reconfigure floating window `win`. The window should be\n-\tdisplayed above another grid `anchor_grid` at the specified position\n-\t`anchor_row` and `anchor_col`. For the meaning of `anchor` and more details\n-\tof positioning, see |nvim_open_win()|. `mouse_enabled` is true if the\n-\twindow can receive mouse events.\n+[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex, compindex, screen_row, screen_col] ~\n+\tDisplay or reconfigure floating window `win`.\n+\n+\tThere are two alternative ways of positioning the window\n+\t  -  Manually - The window should be displayed above another grid\n+\t     `anchor_grid` at the specified position `anchor_row` and\n+\t     `anchor_col`. For the meaning of `anchor` and more details of\n+\t     positioning, see |nvim_open_win()|. NOTE: you have to manually\n+\t     ensure that the window fits the screen, possibly by further\n+\t     reposition it. Ignore `screen_row` and `screen_col` in this case.\n+\t  - Let nvim take care of the positioning - You can ignore `anchor`",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1901976299",
            "id": 1901976299,
            "line": 622,
            "node_id": "PRRC_kwDOAPphoM5xXdrr",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 622,
            "original_position": 20,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 20,
            "pull_request_review_id": 2529404547,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1901976299/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T17:32:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1901976299",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4594126?v=4",
                "events_url": "https://api.github.com/users/vhakulinen/events{/privacy}",
                "followers_url": "https://api.github.com/users/vhakulinen/followers",
                "following_url": "https://api.github.com/users/vhakulinen/following{/other_user}",
                "gists_url": "https://api.github.com/users/vhakulinen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/vhakulinen",
                "id": 4594126,
                "login": "vhakulinen",
                "node_id": "MDQ6VXNlcjQ1OTQxMjY=",
                "organizations_url": "https://api.github.com/users/vhakulinen/orgs",
                "received_events_url": "https://api.github.com/users/vhakulinen/received_events",
                "repos_url": "https://api.github.com/users/vhakulinen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/vhakulinen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vhakulinen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/vhakulinen",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1901977611"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1901977611"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "`nvim_open_win` documents the zindex for msg win and some other elements to be static:\r\n\r\n```\r\n                   • zindex: Stacking order. floats with higher `zindex` go on\r\n                    top on floats with lower indices. Must be larger than\r\n                    zero. The following screen elements have hard-coded\r\n                    z-indices:\r\n                    • 100: insert completion popupmenu\r\n                    • 200: message scrollback\r\n                    • 250: cmdline completion popupmenu (when\r\n                      wildoptions+=pum) The default value for floats are 50.\r\n                      In general, values below 100 are recommended, unless\r\n                      there is a good reason to overshadow builtin elements.\r\n```\r\n\r\nCould the zindex be omitted?",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T16:52:52Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1901977611",
            "id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xXeAL",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529404547,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1901977611/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T17:32:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1901977611",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4594126?v=4",
                "events_url": "https://api.github.com/users/vhakulinen/events{/privacy}",
                "followers_url": "https://api.github.com/users/vhakulinen/followers",
                "following_url": "https://api.github.com/users/vhakulinen/following{/other_user}",
                "gists_url": "https://api.github.com/users/vhakulinen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/vhakulinen",
                "id": 4594126,
                "login": "vhakulinen",
                "node_id": "MDQ6VXNlcjQ1OTQxMjY=",
                "organizations_url": "https://api.github.com/users/vhakulinen/orgs",
                "received_events_url": "https://api.github.com/users/vhakulinen/received_events",
                "repos_url": "https://api.github.com/users/vhakulinen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/vhakulinen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vhakulinen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/vhakulinen",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902020713"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902020713"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Not exactly, the anchor always represents the position that the user requested in `nvim_open_win`, while the absolute position can be offset from that. That's normally done by nvim, when the window would go out of the screen. \r\n\r\nSome UIs, might want to use the anchor exactly, while others don't. One example where they let it overflow is https://github.com/akiyosi/goneovim, if you look at the frontpage.\r\n\r\nIn Neovide, we don't want that, and before these changes, we copied the behaviour and implemented it here https://github.com/neovide/neovide/pull/2029. But it's still not perfect, see this comment for example https://github.com/neovide/neovide/issues/2502#issuecomment-2083173795\r\n\r\n",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T17:45:08Z",
            "diff_hunk": "@@ -610,12 +610,31 @@ tabs.\n \tsize). If the window was previously hidden, it should now be shown\n \tagain.\n \n-[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex] ~\n-\tDisplay or reconfigure floating window `win`. The window should be\n-\tdisplayed above another grid `anchor_grid` at the specified position\n-\t`anchor_row` and `anchor_col`. For the meaning of `anchor` and more details\n-\tof positioning, see |nvim_open_win()|. `mouse_enabled` is true if the\n-\twindow can receive mouse events.\n+[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex, compindex, screen_row, screen_col] ~\n+\tDisplay or reconfigure floating window `win`.\n+\n+\tThere are two alternative ways of positioning the window\n+\t  -  Manually - The window should be displayed above another grid\n+\t     `anchor_grid` at the specified position `anchor_row` and\n+\t     `anchor_col`. For the meaning of `anchor` and more details of\n+\t     positioning, see |nvim_open_win()|. NOTE: you have to manually\n+\t     ensure that the window fits the screen, possibly by further\n+\t     reposition it. Ignore `screen_row` and `screen_col` in this case.\n+\t  - Let nvim take care of the positioning - You can ignore `anchor`",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902020713",
            "id": 1902020713,
            "in_reply_to_id": 1901976299,
            "line": 622,
            "node_id": "PRRC_kwDOAPphoM5xXohp",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 622,
            "original_position": 20,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 20,
            "pull_request_review_id": 2529478363,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902020713/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T17:45:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902020713",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902029262"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902029262"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Both are important for Neovide, we use the z-index to group the windows into something that resembles a single layer, the telescope UI is a great example of that. The `compindex` on the other hand defines the actual order of windows with the same z-index.\r\n\r\nThis was done https://github.com/neovide/neovide/pull/2612, follow he links from here to see what the issues where.\r\n\r\nYou can ignore the z-index, and just use `compindex` if you don't need special handling like that. In that case, you can perfectly emulate the terminal by first rendering the main grid, then all floating windows in `compindex` order. But let each cell overwrite any other floating window cells at the same location. Then finally do a blending pass between the floating windows and the main grid.\r\n\r\nJust using the z-index could cause of all kinds of issues, with windows being behind each other, when they should not. One example is this https://github.com/neovide/neovide/issues/2624, ",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T17:56:21Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902029262",
            "id": 1902029262,
            "in_reply_to_id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xXqnO",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529492131,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902029262/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T17:56:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902029262",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902038837"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902038837"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "> Not exactly, the anchor always represents the position that the user requested in nvim_open_win, while the absolute position can be offset from that. That's normally done by nvim, when the window would go out of the screen.\r\n\r\nDoes the anchor position reported to GUIs have to be the position that was requested? Floating windows overflowing is another topic, but feature parity between GUIs and the TUI should probably exist.\r\n\r\n> One example where they let it overflow is https://github.com/akiyosi/goneovim, if you look at the frontpage.\r\n\r\nIsn't that the external window, not a floating window that overflows?",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T18:05:17Z",
            "diff_hunk": "@@ -610,12 +610,31 @@ tabs.\n \tsize). If the window was previously hidden, it should now be shown\n \tagain.\n \n-[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex] ~\n-\tDisplay or reconfigure floating window `win`. The window should be\n-\tdisplayed above another grid `anchor_grid` at the specified position\n-\t`anchor_row` and `anchor_col`. For the meaning of `anchor` and more details\n-\tof positioning, see |nvim_open_win()|. `mouse_enabled` is true if the\n-\twindow can receive mouse events.\n+[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex, compindex, screen_row, screen_col] ~\n+\tDisplay or reconfigure floating window `win`.\n+\n+\tThere are two alternative ways of positioning the window\n+\t  -  Manually - The window should be displayed above another grid\n+\t     `anchor_grid` at the specified position `anchor_row` and\n+\t     `anchor_col`. For the meaning of `anchor` and more details of\n+\t     positioning, see |nvim_open_win()|. NOTE: you have to manually\n+\t     ensure that the window fits the screen, possibly by further\n+\t     reposition it. Ignore `screen_row` and `screen_col` in this case.\n+\t  - Let nvim take care of the positioning - You can ignore `anchor`",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902038837",
            "id": 1902038837,
            "in_reply_to_id": 1901976299,
            "line": 622,
            "node_id": "PRRC_kwDOAPphoM5xXs81",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 622,
            "original_position": 20,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 20,
            "pull_request_review_id": 2529508320,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902038837/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T18:05:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902038837",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4594126?v=4",
                "events_url": "https://api.github.com/users/vhakulinen/events{/privacy}",
                "followers_url": "https://api.github.com/users/vhakulinen/followers",
                "following_url": "https://api.github.com/users/vhakulinen/following{/other_user}",
                "gists_url": "https://api.github.com/users/vhakulinen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/vhakulinen",
                "id": 4594126,
                "login": "vhakulinen",
                "node_id": "MDQ6VXNlcjQ1OTQxMjY=",
                "organizations_url": "https://api.github.com/users/vhakulinen/orgs",
                "received_events_url": "https://api.github.com/users/vhakulinen/received_events",
                "repos_url": "https://api.github.com/users/vhakulinen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/vhakulinen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vhakulinen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/vhakulinen",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902047152"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902047152"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "But the zindex is static. I've hard coded zindex for msg window and popupmenu in gnvim based on the `nvim_open_win` docs.\r\n\r\ngnvim just renders the windows on top of each other after sorting by zindex. Not sure what there is to achieve by composing them into single layer. Some uniform shadows I assume?\r\n\r\nFrom the linked issue:\r\n> nvim-tree displays a window containing a file selector; when configured to be floating and offset from the upper left corner: typing g? displays another \"help\" window listing nvim-tree's keymaps. Prior to Neovim 0.10.0, this help window appeared alone. Since 0.10.0 the help window appears behind the file selector window and is thus unusable. See context below for conditions.\r\n\r\nAren't floating windows from a single plugin with conflicting z index a bug of the plugin? Fixing that in a GUI doesn't sound right.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T18:16:37Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902047152",
            "id": 1902047152,
            "in_reply_to_id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xXu-w",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529521772,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902047152/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T18:16:38Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902047152",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4594126?v=4",
                "events_url": "https://api.github.com/users/vhakulinen/events{/privacy}",
                "followers_url": "https://api.github.com/users/vhakulinen/followers",
                "following_url": "https://api.github.com/users/vhakulinen/following{/other_user}",
                "gists_url": "https://api.github.com/users/vhakulinen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/vhakulinen",
                "id": 4594126,
                "login": "vhakulinen",
                "node_id": "MDQ6VXNlcjQ1OTQxMjY=",
                "organizations_url": "https://api.github.com/users/vhakulinen/orgs",
                "received_events_url": "https://api.github.com/users/vhakulinen/received_events",
                "repos_url": "https://api.github.com/users/vhakulinen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/vhakulinen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vhakulinen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/vhakulinen",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902048924"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902048924"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "> Does the anchor position reported to GUIs have to be the position that was requested? Floating windows overflowing is another topic, but feature parity between GUIs and the TUI should probably exist.\r\n\r\nIt probably does, or it's a breaking change. It would require negative anchors to deal with situations like these https://github.com/neovide/neovide/issues/1641 (that case is just barely enough to fit in the window, but one column to the left and it would overflow. Also, if the UI render those with a smaller font, then it probably don't need to move.\r\n\r\n> Isn't that the external window, not a floating window that overflows?\r\n\r\nIt could be, but the UI protocol allows the same thing with for floating windows. ",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T18:19:03Z",
            "diff_hunk": "@@ -610,12 +610,31 @@ tabs.\n \tsize). If the window was previously hidden, it should now be shown\n \tagain.\n \n-[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex] ~\n-\tDisplay or reconfigure floating window `win`. The window should be\n-\tdisplayed above another grid `anchor_grid` at the specified position\n-\t`anchor_row` and `anchor_col`. For the meaning of `anchor` and more details\n-\tof positioning, see |nvim_open_win()|. `mouse_enabled` is true if the\n-\twindow can receive mouse events.\n+[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex, compindex, screen_row, screen_col] ~\n+\tDisplay or reconfigure floating window `win`.\n+\n+\tThere are two alternative ways of positioning the window\n+\t  -  Manually - The window should be displayed above another grid\n+\t     `anchor_grid` at the specified position `anchor_row` and\n+\t     `anchor_col`. For the meaning of `anchor` and more details of\n+\t     positioning, see |nvim_open_win()|. NOTE: you have to manually\n+\t     ensure that the window fits the screen, possibly by further\n+\t     reposition it. Ignore `screen_row` and `screen_col` in this case.\n+\t  - Let nvim take care of the positioning - You can ignore `anchor`",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902048924",
            "id": 1902048924,
            "in_reply_to_id": 1901976299,
            "line": 622,
            "node_id": "PRRC_kwDOAPphoM5xXvac",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 622,
            "original_position": 20,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 20,
            "pull_request_review_id": 2529524424,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902048924/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T18:19:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902048924",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902059367"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902059367"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Ah you mean for this specific call, for the messages, yes it's static, but it could change and new types could be added, so I don't see any reason not to provide it. And it's also possible to read it wrong, like I apparently have done https://github.com/neovide/neovide/pull/2919/files#diff-bc5a2092e5f015050e56c3182e33339f6dd6e456dc07e8a4dd7db8c10ab85980R489\r\n\r\n> gnvim just renders the windows on top of each other after sorting by zindex. Not sure what there is to achieve by composing them into single layer. Some uniform shadows I assume?\r\n\r\nYes, correct blending, including shadows, the prime example is here \r\n![image](https://github.com/user-attachments/assets/d5f0005c-9811-47e7-84cc-9b7819cceb9b)\r\nvs\r\n![image](https://github.com/user-attachments/assets/815b3d9a-e2e5-49f3-bea4-18be19d26bf2)\r\n\r\nWe requested mui to change the rendering to be done int the same way as many other plugins like telescope here https://github.com/MunifTanjim/nui.nvim/issues/372\r\n\r\nWithout this special case, we need many more highlight attributes, and a wide adaptation of it in the whole plugin echo system. Using an existing convention, just made more sense in our opinion since most plugin authors care about the TUI only.\r\n\r\n> Aren't floating windows from a single plugin with conflicting z index a bug of the plugin? Fixing that in a GUI doesn't sound right.\r\n\r\nPerhaps, in that case, but all those bugs are reported to us because the author only test the TUI, so it's much better to be consistent.\r\n",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T18:33:40Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902059367",
            "id": 1902059367,
            "in_reply_to_id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xXx9n",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529541379,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902059367/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T18:33:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902059367",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902067927"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902067927"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "> It could be, but the UI protocol allows the same thing with for floating windows.\r\n\r\nThe source of that:\r\n> https://github.com/neovim/neovim/issues/24801#issuecomment-1718455002\r\n\r\nWhich means that everyone that *don't* want that have to handle their own positions currently.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T18:45:52Z",
            "diff_hunk": "@@ -610,12 +610,31 @@ tabs.\n \tsize). If the window was previously hidden, it should now be shown\n \tagain.\n \n-[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex] ~\n-\tDisplay or reconfigure floating window `win`. The window should be\n-\tdisplayed above another grid `anchor_grid` at the specified position\n-\t`anchor_row` and `anchor_col`. For the meaning of `anchor` and more details\n-\tof positioning, see |nvim_open_win()|. `mouse_enabled` is true if the\n-\twindow can receive mouse events.\n+[\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex, compindex, screen_row, screen_col] ~\n+\tDisplay or reconfigure floating window `win`.\n+\n+\tThere are two alternative ways of positioning the window\n+\t  -  Manually - The window should be displayed above another grid\n+\t     `anchor_grid` at the specified position `anchor_row` and\n+\t     `anchor_col`. For the meaning of `anchor` and more details of\n+\t     positioning, see |nvim_open_win()|. NOTE: you have to manually\n+\t     ensure that the window fits the screen, possibly by further\n+\t     reposition it. Ignore `screen_row` and `screen_col` in this case.\n+\t  - Let nvim take care of the positioning - You can ignore `anchor`",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902067927",
            "id": 1902067927,
            "in_reply_to_id": 1901976299,
            "line": 622,
            "node_id": "PRRC_kwDOAPphoM5xX0DX",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 622,
            "original_position": 20,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 20,
            "pull_request_review_id": 2529555534,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902067927/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T18:45:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902067927",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902071567"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902071567"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Shadows based on zindex would still be quite implicit feature. I think it (shadows) should be a window property. Are there other features that _require_ compindex at the moment to function correctly?\r\n\r\n> Perhaps, in that case, but all those bugs are reported to us because the author only test the TUI, so it's much better to be consistent.\r\n\r\nI can imagine that similar thing happens to the neovim project too...",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T18:51:06Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902071567",
            "id": 1902071567,
            "in_reply_to_id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xX08P",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529561423,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902071567/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T18:51:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902071567",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4594126?v=4",
                "events_url": "https://api.github.com/users/vhakulinen/events{/privacy}",
                "followers_url": "https://api.github.com/users/vhakulinen/followers",
                "following_url": "https://api.github.com/users/vhakulinen/following{/other_user}",
                "gists_url": "https://api.github.com/users/vhakulinen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/vhakulinen",
                "id": 4594126,
                "login": "vhakulinen",
                "node_id": "MDQ6VXNlcjQ1OTQxMjY=",
                "organizations_url": "https://api.github.com/users/vhakulinen/orgs",
                "received_events_url": "https://api.github.com/users/vhakulinen/received_events",
                "repos_url": "https://api.github.com/users/vhakulinen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/vhakulinen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/vhakulinen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/vhakulinen",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902086007"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902086007"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "> Are there other features that require compindex at the moment to function correctly?\r\n\r\nWell, assuming that for example telescope fixes their UI (which they didn't for one and a half year https://github.com/nvim-telescope/telescope.nvim/issues/2603), to compose it of elements without any overlap, then perhaps not. It also makes things complex, for example the Noice command line above currently consists of two floats with the same z-index. Doing it \"correctly\", would require 5 (and this is a really simple example). Also, if you compose the window like that, things like mouse input also gets much harder. You could argue that they could use standard Neovim borders, but the UI also have some special borders, so that's not an option. \r\n\r\nBut the issue is really that Neovide, don't have any sort of power to set new standards across the plugin ecosystem. And, so far, we have got very little help from the Neovim core team to slowly move towards that goal, thus pushing for this, which at least makes things work properly in short term. \r\n\r\nWe also don't want to set our own standards, which require Neovide compatible plugins, or even special cases for Neovide. At least not for standard plugins.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T19:11:10Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902086007",
            "id": 1902086007,
            "in_reply_to_id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xX4d3",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529585713,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902086007/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T19:11:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902086007",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902109046"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902109046"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "> Are there other features that require compindex at the moment to function correctly?\r\n\r\nContinuing on this.\r\nThe `screenstring()` and similar need to be completely removed and replaced by some alternative if needed. And that UIs always have to provide the mouse coordinates like before and `getmousepos` is removed and replaced by something that only returns window coordinates. But then, what about other elements that don't have neovim assigned window? Or perhaps, make a breaking change, and require the UIs to provide an absolute coordinate in addition to relative ones for `nvim_input_mouse`\r\n\r\nWithout `compindex` the above functions would just behave randomly, dependent on what order Neovim internally use for the windows, and what the UI use.\r\n\r\nBTW, one use case of `screenstring` I can think of, is to be able to select anything, people often complain about that they can't select stuff from the command line with the mouse for example. An UI could implement it without, although it is quite tricky. But with `screenstring`  it could be implemented even for the TUI by a plugin.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T19:43:31Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902109046",
            "id": 1902109046,
            "in_reply_to_id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xX-F2",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529623884,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902109046/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T19:43:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902109046",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1902233310"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902233310"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "BTW, support for windows with the same z-index seems to be something that was deliberately added in the very first implementation of floats, here https://github.com/neovim/neovim/pull/6619. \r\n\r\nThis piece of code makes sure that any window, that the cursor moves to, stays on top of others. And, yes in Neovide we try to mimic that, otherwise some windows that should be visible will be hidden. https://github.com/neovim/neovim/blob/a09c7a5d57ba2aca58fbc00e0b04a1437555a3c0/src/nvim/ui_compositor.c#L281-L293",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-01-03T23:24:55Z",
            "diff_hunk": "@@ -628,7 +647,7 @@ tabs.\n [\"win_close\", grid] ~\n \tClose the window.\n \n-[\"msg_set_pos\", grid, row, scrolled, sep_char] ~\n+[\"msg_set_pos\", grid, row, scrolled, sep_char, zindex, compindex] ~",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1902233310",
            "id": 1902233310,
            "in_reply_to_id": 1901977611,
            "line": 649,
            "node_id": "PRRC_kwDOAPphoM5xYcbe",
            "original_commit_id": "295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46",
            "original_line": 649,
            "original_position": 43,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 43,
            "pull_request_review_id": 2529823046,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902233310/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-01-03T23:24:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1902233310",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1957320606"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1957320606"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "There's no space to display the popup menu below, so this behaviour change makes sense",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-02-16T12:58:15Z",
            "diff_hunk": "@@ -693,7 +693,7 @@ describe('ext_multigrid', function()\n         {24: foo}|\n         {21: bar}|\n       ]], float_pos={\n-        [4] = {-1, \"NW\", 2, 15, 55, false, 100};\n+        [4] = {-1, \"SW\", 2, 14, 49, false, 100, 1, 12, 49};",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1957320606",
            "id": 1957320606,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50qlee",
            "original_commit_id": "d004d5bf7866999bb49d1a2830941f8a4a480faa",
            "original_line": 696,
            "original_position": 14,
            "original_start_line": null,
            "path": "test/functional/ui/multigrid_spec.lua",
            "position": null,
            "pull_request_review_id": 2619621956,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1957320606/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-16T12:58:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1957320606",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r1957320640"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1957320640"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "There's no space to display the popup menu below, so this behaviour change makes sense",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-02-16T12:58:32Z",
            "diff_hunk": "@@ -715,7 +715,7 @@ describe('ext_multigrid', function()\n         {24:            oof}|\n         {21:            rab}|\n       ]], float_pos={\n-        [4] = {-1, \"NW\", 2, 16, 45, false, 100};\n+        [4] = {-1, \"SW\", 2, 15, 45, false, 100, 1, 13, 45};",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r1957320640",
            "id": 1957320640,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50qlfA",
            "original_commit_id": "d004d5bf7866999bb49d1a2830941f8a4a480faa",
            "original_line": 718,
            "original_position": 23,
            "original_start_line": null,
            "path": "test/functional/ui/multigrid_spec.lua",
            "position": null,
            "pull_request_review_id": 2619621956,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1957320640/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-16T12:58:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1957320640",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2022454278"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022454278"
                }
            },
            "author_association": "MEMBER",
            "body": "to avoid confusion could mention that zindex is hardcoded to be `200` but included for completeness, or something.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-01T09:02:17Z",
            "diff_hunk": "@@ -638,6 +657,8 @@ tabs.\n \tWhen |ui-messages| is active, no message grid is used, and this event\n \twill not be sent.\n \n+\t`zindex` and `compindex` have the same meaning as for `win_float_pos`.",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2022454278",
            "id": 2022454278,
            "line": 660,
            "node_id": "PRRC_kwDOAPphoM54jDQG",
            "original_commit_id": "49ea1761066c64c588d16f8ba2d5a8dc9dc36ab6",
            "original_line": 660,
            "original_position": 51,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 51,
            "pull_request_review_id": 2732008938,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022454278/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-01T09:02:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022454278",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2022477201"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022477201"
                }
            },
            "author_association": "MEMBER",
            "body": "hmm, it is a bit unfortunate if we need to update every single grid anytime a window is recomposed. In principle, the `comp_index` field is only strictly needed when an ui reconnects or we need to recompose the entire screen or something. \r\n\r\nWhile if a grid is simply has its `comp_index` changed incrementally, the UI should be able to adjust the index of the others. Like of if the existing indicies are `0`, `1` and `2` and if a grid is raised from `0` to `2`, it is obvious the others are being pushed down a notch (in many languages this would be a builtin vector/arraylist/whatever operation)",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-01T09:16:23Z",
            "diff_hunk": "@@ -7456,18 +7464,25 @@ void win_get_tabwin(handle_T id, int *tabnr, int *winnr)\n void win_ui_flush(bool validate)\n {\n   FOR_ALL_TAB_WINDOWS(tp, wp) {\n-    if (wp->w_pos_changed && wp->w_grid_alloc.chars != NULL) {\n+    if ((wp->w_pos_changed || wp->w_grid_alloc.composition_updated)\n+        && wp->w_grid_alloc.chars != NULL) {\n       if (tp == curtab) {\n         ui_ext_win_position(wp, validate);\n       } else {\n         ui_call_win_hide(wp->w_grid_alloc.handle);\n         wp->w_pos_changed = false;\n       }\n+      wp->w_grid_alloc.composition_updated = false;\n     }\n     if (tp == curtab) {\n       ui_ext_win_viewport(wp);\n     }\n   }\n+  // The popupmenu could also have moved or changed its comp_index\n+  pum_ui_flush();\n+\n+  // And the message\n+  msg_ui_flush();",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2022477201",
            "id": 2022477201,
            "line": 7485,
            "node_id": "PRRC_kwDOAPphoM54jI2R",
            "original_commit_id": "49ea1761066c64c588d16f8ba2d5a8dc9dc36ab6",
            "original_line": 7485,
            "original_position": 135,
            "original_start_line": null,
            "path": "src/nvim/window.c",
            "position": 135,
            "pull_request_review_id": 2732047929,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022477201/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-01T09:16:44Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022477201",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2022509695"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022509695"
                }
            },
            "author_association": "MEMBER",
            "body": "Could we remove those behavioural changes from _this_ PR? It seems PR is already mostly reduced to only the \"provide more info\" part, and if we get it fully down to only that without changing behavior for other multigrid UI:s, it is something we could get merged ASAP and then consider other this PR:s (which potential behavior changes) on top of this. ",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-01T09:36:23Z",
            "diff_hunk": "@@ -693,7 +693,7 @@ describe('ext_multigrid', function()\n         {24: foo}|\n         {21: bar}|\n       ]], float_pos={\n-        [4] = {-1, \"NW\", 2, 15, 55, false, 100};\n+        [4] = {-1, \"SW\", 2, 14, 49, false, 100, 1, 12, 49};",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2022509695",
            "id": 2022509695,
            "in_reply_to_id": 1957320606,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM54jQx_",
            "original_commit_id": "d004d5bf7866999bb49d1a2830941f8a4a480faa",
            "original_line": 696,
            "original_position": 14,
            "original_start_line": null,
            "path": "test/functional/ui/multigrid_spec.lua",
            "position": null,
            "pull_request_review_id": 2732101670,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022509695/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-01T09:36:23Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2022509695",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2023528668"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2023528668"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "It's not as bad as it seems. The `pum_ui_flush` and `msg_ui_flush` has internal guards, so they only update when the composition index has actually changed. And they only call the `ui_call_win_float_pos` and `ui_ext_msg_set_pos` respectively, so at least on the Neovim side it's cheap. On the UI side it depends, but if it's expensive, the UI could optimize to not do repositioning if only the composition index changes and vice versa, it should be quite easy to compare against the old value.\r\n\r\nIt's also quite rare to see multiple floating windows stacked on each other, especially where the order changes frequently. Also, in most cases when you open a window it will be on the top, and only that window will need to be updated, since no windows are above it in the stack.\r\n\r\nAt a first glance your suggestion seems very tricky to get right if multiple windows are updated at the same time, or when there's a mix of additions, removals and `comp_index` changes. A total ordering of the events is needed. So, a set of new events that are sent by the compositor on each real update is probably much more doable. It would just have the grid id and the `comp_index`. The cost of this approach is a new event type, and a lot of tests that needs to be updated, unless we still make it part of the window position field for testing purposes. On connection, it would just send all existing grids in order.\r\n\r\nFor Neovide, this approach would be more inconvenient, but not a dealbreaker. We store the grids in a hash table and sort them when they are about to render, so we don't have a persistent sorted array anywhere.\r\n\r\nDo you think it's worth it, and should we add the new event type instead?",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-01T19:04:36Z",
            "diff_hunk": "@@ -7456,18 +7464,25 @@ void win_get_tabwin(handle_T id, int *tabnr, int *winnr)\n void win_ui_flush(bool validate)\n {\n   FOR_ALL_TAB_WINDOWS(tp, wp) {\n-    if (wp->w_pos_changed && wp->w_grid_alloc.chars != NULL) {\n+    if ((wp->w_pos_changed || wp->w_grid_alloc.composition_updated)\n+        && wp->w_grid_alloc.chars != NULL) {\n       if (tp == curtab) {\n         ui_ext_win_position(wp, validate);\n       } else {\n         ui_call_win_hide(wp->w_grid_alloc.handle);\n         wp->w_pos_changed = false;\n       }\n+      wp->w_grid_alloc.composition_updated = false;\n     }\n     if (tp == curtab) {\n       ui_ext_win_viewport(wp);\n     }\n   }\n+  // The popupmenu could also have moved or changed its comp_index\n+  pum_ui_flush();\n+\n+  // And the message\n+  msg_ui_flush();",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2023528668",
            "id": 2023528668,
            "in_reply_to_id": 2022477201,
            "line": 7485,
            "node_id": "PRRC_kwDOAPphoM54nJjc",
            "original_commit_id": "49ea1761066c64c588d16f8ba2d5a8dc9dc36ab6",
            "original_line": 7485,
            "original_position": 135,
            "original_start_line": null,
            "path": "src/nvim/window.c",
            "position": 135,
            "pull_request_review_id": 2733800535,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2023528668/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-01T19:04:36Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2023528668",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2023529576"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2023529576"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Yes, I will add that when I make the other changes.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-01T19:05:23Z",
            "diff_hunk": "@@ -638,6 +657,8 @@ tabs.\n \tWhen |ui-messages| is active, no message grid is used, and this event\n \twill not be sent.\n \n+\t`zindex` and `compindex` have the same meaning as for `win_float_pos`.",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2023529576",
            "id": 2023529576,
            "in_reply_to_id": 2022454278,
            "line": 660,
            "node_id": "PRRC_kwDOAPphoM54nJxo",
            "original_commit_id": "49ea1761066c64c588d16f8ba2d5a8dc9dc36ab6",
            "original_line": 660,
            "original_position": 51,
            "original_start_line": null,
            "path": "runtime/doc/ui.txt",
            "position": 51,
            "pull_request_review_id": 2733802106,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2023529576/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-01T19:05:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2023529576",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2026320492"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2026320492"
                }
            },
            "author_association": "MEMBER",
            "body": "> It's not as bad as it seems. The pum_ui_flush and msg_ui_flush has internal guards, so they only update when the composition index has actually changed.\r\n\r\nOk it is probably fine then.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-03T06:51:34Z",
            "diff_hunk": "@@ -7456,18 +7464,25 @@ void win_get_tabwin(handle_T id, int *tabnr, int *winnr)\n void win_ui_flush(bool validate)\n {\n   FOR_ALL_TAB_WINDOWS(tp, wp) {\n-    if (wp->w_pos_changed && wp->w_grid_alloc.chars != NULL) {\n+    if ((wp->w_pos_changed || wp->w_grid_alloc.composition_updated)\n+        && wp->w_grid_alloc.chars != NULL) {\n       if (tp == curtab) {\n         ui_ext_win_position(wp, validate);\n       } else {\n         ui_call_win_hide(wp->w_grid_alloc.handle);\n         wp->w_pos_changed = false;\n       }\n+      wp->w_grid_alloc.composition_updated = false;\n     }\n     if (tp == curtab) {\n       ui_ext_win_viewport(wp);\n     }\n   }\n+  // The popupmenu could also have moved or changed its comp_index\n+  pum_ui_flush();\n+\n+  // And the message\n+  msg_ui_flush();",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2026320492",
            "id": 2026320492,
            "in_reply_to_id": 2022477201,
            "line": 7485,
            "node_id": "PRRC_kwDOAPphoM54xzJs",
            "original_commit_id": "49ea1761066c64c588d16f8ba2d5a8dc9dc36ab6",
            "original_line": 7485,
            "original_position": 135,
            "original_start_line": null,
            "path": "src/nvim/window.c",
            "position": 135,
            "pull_request_review_id": 2738706009,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2026320492/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-03T06:51:34Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2026320492",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2029427345"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029427345"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Sorry, I didn't see this message earlier. I will check tomorrow, but most likely it will mean more complex code and calculate two different anchors, one for the anchor, and another for the absolute position.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-04T20:58:46Z",
            "diff_hunk": "@@ -693,7 +693,7 @@ describe('ext_multigrid', function()\n         {24: foo}|\n         {21: bar}|\n       ]], float_pos={\n-        [4] = {-1, \"NW\", 2, 15, 55, false, 100};\n+        [4] = {-1, \"SW\", 2, 14, 49, false, 100, 1, 12, 49};",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2029427345",
            "id": 2029427345,
            "in_reply_to_id": 1957320606,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM549pqR",
            "original_commit_id": "d004d5bf7866999bb49d1a2830941f8a4a480faa",
            "original_line": 696,
            "original_position": 14,
            "original_start_line": null,
            "path": "test/functional/ui/multigrid_spec.lua",
            "position": null,
            "pull_request_review_id": 2744093400,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029427345/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-04T20:58:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029427345",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2029839148"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029839148"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I was wrong about the changing of the behaviour making sense. The tests are testing a resized grid, so the popup should follow that, not the screen size. I'm fixing that now.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-05T10:51:52Z",
            "diff_hunk": "@@ -693,7 +693,7 @@ describe('ext_multigrid', function()\n         {24: foo}|\n         {21: bar}|\n       ]], float_pos={\n-        [4] = {-1, \"NW\", 2, 15, 55, false, 100};\n+        [4] = {-1, \"SW\", 2, 14, 49, false, 100, 1, 12, 49};",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2029839148",
            "id": 2029839148,
            "in_reply_to_id": 1957320606,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM54_OMs",
            "original_commit_id": "d004d5bf7866999bb49d1a2830941f8a4a480faa",
            "original_line": 696,
            "original_position": 14,
            "original_start_line": null,
            "path": "test/functional/ui/multigrid_spec.lua",
            "position": null,
            "pull_request_review_id": 2744862631,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029839148/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-05T10:51:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029839148",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2029848281"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029848281"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "That's fixed now",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-05T11:39:14Z",
            "diff_hunk": "@@ -693,7 +693,7 @@ describe('ext_multigrid', function()\n         {24: foo}|\n         {21: bar}|\n       ]], float_pos={\n-        [4] = {-1, \"NW\", 2, 15, 55, false, 100};\n+        [4] = {-1, \"SW\", 2, 14, 49, false, 100, 1, 12, 49};",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2029848281",
            "id": 2029848281,
            "in_reply_to_id": 1957320606,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM54_QbZ",
            "original_commit_id": "d004d5bf7866999bb49d1a2830941f8a4a480faa",
            "original_line": 696,
            "original_position": 14,
            "original_start_line": null,
            "path": "test/functional/ui/multigrid_spec.lua",
            "position": null,
            "pull_request_review_id": 2744870228,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029848281/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-04-05T11:39:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029848281",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2029850913"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029850913"
                }
            },
            "author_association": "MEMBER",
            "body": "Is this needed? Doesn't `pum_position_at_mouse()` already do this?",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-05T11:54:11Z",
            "diff_hunk": "@@ -1528,6 +1549,8 @@ void pum_make_popup(const char *path_name, int use_mouse_pos)\n                                   : curwin->w_wcol);\n     if (ui_has(kUIMultigrid)) {\n       mouse_grid = curwin->w_grid.target->handle;\n+      pum_win_row_offset = curwin->w_winrow;\n+      pum_win_col_offset = curwin->w_wincol;",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2029850913",
            "id": 2029850913,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM54_REh",
            "original_commit_id": "22e51bdf94a18058860ccf42b7cb3d9e67a107e4",
            "original_line": 1553,
            "original_position": 196,
            "original_start_line": 1552,
            "path": "src/nvim/popupmenu.c",
            "position": null,
            "pull_request_review_id": 2744872566,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029850913/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-04-05T11:54:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029850913",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/31837#discussion_r2029871622"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/31837"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029871622"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I removed it. Guess I was not expecting `pum_position_at_mouse` to be called when running an ex command. All tests still pass.",
            "commit_id": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
            "created_at": "2025-04-05T13:25:28Z",
            "diff_hunk": "@@ -1528,6 +1549,8 @@ void pum_make_popup(const char *path_name, int use_mouse_pos)\n                                   : curwin->w_wcol);\n     if (ui_has(kUIMultigrid)) {\n       mouse_grid = curwin->w_grid.target->handle;\n+      pum_win_row_offset = curwin->w_winrow;\n+      pum_win_col_offset = curwin->w_wincol;",
            "html_url": "https://github.com/neovim/neovim/pull/31837#discussion_r2029871622",
            "id": 2029871622,
            "in_reply_to_id": 2029850913,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM54_WIG",
            "original_commit_id": "22e51bdf94a18058860ccf42b7cb3d9e67a107e4",
            "original_line": 1553,
            "original_position": 196,
            "original_start_line": 1552,
            "path": "src/nvim/popupmenu.c",
            "position": null,
            "pull_request_review_id": 2744898051,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029871622/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-04-05T13:25:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2029871622",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "MEMBER",
            "body": "> The UI multigrid protocol does not include enough information to render the UI like the TUI. \r\n\r\nThis is expected behavior as the entire point of the multigrid _mode_ is to allow UI states that cannot even be rendered by the TUI (the current implementation/iteration) in the first place.\r\n\r\nThus \"Partially run the compositor\" in multigrid mode is going to be a recipe for unmitigated disaster.  It might work by accident when a single UI is in full control in an artificial test scenario but it is going to be impossible to specify and maintain expectations when using multiple UI:s simultaneously and doing further refactors to the UI subsystem without going insane.\r\n\r\nLuckily there is another path. There is an undocumented UI option called `_debug_float` which we can stabilize as a public option. This uses the same protocol encoding as multigrid but actually keeps neovim in single-grid mode, and exposes the exact _inputs_ to the compositor, without making the behavior of the compositor itself ossified part of the public protocol . But this will be with the understanding that it is a separate mode from running neovim in the fully multigrid mode and the windowing extensions it enables will not be possible. ",
            "created_at": "2025-01-02T21:09:52Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2568381402",
            "id": 2568381402,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZFmPa",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568381402/reactions"
            },
            "updated_at": "2025-01-02T21:09:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568381402",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "`debug_float` looks like a no-op https://github.com/search?q=repo%3Aneovim%2Fneovim%20debug_float&type=code\r\n\r\nAnd searching for  `kUIFloatDebug` gives this https://github.com/search?q=repo%3Aneovim%2Fneovim%20kUIFloatDebug&type=code\r\n\r\nIt just skips attaching the compositor, which is the opposite of what we need. Besides, this PR does not attach the compositor either, it just runs the layout part of it.",
            "created_at": "2025-01-02T21:18:50Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2568390736",
            "id": 2568390736,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZFohQ",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568390736/reactions"
            },
            "updated_at": "2025-01-02T21:45:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568390736",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I hope you didn't think that it was going to run both multigrid and non-multigrid from the same client, I'm of course talking about two different clients, like a TUI and Neovide attached to the same instance, combined with plugins that also use the UI plugin in either mode,  which I believe is requested here https://github.com/neovim/neovim/issues/31726 \r\n\r\nBut in any case, that's not what this PR does, it just makes it easier to add in the future if desired.",
            "created_at": "2025-01-02T21:58:02Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2568431895",
            "id": 2568431895,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZFykX",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568431895/reactions"
            },
            "updated_at": "2025-01-02T21:58:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568431895",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "ok, perhaps put in a better way: anything which we expect to happen in multigrid mode should not be a part of the compositor.  These are two mutually exclusive modes of operation. Some of the changes you want can still can be done, because they can usefully be thought of **breaking out** functionality from the compositor and instead making them part of nvim core (i e the code which does not care about if we are in single-grid or multigrid mode). \r\n\r\nThe best example of that from this PR would be the absolute windowing order, including breaking all ties between windows of the same z-index. This would be thought then as decisions now done by core UI (i e ui.c and api/ui.c), not anything done by the compositor. \r\n\r\n> In order to be able to test this, a new test variable NVIM_TEST_FORCE_MULTIGRID has been added. This forces nvim to run with multigrid enabled, but the code in screen.lua emulates the non-multigrid mode, so that almost the whole test suite can be run. \r\n\r\nBut this is an example of something which is an anti-pattern, and would block useful refactors and functionality down the line. The point of the multigrid mode is allowing things which cannot be gracefully be reduced to singe-grid rendering, at least not in a remotely back-wards compatible way (as a side note \"TUI2\" which natively runs in ext_multigrid would be interesting, but a very different thing and something which is interesting just because it is allowed to do very different things than the existing TUI)\r\n",
            "created_at": "2025-01-03T10:08:16Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2568981953",
            "id": 2568981953,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZH43B",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568981953/reactions"
            },
            "updated_at": "2025-01-03T10:08:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2568981953",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> This is expected behavior as the entire point of the multigrid mode is to allow UI states that cannot even be rendered by the TUI (the current implementation/iteration) in the first place.\r\n\r\nI have to disagree here, Neovide (a project with over 10000 stars on Github) has been using it for emulating the TUI with additional purely visual effects to a great success (except for a few problems, for example the ones mentioned in the description). \r\n\r\nThe multigrid mode is critical to make this work and provides at least the following features\r\n* It provides viewport and scrolling information, which lets us implement smooth scrolling (the killer feature of Neovide IMO)\r\n* It provides us individual position and content information,\r\n  * It lets us do some optional visual animations of the window positions\r\n  * It lets us do proper transparency blending, but that could be improved with more Neovim support https://github.com/neovim/neovim/issues/24472\r\n\r\nWithout these features, the whole concept of Neovide fails. No one would use it, if it's just a terminal, without being an actual terminal.\r\n\r\nThe documentation also disagrees\r\n> The multigrid extension gives UIs more control over how windows are displayed:\r\nUIs receive updates on a separate grid for each window.\r\nUIs **can** set the grid size independently of how much space the window occupies on the global layout. So the UI could use a different font size per-window. Or reserve space around the border of the window for its own elements, such as scrollbars from the UI toolkit.\r\nA dedicated grid is used for messages, which may scroll over the window area. (Alternatively [ui-messages](https://neovim.io/doc/user/ui.html#ui-messages) can be used).\r\n**By default**, the grid size is handled by Nvim and set to the outer grid size (i.e. the size of the window frame in Nvim) whenever the split is created. Once a UI sets a grid size, Nvim does not handle the size for that grid and the UI must change the grid size whenever the outer size is changed. **To delegate grid-size handling back to Nvim**, request the size (0, 0).\r\nA window can be hidden and redisplayed without its grid being deallocated. This can happen multiple times for the same window, for instance when switching tabs.\r\n\r\nNowhere does it say that UIs have to handle all the sizing and positioning manually, not even here:\r\n> [\"win_float_pos\", grid, win, anchor, anchor_grid, anchor_row, anchor_col, mouse_enabled, zindex]\r\nDisplay or reconfigure floating window win. The window should be displayed above another grid anchor_grid at the specified position anchor_row and anchor_col. For the meaning of anchor and more details of positioning, see [nvim_open_win()](https://neovim.io/doc/user/api.html#nvim_open_win()). mouse_enabled is true if the window can receive mouse events.\r\n\r\nIt's only after you have implemented the protocol, that you discover that [it's not the case](https://github.com/neovim/neovim/issues/24801)\r\n\r\n> Thus \"Partially run the compositor\" in multigrid mode is going to be a recipe for unmitigated disaster. It might work by accident when a single UI is in full control in an artificial test scenario but it is going to be impossible to specify and maintain expectations when using multiple UI:s simultaneously and doing further refactors to the UI subsystem without going insane.\r\n\r\nWell, I tested to launch TUI nvim with these changes, using `nvim --listen localhost:1337`, then connect Neovide (https://github.com/neovide/neovide/pull/2919) with multigrid to it (`neovide --server localhost:1337`). Then controlling the TUI with the keyboard and mosue input from Neovide. \r\n\r\nThe TUI renders and responds without any glitches as far as I can see. The Neovide main grid is working fine, but for some reason `win_float_pos` events are not delivered, so the floats don't work.  But they can still be interacted with by the mouse and clicking at the correct location from Neovide, even with `nvim-scrollview`, which is completely broken in Neovide without this PR . The smooth scrolling also has problems. But connecting two instances to the same server has never worked in multigrid, so there's some work left to do there, and I also think these are related (https://github.com/neovim/neovim/issues/30582, https://github.com/neovim/neovim/issues/30583). But as mentioned, that's something for the future, and not the priority here. From my already quite extensive studying of the Neovim UI code, I see almost zero problems with fixing that, and the additional changes needed would be quite minimal. Yes, GUIs that takes care of the positioning themselves will cause problems, but I don't see how that's preventing anything, they have to do something special to even be compatible with itself when connecting two instances.\r\n\r\n> in a better way: anything which we expect to happen in multigrid mode should not be a part of the compositor. These are two mutually exclusive modes of operation. Some of the changes you want can still can be done, because they can usefully be thought of breaking out functionality from the compositor and instead making them part of nvim core (i e the code which does not care about if we are in single-grid or multigrid mode).\r\n\r\n> The best example of that from this PR would be the absolute windowing order, including breaking all ties between windows of the same z-index. This would be thought then as decisions now done by core UI (i e ui.c and api/ui.c), not anything done by the compositor.\r\n\r\nThat's just a code organization change then, that code can easily be moved out of the compositor if that's preferred. And `comp_index` renamed to something else. In my opinion a compositor also deals with positioning the windows and the sort order of them. But that's just semantics, and to be precise in multigrid Neovim only handles part of the composition, the rest is dealt with by the UI itself. In any case that change would also make this PR almost impossible to review, so it should be done separately IMO. Now when the code stays in place, you can actually see that the changes to the c code are fairly minimal. And nearly all changes are done outside the compositor. Only the additional boolean, `composition_updated`, has been added and a small fix for `ui_comp_get_grid_at_coord` to deal with the multigrid mode.\r\n\r\nTo actually duplicate the code would make zero sense, all functions would look identical, except that `compose_area` and `compose_line` are never called. But that's already the case in this PR (unless a non-multigrid UI is *also* connected. That and the id allocation of the main grid (splits for example), is the only differences between the modes. And the id allocation is something that should be refactored at some point IMO, to make the regular grid a strict susbset of the multigrid mode. Non-multigrid would just send `grid 1`, which is the fully composed screen. While multigrid UIs would receive everything else.\r\n\r\nSpecification-wise it's already a subset, as demonstrated by the code in `screen.lua` in this PR, it's able to process multigrid events and compose a screen that perfectly represents what non-multgrid UI would receive. And the documentation only adds extra events, without specifying any change of behaviour. \r\n\r\nAnother alternative implementation, which would also change a lot, would be to make an internal multigrid client, that just does the same work as the changes I did to `screen.lua` and sends composed grid to non-multigrid clients.\r\n\r\n> But this is an example of something which is an anti-pattern, and would block useful refactors and functionality down the line. \r\n\r\nAn antipattern as opposed to modify hundreds, if not thousands of tests to get a proper coverage for the multigrid mode? The multigrid test coverage is very poor at the moment, and I saw this way as the best way to not only make sure that I test the correct thing, and that there are no regressions anywhere. Furthermore, the multigrid tests are much more fragile than the regular tests, which just check the screen output and don't care about what the protocol sends. So, if you do some refactoring that changes the composition index for example, all multigrid specific tests need to be changed, while the regular tests don't, as long as the screen output is the same.\r\n\r\n> The point of the multigrid mode is allowing things which cannot be gracefully be reduced to singe-grid rendering, at least not in a remotely back-wards compatible way (as a side note \"TUI2\" which natively runs in ext_multigrid would be interesting, but a very different thing and something which is interesting just because it is allowed to do very different things than the existing TUI)\r\n\r\nThese changes don't change the behaviour of any existing multigrid or single-grid test, and I don't see why it would be different in the future. Yes, some tests are currently failing when forced multigrid is used, so doing `screen.lua` based composition with the core running in multigrid. But all of those are existing bugs that we observe in Neovide as well, or they are so minor that it's not worth fixing. Once those are fixed, then tests that are failing, are most likely real failures that would break multigrid clients.\r\n\r\nIf you want to test things that are only supported in multi-grid, then you make a multigrid specific test, just like the tests for external windows for example. But otherwise, everything supported in single grid should be supported in multigrid as well.\r\n\r\nAnd the flag is added to the CI for additional tests, you ensure that nothing breaks. Of course, if something in the core composition changes, then `screen.lua` needs to be updated as well, but if you make breaking changes like that, then all clients (both multigrid and non-multigrid ones) break in the same way.\r\n\r\n\r\n\r\n",
            "created_at": "2025-01-03T15:28:19Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2569399877",
            "id": 2569399877,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZJe5F",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2569399877/reactions"
            },
            "updated_at": "2025-01-03T15:32:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2569399877",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@qvacua ([vimr](https://github.com/qvacua/vimr)), @akiyosi ([goneovim](https://github.com/akiyosi/goneovim)), @equalsraf ([neovim-qt](https://github.com/equalsraf/neovim-qt)), @vhakulinen ([gnvim)](https://github.com/vhakulinen/gnvim), @yatli ([fvim](https://github.com/yatli/fvim))\r\n\r\nYou are the other GUIs, with over 1000 stars on Github. So, it would be nice to get some input and perhaps some testing from you as well. Other GUI implementers are of course also welcome to comment.",
            "created_at": "2025-01-03T15:48:32Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2569445446",
            "id": 2569445446,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZJqBG",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2569445446/reactions"
            },
            "updated_at": "2025-01-03T15:48:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2569445446",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Only broken thing that I've personally noticed (w.r.t the topics of this PR) is that floating window positions aren't updated at times when I would've expected them to be updated (by nvim). I haven't figured this one out yet, except that one case was a bug in gnvim (https://github.com/vhakulinen/gnvim/commit/24e8a74e76ff8f62ea2f98e3c363efb48d489e46). I suspect that similar issue exists with neovide, based on this issue on fidget.nvim: https://github.com/j-hui/fidget.nvim/issues/228\r\n\r\nOne example where this happens is this https://github.com/neovide/neovide/issues/1641\r\n\r\n> W.r.t. compindex. When is the zindex not enough?\r\nI answered to the code comment\r\n\r\n> Couldn't functions that operate on screen positions be deprecated? Those cant truly function cross UIs, can they? Not unless they proxy the call to the UIs behind the scenes.\r\n\r\nPerhaps, but it's used in the wild as of today, for example here https://github.com/neovide/neovide/issues/2569#issuecomment-2132168195\r\n\r\nThe same with getting the mouse position. I provided an alternative here https://github.com/neovim/neovim/issues/27181#issuecomment-1908796946, but that too have a lot of problems.\r\n\r\nFurthermore, a scroll bar for example should still work, if you move out of the window that activated it.\r\n\r\n>...they still have to pass the grid id to nvim_input_mouse...\r\n> Isn't that what you are supposed to do?\r\n\r\nWith these changes if you only use the absolute coordinates given, then you can provide 0. But if you move the windows yourself, render in custom order, or even just use the anchor information directly you need to provide the grid id, because neovim can't know where the window is.\r\n\r\nNOTE: that in order to do it perfectly (like the TUI does), you need to detect if the window has a winbar or not. You can use the margins to detect borders, and click the window below, but the margin is also set when there's a winbar, and when that is clicked, you should report the grid id of the window.\r\n",
            "created_at": "2025-01-03T18:10:30Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2569628324",
            "id": 2569628324,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZKWqk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2569628324/reactions"
            },
            "updated_at": "2025-01-03T18:10:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2569628324",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@fredizzimo: VimR does not use multigrid. It just renders whatever Neovim tells it to render, thus, I am not aware of any insufficiencies/issues with multigrid or the needs UIs with more elaborate visual elements have. That said, my two cents: From a high-level point of view, https://github.com/neovim/neovim/pull/31837#issuecomment-2568381402 makes sense to me: When using multigrid, my understanding is that the UIs should do the composition. If Neovim does not yet provide enough information for UIs to do that correctly, I guess, as @bfredl said, Neovim could provide the inputs for its compositor to the clients or something similar. Multigrid call returning (partial?) result of Neovim's compositor does not seem to be the right way to me.",
            "created_at": "2025-01-04T13:03:37Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2571282281",
            "id": 2571282281,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZQqdp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571282281/reactions"
            },
            "updated_at": "2025-01-04T13:03:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571282281",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/460034?v=4",
                "events_url": "https://api.github.com/users/qvacua/events{/privacy}",
                "followers_url": "https://api.github.com/users/qvacua/followers",
                "following_url": "https://api.github.com/users/qvacua/following{/other_user}",
                "gists_url": "https://api.github.com/users/qvacua/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/qvacua",
                "id": 460034,
                "login": "qvacua",
                "node_id": "MDQ6VXNlcjQ2MDAzNA==",
                "organizations_url": "https://api.github.com/users/qvacua/orgs",
                "received_events_url": "https://api.github.com/users/qvacua/received_events",
                "repos_url": "https://api.github.com/users/qvacua/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/qvacua/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/qvacua/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/qvacua",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Neovim could provide the inputs for its compositor to the clients or something similar\r\n\r\nThat's exactly what this PR does. I'm just not sure how it could do that without running the actual same logic.\r\n\r\nRemember, the logic is complex and filled with special cases, like any window that is entered should be brought to the top of it's zindex.",
            "created_at": "2025-01-04T15:35:20Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2571335505",
            "id": 2571335505,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZQ3dR",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571335505/reactions"
            },
            "updated_at": "2025-01-04T15:35:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571335505",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Multigrid UI:s are absolutely supposed do their own position calculations and have done so just fine for 6 years. Not sure what the point is to write retcon fiction about this.\r\n\r\nAnd yes, it is of course perfectly reasonable to use ext_multigrid to deliver a TUI-like _user experience_. The problem is when we somehow make the jump to imply screen-cell-for-screen-cell, bug-for-bug, legacy-feature-for-legacy-feature identical behavior with the `ext_multigrid=false` mode (metonymously \"nvim in the TUI\" as using the TUI implies it). \r\n\r\nThis is why I think the distinction I made above still stands. We can absolutely make core nvim emit _more information_ which makes the life of GUI:s like Neovide easier. We could even stretch this so far as emit the result of the calculations the compositor _would have done_ for absolute, monospace-grid assuming, positioning. This sharing of information will still not guarantee identical behavior, as you noted yourself the popupmenu could go out-of-bounds of the TUI-like grid as these checks are disabled etc (it does not somehow disappear with disabling nvim_ui_resize_grid ) .\r\n\r\nThe amount of tests is completely irrelevant if we are testing for the wrong thing. We will not add a large batch of tests mandating that multigrid reproduces the current single-grid behaviors exactly, at least not at this point in time where this explicitly mandates one specific single-grid \"frontend\" (i e the _current_ compositor behavior).  On the contrary, multigrid even when used for \"single-grid like\" UI:s in no way shape or form meant to be restricted to deliver one identical or even remotely close to \"TUI 1.0\" . For instance TUI2 could be made to be able display different viewports for multiple TUI:s attached to the same server. The priority for previous and all further development of the multigrid mode is to enable these new things. If behavior identical to existing TUI is desired we already have a completely fine mechanism: using `ext_multigrid=false` . ",
            "created_at": "2025-01-04T19:30:08Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2571390685",
            "id": 2571390685,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZRE7d",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571390685/reactions"
            },
            "updated_at": "2025-01-04T19:30:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571390685",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "This PR makes multigrid 99% compatible with the TUI after the following three (serious) bugs are fixed, non of them related to this PR at all\r\n*  https://github.com/neovim/neovim/issues/24802\r\n*  https://github.com/neovim/neovim/issues/31811\r\n*  https://github.com/neovim/neovim/issues/24705, \r\n\r\nAs for the rest, all detected due to proper testing, some TUI bugs and some multigrid issues unrelated to this PR\r\n* This looks like a TUI bug, the cursor should probably move with the window there too https://github.com/neovim/neovim/blob/295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46/test/functional/api/vim_spec.lua#L5281\r\n*  this also looks like a TUI bug https://github.com/neovim/neovim/blob/295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46/test/functional/legacy/cmdline_spec.lua#L180\r\n*  this is an unreported multigrid bug, not related to the PR https://github.com/neovim/neovim/blob/295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46/test/functional/lua/ui_event_spec.lua#L200\r\n*  another unrelated unreported multigrid bug https://github.com/neovim/neovim/blob/295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46/test/functional/ui/float_spec.lua#L8957\r\n*  here you could argue that both are correct and that it doesn't really matter https://github.com/neovim/neovim/blob/295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46/test/functional/ui/popupmenu_spec.lua#L2581\r\n* here again, I think the multigrid case is correct  https://github.com/neovim/neovim/blob/295f0f8d2717f4a64dbbad7ff6c8b8ab4204ee46/test/functional/ui/screen_basic_spec.lua#L661\r\n",
            "created_at": "2025-01-04T22:17:23Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2571425736",
            "id": 2571425736,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ZRNfI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571425736/reactions"
            },
            "updated_at": "2025-01-04T22:18:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2571425736",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@justinmk \r\n\r\nIs there any way we can proceed with this? I have been given no concrete options what needs to be done. And properly working mouse support is critical for a GUI like Neovide, so I would like to get it done sooner rather than later.\r\n\r\nMy view is that a multigrid UI should be functionally no different than a TUI, unless the GUI decides to move or resize the windows, or use external windows. Ans this PR brings us very close, with few non-breaking changes.\r\n\r\nIf we further allow Neovim to internally always work with multiple grids, which are just composed then together to a single grid before sending, it would remove almost all of the multigrid special cases from the code. But that's a much bigger and perhaps controversial change. So it's not done here.  ",
            "created_at": "2025-02-06T01:08:07Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2638378025",
            "id": 2638378025,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6dQnQp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 2,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2638378025/reactions"
            },
            "updated_at": "2025-02-06T01:22:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2638378025",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Breaking out parts into separate PRs as you have done helps a lot. But as [mentioned](https://github.com/neovim/neovim/pull/31837#issuecomment-2568981953), crystallizing accidental internals into the UI protocol isn't a viable approach. \r\n\r\nIs there a way to do this more incrementally?\r\n\r\nIf this changes the UI protocol so that UIs can mimic the TUI, why aren't there changes to `tui.c` here (and deleting old \"side-channel\" codepaths)? \r\n\r\nTo move forward, I suggest starting with an incremental PR that makes one change to the UI protocol, which also changes `tui.c` to use that new UI protocol feature. That will allow more targeted discussion. And will allow us to discuss concrete alternatives, if necessary.",
            "created_at": "2025-02-11T12:02:41Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2650606320",
            "id": 2650606320,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6d_Qrw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2650606320/reactions"
            },
            "updated_at": "2025-02-11T12:02:41Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2650606320",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thanks @justinmk \r\n\r\nI will split this into a few different PRs, and try to add regular multigrid tests to motivate each change. Some of these PRs will be dependent on each other, and from the Neovide's point of view it doesn't really work until everything is merged, but if it makes it easier to review, I will do that. At least some of them will furthermore be dependent on each other. I have already extracted a bugfix, so, that's almost ready for a PR, but by doing that I discovered some other things that I'm investigating right now, so I will only send the PR once I have verified it properly.\r\n\r\nI think I will leave this PR open but in draft status for now containing everything so that it can be tested as a whole until the other ones are merged.\r\n\r\n> But as https://github.com/neovim/neovim/pull/31837#issuecomment-2568981953, crystallizing accidental internals into the UI protocol isn't a viable approach.\r\n\r\nI don't think the composition index is an accidental internal, the very first implementation relied on it to bring a window to the front of it's z-index when the cursor enters the window https://github.com/neovim/neovim/pull/6619/files#diff-0d9abedfba2500c46e5ac12f91f7f7947c1a5c8eef29be488579053a558d92c3R248. So at least that part looks very intentional to me. \r\n\r\nI'm fine with not exposing it, but then the non-multigrid protocol and TUI needs to be changed as well, so that we have a deterministic sort order that can be determined from the information available, even when we reconnect after detaching. In practice this would probably be the window or grid id as a secondary sort key after the z-index. Disallowing the use of the same z-index completely seems like a recipe for disaster, where things start to break when the user installs two conflicting plugins. But any change to this, means a huge breaking change, so exposing the compindex seems like a much better alternative to me.\r\n\r\nIf the changes to the compindex, can stay, I need a more concrete instruction for the practical side of it. Currently around half of `ui_compositor.c` deals with calculating the composition index and maintaining the z-order of the windows, and moving that to `UI.c`, which is already quite big seems counter-productive to me. It could be moved to another file, but what should it be called? And what should `compindex` be renamed to? If that's no longer calculated by the compositor?\r\n\r\nIn any case, I think this should be a completely different refactor, this PR doesn't make any changes to `ui_compositor.c`, apart from adding a boolean that tells that the index has changed, and a small fix to `ui_comp_get_grid_at_coord`, to make it work with multigrid. Instead, it removes the special cases, that prevents the code from being run when running a multigrid UI, so that the composition index is available. \r\n\r\n> If this changes the UI protocol so that UIs can mimic the TUI, why aren't there changes to tui.c here (and deleting old \"side-channel\" codepaths)?\r\n\r\nThis does only change the multigrid protocol, so no TUI changes are necessary.\r\n\r\nIn the future it may be possible to implement a TUI client using the multigrid protocol or even deprecate the old protocol completely if that's desired. But I think those kinds of changes are out of scope for now. Alternatively, I think it's possible to make Neovim internally threat everything as multigrid, and let the compositor compose everything for the non-multigrid protocol before sending. But that too is a bigger change, and not really needed. This PR already brings things closer, by eliminating a couple of special cases.\r\n\r\n\r\n\r\n\r\n\r\n",
            "created_at": "2025-02-14T04:58:00Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2658278391",
            "id": 2658278391,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6echv3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2658278391/reactions"
            },
            "updated_at": "2025-02-14T04:58:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2658278391",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "It does not make much sense to separate the composition index and the position update into their own PRs, because both relies on the compositor code being run. So, if one of them is implemented, the other one follows trivially, just with a lot of test changes, since each multigrid test needs both.\r\n\r\nI can split out the fixes for `screenchar()`, and `getmousepos()`, which can be added after the main PR is merged. I will also move out the `FORCE_MULTIGRID` test support once I make sure that we have enough normal multigrid tests to at least get a decent test coverage for the new PRs.\r\n\r\n",
            "created_at": "2025-02-14T08:34:50Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2658601275",
            "id": 2658601275,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6edwk7",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2658601275/reactions"
            },
            "updated_at": "2025-02-14T08:34:50Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2658601275",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> > If this changes the UI protocol so that UIs can mimic the TUI, why aren't there changes to tui.c here (and deleting old \"side-channel\" codepaths)?\r\n> \r\n> This does only change the multigrid protocol, so no TUI changes are necessary.\r\n\r\nSo if Neovide doesn't use multigrid, it can behave like the TUI?\r\n\r\nPlease keep comments concise. The multi-page replies discourage others from following and commenting.",
            "created_at": "2025-02-14T12:01:36Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2659155413",
            "id": 2659155413,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ef33V",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2659155413/reactions"
            },
            "updated_at": "2025-02-14T12:01:36Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2659155413",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> So if Neovide doesn't use multigrid, it can behave like the TUI?\r\n\r\nYes, it can, but that defeats the purpose of Neovide, since all animations and window blending have to be disabled. Only  the cursor effects work with just linegrid enabled.\r\n\r\nFor more thorough response, see the start of this message https://github.com/neovim/neovim/pull/31837#issuecomment-2569399877",
            "created_at": "2025-02-14T12:04:29Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2659160812",
            "id": 2659160812,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6ef5Ls",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2659160812/reactions"
            },
            "updated_at": "2025-02-15T04:30:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2659160812",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I have removed everything extra, so now once these are merged and the PR rebased, it should be ready for review again. Or if you want to do it earlier, you can review just the last commit\r\n\r\n* https://github.com/neovim/neovim/pull/32440\r\n* https://github.com/neovim/neovim/pull/32470\r\n\r\n(now fixed) ~~**Edit:** I found some bug when reviewing it myself for the nth time. Some of the anchors have changed, I need to investigate what has caused that.~~",
            "created_at": "2025-02-16T05:03:41Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2661247710",
            "id": 2661247710,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6en2re",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2661247710/reactions"
            },
            "updated_at": "2025-02-16T13:27:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2661247710",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "In case you missed, this PR is now ready from my side, once the following are merged https://github.com/neovim/neovim/pull/32440, https://github.com/neovim/neovim/pull/32470 or some actual *actionable* feedback is received.\r\n\r\nAnd after this https://github.com/neovim/neovim/pull/32494, https://github.com/neovim/neovim/pull/32535, which were both initially part of this PR. But now independent with some slight improvements and bug fixes.\r\n\r\nI also have some WIP follow up code that makes Neovim internally always use multiple grids, which removes almost all of the `ui_has(kUIMultigrid))` checks, and the associated code complexity with it. It also allows multigrid and non-multigrid UIs to seamlessly connect and work together with the same Neovim instance. The only remaining multigrid checks are the ones that allow more things when a multigrid UI is connected, like external windows. But it can't be completed until the inccommand is fixed. But a draft PR will be put up within a couple of days.",
            "created_at": "2025-02-26T05:47:59Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2683961244",
            "id": 2683961244,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6f-f-c",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2683961244/reactions"
            },
            "updated_at": "2025-02-26T05:47:59Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2683961244",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "@justinmk, @bfredl and @clason (you have discussed this with @kethku)\r\n\r\nIt would be nice to have some *concrete* suggestions here. As I see it, we have four options for exposing the rendering order and focusing order of the windows.\r\n\r\n1. Accept that this is the way it works, and expose the composition order (This PR)\r\n2. Break a big chunk of the nvim plugin ecosystem and define a deterministic order without needing a hidden order. Use for example the grid id as a tie breaker when the z-index is the same\r\n3. Create a new UI protocol or extend the single grid one with the same information as multigrid (scroll deltas and window positions). I don't see why this would be done since multigrid already does it. And compared to this PR does not allow to use external windows or position and resize *some* of the windows differently\r\n4. The Neovide use case is not supported by Neovim -> Neovide forks it, and implements the needed things",
            "created_at": "2025-02-26T05:48:14Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2683961513",
            "id": 2683961513,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6f-gCp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2683961513/reactions"
            },
            "updated_at": "2025-02-26T05:48:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2683961513",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I rebased and added the documentation change as suggested. \r\n\r\nI also ran the tests here https://github.com/fredizzimo/neovim/tree/multigrid-composition-test, with Neovim running multigrid and the test code outputting in a format compatible with single grid tests to verify that everything still works.",
            "created_at": "2025-04-04T18:55:11Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2779521143",
            "id": 2779521143,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6lrCB3",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2779521143/reactions"
            },
            "updated_at": "2025-04-04T18:55:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2779521143",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I think everything should be addressed now. The change of behaviour was indeed a bug.",
            "created_at": "2025-04-05T11:40:09Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2780677220",
            "id": 2780677220,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6lvcRk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2780677220/reactions"
            },
            "updated_at": "2025-04-05T11:40:09Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2780677220",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "merged. I'm going to some refactors as a follow-up PR.",
            "created_at": "2025-04-15T09:56:43Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2804499228",
            "id": 2804499228,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6nKUMc",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2804499228/reactions"
            },
            "updated_at": "2025-04-15T09:56:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2804499228",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1363104?v=4",
                "events_url": "https://api.github.com/users/bfredl/events{/privacy}",
                "followers_url": "https://api.github.com/users/bfredl/followers",
                "following_url": "https://api.github.com/users/bfredl/following{/other_user}",
                "gists_url": "https://api.github.com/users/bfredl/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/bfredl",
                "id": 1363104,
                "login": "bfredl",
                "node_id": "MDQ6VXNlcjEzNjMxMDQ=",
                "organizations_url": "https://api.github.com/users/bfredl/orgs",
                "received_events_url": "https://api.github.com/users/bfredl/received_events",
                "repos_url": "https://api.github.com/users/bfredl/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/bfredl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bfredl/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/bfredl",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thank you very much!\r\n\r\nI have now marked the following, which were originally part of this PR as ready for review\r\n* https://github.com/neovim/neovim/pull/32494\r\n* https://github.com/neovim/neovim/pull/32535",
            "created_at": "2025-04-18T22:15:14Z",
            "html_url": "https://github.com/neovim/neovim/pull/31837#issuecomment-2816274793",
            "id": 2816274793,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
            "node_id": "IC_kwDOAPphoM6n3PFp",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2816274793/reactions"
            },
            "updated_at": "2025-04-18T22:15:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2816274793",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/31837/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/31837/commits",
    "created_at": "2025-01-02T20:16:29Z",
    "diff_url": "https://github.com/neovim/neovim/pull/31837.diff",
    "draft": false,
    "head": {
        "label": "fredizzimo:multigrid-composition",
        "ref": "multigrid-composition",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/fredizzimo/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/fredizzimo/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/fredizzimo/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/fredizzimo/neovim/branches{/branch}",
            "clone_url": "https://github.com/fredizzimo/neovim.git",
            "collaborators_url": "https://api.github.com/repos/fredizzimo/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/fredizzimo/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/fredizzimo/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/fredizzimo/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/fredizzimo/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/fredizzimo/neovim/contributors",
            "created_at": "2021-07-09T10:07:26Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/fredizzimo/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/fredizzimo/neovim/downloads",
            "events_url": "https://api.github.com/repos/fredizzimo/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/fredizzimo/neovim/forks",
            "full_name": "fredizzimo/neovim",
            "git_commits_url": "https://api.github.com/repos/fredizzimo/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/fredizzimo/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/fredizzimo/neovim/git/tags{/sha}",
            "git_url": "git://github.com/fredizzimo/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/fredizzimo/neovim/hooks",
            "html_url": "https://github.com/fredizzimo/neovim",
            "id": 384397538,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/fredizzimo/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/fredizzimo/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/fredizzimo/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/fredizzimo/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/fredizzimo/neovim/labels{/name}",
            "language": null,
            "languages_url": "https://api.github.com/repos/fredizzimo/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/fredizzimo/neovim/merges",
            "milestones_url": "https://api.github.com/repos/fredizzimo/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkzODQzOTc1Mzg=",
            "notifications_url": "https://api.github.com/repos/fredizzimo/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
                "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
                "followers_url": "https://api.github.com/users/fredizzimo/followers",
                "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
                "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/fredizzimo",
                "id": 9946255,
                "login": "fredizzimo",
                "node_id": "MDQ6VXNlcjk5NDYyNTU=",
                "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
                "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
                "repos_url": "https://api.github.com/users/fredizzimo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/fredizzimo",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/fredizzimo/neovim/pulls{/number}",
            "pushed_at": "2025-04-19T10:17:15Z",
            "releases_url": "https://api.github.com/repos/fredizzimo/neovim/releases{/id}",
            "size": 310996,
            "ssh_url": "git@github.com:fredizzimo/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/fredizzimo/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/fredizzimo/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/fredizzimo/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/fredizzimo/neovim/subscription",
            "svn_url": "https://github.com/fredizzimo/neovim",
            "tags_url": "https://api.github.com/repos/fredizzimo/neovim/tags",
            "teams_url": "https://api.github.com/repos/fredizzimo/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/fredizzimo/neovim/git/trees{/sha}",
            "updated_at": "2021-07-09T10:07:27Z",
            "url": "https://api.github.com/repos/fredizzimo/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "f29856d0344435347a5032a5a1fda3dcb5618c1b",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
            "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
            "followers_url": "https://api.github.com/users/fredizzimo/followers",
            "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
            "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/fredizzimo",
            "id": 9946255,
            "login": "fredizzimo",
            "node_id": "MDQ6VXNlcjk5NDYyNTU=",
            "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
            "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
            "repos_url": "https://api.github.com/users/fredizzimo/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/fredizzimo",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/31837",
    "id": 2258370826,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/31837",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "",
            "id": 113026979,
            "name": "ui",
            "node_id": "MDU6TGFiZWwxMTMwMjY5Nzk=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ui"
        }
    ],
    "locked": false,
    "merge_commit_sha": "07b33c326697df0fd922053215fb546de5c4f1b1",
    "merged_at": "2025-04-15T09:56:39Z",
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6GnAEK",
    "number": 31837,
    "patch_url": "https://github.com/neovim/neovim/pull/31837.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/31837/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/f29856d0344435347a5032a5a1fda3dcb5618c1b",
    "title": "feat(ui): include compositor info with multigrid",
    "updated_at": "2025-04-18T22:15:15Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/31837",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/9946255?v=4",
        "events_url": "https://api.github.com/users/fredizzimo/events{/privacy}",
        "followers_url": "https://api.github.com/users/fredizzimo/followers",
        "following_url": "https://api.github.com/users/fredizzimo/following{/other_user}",
        "gists_url": "https://api.github.com/users/fredizzimo/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/fredizzimo",
        "id": 9946255,
        "login": "fredizzimo",
        "node_id": "MDQ6VXNlcjk5NDYyNTU=",
        "organizations_url": "https://api.github.com/users/fredizzimo/orgs",
        "received_events_url": "https://api.github.com/users/fredizzimo/received_events",
        "repos_url": "https://api.github.com/users/fredizzimo/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/fredizzimo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fredizzimo/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/fredizzimo",
        "user_view_type": "public"
    }
}
{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36575/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36575/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/36575"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36575"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36575/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/9ab28effcc9ae4f013c56990dc1750e0c7b3e171"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 6429,
            "forks_count": 6429,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 2027,
            "open_issues_count": 2027,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-11-25T01:10:51Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 352207,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 94510,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-11-25T02:41:34Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 94510,
            "watchers_count": 94510,
            "web_commit_signoff_required": false
        },
        "sha": "60c35cc4c7b713c27e8bfdd196cbee46cf050bbb",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "feat(lsp): add Operator-pending mode support for LSP textobjects.\r\n\r\nProblem:\r\nLSP incremental selection provides default visual-mode keymaps for `an` and `in`. Operator-pending mode is not supported, so `dan` and `can` do not apply the operation.\r\n\r\nSolution: \r\nImplement Operator-pending mode for LSP textobjects  by adding a callback to `vim.lsp.buf.selection_range()`. The callback ensures that the operator waits until the selection range is fully computed before applying the operation. The solution uses a similar pattern to #34523 to make it `vim.async` ready. \r\n\r\nFix: #36044 \r\n\r\nNotes:\r\nAny feedback would be greatly appreciated since this is my first time contributing.",
    "closed_at": "2025-11-25T01:10:51Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2532229781"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532229781"
                }
            },
            "author_association": "MEMBER",
            "body": "`M.selection_range` maps to an actual lsp name. LSP does not have \"operationRange\" so not sure about exposing this `buf.operation_range`. \n\nAlso just a nit, in vim \"operation\" is referred to as \"op\", it is not spelled out.\n\nMore generally, how much of this code overlaps with `selection_range()` and why can't they use the same implementation?\n\n",
            "commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "created_at": "2025-11-16T21:01:39Z",
            "diff_hunk": "@@ -1493,4 +1493,47 @@ function M.selection_range(direction)\n   )\n end\n \n+function M.operation_range()",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2532229781",
            "id": 2532229781,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6W7sKV",
            "original_commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "original_line": 1496,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3470490521,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532229781/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-16T21:01:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532229781",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2532259116"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532259116"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "A good portion of the code is similar to `selection_range()` except I think that the operator-pending mode needs to use `buf_request_sync()` instead of `buf_request()`. \r\n\r\nI originally tried to map the operator-pending keymap to `selection_range()` but that only triggered the visual selection behavior.\r\n\r\nI think it is because the operation-mode is synchronous and is waiting for the marks to be set. If the LSP request runs asynchronously then the marks don't get set before the operation is executed, so nothing happens.",
            "commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "created_at": "2025-11-16T21:39:20Z",
            "diff_hunk": "@@ -1493,4 +1493,47 @@ function M.selection_range(direction)\n   )\n end\n \n+function M.operation_range()",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2532259116",
            "id": 2532259116,
            "in_reply_to_id": 2532229781,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6W7zUs",
            "original_commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "original_line": 1496,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3470520363,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532259116/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-16T21:39:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532259116",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2532653309"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532653309"
                }
            },
            "author_association": "MEMBER",
            "body": "in general, vim operators can be implemented once there is a visual-mode implementation. Look at https://github.com/tpope/vim-jdaddy/blob/23b67752cb869dd9c8f3109173b69aa96a1f3acf/plugin/jdaddy.vim#L11-L12 for example (vimscript, sorry ðŸ˜… )\r\n\r\npossibly something could be improved in the visual impl.\r\n\r\n> similar to `selection_range()` except I think that the operator-pending mode needs to use `buf_request_sync()` instead of `buf_request()`.\r\n\r\nso in the worst case, that could just be a parameter?",
            "commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "created_at": "2025-11-17T04:24:10Z",
            "diff_hunk": "@@ -1493,4 +1493,47 @@ function M.selection_range(direction)\n   )\n end\n \n+function M.operation_range()",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2532653309",
            "id": 2532653309,
            "in_reply_to_id": 2532229781,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6W9Tj9",
            "original_commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "original_line": 1496,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3470935624,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532653309/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-17T04:25:17Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2532653309",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2535067121"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2535067121"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "It looks like I was implementing the vim operators incorrectly so that is why it was only doing the visual-mode operation.\r\nInstead of calling `vim.cmd.normal()` I was calling the `selection_range()` method directly. \r\n\r\nThat being said, when I implemented the operator mapping the correct way, it was only performing the operation on a single character (because I think the marks weren't being set in time). I am updated `selection_range()` to handle both the operator-mode and the visual-mode.\r\n\r\nThe current tests for `selection_range()` are passing. Do I need to write additional tests for the operator-mode?",
            "commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "created_at": "2025-11-17T18:09:21Z",
            "diff_hunk": "@@ -1493,4 +1493,47 @@ function M.selection_range(direction)\n   )\n end\n \n+function M.operation_range()",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2535067121",
            "id": 2535067121,
            "in_reply_to_id": 2532229781,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6XGg3x",
            "original_commit_id": "044449f6f592a3a4bd1e5fd0f876a9994b05c975",
            "original_line": 1496,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3473976570,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2535067121/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-17T18:09:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2535067121",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2536414929"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2536414929"
                }
            },
            "author_association": "MEMBER",
            "body": "I think instead of adding a `use_sync` flag this should probably follow the pattern from https://github.com/neovim/neovim/pull/34523 and add a callback to make it `vim.async` ready. Until `vim.async` is ready one can then use the callback to set a flag to block on with `vim.wait`.\r\n\r\nAlternatively: Could make this in general synchronous. Not sure if there's much value for it to be async, given that opposed to something like completion it is unusual to continue editing while getting the selection range. ",
            "commit_id": "5655ee0f805c742c981dca303e6191c0c05a1f38",
            "created_at": "2025-11-18T05:56:45Z",
            "diff_hunk": "@@ -1405,11 +1405,16 @@ end\n \n --- Perform an incremental selection at the cursor position based on ranges given by the LSP. The\n --- `direction` parameter specifies the number of times to expand the selection. Negative values\n---- will shrink the selection.\n+--- will shrink the selection. The `use_sync` is optional. When true, the request is performed\n+--- synchronously. Operator-pending mode requires synchronous execution.\n ---\n --- @param direction integer\n-function M.selection_range(direction)\n+--- @param use_sync? boolean\n+function M.selection_range(direction, use_sync)",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2536414929",
            "id": 2536414929,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6XLp7R",
            "original_commit_id": "5655ee0f805c742c981dca303e6191c0c05a1f38",
            "original_line": 1413,
            "original_position": 11,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3475609878,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2536414929/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-18T05:56:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2536414929",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/38700?v=4",
                "events_url": "https://api.github.com/users/mfussenegger/events{/privacy}",
                "followers_url": "https://api.github.com/users/mfussenegger/followers",
                "following_url": "https://api.github.com/users/mfussenegger/following{/other_user}",
                "gists_url": "https://api.github.com/users/mfussenegger/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/mfussenegger",
                "id": 38700,
                "login": "mfussenegger",
                "node_id": "MDQ6VXNlcjM4NzAw",
                "organizations_url": "https://api.github.com/users/mfussenegger/orgs",
                "received_events_url": "https://api.github.com/users/mfussenegger/received_events",
                "repos_url": "https://api.github.com/users/mfussenegger/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/mfussenegger/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mfussenegger/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/mfussenegger",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2542731339"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2542731339"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Thank you for the example! I was able to implement the callback pattern to make it `vim.async` ready. \r\n\r\nI saw some talk about callback naming convention so I named it `on_response` instead of `callback` (not sure if that convention has been nailed down yet).\r\n\r\nI also added a test to make sure that the callback is actually being called by `selection_range`. ",
            "commit_id": "5655ee0f805c742c981dca303e6191c0c05a1f38",
            "created_at": "2025-11-19T16:23:26Z",
            "diff_hunk": "@@ -1405,11 +1405,16 @@ end\n \n --- Perform an incremental selection at the cursor position based on ranges given by the LSP. The\n --- `direction` parameter specifies the number of times to expand the selection. Negative values\n---- will shrink the selection.\n+--- will shrink the selection. The `use_sync` is optional. When true, the request is performed\n+--- synchronously. Operator-pending mode requires synchronous execution.\n ---\n --- @param direction integer\n-function M.selection_range(direction)\n+--- @param use_sync? boolean\n+function M.selection_range(direction, use_sync)",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2542731339",
            "id": 2542731339,
            "in_reply_to_id": 2536414929,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6XjwBL",
            "original_commit_id": "5655ee0f805c742c981dca303e6191c0c05a1f38",
            "original_line": 1413,
            "original_position": 11,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3483667632,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2542731339/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-19T16:23:26Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2542731339",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2551395579"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551395579"
                }
            },
            "author_association": "MEMBER",
            "body": "nit: this note could be on the parameter doc itself",
            "commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "created_at": "2025-11-22T00:23:44Z",
            "diff_hunk": "@@ -1507,13 +1507,16 @@ rename({new_name}, {opts})                              *vim.lsp.buf.rename()*\n                       ones where client.name matches this field.\n                     â€¢ {bufnr}? (`integer`) (default: current buffer)\n \n-selection_range({direction})                   *vim.lsp.buf.selection_range()*\n+                                               *vim.lsp.buf.selection_range()*\n+selection_range({direction}, {on_response})\n     Perform an incremental selection at the cursor position based on ranges\n     given by the LSP. The `direction` parameter specifies the number of times\n     to expand the selection. Negative values will shrink the selection.\n+    `on_response` is called after the request is completed.",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2551395579",
            "id": 2551395579,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YEzT7",
            "original_commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "original_line": 1515,
            "original_position": 19,
            "original_start_line": null,
            "path": "runtime/doc/lsp.txt",
            "position": 1,
            "pull_request_review_id": 3494872996,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551395579/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-22T00:23:44Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551395579",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2551396381"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551396381"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n  validate('on_response', on_response, 'function', true)\n```",
            "commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "created_at": "2025-11-22T00:23:59Z",
            "diff_hunk": "@@ -1405,24 +1405,32 @@ end\n \n --- Perform an incremental selection at the cursor position based on ranges given by the LSP. The\n --- `direction` parameter specifies the number of times to expand the selection. Negative values\n---- will shrink the selection.\n+--- will shrink the selection. `on_response` is called after the request is completed.\n ---\n --- @param direction integer\n-function M.selection_range(direction)\n+--- @param on_response? fun(errors: table<integer, lsp.ResponseError>)\n+function M.selection_range(direction, on_response)\n   validate('direction', direction, 'number')\n+  validate('callback', on_response, 'function', true)",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2551396381",
            "id": 2551396381,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YEzgd",
            "original_commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "original_line": 1414,
            "original_position": 12,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3494873722,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551396381/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-22T00:24:00Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551396381",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2551403979"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551403979"
                }
            },
            "author_association": "MEMBER",
            "body": "the mappings are identical except for the `vim.v.count1` param. just define a `local function` and re-use it",
            "commit_id": "9ab28effcc9ae4f013c56990dc1750e0c7b3e171",
            "created_at": "2025-11-22T00:26:06Z",
            "diff_hunk": "@@ -227,6 +227,34 @@ do\n       vim.lsp.buf.selection_range(-vim.v.count1)\n     end, { desc = 'vim.lsp.buf.selection_range(-vim.v.count1)' })\n \n+    vim.keymap.set('o', 'an', function()",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2551403979",
            "id": 2551403979,
            "line": 230,
            "node_id": "PRRC_kwDOAPphoM6YE1XL",
            "original_commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "original_line": 230,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/_defaults.lua",
            "position": 4,
            "pull_request_review_id": 3494880766,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551403979/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-22T00:26:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2551403979",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2553307999"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2553307999"
                }
            },
            "author_association": "MEMBER",
            "body": "This pattern seems kind of sus to me; would it make sense to just pass a timeout parameter to `selection_range()` which makes it run synchronously?",
            "commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "created_at": "2025-11-22T19:07:52Z",
            "diff_hunk": "@@ -227,6 +227,34 @@ do\n       vim.lsp.buf.selection_range(-vim.v.count1)\n     end, { desc = 'vim.lsp.buf.selection_range(-vim.v.count1)' })\n \n+    vim.keymap.set('o', 'an', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true\n+      end)\n+      local timeout_ms = 1000\n+      local did_finish = vim.wait(timeout_ms, function()\n+        return done\n+      end)\n+      if not did_finish then\n+        vim.lsp.log.error('Timeout error when executing operator function for selection_range')\n+      end\n+    end, { desc = 'vim.lsp.buf.selection_range(vim.v.count1, on_response)' })\n+\n+    vim.keymap.set('o', 'in', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2553307999",
            "id": 2553307999,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YMGNf",
            "original_commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "original_line": 247,
            "original_position": 21,
            "original_start_line": null,
            "path": "runtime/lua/vim/_defaults.lua",
            "position": 1,
            "pull_request_review_id": 3496911500,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2553307999/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-22T19:07:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2553307999",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2554161651"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554161651"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Yes, I can change it to have a timeout parameter. That makes more sense than the boolean `use_sync` param that I had done before.\r\n\r\nDo you think that `selection_range()` should be async in general? @mfussenegger pointed out that it might make sense to just make it a synchronous function.",
            "commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "created_at": "2025-11-23T15:40:48Z",
            "diff_hunk": "@@ -227,6 +227,34 @@ do\n       vim.lsp.buf.selection_range(-vim.v.count1)\n     end, { desc = 'vim.lsp.buf.selection_range(-vim.v.count1)' })\n \n+    vim.keymap.set('o', 'an', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true\n+      end)\n+      local timeout_ms = 1000\n+      local did_finish = vim.wait(timeout_ms, function()\n+        return done\n+      end)\n+      if not did_finish then\n+        vim.lsp.log.error('Timeout error when executing operator function for selection_range')\n+      end\n+    end, { desc = 'vim.lsp.buf.selection_range(vim.v.count1, on_response)' })\n+\n+    vim.keymap.set('o', 'in', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2554161651",
            "id": 2554161651,
            "in_reply_to_id": 2553307999,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YPWnz",
            "original_commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "original_line": 247,
            "original_position": 21,
            "original_start_line": null,
            "path": "runtime/lua/vim/_defaults.lua",
            "position": 1,
            "pull_request_review_id": 3497857049,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554161651/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-23T15:40:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554161651",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2554187370"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554187370"
                }
            },
            "author_association": "MEMBER",
            "body": "in order to close this out, go ahead and make it synchronous for now. we can always revisit that in a followup if needed.",
            "commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "created_at": "2025-11-23T16:28:14Z",
            "diff_hunk": "@@ -227,6 +227,34 @@ do\n       vim.lsp.buf.selection_range(-vim.v.count1)\n     end, { desc = 'vim.lsp.buf.selection_range(-vim.v.count1)' })\n \n+    vim.keymap.set('o', 'an', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true\n+      end)\n+      local timeout_ms = 1000\n+      local did_finish = vim.wait(timeout_ms, function()\n+        return done\n+      end)\n+      if not did_finish then\n+        vim.lsp.log.error('Timeout error when executing operator function for selection_range')\n+      end\n+    end, { desc = 'vim.lsp.buf.selection_range(vim.v.count1, on_response)' })\n+\n+    vim.keymap.set('o', 'in', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2554187370",
            "id": 2554187370,
            "in_reply_to_id": 2553307999,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YPc5q",
            "original_commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "original_line": 247,
            "original_position": 21,
            "original_start_line": null,
            "path": "runtime/lua/vim/_defaults.lua",
            "position": 1,
            "pull_request_review_id": 3497880679,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554187370/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-23T16:28:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554187370",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2554196828"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554196828"
                }
            },
            "author_association": "MEMBER",
            "body": "I think synchronous makes sense",
            "commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "created_at": "2025-11-23T16:45:40Z",
            "diff_hunk": "@@ -227,6 +227,34 @@ do\n       vim.lsp.buf.selection_range(-vim.v.count1)\n     end, { desc = 'vim.lsp.buf.selection_range(-vim.v.count1)' })\n \n+    vim.keymap.set('o', 'an', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true\n+      end)\n+      local timeout_ms = 1000\n+      local did_finish = vim.wait(timeout_ms, function()\n+        return done\n+      end)\n+      if not did_finish then\n+        vim.lsp.log.error('Timeout error when executing operator function for selection_range')\n+      end\n+    end, { desc = 'vim.lsp.buf.selection_range(vim.v.count1, on_response)' })\n+\n+    vim.keymap.set('o', 'in', function()\n+      local done = false\n+      vim.lsp.buf.selection_range(-vim.v.count1, function()\n+        done = true",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2554196828",
            "id": 2554196828,
            "in_reply_to_id": 2553307999,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YPfNc",
            "original_commit_id": "396c398e13a4a09e8f136705819d2e998deb920b",
            "original_line": 247,
            "original_position": 21,
            "original_start_line": null,
            "path": "runtime/lua/vim/_defaults.lua",
            "position": 1,
            "pull_request_review_id": 3497887117,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554196828/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-23T16:45:40Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2554196828",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2557138710"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557138710"
                }
            },
            "author_association": "MEMBER",
            "body": "super nit: would you mind keeping the comment about why we get only the first selection range here? looks like the other comments got deleted as well, but i don't think they're too important",
            "commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "created_at": "2025-11-24T17:24:24Z",
            "diff_hunk": "@@ -1434,63 +1437,58 @@ function M.selection_range(direction)\n     positions = { position_params.position },\n   }\n \n-  lsp.buf_request(\n-    0,\n-    method,\n-    params,\n-    ---@param response lsp.SelectionRange[]?\n-    function(err, response)\n-      if err then\n-        lsp.log.error(err.code, err.message)\n-        return\n-      end\n-      if not response then\n-        return\n-      end\n-      -- We only requested one range, thus we get the first and only response here.\n-      response = response[1]\n-      local ranges = {} ---@type lsp.Range[]\n-      local lines = api.nvim_buf_get_lines(0, 0, -1, false)\n-\n-      -- Populate the list of ranges from the given request.\n-      while response do\n-        local range = response.range\n-        if not is_empty(range) then\n-          local start_line = range.start.line\n-          local end_line = range['end'].line\n-          range.start.character = vim.str_byteindex(\n-            lines[start_line + 1] or '',\n-            client.offset_encoding,\n-            range.start.character,\n-            false\n-          )\n-          range['end'].character = vim.str_byteindex(\n-            lines[end_line + 1] or '',\n-            client.offset_encoding,\n-            range['end'].character,\n-            false\n-          )\n-          ranges[#ranges + 1] = range\n-        end\n-        response = response.parent\n-      end\n-\n-      -- Clear selection ranges when leaving visual mode.\n-      api.nvim_create_autocmd('ModeChanged', {\n-        once = true,\n-        pattern = 'v*:*',\n-        callback = function()\n-          selection_ranges = nil\n-        end,\n-      })\n+  timeout_ms = timeout_ms or 1000\n+  local result, err = lsp.buf_request_sync(0, method, params, timeout_ms)\n+  if err then\n+    lsp.log.error('selectionRange request failed: ' .. err)\n+    return\n+  end\n+  if not result or not result[client.id] or not result[client.id].result then\n+    return\n+  end\n+  if result[client.id].error then\n+    lsp.log.error(result[client.id].error.code, result[client.id].error.code)\n+  end\n \n-      if #ranges > 0 then\n-        local index = math.min(#ranges, math.max(1, direction))\n-        selection_ranges = { index = index, ranges = ranges }\n-        select_range(ranges[index])\n-      end\n+  local response = result[client.id].result[1] ---@type lsp.SelectionRange",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2557138710",
            "id": 2557138710,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YatcW",
            "original_commit_id": "5611be8f27fbab6606b1ad7dbfdb4ae49dad5750",
            "original_line": 1454,
            "original_position": 88,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3501481797,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557138710/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-24T17:24:32Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557138710",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
                "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
                "followers_url": "https://api.github.com/users/ribru17/followers",
                "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
                "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ribru17",
                "id": 55766287,
                "login": "ribru17",
                "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
                "organizations_url": "https://api.github.com/users/ribru17/orgs",
                "received_events_url": "https://api.github.com/users/ribru17/received_events",
                "repos_url": "https://api.github.com/users/ribru17/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ribru17",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2557150552"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557150552"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Whoops I didn't mean to leave out the comments. Let me add those back really quick",
            "commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "created_at": "2025-11-24T17:28:37Z",
            "diff_hunk": "@@ -1434,63 +1437,58 @@ function M.selection_range(direction)\n     positions = { position_params.position },\n   }\n \n-  lsp.buf_request(\n-    0,\n-    method,\n-    params,\n-    ---@param response lsp.SelectionRange[]?\n-    function(err, response)\n-      if err then\n-        lsp.log.error(err.code, err.message)\n-        return\n-      end\n-      if not response then\n-        return\n-      end\n-      -- We only requested one range, thus we get the first and only response here.\n-      response = response[1]\n-      local ranges = {} ---@type lsp.Range[]\n-      local lines = api.nvim_buf_get_lines(0, 0, -1, false)\n-\n-      -- Populate the list of ranges from the given request.\n-      while response do\n-        local range = response.range\n-        if not is_empty(range) then\n-          local start_line = range.start.line\n-          local end_line = range['end'].line\n-          range.start.character = vim.str_byteindex(\n-            lines[start_line + 1] or '',\n-            client.offset_encoding,\n-            range.start.character,\n-            false\n-          )\n-          range['end'].character = vim.str_byteindex(\n-            lines[end_line + 1] or '',\n-            client.offset_encoding,\n-            range['end'].character,\n-            false\n-          )\n-          ranges[#ranges + 1] = range\n-        end\n-        response = response.parent\n-      end\n-\n-      -- Clear selection ranges when leaving visual mode.\n-      api.nvim_create_autocmd('ModeChanged', {\n-        once = true,\n-        pattern = 'v*:*',\n-        callback = function()\n-          selection_ranges = nil\n-        end,\n-      })\n+  timeout_ms = timeout_ms or 1000\n+  local result, err = lsp.buf_request_sync(0, method, params, timeout_ms)\n+  if err then\n+    lsp.log.error('selectionRange request failed: ' .. err)\n+    return\n+  end\n+  if not result or not result[client.id] or not result[client.id].result then\n+    return\n+  end\n+  if result[client.id].error then\n+    lsp.log.error(result[client.id].error.code, result[client.id].error.code)\n+  end\n \n-      if #ranges > 0 then\n-        local index = math.min(#ranges, math.max(1, direction))\n-        selection_ranges = { index = index, ranges = ranges }\n-        select_range(ranges[index])\n-      end\n+  local response = result[client.id].result[1] ---@type lsp.SelectionRange",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2557150552",
            "id": 2557150552,
            "in_reply_to_id": 2557138710,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YawVY",
            "original_commit_id": "5611be8f27fbab6606b1ad7dbfdb4ae49dad5750",
            "original_line": 1454,
            "original_position": 88,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3501495804,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557150552/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-24T17:28:37Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557150552",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2557936005"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557936005"
                }
            },
            "author_association": "MEMBER",
            "body": "document parameters on the parameters, not in the middle of the body description.\n```suggestion\n--- @param timeout_ms integer? (default: `1000`) Maximum time (milliseconds) to wait for a result.\n```",
            "commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "created_at": "2025-11-24T22:41:42Z",
            "diff_hunk": "@@ -1405,11 +1405,14 @@ end\n \n --- Perform an incremental selection at the cursor position based on ranges given by the LSP. The\n --- `direction` parameter specifies the number of times to expand the selection. Negative values\n---- will shrink the selection.\n+--- will shrink the selection. `timeout_ms` parameter specifies the maximum time in milliseconds\n+--- to wait for a result (default: `1000`).\n ---\n --- @param direction integer\n-function M.selection_range(direction)\n+--- @param timeout_ms integer?",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2557936005",
            "id": 2557936005,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YdwGF",
            "original_commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "original_line": 1412,
            "original_position": 10,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3502509224,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557936005/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-24T22:41:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557936005",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2557937905"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557937905"
                }
            },
            "author_association": "MEMBER",
            "body": "is it intentional that `result[client.id].error.code` is passed twice?",
            "commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "created_at": "2025-11-24T22:42:21Z",
            "diff_hunk": "@@ -1434,63 +1437,61 @@ function M.selection_range(direction)\n     positions = { position_params.position },\n   }\n \n-  lsp.buf_request(\n-    0,\n-    method,\n-    params,\n-    ---@param response lsp.SelectionRange[]?\n-    function(err, response)\n-      if err then\n-        lsp.log.error(err.code, err.message)\n-        return\n-      end\n-      if not response then\n-        return\n-      end\n-      -- We only requested one range, thus we get the first and only response here.\n-      response = response[1]\n-      local ranges = {} ---@type lsp.Range[]\n-      local lines = api.nvim_buf_get_lines(0, 0, -1, false)\n-\n-      -- Populate the list of ranges from the given request.\n-      while response do\n-        local range = response.range\n-        if not is_empty(range) then\n-          local start_line = range.start.line\n-          local end_line = range['end'].line\n-          range.start.character = vim.str_byteindex(\n-            lines[start_line + 1] or '',\n-            client.offset_encoding,\n-            range.start.character,\n-            false\n-          )\n-          range['end'].character = vim.str_byteindex(\n-            lines[end_line + 1] or '',\n-            client.offset_encoding,\n-            range['end'].character,\n-            false\n-          )\n-          ranges[#ranges + 1] = range\n-        end\n-        response = response.parent\n-      end\n-\n-      -- Clear selection ranges when leaving visual mode.\n-      api.nvim_create_autocmd('ModeChanged', {\n-        once = true,\n-        pattern = 'v*:*',\n-        callback = function()\n-          selection_ranges = nil\n-        end,\n-      })\n+  timeout_ms = timeout_ms or 1000\n+  local result, err = lsp.buf_request_sync(0, method, params, timeout_ms)\n+  if err then\n+    lsp.log.error('selectionRange request failed: ' .. err)\n+    return\n+  end\n+  if not result or not result[client.id] or not result[client.id].result then\n+    return\n+  end\n+  if result[client.id].error then\n+    lsp.log.error(result[client.id].error.code, result[client.id].error.code)",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2557937905",
            "id": 2557937905,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6Ydwjx",
            "original_commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "original_line": 1450,
            "original_position": 80,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3502511738,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557937905/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-24T22:42:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557937905",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2557945824"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557945824"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n  local response = assert(result[client.id].result[1]) ---@type lsp.SelectionRange\n```",
            "commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "created_at": "2025-11-24T22:44:48Z",
            "diff_hunk": "@@ -1434,63 +1437,61 @@ function M.selection_range(direction)\n     positions = { position_params.position },\n   }\n \n-  lsp.buf_request(\n-    0,\n-    method,\n-    params,\n-    ---@param response lsp.SelectionRange[]?\n-    function(err, response)\n-      if err then\n-        lsp.log.error(err.code, err.message)\n-        return\n-      end\n-      if not response then\n-        return\n-      end\n-      -- We only requested one range, thus we get the first and only response here.\n-      response = response[1]\n-      local ranges = {} ---@type lsp.Range[]\n-      local lines = api.nvim_buf_get_lines(0, 0, -1, false)\n-\n-      -- Populate the list of ranges from the given request.\n-      while response do\n-        local range = response.range\n-        if not is_empty(range) then\n-          local start_line = range.start.line\n-          local end_line = range['end'].line\n-          range.start.character = vim.str_byteindex(\n-            lines[start_line + 1] or '',\n-            client.offset_encoding,\n-            range.start.character,\n-            false\n-          )\n-          range['end'].character = vim.str_byteindex(\n-            lines[end_line + 1] or '',\n-            client.offset_encoding,\n-            range['end'].character,\n-            false\n-          )\n-          ranges[#ranges + 1] = range\n-        end\n-        response = response.parent\n-      end\n-\n-      -- Clear selection ranges when leaving visual mode.\n-      api.nvim_create_autocmd('ModeChanged', {\n-        once = true,\n-        pattern = 'v*:*',\n-        callback = function()\n-          selection_ranges = nil\n-        end,\n-      })\n+  timeout_ms = timeout_ms or 1000\n+  local result, err = lsp.buf_request_sync(0, method, params, timeout_ms)\n+  if err then\n+    lsp.log.error('selectionRange request failed: ' .. err)\n+    return\n+  end\n+  if not result or not result[client.id] or not result[client.id].result then\n+    return\n+  end\n+  if result[client.id].error then\n+    lsp.log.error(result[client.id].error.code, result[client.id].error.code)\n+  end\n \n-      if #ranges > 0 then\n-        local index = math.min(#ranges, math.max(1, direction))\n-        selection_ranges = { index = index, ranges = ranges }\n-        select_range(ranges[index])\n-      end\n+  -- We only requested one range, thus we get the first and only reponse here.\n+  local response = result[client.id].result[1] ---@type lsp.SelectionRange",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2557945824",
            "id": 2557945824,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6Ydyfg",
            "original_commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "original_line": 1454,
            "original_position": 89,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3502520934,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557945824/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-24T22:44:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2557945824",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36575#discussion_r2558049538"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36575"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2558049538"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "No, my bad. That second parameter is supposed to be `result[client.id].error.message`.\r\n\r\nFixing that now.",
            "commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "created_at": "2025-11-24T23:40:21Z",
            "diff_hunk": "@@ -1434,63 +1437,61 @@ function M.selection_range(direction)\n     positions = { position_params.position },\n   }\n \n-  lsp.buf_request(\n-    0,\n-    method,\n-    params,\n-    ---@param response lsp.SelectionRange[]?\n-    function(err, response)\n-      if err then\n-        lsp.log.error(err.code, err.message)\n-        return\n-      end\n-      if not response then\n-        return\n-      end\n-      -- We only requested one range, thus we get the first and only response here.\n-      response = response[1]\n-      local ranges = {} ---@type lsp.Range[]\n-      local lines = api.nvim_buf_get_lines(0, 0, -1, false)\n-\n-      -- Populate the list of ranges from the given request.\n-      while response do\n-        local range = response.range\n-        if not is_empty(range) then\n-          local start_line = range.start.line\n-          local end_line = range['end'].line\n-          range.start.character = vim.str_byteindex(\n-            lines[start_line + 1] or '',\n-            client.offset_encoding,\n-            range.start.character,\n-            false\n-          )\n-          range['end'].character = vim.str_byteindex(\n-            lines[end_line + 1] or '',\n-            client.offset_encoding,\n-            range['end'].character,\n-            false\n-          )\n-          ranges[#ranges + 1] = range\n-        end\n-        response = response.parent\n-      end\n-\n-      -- Clear selection ranges when leaving visual mode.\n-      api.nvim_create_autocmd('ModeChanged', {\n-        once = true,\n-        pattern = 'v*:*',\n-        callback = function()\n-          selection_ranges = nil\n-        end,\n-      })\n+  timeout_ms = timeout_ms or 1000\n+  local result, err = lsp.buf_request_sync(0, method, params, timeout_ms)\n+  if err then\n+    lsp.log.error('selectionRange request failed: ' .. err)\n+    return\n+  end\n+  if not result or not result[client.id] or not result[client.id].result then\n+    return\n+  end\n+  if result[client.id].error then\n+    lsp.log.error(result[client.id].error.code, result[client.id].error.code)",
            "html_url": "https://github.com/neovim/neovim/pull/36575#discussion_r2558049538",
            "id": 2558049538,
            "in_reply_to_id": 2557937905,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6YeL0C",
            "original_commit_id": "9eca8895a377afd1441740ae7bbd78020b1b4669",
            "original_line": 1450,
            "original_position": 80,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/buf.lua",
            "position": 1,
            "pull_request_review_id": 3502649773,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2558049538/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-24T23:40:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2558049538",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thank you @justinmk, @ribru17 and @mfussenegger for the reviews and guidance! I really appreciate the help on my first open source contribution!",
            "created_at": "2025-11-25T01:39:03Z",
            "html_url": "https://github.com/neovim/neovim/pull/36575#issuecomment-3573420132",
            "id": 3573420132,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36575",
            "node_id": "IC_kwDOAPphoM7U_hBk",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 1,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3573420132/reactions"
            },
            "updated_at": "2025-11-25T01:39:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3573420132",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36575/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/36575/commits",
    "created_at": "2025-11-16T20:28:47Z",
    "diff_url": "https://github.com/neovim/neovim/pull/36575.diff",
    "draft": false,
    "head": {
        "label": "brandencall:feat/lsp-operator-selection",
        "ref": "feat/lsp-operator-selection",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/brandencall/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/brandencall/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/brandencall/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/brandencall/neovim/branches{/branch}",
            "clone_url": "https://github.com/brandencall/neovim.git",
            "collaborators_url": "https://api.github.com/repos/brandencall/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/brandencall/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/brandencall/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/brandencall/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/brandencall/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/brandencall/neovim/contributors",
            "created_at": "2025-11-14T15:11:01Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/brandencall/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/brandencall/neovim/downloads",
            "events_url": "https://api.github.com/repos/brandencall/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/brandencall/neovim/forks",
            "full_name": "brandencall/neovim",
            "git_commits_url": "https://api.github.com/repos/brandencall/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/brandencall/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/brandencall/neovim/git/tags{/sha}",
            "git_url": "git://github.com/brandencall/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/brandencall/neovim/hooks",
            "html_url": "https://github.com/brandencall/neovim",
            "id": 1096535297,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/brandencall/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/brandencall/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/brandencall/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/brandencall/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/brandencall/neovim/labels{/name}",
            "language": null,
            "languages_url": "https://api.github.com/repos/brandencall/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/brandencall/neovim/merges",
            "milestones_url": "https://api.github.com/repos/brandencall/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOQVvNAQ",
            "notifications_url": "https://api.github.com/repos/brandencall/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
                "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
                "followers_url": "https://api.github.com/users/brandencall/followers",
                "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
                "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/brandencall",
                "id": 54908229,
                "login": "brandencall",
                "node_id": "MDQ6VXNlcjU0OTA4MjI5",
                "organizations_url": "https://api.github.com/users/brandencall/orgs",
                "received_events_url": "https://api.github.com/users/brandencall/received_events",
                "repos_url": "https://api.github.com/users/brandencall/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/brandencall",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/brandencall/neovim/pulls{/number}",
            "pushed_at": "2025-11-24T23:41:38Z",
            "releases_url": "https://api.github.com/repos/brandencall/neovim/releases{/id}",
            "size": 340306,
            "ssh_url": "git@github.com:brandencall/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/brandencall/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/brandencall/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/brandencall/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/brandencall/neovim/subscription",
            "svn_url": "https://github.com/brandencall/neovim",
            "tags_url": "https://api.github.com/repos/brandencall/neovim/tags",
            "teams_url": "https://api.github.com/repos/brandencall/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/brandencall/neovim/git/trees{/sha}",
            "updated_at": "2025-11-14T15:11:01Z",
            "url": "https://api.github.com/repos/brandencall/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "9ab28effcc9ae4f013c56990dc1750e0c7b3e171",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
            "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
            "followers_url": "https://api.github.com/users/brandencall/followers",
            "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
            "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/brandencall",
            "id": 54908229,
            "login": "brandencall",
            "node_id": "MDQ6VXNlcjU0OTA4MjI5",
            "organizations_url": "https://api.github.com/users/brandencall/orgs",
            "received_events_url": "https://api.github.com/users/brandencall/received_events",
            "repos_url": "https://api.github.com/users/brandencall/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/brandencall",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/36575",
    "id": 3015574815,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36575",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "Nvim defaults for options, colorscheme/theme, autocmds/events, etc.",
            "id": 103777064,
            "name": "defaults",
            "node_id": "MDU6TGFiZWwxMDM3NzcwNjQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/defaults"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        },
        {
            "color": "0052CC",
            "default": false,
            "description": "",
            "id": 6664957181,
            "name": "ci:skip-news",
            "node_id": "LA_kwDOAPphoM8AAAABjUMs_Q",
            "url": "https://api.github.com/repos/neovim/neovim/labels/ci:skip-news"
        }
    ],
    "locked": false,
    "merge_commit_sha": "e82aef2e22a57688dcc19a978cbe083349ad8a2a",
    "merged_at": "2025-11-25T01:10:51Z",
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6zvgUf",
    "number": 36575,
    "patch_url": "https://github.com/neovim/neovim/pull/36575.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/36575/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/9ab28effcc9ae4f013c56990dc1750e0c7b3e171",
    "title": "feat(lsp): operator pending mode for textobjects",
    "updated_at": "2025-11-25T01:39:04Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/36575",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/54908229?v=4",
        "events_url": "https://api.github.com/users/brandencall/events{/privacy}",
        "followers_url": "https://api.github.com/users/brandencall/followers",
        "following_url": "https://api.github.com/users/brandencall/following{/other_user}",
        "gists_url": "https://api.github.com/users/brandencall/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/brandencall",
        "id": 54908229,
        "login": "brandencall",
        "node_id": "MDQ6VXNlcjU0OTA4MjI5",
        "organizations_url": "https://api.github.com/users/brandencall/orgs",
        "received_events_url": "https://api.github.com/users/brandencall/received_events",
        "repos_url": "https://api.github.com/users/brandencall/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/brandencall/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/brandencall/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/brandencall",
        "user_view_type": "public"
    }
}
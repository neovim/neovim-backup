{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/33007/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/33007/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/33007"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/33007"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/33007/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/17b14f16a62e898e620af221e18aaa86b5eca822"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 5947,
            "forks_count": 5947,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 1887,
            "open_issues_count": 1887,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-03-25T00:05:23Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 313207,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 87566,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-03-25T02:32:27Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 87566,
            "watchers_count": 87566,
            "web_commit_signoff_required": false
        },
        "sha": "c98260822699bf622b14caffc908a47039deca51",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "Fix https://github.com/neovim/neovim/issues/33003.\r\n\r\nProblem:\r\n`:lua vim.lsp.c<tab>` does not list vim.lsp.completion in the completion list after [`24cea4c` (#27216)](https://github.com/neovim/neovim/pull/27216/commits/24cea4c7f7417c7fe99a98a0487f51dd68c4f409).\r\nThis happened on all defer_require() modules.\r\n\r\nSolution:\r\nInclude keys in `vim.lsp._submodule` into candidates.\r\nFix `vim.lsp.c<tab>` -> `vim.lsp.completion`.\r\n\r\n~~Call `mt.__index` function to ensure module loaded to get its key.~~\r\nEager-load `vim.lsp.completion` to get its completion.\r\nFix `vim.lsp.completion.g<tab>` -> `vim.lsp.completion.get`.\r\n",
    "closed_at": "2025-03-24T12:14:22Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2006319476"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006319476"
                }
            },
            "author_association": "MEMBER",
            "body": "nit: this test probably belongs just after line 930, since that describe() block is related to Lua completion.\r\n\r\nthen its desc can be:\r\n\r\n```suggestion\r\n  it('completes _defer_require() modules', function()\r\n```",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-20T19:29:54Z",
            "diff_hunk": "@@ -945,6 +945,19 @@ describe('completion', function()\n     end\n   end)\n \n+  it('cmdline completion include `_defer_require` module', function()",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2006319476",
            "id": 2006319476,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53lgF0",
            "original_commit_id": "6b651261095e8b920865d36ef9b832d310e882fd",
            "original_line": 948,
            "original_position": 4,
            "original_start_line": null,
            "path": "test/functional/editor/completion_spec.lua",
            "position": null,
            "pull_request_review_id": 2703890717,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006319476/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-03-20T19:29:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006319476",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2006321896"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006321896"
                }
            },
            "author_association": "MEMBER",
            "body": "`tbl_contains()` ? same for the other case\r\n\r\n```suggestion\r\n    ok(vim.tbl_contains(fn.getcompletion('lua vim.lsp.c', 'cmdline'), 'completion'))\r\n```",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-20T19:32:01Z",
            "diff_hunk": "@@ -945,6 +945,19 @@ describe('completion', function()\n     end\n   end)\n \n+  it('cmdline completion include `_defer_require` module', function()\n+    -- vim.lsp.c<tab> -> vim.lsp.completion\n+    eq(\n+      'completion',\n+      table.concat(fn.getcompletion('lua vim.lsp.c', 'cmdline'), ':'):match('completion')\n+    )",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2006321896",
            "id": 2006321896,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53lgro",
            "original_commit_id": "6b651261095e8b920865d36ef9b832d310e882fd",
            "original_line": 953,
            "original_position": 9,
            "original_start_line": 950,
            "path": "test/functional/editor/completion_spec.lua",
            "position": null,
            "pull_request_review_id": 2703894672,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006321896/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-03-20T19:32:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006321896",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2006334648"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006334648"
                }
            },
            "author_association": "MEMBER",
            "body": "does this work (and avoids future maintenance)?\r\n```suggestion\r\n  elseif final_env._submodules then\r\n```\r\n\r\n",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-20T19:40:27Z",
            "diff_hunk": "@@ -997,6 +1000,10 @@ function vim._expand_pat(pat, env)\n     insert_keys(vim._extra)\n   end\n \n+  if final_env == vim.lsp or final_env == vim.treesitter or final_env == vim.provider then",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2006334648",
            "id": 2006334648,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53ljy4",
            "original_commit_id": "6b651261095e8b920865d36ef9b832d310e882fd",
            "original_line": 1003,
            "original_position": 14,
            "original_start_line": 1001,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2703917042,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006334648/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-03-20T19:40:28Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2006334648",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2007236276"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007236276"
                }
            },
            "author_association": "MEMBER",
            "body": "From @bfredl : \r\n\r\n> the original rationality for not using `final_env[key]` unconditionally was to avoid surprising arbitrary code execution in an arbitrary environment (`__index` can be a function. not from a \"security\" side-point, more like avoiding surprising side-effects standpoint), but maybe it's fine.\r\n>\r\n> the alternative would be to change `final_env == vim and (vim._submodules[key] or vim._extra[key])` to `final_env._submodules and final_env._submodules[key]` . and same for `_extra`\r\n",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-21T09:56:42Z",
            "diff_hunk": "@@ -947,16 +947,7 @@ function vim._expand_pat(pat, env)\n \n       key = result\n     end\n-    local field = rawget(final_env, key)\n-    if field == nil then\n-      local mt = getmetatable(final_env)\n-      if mt and type(mt.__index) == 'table' then\n-        field = rawget(mt.__index, key)\n-      elseif final_env == vim and (vim._submodules[key] or vim._extra[key]) then\n-        field = vim[key] --- @type any\n-      end\n-    end\n-    final_env = field\n+    final_env = final_env[key] ---@type any",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2007236276",
            "id": 2007236276,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53o_60",
            "original_commit_id": "ab4bbb16762a0a70ace5bc2a72e8b503a0f0a660",
            "original_line": 950,
            "original_position": 14,
            "original_start_line": 955,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2705357370,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007236276/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "LEFT",
            "subject_type": "line",
            "updated_at": "2025-03-21T09:56:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007236276",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2007322593"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007322593"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "But for all `_defer_required` module, if we don't finally require/index its parent, we cannot get its completion (e.g. `vim.lsp.completion.g<tab>`), unless do something like this:\r\n```diff\r\nlocal lsp = vim._defer_require('vim.lsp', {\r\n-  completion = ..., --- @module 'vim.lsp.completion'\r\n+  completion = { get = true, ... }, },\r\n```\r\n\r\nEDIT:\r\n> the alternative would be to change `final_env == vim and (vim._submodules[key] or vim._extra[key])` to `final_env._submodules and final_env._submodules[key]` . and same for `_extra`\r\n\r\nI seems got it... I was trying to index by `final_env = final_env._submodules[key]` to avoid require the file.\r\n\r\nBut does this means we can apply a `final_env = final_env[key]` to require the file listed in `._submodules`/`_extra` (at least better than unconditionally indexing.\r\n\r\nPushed a fixup, maybe now it feel better?",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-21T10:46:53Z",
            "diff_hunk": "@@ -947,16 +947,7 @@ function vim._expand_pat(pat, env)\n \n       key = result\n     end\n-    local field = rawget(final_env, key)\n-    if field == nil then\n-      local mt = getmetatable(final_env)\n-      if mt and type(mt.__index) == 'table' then\n-        field = rawget(mt.__index, key)\n-      elseif final_env == vim and (vim._submodules[key] or vim._extra[key]) then\n-        field = vim[key] --- @type any\n-      end\n-    end\n-    final_env = field\n+    final_env = final_env[key] ---@type any",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2007322593",
            "id": 2007322593,
            "in_reply_to_id": 2007236276,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53pU_h",
            "original_commit_id": "ab4bbb16762a0a70ace5bc2a72e8b503a0f0a660",
            "original_line": 950,
            "original_position": 14,
            "original_start_line": 955,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2705498196,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007322593/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "LEFT",
            "subject_type": "line",
            "updated_at": "2025-03-21T11:09:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007322593",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91544758?v=4",
                "events_url": "https://api.github.com/users/phanen/events{/privacy}",
                "followers_url": "https://api.github.com/users/phanen/followers",
                "following_url": "https://api.github.com/users/phanen/following{/other_user}",
                "gists_url": "https://api.github.com/users/phanen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/phanen",
                "id": 91544758,
                "login": "phanen",
                "node_id": "U_kgDOBXTctg",
                "organizations_url": "https://api.github.com/users/phanen/orgs",
                "received_events_url": "https://api.github.com/users/phanen/received_events",
                "repos_url": "https://api.github.com/users/phanen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/phanen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/phanen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/phanen",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2007365591"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007365591"
                }
            },
            "author_association": "MEMBER",
            "body": "use parens to make the intended logic here more obvious",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-21T11:17:42Z",
            "diff_hunk": "@@ -952,8 +952,11 @@ function vim._expand_pat(pat, env)\n       local mt = getmetatable(final_env)\n       if mt and type(mt.__index) == 'table' then\n         field = rawget(mt.__index, key)\n-      elseif final_env == vim and (vim._submodules[key] or vim._extra[key]) then\n-        field = vim[key] --- @type any\n+      elseif\n+        final_env._submodules and final_env._submodules[key]\n+        or final_env._extra and final_env._extra[key]",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2007365591",
            "id": 2007365591,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53pffX",
            "original_commit_id": "4e50fb0452da0837139d273d7eb190717c2b27f0",
            "original_line": 957,
            "original_position": 8,
            "original_start_line": 956,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2705572152,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007365591/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-03-21T11:17:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007365591",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2007367005"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007367005"
                }
            },
            "author_association": "MEMBER",
            "body": "nit\r\n```suggestion\r\n    eq({ { 'treesitter' }, 4 }, get_completions('vim.treesi'))\r\n    eq({ { 'dev' }, 15 }, get_completions('vim.treesitter.de'))\r\n    eq({ { 'edit_query' }, 19 }, get_completions('vim.treesitter.dev.edit_'))\r\n```",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-21T11:18:49Z",
            "diff_hunk": "@@ -102,6 +102,10 @@ describe('nlua_expand_pat', function()\n \n     eq({ { 'treesitter' }, 4 }, get_completions('vim.treesi'))\n \n+    eq({ { 'dev' }, 15 }, get_completions('vim.treesitter.de'))\n+\n+    eq({ { 'edit_query' }, 19 }, get_completions('vim.treesitter.dev.edit_'))\n+",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2007367005",
            "id": 2007367005,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53pf1d",
            "original_commit_id": "4e50fb0452da0837139d273d7eb190717c2b27f0",
            "original_line": 108,
            "original_position": 7,
            "original_start_line": 102,
            "path": "test/functional/lua/command_line_completion_spec.lua",
            "position": null,
            "pull_request_review_id": 2705574371,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007367005/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-03-21T11:18:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007367005",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2007721547"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007721547"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "~Found some edge case: `vim.o.foo.bar`, `vim.fn.foo.bar` both throw error now. I should fix it...~ DONE",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-21T14:36:04Z",
            "diff_hunk": "@@ -947,16 +947,7 @@ function vim._expand_pat(pat, env)\n \n       key = result\n     end\n-    local field = rawget(final_env, key)\n-    if field == nil then\n-      local mt = getmetatable(final_env)\n-      if mt and type(mt.__index) == 'table' then\n-        field = rawget(mt.__index, key)\n-      elseif final_env == vim and (vim._submodules[key] or vim._extra[key]) then\n-        field = vim[key] --- @type any\n-      end\n-    end\n-    final_env = field\n+    final_env = final_env[key] ---@type any",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2007721547",
            "id": 2007721547,
            "in_reply_to_id": 2007236276,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53q2ZL",
            "original_commit_id": "ab4bbb16762a0a70ace5bc2a72e8b503a0f0a660",
            "original_line": 950,
            "original_position": 14,
            "original_start_line": 955,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2706188071,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007721547/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "LEFT",
            "subject_type": "line",
            "updated_at": "2025-03-22T10:15:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2007721547",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91544758?v=4",
                "events_url": "https://api.github.com/users/phanen/events{/privacy}",
                "followers_url": "https://api.github.com/users/phanen/followers",
                "following_url": "https://api.github.com/users/phanen/following{/other_user}",
                "gists_url": "https://api.github.com/users/phanen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/phanen",
                "id": 91544758,
                "login": "phanen",
                "node_id": "U_kgDOBXTctg",
                "organizations_url": "https://api.github.com/users/phanen/orgs",
                "received_events_url": "https://api.github.com/users/phanen/received_events",
                "repos_url": "https://api.github.com/users/phanen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/phanen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/phanen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/phanen",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2009093564"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009093564"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\r\n    local val = rawget(m, k)\r\n    if val ~= nil then\r\n      return val\r\n    end\r\n```",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-23T11:58:56Z",
            "diff_hunk": "@@ -917,6 +917,30 @@ function vim._expand_pat(pat, env)\n \n   local final_env = env\n \n+  --- @param m table\n+  --- @param k string\n+  --- @return any\n+  local function safe_tbl_get(m, k)\n+    if rawget(m, k) then\n+      return rawget(m, k)\n+    end",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2009093564",
            "id": 2009093564,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53wFW8",
            "original_commit_id": "dd09ab3af57ee3aff2e6bb07b92888cfb66436ca",
            "original_line": 934,
            "original_position": 10,
            "original_start_line": 924,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2708551613,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009093564/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-03-23T11:59:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009093564",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/41671631?v=4",
                "events_url": "https://api.github.com/users/glepnir/events{/privacy}",
                "followers_url": "https://api.github.com/users/glepnir/followers",
                "following_url": "https://api.github.com/users/glepnir/following{/other_user}",
                "gists_url": "https://api.github.com/users/glepnir/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/glepnir",
                "id": 41671631,
                "login": "glepnir",
                "node_id": "MDQ6VXNlcjQxNjcxNjMx",
                "organizations_url": "https://api.github.com/users/glepnir/orgs",
                "received_events_url": "https://api.github.com/users/glepnir/received_events",
                "repos_url": "https://api.github.com/users/glepnir/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/glepnir/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glepnir/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/glepnir",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2009280456"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009280456"
                }
            },
            "author_association": "MEMBER",
            "body": "Just noticed this in the commit message:\r\n\r\n> Always access `._submodules` field to ensure `_defer_require` module loaded.\r\n\r\nThat is a rather important thing to clearly call out. Starting with this code comment. Is this comment correct?:\r\n\r\n\r\n```suggestion\r\n      -- Access the module to force _defer_require() to load the module.\r\n      return m[k]\r\n```",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-23T22:50:38Z",
            "diff_hunk": "@@ -917,6 +917,31 @@ function vim._expand_pat(pat, env)\n \n   local final_env = env\n \n+  --- @param m table\n+  --- @param k string\n+  --- @return any\n+  local function safe_tbl_get(m, k)\n+    local val = rawget(m, k)\n+    if val ~= nil then\n+      return val\n+    end\n+\n+    local mt = getmetatable(m)\n+    if not mt then\n+      return m == vim and vim._extra[k] or nil\n+    end\n+\n+    -- use mt.__index, _submodules as fallback\n+    if type(mt.__index) == 'table' then\n+      return rawget(mt.__index, k)\n+    end\n+\n+    local sub = rawget(m, '_submodules')\n+    if sub and type(sub) == 'table' and rawget(sub, k) then\n+      return m[k] -- access to required module",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2009280456",
            "id": 2009280456,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53wy_I",
            "original_commit_id": "f7fb848f296ac56738f33b0aa891ecb289052505",
            "original_line": 941,
            "original_position": 25,
            "original_start_line": null,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2708837739,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009280456/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-03-23T22:50:39Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009280456",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/33007#discussion_r2009353806"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/33007"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009353806"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Yes. I should elaborate on it..",
            "commit_id": "17b14f16a62e898e620af221e18aaa86b5eca822",
            "created_at": "2025-03-24T01:58:08Z",
            "diff_hunk": "@@ -917,6 +917,31 @@ function vim._expand_pat(pat, env)\n \n   local final_env = env\n \n+  --- @param m table\n+  --- @param k string\n+  --- @return any\n+  local function safe_tbl_get(m, k)\n+    local val = rawget(m, k)\n+    if val ~= nil then\n+      return val\n+    end\n+\n+    local mt = getmetatable(m)\n+    if not mt then\n+      return m == vim and vim._extra[k] or nil\n+    end\n+\n+    -- use mt.__index, _submodules as fallback\n+    if type(mt.__index) == 'table' then\n+      return rawget(mt.__index, k)\n+    end\n+\n+    local sub = rawget(m, '_submodules')\n+    if sub and type(sub) == 'table' and rawget(sub, k) then\n+      return m[k] -- access to required module",
            "html_url": "https://github.com/neovim/neovim/pull/33007#discussion_r2009353806",
            "id": 2009353806,
            "in_reply_to_id": 2009280456,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM53xE5O",
            "original_commit_id": "f7fb848f296ac56738f33b0aa891ecb289052505",
            "original_line": 941,
            "original_position": 25,
            "original_start_line": null,
            "path": "runtime/lua/vim/_editor.lua",
            "position": null,
            "pull_request_review_id": 2708945061,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009353806/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-03-24T01:58:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2009353806",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91544758?v=4",
                "events_url": "https://api.github.com/users/phanen/events{/privacy}",
                "followers_url": "https://api.github.com/users/phanen/followers",
                "following_url": "https://api.github.com/users/phanen/following{/other_user}",
                "gists_url": "https://api.github.com/users/phanen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/phanen",
                "id": 91544758,
                "login": "phanen",
                "node_id": "U_kgDOBXTctg",
                "organizations_url": "https://api.github.com/users/phanen/orgs",
                "received_events_url": "https://api.github.com/users/phanen/received_events",
                "repos_url": "https://api.github.com/users/phanen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/phanen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/phanen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/phanen",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "MEMBER",
            "body": "Does [this](https://github.com/neovim/neovim/pull/33007#discussion_r2009280456) mean that cmdline completion of `vim.*` will un-defer a `_defer_require` module? If so, please update the docstring of `_defer_require`:\r\n\r\n```diff\r\ndiff --git a/runtime/lua/vim/shared.lua b/runtime/lua/vim/shared.lua\r\nindex 3aeda1586ddd..de727a2f86aa 100644\r\n--- a/runtime/lua/vim/shared.lua\r\n+++ b/runtime/lua/vim/shared.lua\r\n@@ -1182,6 +1182,11 @@ do\r\n end\r\n \r\n --- @private\r\n+---\r\n+--- Allows submodules to be defined on a `vim.<module>` table without eager-loading the module.\r\n+---\r\n+--- Cmdline completion (`:lua vim.lsp.c<tab>`) will eager-load the module anyway. #33007\r\n+---\r\n --- @generic T\r\n --- @param root string\r\n --- @param mod T\r\n```",
            "created_at": "2025-03-23T23:01:07Z",
            "html_url": "https://github.com/neovim/neovim/pull/33007#issuecomment-2746528659",
            "id": 2746528659,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33007",
            "node_id": "IC_kwDOAPphoM6jtLOT",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2746528659/reactions"
            },
            "updated_at": "2025-03-24T12:09:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2746528659",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "> Does [this](https://github.com/neovim/neovim/pull/33007#discussion_r2009280456) mean that cmdline completion of `vim.*` will un-defer a `_defer_require` module? If so, please update the docstring of `_defer_require`:\r\n\r\nYes, but a small correction:\r\n* `vim.lsp.c<tab>` get candidates by `insert_keys(rawget(vim.lsp, \"_submodules\"))` (so it doesn't trigger a `require`)\r\n* `vim.lsp.completion.g<tab>` get candidates by `insert_keys(vim.lsp.completion)`:\r\n```patch\r\n---- Cmdline completion (`:lua vim.lsp.c<tab>`) will eager-load the module anyway. #33007\r\n----\r\n+--- Cmdline completion (`:lua vim.lsp.c<tab>`) accesses `vim.lsp._submodules` when no other candidates.\r\n+--- Cmdline completion (`:lua vim.lsp.completion.g<tab>`) will eager-load the module anyway. #33007\r\n+---\r\n```",
            "created_at": "2025-03-24T01:36:10Z",
            "html_url": "https://github.com/neovim/neovim/pull/33007#issuecomment-2746658865",
            "id": 2746658865,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33007",
            "node_id": "IC_kwDOAPphoM6jtrAx",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2746658865/reactions"
            },
            "updated_at": "2025-03-24T01:41:30Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2746658865",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91544758?v=4",
                "events_url": "https://api.github.com/users/phanen/events{/privacy}",
                "followers_url": "https://api.github.com/users/phanen/followers",
                "following_url": "https://api.github.com/users/phanen/following{/other_user}",
                "gists_url": "https://api.github.com/users/phanen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/phanen",
                "id": 91544758,
                "login": "phanen",
                "node_id": "U_kgDOBXTctg",
                "organizations_url": "https://api.github.com/users/phanen/orgs",
                "received_events_url": "https://api.github.com/users/phanen/received_events",
                "repos_url": "https://api.github.com/users/phanen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/phanen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/phanen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/phanen",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Ok, that's good!",
            "created_at": "2025-03-24T12:10:05Z",
            "html_url": "https://github.com/neovim/neovim/pull/33007#issuecomment-2747914817",
            "id": 2747914817,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33007",
            "node_id": "IC_kwDOAPphoM6jydpB",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2747914817/reactions"
            },
            "updated_at": "2025-03-24T12:10:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2747914817",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/33007/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/33007/commits",
    "created_at": "2025-03-20T13:55:35Z",
    "diff_url": "https://github.com/neovim/neovim/pull/33007.diff",
    "draft": false,
    "head": {
        "label": "phanen:fix-completion-defer-require-module",
        "ref": "fix-completion-defer-require-module",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/phanen/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/phanen/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/phanen/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/phanen/neovim/branches{/branch}",
            "clone_url": "https://github.com/phanen/neovim.git",
            "collaborators_url": "https://api.github.com/repos/phanen/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/phanen/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/phanen/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/phanen/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/phanen/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/phanen/neovim/contributors",
            "created_at": "2024-03-01T09:10:43Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/phanen/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/phanen/neovim/downloads",
            "events_url": "https://api.github.com/repos/phanen/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/phanen/neovim/forks",
            "full_name": "phanen/neovim",
            "git_commits_url": "https://api.github.com/repos/phanen/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/phanen/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/phanen/neovim/git/tags{/sha}",
            "git_url": "git://github.com/phanen/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/phanen/neovim/hooks",
            "html_url": "https://github.com/phanen/neovim",
            "id": 765611046,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/phanen/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/phanen/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/phanen/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/phanen/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/phanen/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/phanen/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/phanen/neovim/merges",
            "milestones_url": "https://api.github.com/repos/phanen/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOLaJMJg",
            "notifications_url": "https://api.github.com/repos/phanen/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/91544758?v=4",
                "events_url": "https://api.github.com/users/phanen/events{/privacy}",
                "followers_url": "https://api.github.com/users/phanen/followers",
                "following_url": "https://api.github.com/users/phanen/following{/other_user}",
                "gists_url": "https://api.github.com/users/phanen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/phanen",
                "id": 91544758,
                "login": "phanen",
                "node_id": "U_kgDOBXTctg",
                "organizations_url": "https://api.github.com/users/phanen/orgs",
                "received_events_url": "https://api.github.com/users/phanen/received_events",
                "repos_url": "https://api.github.com/users/phanen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/phanen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/phanen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/phanen",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/phanen/neovim/pulls{/number}",
            "pushed_at": "2025-03-24T05:30:22Z",
            "releases_url": "https://api.github.com/repos/phanen/neovim/releases{/id}",
            "size": 310567,
            "ssh_url": "git@github.com:phanen/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/phanen/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/phanen/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/phanen/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/phanen/neovim/subscription",
            "svn_url": "https://github.com/phanen/neovim",
            "tags_url": "https://api.github.com/repos/phanen/neovim/tags",
            "teams_url": "https://api.github.com/repos/phanen/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/phanen/neovim/git/trees{/sha}",
            "updated_at": "2025-01-21T04:48:04Z",
            "url": "https://api.github.com/repos/phanen/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "17b14f16a62e898e620af221e18aaa86b5eca822",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/91544758?v=4",
            "events_url": "https://api.github.com/users/phanen/events{/privacy}",
            "followers_url": "https://api.github.com/users/phanen/followers",
            "following_url": "https://api.github.com/users/phanen/following{/other_user}",
            "gists_url": "https://api.github.com/users/phanen/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/phanen",
            "id": 91544758,
            "login": "phanen",
            "node_id": "U_kgDOBXTctg",
            "organizations_url": "https://api.github.com/users/phanen/orgs",
            "received_events_url": "https://api.github.com/users/phanen/received_events",
            "repos_url": "https://api.github.com/users/phanen/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/phanen/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/phanen/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/phanen",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/33007",
    "id": 2407066383,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/33007",
    "labels": [
        {
            "color": "C5DEF5",
            "default": false,
            "description": "Nvim built-in (omni)completion",
            "id": 3214348835,
            "name": "completion",
            "node_id": "MDU6TGFiZWwzMjE0MzQ4ODM1",
            "url": "https://api.github.com/repos/neovim/neovim/labels/completion"
        }
    ],
    "locked": false,
    "merge_commit_sha": "af4231d4070c8d664b919f5466a827905881ef32",
    "merged_at": "2025-03-24T12:14:22Z",
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6PeOsP",
    "number": 33007,
    "patch_url": "https://github.com/neovim/neovim/pull/33007.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/33007/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/17b14f16a62e898e620af221e18aaa86b5eca822",
    "title": "fix(completion): cmdline completion does not complete items for `_defer_require` module",
    "updated_at": "2025-03-24T12:14:23Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/33007",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/91544758?v=4",
        "events_url": "https://api.github.com/users/phanen/events{/privacy}",
        "followers_url": "https://api.github.com/users/phanen/followers",
        "following_url": "https://api.github.com/users/phanen/following{/other_user}",
        "gists_url": "https://api.github.com/users/phanen/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/phanen",
        "id": 91544758,
        "login": "phanen",
        "node_id": "U_kgDOBXTctg",
        "organizations_url": "https://api.github.com/users/phanen/orgs",
        "received_events_url": "https://api.github.com/users/phanen/received_events",
        "repos_url": "https://api.github.com/users/phanen/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/phanen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/phanen/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/phanen",
        "user_view_type": "public"
    }
}
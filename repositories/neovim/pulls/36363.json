{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36363/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36363/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/36363"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36363"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36363/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/4a17851882289aa125715792f952c08a7aec7072"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "FIRST_TIME_CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 6416,
            "forks_count": 6416,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 2049,
            "open_issues_count": 2049,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-11-18T01:49:14Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 351477,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 94330,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-11-18T01:55:51Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 94330,
            "watchers_count": 94330,
            "web_commit_signoff_required": false
        },
        "sha": "59a44caac64c52e9e48c7d1da37d49fabf44db05",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "### Problem\r\n\r\nNeovim no longer ships with a tee binary on Windows, which breaks functionality for the :grep and :make commands.\r\n\r\n### Solution\r\n\r\nInclude a simple, no-dependency tee.c source file in the src/ directory. Update CMakeLists.txt to build a tee executable alongside neovim during the build process, and ensure the tee.exe program appears alongside the neovim executable in the bin/ directory so that it is accessible for :grep and :make.\r\n\r\nThe tee.c was obtained from the vim codebase [here](https://github.com/vim/vim/blob/master/src/tee/tee.c). I ran a search of the strings in the tee binary that used to ship with neovim; strings that appeared in the binary show that this tee.c was very likely the source of that binary. I considered other available tee sources (see below), but felt that this was by far the most simple option for restoring the desired functionality. It builds without any required tinkering. \r\n\r\n### How to reproduce (before)\r\n\r\nOn Windows:\r\n\r\nnvim --clean\r\n:grep foo or :make, after setting a file to the makeprg option.\r\n\r\n<img width=\"887\" height=\"172\" alt=\"Screenshot 2025-10-27 134646\" src=\"https://github.com/user-attachments/assets/4c633f58-f4bd-49c9-a89e-d9bd426d99be\" />\r\n\r\n### How to verify (after)\r\n\r\nnvim --clean\r\n:grep foo or :make, after setting a file to the makeprg option.\r\nVerify that :grep results and error output from a compiler appear in the message pane.\r\n\r\n<img width=\"1813\" height=\"287\" alt=\"Screenshot 2025-10-27 135006\" src=\"https://github.com/user-attachments/assets/1bc3df38-df44-4e41-b966-a80fcbe4f4ad\" />\r\n\r\n### Tests\r\n\r\nThis is a draft and I have not done any testing yet; would welcome any direction. At minimum, we should verify that tee is able to correctly pipe text back into neovim that displays properly in the quickfix list.\r\n\r\n### Notes\r\n\r\nOther tee options:\r\n- [tee-win32](https://github.com/dEajL3kA/tee-win32):  (this is MIT-licensed. However, I couldn't get it to build on my machine even after updating its makefile to call my install of MSVC. It's also super optimized and uses some processor intrinsics for multithreading. On the whole very impressive but not very portable, so not very suitable, I think.)\r\n\r\n- [gnu coreutils tee](https://gnuwin32.sourceforge.net/packages/coreutils.htm): (Windows coreutils contains a tee.c. Last updated 2005. Did not build immediately on my machine; we'd have to determine which definitions from elsewhere in coreutils tee.c needs and incorporate them somehow.)\r\n\r\n- [WinTee](https://github.com/mpderbec/WinTee): (Has no license. Last updated 11 years ago. Relies on Visual Studio to build.)\r\n\r\n### Related discussions\r\nhttps://github.com/neovim/neovim/issues/32431 (about the suspicious original tee binary)\r\nhttps://github.com/neovim/neovim/issues/32504 (demonstration of broken tee functionality)\r\n\r\n### Todo\r\n\r\n- Testing\r\n- Update zig build file with tee.c instruction\r\n",
    "closed_at": null,
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36363#discussion_r2467544085"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2467544085"
                }
            },
            "author_association": "MEMBER",
            "body": "running `make formatc` should fix most lint issues in this file ",
            "commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "created_at": "2025-10-28T00:51:45Z",
            "diff_hunk": "",
            "html_url": "https://github.com/neovim/neovim/pull/36363#discussion_r2467544085",
            "id": 2467544085,
            "line": 1,
            "node_id": "PRRC_kwDOAPphoM6TE7wV",
            "original_commit_id": "7bbe470ba96b8605e9df1b20f635830ec7aa0a0c",
            "original_line": 1,
            "original_position": 1,
            "original_start_line": null,
            "path": "src/tee/tee.c",
            "position": 1,
            "pull_request_review_id": 3386087708,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2467544085/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "file",
            "updated_at": "2025-10-28T00:51:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2467544085",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36363#discussion_r2467552195"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2467552195"
                }
            },
            "author_association": "MEMBER",
            "body": "this is a Windows-only feature, btw. on non-Windows we always need to use either `./tee`, or the absolute path, or the parent dir needs to be in `$PATH`.\n\nin test, you can use `n.testprg('tee')` to get the fullpath. (but this might be irrelevant since the purpose of including `tee` is that Nvim should automatically find it.) https://github.com/neovim/neovim/blob/7088441de41c468e22dc5daffd377c00211ce45b/test/functional/testnvim.lua#L941-L943",
            "commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "created_at": "2025-10-28T00:59:04Z",
            "diff_hunk": "@@ -0,0 +1,10 @@\n+add_executable(tee tee.c)\n+\n+# tee has to be in the same directory as the nvim executable",
            "html_url": "https://github.com/neovim/neovim/pull/36363#discussion_r2467552195",
            "id": 2467552195,
            "line": 3,
            "node_id": "PRRC_kwDOAPphoM6TE9vD",
            "original_commit_id": "7bbe470ba96b8605e9df1b20f635830ec7aa0a0c",
            "original_line": 3,
            "original_position": 3,
            "original_start_line": null,
            "path": "src/tee/CMakeLists.txt",
            "position": 3,
            "pull_request_review_id": 3386096460,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2467552195/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-28T01:01:42Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2467552195",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36363#discussion_r2521039971"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521039971"
                }
            },
            "author_association": "MEMBER",
            "body": "How big is BUFSIZ? Does changing this to something big, improve the performance?\n\n\n```suggestion\n\tchar\tbuf[65536];\n```",
            "commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "created_at": "2025-11-13T02:56:24Z",
            "diff_hunk": "@@ -0,0 +1,165 @@\n+/*  vim:set ts=4 sw=4:\n+ *\n+ *\tCopyright (c) 1996, Paul Slootman\n+ *\n+ *\tAuthor: Paul Slootman\n+ *\t\t\t(paul@wurtel.hobby.nl, paul@murphy.nl, paulS@toecompst.nl)\n+ *\tModifications for MSVC: Yasuhiro Matsumoto\n+ *\n+ *\tThis source code is released into the public domain. It is provided on an\n+ *\tas-is basis and no responsibility is accepted for its failure to perform\n+ *\tas expected. It is worth at least as much as you paid for it!\n+ *\n+ * tee.c - pipe fitting\n+ *\n+ * tee reads stdin, and writes what it reads to each of the specified\n+ * files. The primary reason of existence for this version is a quick\n+ * and dirty implementation to distribute with Vim, to make one of the\n+ * most useful features of Vim possible on OS/2: quickfix.\n+ *\n+ * Of course, not using tee but instead redirecting make's output directly\n+ * into a temp file and then processing that is possible, but if we have a\n+ * system capable of correctly piping (unlike DOS, for example), why not\n+ * use it as well as possible? This tee should also work on other systems,\n+ * but it's not been tested there, only on OS/2.\n+ *\n+ * tee is also available in the GNU shellutils package, which is available\n+ * precompiled for OS/2. That one probably works better.\n+ */\n+\n+#ifndef _MSC_VER\n+# include <unistd.h>\n+#endif\n+#include <malloc.h>\n+#include <stdio.h>\n+#include <stdlib.h>\n+#include <string.h>\n+#include <fcntl.h>\n+\n+#ifdef _WIN32\n+# define sysconf(x) -1\n+#endif\n+\n+void usage(void)\n+{\n+\tfprintf(stderr,\n+\"tee usage:\\n\\\n+\\ttee [-a] file ... file_n\\n\\\n+\\n\\\n+\\t-a\\tappend to files instead of truncating\\n\\\n+\\nTee reads its input, and writes to each of the specified files,\\n\\\n+as well as to the standard output.\\n\\\n+\\n\\\n+This version supplied with Vim 4.2 to make ':make' possible.\\n\\\n+For a more complete and stable version, consider getting\\n\\\n+[a port of] the GNU shellutils package.\\n\\\n+\");\n+}\n+\n+/*\n+ * fread only returns when count is read or at EOF.\n+ * We could use fgets, but I want to be able to handle binary blubber.\n+ */\n+\n+int\n+myfread(char *buf, int elsize /*ignored*/, int max, FILE *fp)\n+{\n+\tint\tc;\n+\tint\tn = 0;\n+\n+\twhile ((n < max) && ((c = getchar()) != EOF))\n+\t{\n+\t\t*(buf++) = c;\n+\t\tn++;\n+\t\tif (c == '\\n' || c == '\\r')\n+\t\t\tbreak;\n+\t}\n+\treturn n;\n+}\n+\n+\n+int\n+main(int argc, char *argv[])\n+{\n+\tint\tappend = 0;\n+\tsize_t\tnumfiles;\n+\tint\tmaxfiles;\n+\tFILE\t**filepointers;\n+\tint\ti;\n+\tchar\tbuf[BUFSIZ];",
            "html_url": "https://github.com/neovim/neovim/pull/36363#discussion_r2521039971",
            "id": 2521039971,
            "line": 89,
            "node_id": "PRRC_kwDOAPphoM6WRARj",
            "original_commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "original_line": 89,
            "original_position": 89,
            "original_start_line": null,
            "path": "src/tee/tee.c",
            "position": 89,
            "pull_request_review_id": 3456917379,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521039971/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-13T02:56:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521039971",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36363#discussion_r2521105498"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521105498"
                }
            },
            "author_association": "MEMBER",
            "body": "try removing this (or comment it, as a reminder for future), is it faster?\n\nactually, here's what chatgpt suggests (and it looks like a good idea to me):\n\n```c\nint n;\nwhile ((n = fread(buf, 1, sizeof(buf), stdin)) > 0) {\n    fwrite(buf, 1, n, stdout);\n    for (i = 0; i < numfiles; i++)\n        if (filepointers[i])\n            fwrite(buf, 1, n, filepointers[i]);\n    fflush(stdout);  // flush once per block, not per byte\n}\n```\n\n> Now fread() does large reads (e.g., 4–8 KB), and fflush() happens per block.\n\nanother optional thing to try:\n\n```c\nsetvbuf(stdout, NULL, _IONBF, 0);   // fully unbuffered\n```\n\n> Set stdout to line-buffered or unbuffered mode if you want immediate output.\n>\n> That’s exactly what GNU tee effectively does — it disables buffering on stdout if it’s a terminal or pipe.",
            "commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "created_at": "2025-11-13T03:13:31Z",
            "diff_hunk": "@@ -0,0 +1,165 @@\n+/*  vim:set ts=4 sw=4:\n+ *\n+ *\tCopyright (c) 1996, Paul Slootman\n+ *\n+ *\tAuthor: Paul Slootman\n+ *\t\t\t(paul@wurtel.hobby.nl, paul@murphy.nl, paulS@toecompst.nl)\n+ *\tModifications for MSVC: Yasuhiro Matsumoto\n+ *\n+ *\tThis source code is released into the public domain. It is provided on an\n+ *\tas-is basis and no responsibility is accepted for its failure to perform\n+ *\tas expected. It is worth at least as much as you paid for it!\n+ *\n+ * tee.c - pipe fitting\n+ *\n+ * tee reads stdin, and writes what it reads to each of the specified\n+ * files. The primary reason of existence for this version is a quick\n+ * and dirty implementation to distribute with Vim, to make one of the\n+ * most useful features of Vim possible on OS/2: quickfix.\n+ *\n+ * Of course, not using tee but instead redirecting make's output directly\n+ * into a temp file and then processing that is possible, but if we have a\n+ * system capable of correctly piping (unlike DOS, for example), why not\n+ * use it as well as possible? This tee should also work on other systems,\n+ * but it's not been tested there, only on OS/2.\n+ *\n+ * tee is also available in the GNU shellutils package, which is available\n+ * precompiled for OS/2. That one probably works better.\n+ */\n+\n+#ifndef _MSC_VER\n+# include <unistd.h>\n+#endif\n+#include <malloc.h>\n+#include <stdio.h>\n+#include <stdlib.h>\n+#include <string.h>\n+#include <fcntl.h>\n+\n+#ifdef _WIN32\n+# define sysconf(x) -1\n+#endif\n+\n+void usage(void)\n+{\n+\tfprintf(stderr,\n+\"tee usage:\\n\\\n+\\ttee [-a] file ... file_n\\n\\\n+\\n\\\n+\\t-a\\tappend to files instead of truncating\\n\\\n+\\nTee reads its input, and writes to each of the specified files,\\n\\\n+as well as to the standard output.\\n\\\n+\\n\\\n+This version supplied with Vim 4.2 to make ':make' possible.\\n\\\n+For a more complete and stable version, consider getting\\n\\\n+[a port of] the GNU shellutils package.\\n\\\n+\");\n+}\n+\n+/*\n+ * fread only returns when count is read or at EOF.\n+ * We could use fgets, but I want to be able to handle binary blubber.\n+ */\n+\n+int\n+myfread(char *buf, int elsize /*ignored*/, int max, FILE *fp)\n+{\n+\tint\tc;\n+\tint\tn = 0;\n+\n+\twhile ((n < max) && ((c = getchar()) != EOF))\n+\t{\n+\t\t*(buf++) = c;\n+\t\tn++;\n+\t\tif (c == '\\n' || c == '\\r')\n+\t\t\tbreak;\n+\t}\n+\treturn n;\n+}\n+\n+\n+int\n+main(int argc, char *argv[])\n+{\n+\tint\tappend = 0;\n+\tsize_t\tnumfiles;\n+\tint\tmaxfiles;\n+\tFILE\t**filepointers;\n+\tint\ti;\n+\tchar\tbuf[BUFSIZ];\n+\tint\tn;\n+\tint\toptind = 1;\n+\n+\tfor (i = 1; i < argc; i++)\n+\t{\n+\t\tif (argv[i][0] != '-')\n+\t\t\tbreak;\n+\t\tif (!strcmp(argv[i], \"-a\"))\n+\t\t\tappend++;\n+\t\telse\n+\t\t\tusage();\n+\t\toptind++;\n+\t}\n+\n+\tnumfiles = argc - optind;\n+\n+\tif (numfiles == 0)\n+\t{\n+\t\tfprintf(stderr, \"doesn't make much sense using tee without any file name arguments...\\n\");\n+\t\tusage();\n+\t\texit(2);\n+\t}\n+\n+\tmaxfiles = sysconf(_SC_OPEN_MAX);\t/* or fill in 10 or so */\n+\tif (maxfiles < 0)\n+\t\tmaxfiles = 10;\n+\tif (numfiles + 3 > maxfiles)\t/* +3 accounts for stdin, out, err */\n+\t{\n+\t\tfprintf(stderr, \"Sorry, there is a limit of max %d files.\\n\", maxfiles - 3);\n+\t\texit(1);\n+\t}\n+\tfilepointers = calloc(numfiles, sizeof(FILE *));\n+\tif (filepointers == NULL)\n+\t{\n+\t\tfprintf(stderr, \"Error allocating memory for %ld files\\n\",\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   (long)numfiles);\n+\t\texit(1);\n+\t}\n+\tfor (i = 0; i < numfiles; i++)\n+\t{\n+\t\tfilepointers[i] = fopen(argv[i+optind], append ? \"ab\" : \"wb\");\n+\t\tif (filepointers[i] == NULL)\n+\t\t{\n+\t\t\tfprintf(stderr, \"Can't open \\\"%s\\\"\\n\", argv[i+optind]);\n+\t\t\texit(1);\n+\t\t}\n+\t}\n+#ifdef _WIN32\n+\tsetmode(fileno(stdin),  O_BINARY);\n+\tfflush(stdout);\t/* needed for _fsetmode(stdout) */\n+\tsetmode(fileno(stdout),  O_BINARY);\n+#endif\n+\n+\twhile ((n = myfread(buf, sizeof(char), sizeof(buf), stdin)) > 0)\n+\t{\n+\t\tfwrite(buf, sizeof(char), n, stdout);\n+\t\tfflush(stdout);",
            "html_url": "https://github.com/neovim/neovim/pull/36363#discussion_r2521105498",
            "id": 2521105498,
            "line": 146,
            "node_id": "PRRC_kwDOAPphoM6WRQRa",
            "original_commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "original_line": 146,
            "original_position": 146,
            "original_start_line": null,
            "path": "src/tee/tee.c",
            "position": 146,
            "pull_request_review_id": 3456994581,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521105498/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-13T03:19:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521105498",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36363#discussion_r2521136338"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521136338"
                }
            },
            "author_association": "MEMBER",
            "body": "from chatgpt:\n\n- getchar() reads one byte at a time using fully buffered stdio calls.\n    - On Linux, this may still get internally buffered at a reasonable chunk size, so it’s not disastrous.\n     - On Windows, especially when stdin is a pipe, each getchar() often results in a real system call (ReadFile of size 1) — that’s excruciatingly slow for large inputs.\n\nsuggested fix:\n\n> Change myfread() to a real buffered read:\n\n```c\nint myfread(char *buf, int elsize, int max, FILE *fp)\n{\n    return fread(buf, elsize, max, fp);\n}\n```\n\nand call it like this:\n\n```c\nwhile ((n = myfread(buf, 1, sizeof(buf), stdin)) > 0)\n{\n    fwrite(buf, 1, n, stdout);\n    for (i = 0; i < numfiles; i++)\n        if (filepointers[i]) fwrite(buf, 1, n, filepointers[i]);\n}\n```",
            "commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "created_at": "2025-11-13T03:21:49Z",
            "diff_hunk": "@@ -0,0 +1,165 @@\n+/*  vim:set ts=4 sw=4:\n+ *\n+ *\tCopyright (c) 1996, Paul Slootman\n+ *\n+ *\tAuthor: Paul Slootman\n+ *\t\t\t(paul@wurtel.hobby.nl, paul@murphy.nl, paulS@toecompst.nl)\n+ *\tModifications for MSVC: Yasuhiro Matsumoto\n+ *\n+ *\tThis source code is released into the public domain. It is provided on an\n+ *\tas-is basis and no responsibility is accepted for its failure to perform\n+ *\tas expected. It is worth at least as much as you paid for it!\n+ *\n+ * tee.c - pipe fitting\n+ *\n+ * tee reads stdin, and writes what it reads to each of the specified\n+ * files. The primary reason of existence for this version is a quick\n+ * and dirty implementation to distribute with Vim, to make one of the\n+ * most useful features of Vim possible on OS/2: quickfix.\n+ *\n+ * Of course, not using tee but instead redirecting make's output directly\n+ * into a temp file and then processing that is possible, but if we have a\n+ * system capable of correctly piping (unlike DOS, for example), why not\n+ * use it as well as possible? This tee should also work on other systems,\n+ * but it's not been tested there, only on OS/2.\n+ *\n+ * tee is also available in the GNU shellutils package, which is available\n+ * precompiled for OS/2. That one probably works better.\n+ */\n+\n+#ifndef _MSC_VER\n+# include <unistd.h>\n+#endif\n+#include <malloc.h>\n+#include <stdio.h>\n+#include <stdlib.h>\n+#include <string.h>\n+#include <fcntl.h>\n+\n+#ifdef _WIN32\n+# define sysconf(x) -1\n+#endif\n+\n+void usage(void)\n+{\n+\tfprintf(stderr,\n+\"tee usage:\\n\\\n+\\ttee [-a] file ... file_n\\n\\\n+\\n\\\n+\\t-a\\tappend to files instead of truncating\\n\\\n+\\nTee reads its input, and writes to each of the specified files,\\n\\\n+as well as to the standard output.\\n\\\n+\\n\\\n+This version supplied with Vim 4.2 to make ':make' possible.\\n\\\n+For a more complete and stable version, consider getting\\n\\\n+[a port of] the GNU shellutils package.\\n\\\n+\");\n+}\n+\n+/*\n+ * fread only returns when count is read or at EOF.\n+ * We could use fgets, but I want to be able to handle binary blubber.\n+ */\n+\n+int\n+myfread(char *buf, int elsize /*ignored*/, int max, FILE *fp)\n+{\n+\tint\tc;\n+\tint\tn = 0;\n+\n+\twhile ((n < max) && ((c = getchar()) != EOF))",
            "html_url": "https://github.com/neovim/neovim/pull/36363#discussion_r2521136338",
            "id": 2521136338,
            "line": 70,
            "node_id": "PRRC_kwDOAPphoM6WRXzS",
            "original_commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "original_line": 70,
            "original_position": 70,
            "original_start_line": null,
            "path": "src/tee/tee.c",
            "position": 70,
            "pull_request_review_id": 3457025811,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521136338/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-13T03:21:49Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521136338",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36363#discussion_r2521140392"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521140392"
                }
            },
            "author_association": "MEMBER",
            "body": "remove",
            "commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "created_at": "2025-11-13T03:23:07Z",
            "diff_hunk": "@@ -121,6 +121,7 @@ if(WIN32 OR APPLE)\n   set(CASE_INSENSITIVE_FILENAME TRUE)\n endif()\n \n+",
            "html_url": "https://github.com/neovim/neovim/pull/36363#discussion_r2521140392",
            "id": 2521140392,
            "line": 124,
            "node_id": "PRRC_kwDOAPphoM6WRYyo",
            "original_commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "original_line": 124,
            "original_position": 4,
            "original_start_line": null,
            "path": "CMakeLists.txt",
            "position": 4,
            "pull_request_review_id": 3457030615,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521140392/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-13T03:23:07Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521140392",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36363#discussion_r2521142604"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36363"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521142604"
                }
            },
            "author_association": "MEMBER",
            "body": "feel free to drop the `if(WIN32)` check. that make the build more uniform, and it should be harmless on non-Windows.\n\nthe binary should be produced at `./build/bin/tee`. \n",
            "commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "created_at": "2025-11-13T03:23:42Z",
            "diff_hunk": "@@ -315,6 +316,10 @@ add_subdirectory(cmake.config)\n add_subdirectory(runtime)\n add_subdirectory(test)\n \n+if(WIN32)\n+  add_subdirectory(src/tee)",
            "html_url": "https://github.com/neovim/neovim/pull/36363#discussion_r2521142604",
            "id": 2521142604,
            "line": 320,
            "node_id": "PRRC_kwDOAPphoM6WRZVM",
            "original_commit_id": "4a17851882289aa125715792f952c08a7aec7072",
            "original_line": 320,
            "original_position": 13,
            "original_start_line": null,
            "path": "CMakeLists.txt",
            "position": 13,
            "pull_request_review_id": 3457032823,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521142604/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-11-13T03:24:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2521142604",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "NONE",
            "body": "@justinmk an update after taking some time to understand the testing framework. i'm going to address two things here: performance of the new tee.exe, and possible updates to [test\\functional\\ex_cmds\\grep_spec.lua](https://github.com/neovim/neovim/blob/master/test/functional/ex_cmds/grep_spec.lua).\r\n\r\n### New tee performance\r\non huge inputs, the windows version of tee that we'd be adding here performs much worse than what test\\functional\\ex_cmds\\grep_spec.lua seems to want. this test greps the letter \"a\", recursively, on the test directory. on windows, it takes about 60 seconds with the new tee.exe. however, because the test only tries to determine whether large input causes :grep to hang, it still passes.\r\n\r\n(note: as far as i can tell, grep_spec.lua is the only test that specifically examines the process of executing a shell command and echoing its output back into the message pane, in a platform-agnostic way (for example, make_spec.lua only examines the behavior of powershell).)\r\n\r\ni ran some tests of my own just to better understand what's happening here. i ran the same \"a\" search with ripgrep with four configs that either use -uu, -uuu, and either do pipe to tee or don't. i tried the same test with both the new tee and the old tee binary that nvim still shipped with as of version 0.10.3. times were basically identical; here's a sample run:\r\n\r\n<img width=\"448\" height=\"1633\" alt=\"image\" src=\"https://github.com/user-attachments/assets/b55f752e-3f16-4907-b905-fb781df93cfb\" />\r\n\r\ni timed it with rg and command prompt as a sanity check; times are almost the same. so this tee is slow on huge inputs. BUT in a typical use case for me, where it's echoing back a few dozen lines from the compiler at most, i notice no slowdown.\r\n\r\n### about grep_spec.lua\r\nif my interpretation is correct, currently grep_spec.lua doesn't run on windows builds because the test hardcodes grep itself, rather than referencing grepprg:\r\n\r\n<img width=\"378\" height=\"112\" alt=\"image\" src=\"https://github.com/user-attachments/assets/ea6c8b01-4460-4f63-8fc6-8346492a2444\" />\r\n\r\n[now that we look for rg and set it as grepprg if it's available by default](https://github.com/neovim/neovim/commit/20b38677c22b0ff19ea54396c7718b5a8f410ed4), we should probably update grep_spec.lua to use grepprg.\r\n\r\nok i can see that as i write this, all builds are failing the test on the line\r\n\r\n`ok(eval('len(getqflist())') > 9000) -- IT'S OVER 9000!!1`\r\n\r\nmaybe the test dir that github runs this test in has fewer files than what i have on my machine...? (update: ok yes, it passes if we set the check on the quickfix list length to 100. this seems fine given that we're mainly wanting to see lines echoed to the message pane properly.)\r\n\r\n### anyway, conclusions\r\n\r\nmy view is that if we were fine with tee performance on windows before the tee binary was killed, then we will be fine with this version. for any typical use case, a user isn't likely to notice. \r\n\r\nhowever, grep_spec.lua should probably be updated to run with whatever is set as grepprg, if our goal is to test under a typical use case.\r\n\r\na final thread to consider re:testing: since we are now building tee instead of shipping a binary, maybe we want to check it built properly. to me, the simplest approach would just be adding a line to test_windows.yml.",
            "created_at": "2025-11-08T01:27:23Z",
            "html_url": "https://github.com/neovim/neovim/pull/36363#issuecomment-3505555075",
            "id": 3505555075,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36363",
            "node_id": "IC_kwDOAPphoM7Q8oaD",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3505555075/reactions"
            },
            "updated_at": "2025-11-13T03:26:25Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3505555075",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18311564?v=4",
                "events_url": "https://api.github.com/users/AaronSteen/events{/privacy}",
                "followers_url": "https://api.github.com/users/AaronSteen/followers",
                "following_url": "https://api.github.com/users/AaronSteen/following{/other_user}",
                "gists_url": "https://api.github.com/users/AaronSteen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/AaronSteen",
                "id": 18311564,
                "login": "AaronSteen",
                "node_id": "MDQ6VXNlcjE4MzExNTY0",
                "organizations_url": "https://api.github.com/users/AaronSteen/orgs",
                "received_events_url": "https://api.github.com/users/AaronSteen/received_events",
                "repos_url": "https://api.github.com/users/AaronSteen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/AaronSteen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/AaronSteen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/AaronSteen",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> this tee is slow on huge inputs. BUT in a typical use case for me, where it's echoing back a few dozen lines from the compiler at most, i notice no slowdown.\r\n\r\nsee https://github.com/neovim/neovim/pull/36363#discussion_r2521136338\r\n\r\n> it passes if we set the check on the quickfix list length to 100. this seems fine given that we're mainly wanting to see lines echoed to the message pane properly.)\r\n\r\nThe test was done that way intentionally. It is testing the performance of quickfix, as well as the codepaths that collect big results. It should not be changed, except to unblock this PR we can special-case it for Windows (but that might not be necessary if the perf issues can be fixed).\r\n\r\nI would like to get the PR over the fence, so please avoid changing unrelated things :)\r\n\r\n> maybe we want to check it built properly\r\n\r\nDoesn't the test that uses `tee` confirm that already?\r\n\r\n> however, grep_spec.lua should probably be updated to run with whatever is set as grepprg\r\n\r\n We aren't testing the performance of grep/rg, that seems irrelevant.",
            "created_at": "2025-11-13T03:24:13Z",
            "html_url": "https://github.com/neovim/neovim/pull/36363#issuecomment-3525062658",
            "id": 3525062658,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36363",
            "node_id": "IC_kwDOAPphoM7SHDAC",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3525062658/reactions"
            },
            "updated_at": "2025-11-13T03:24:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3525062658",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "side-note (not a blocker):\r\n\r\n- we should add this source file to `UNCRUSTIFY_NVIM_SOURCES` so that `lintc` and `formatc` check it https://github.com/neovim/neovim/blob/653871da1b5507d3391239854982438872ad4032/src/nvim/CMakeLists.txt#L425\r\n- and to `LINT_NVIM_SOURCES` https://github.com/neovim/neovim/blob/653871da1b5507d3391239854982438872ad4032/src/nvim/CMakeLists.txt#L456",
            "created_at": "2025-11-13T03:25:58Z",
            "html_url": "https://github.com/neovim/neovim/pull/36363#issuecomment-3525068793",
            "id": 3525068793,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36363",
            "node_id": "IC_kwDOAPphoM7SHEf5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3525068793/reactions"
            },
            "updated_at": "2025-11-13T03:25:58Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3525068793",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36363/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/36363/commits",
    "created_at": "2025-10-28T00:01:21Z",
    "diff_url": "https://github.com/neovim/neovim/pull/36363.diff",
    "draft": false,
    "head": {
        "label": "AaronSteen:feature/windows_tee",
        "ref": "feature/windows_tee",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/AaronSteen/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/AaronSteen/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/AaronSteen/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/AaronSteen/neovim/branches{/branch}",
            "clone_url": "https://github.com/AaronSteen/neovim.git",
            "collaborators_url": "https://api.github.com/repos/AaronSteen/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/AaronSteen/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/AaronSteen/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/AaronSteen/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/AaronSteen/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/AaronSteen/neovim/contributors",
            "created_at": "2025-10-16T15:39:48Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/AaronSteen/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/AaronSteen/neovim/downloads",
            "events_url": "https://api.github.com/repos/AaronSteen/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/AaronSteen/neovim/forks",
            "full_name": "AaronSteen/neovim",
            "git_commits_url": "https://api.github.com/repos/AaronSteen/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/AaronSteen/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/AaronSteen/neovim/git/tags{/sha}",
            "git_url": "git://github.com/AaronSteen/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/AaronSteen/neovim/hooks",
            "html_url": "https://github.com/AaronSteen/neovim",
            "id": 1077687120,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/AaronSteen/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/AaronSteen/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/AaronSteen/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/AaronSteen/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/AaronSteen/neovim/labels{/name}",
            "language": null,
            "languages_url": "https://api.github.com/repos/AaronSteen/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/AaronSteen/neovim/merges",
            "milestones_url": "https://api.github.com/repos/AaronSteen/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOQDwzUA",
            "notifications_url": "https://api.github.com/repos/AaronSteen/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18311564?v=4",
                "events_url": "https://api.github.com/users/AaronSteen/events{/privacy}",
                "followers_url": "https://api.github.com/users/AaronSteen/followers",
                "following_url": "https://api.github.com/users/AaronSteen/following{/other_user}",
                "gists_url": "https://api.github.com/users/AaronSteen/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/AaronSteen",
                "id": 18311564,
                "login": "AaronSteen",
                "node_id": "MDQ6VXNlcjE4MzExNTY0",
                "organizations_url": "https://api.github.com/users/AaronSteen/orgs",
                "received_events_url": "https://api.github.com/users/AaronSteen/received_events",
                "repos_url": "https://api.github.com/users/AaronSteen/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/AaronSteen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/AaronSteen/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/AaronSteen",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/AaronSteen/neovim/pulls{/number}",
            "pushed_at": "2025-11-12T22:13:13Z",
            "releases_url": "https://api.github.com/repos/AaronSteen/neovim/releases{/id}",
            "size": 337863,
            "ssh_url": "git@github.com:AaronSteen/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/AaronSteen/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/AaronSteen/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/AaronSteen/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/AaronSteen/neovim/subscription",
            "svn_url": "https://github.com/AaronSteen/neovim",
            "tags_url": "https://api.github.com/repos/AaronSteen/neovim/tags",
            "teams_url": "https://api.github.com/repos/AaronSteen/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/AaronSteen/neovim/git/trees{/sha}",
            "updated_at": "2025-10-16T15:39:48Z",
            "url": "https://api.github.com/repos/AaronSteen/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "4a17851882289aa125715792f952c08a7aec7072",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/18311564?v=4",
            "events_url": "https://api.github.com/users/AaronSteen/events{/privacy}",
            "followers_url": "https://api.github.com/users/AaronSteen/followers",
            "following_url": "https://api.github.com/users/AaronSteen/following{/other_user}",
            "gists_url": "https://api.github.com/users/AaronSteen/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/AaronSteen",
            "id": 18311564,
            "login": "AaronSteen",
            "node_id": "MDQ6VXNlcjE4MzExNTY0",
            "organizations_url": "https://api.github.com/users/AaronSteen/orgs",
            "received_events_url": "https://api.github.com/users/AaronSteen/received_events",
            "repos_url": "https://api.github.com/users/AaronSteen/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/AaronSteen/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/AaronSteen/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/AaronSteen",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/36363",
    "id": 2953144554,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36363",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "building and installing Neovim using the provided scripts",
            "id": 84723321,
            "name": "build",
            "node_id": "MDU6TGFiZWw4NDcyMzMyMQ==",
            "url": "https://api.github.com/repos/neovim/neovim/labels/build"
        }
    ],
    "locked": false,
    "merge_commit_sha": "1ec3f264c3e2cd2a22f1ef108c058ee9122a4abe",
    "merged_at": null,
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6wBWjq",
    "number": 36363,
    "patch_url": "https://github.com/neovim/neovim/pull/36363.patch",
    "requested_reviewers": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/33953936?v=4",
            "events_url": "https://api.github.com/users/dundargoc/events{/privacy}",
            "followers_url": "https://api.github.com/users/dundargoc/followers",
            "following_url": "https://api.github.com/users/dundargoc/following{/other_user}",
            "gists_url": "https://api.github.com/users/dundargoc/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/dundargoc",
            "id": 33953936,
            "login": "dundargoc",
            "node_id": "MDQ6VXNlcjMzOTUzOTM2",
            "organizations_url": "https://api.github.com/users/dundargoc/orgs",
            "received_events_url": "https://api.github.com/users/dundargoc/received_events",
            "repos_url": "https://api.github.com/users/dundargoc/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/dundargoc/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dundargoc/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/dundargoc",
            "user_view_type": "public"
        },
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/112971?v=4",
            "events_url": "https://api.github.com/users/jamessan/events{/privacy}",
            "followers_url": "https://api.github.com/users/jamessan/followers",
            "following_url": "https://api.github.com/users/jamessan/following{/other_user}",
            "gists_url": "https://api.github.com/users/jamessan/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/jamessan",
            "id": 112971,
            "login": "jamessan",
            "node_id": "MDQ6VXNlcjExMjk3MQ==",
            "organizations_url": "https://api.github.com/users/jamessan/orgs",
            "received_events_url": "https://api.github.com/users/jamessan/received_events",
            "repos_url": "https://api.github.com/users/jamessan/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/jamessan/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jamessan/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/jamessan",
            "user_view_type": "public"
        }
    ],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/36363/comments",
    "state": "open",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/4a17851882289aa125715792f952c08a7aec7072",
    "title": "fix(windows): restore `tee` functionality on Windows",
    "updated_at": "2025-11-13T03:26:25Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/36363",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/18311564?v=4",
        "events_url": "https://api.github.com/users/AaronSteen/events{/privacy}",
        "followers_url": "https://api.github.com/users/AaronSteen/followers",
        "following_url": "https://api.github.com/users/AaronSteen/following{/other_user}",
        "gists_url": "https://api.github.com/users/AaronSteen/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/AaronSteen",
        "id": 18311564,
        "login": "AaronSteen",
        "node_id": "MDQ6VXNlcjE4MzExNTY0",
        "organizations_url": "https://api.github.com/users/AaronSteen/orgs",
        "received_events_url": "https://api.github.com/users/AaronSteen/received_events",
        "repos_url": "https://api.github.com/users/AaronSteen/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/AaronSteen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/AaronSteen/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/AaronSteen",
        "user_view_type": "public"
    }
}
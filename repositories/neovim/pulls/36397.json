{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36397/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36397/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/36397"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36397"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36397/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/77cb75d8f130e73f7994e6f34c3bf156710c20c8"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 6392,
            "forks_count": 6392,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 2048,
            "open_issues_count": 2048,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-11-03T06:23:46Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 350066,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 93940,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-11-04T02:32:33Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 93940,
            "watchers_count": 93940,
            "web_commit_signoff_required": false
        },
        "sha": "5ddabbeba43e519604f5e1cfacb7a1d83094097e",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "As I mentioned in https://github.com/neovim/neovim/issues/25509#issuecomment-3457822973 , I'm testing the current `vim.Pos` and `vim.Range` implementation to find paint-points ( https://github.com/ThePrimeagen/refactoring.nvim/commit/fabfe7be7174d3890b2d0af31a180a2929cd173a is the commit where I refactored the code in `refactoring.nvim` to use my bundled version of them). This PR includes all the problems I've found and my proposed solutions for them. Let me know if it would be better to split it into smaller PRs.\r\n\r\nI also haven't included tests yet because I'm expecting discussion about how to better solve the issues I've found.\r\n\r\n---\r\n\r\nProblem:\r\n\r\nThere is no `vim.Pos` nor `vim.Range` interface for:\r\n\r\n- mark-line indexing\r\n- treesitter indexing\r\n- api indexing\r\n- vimscript indexing\r\n\r\nSolution:\r\n\r\nAdd said interfaces. This PR still leaves out `to_mark` and `to_vimscript`.\r\n\r\n---\r\n\r\nProblem:\r\n\r\nThere is no builtin way to tell if a `vim.Pos` is inside of a `vim.Range`.\r\n\r\nSolution:\r\n\r\nAdd `vim.Range.has_pos`.\r\n\r\n---\r\n\r\nProblem:\r\n\r\nNot all `to_xxx` interfaces have wrapping objects like `to_lsp`\r\n\r\nSolution:\r\n\r\nReturn unwrapped values in ~~all `to_xxx` interfaces~~ in the `to_xxx` interfaces where it makes sense. Accept unwrapped values in \"from\" interfaces where it makes sense, this also has the benefit of creating `vim.Ranges` values like\r\n\r\n```lua\r\nlocal buf = vim.api.nvim_get_current_buf()\r\nlocal node = vim.treesitter.get_node()\r\nlocal range = vim.range.treesitter(buf, node:range())\r\n```\r\n\r\n---\r\n\r\nProblem:\r\n\r\n`start` and `end` positions have different semantics, so they can't be compared. `vim.Range` relies on comparing the `end` and `start` of two ranges to decide which one is greater, which doesn't work as expected because of the different semantics.\r\n\r\nFor example, for the ranges\r\n\r\n```lua\r\nlocal a = {\r\n  start = {\r\n    row = 0,\r\n    col = 22,\r\n  },\r\n  end_ = {\r\n    row = 0,\r\n    col = 24,\r\n  },\r\n}\r\n\r\nlocal b = {\r\n  start = {\r\n    row = 0,\r\n    col = 17,\r\n  },\r\n  end_ = {\r\n    row = 0,\r\n    col = 22,\r\n  },\r\n}\r\n```\r\n\r\nin the following code\r\n\r\n```lua\r\nlocal foo, bar = \"foo\",  \"bar\"\r\n--               |---||-|\r\n--                 b  a\r\n```\r\n\r\nThe range `b` is smaller than the range `a`, but the current implementation compares `b._end` (`col = 22`) and `a.start` (`col = 22`) and concludes that, since `b.col` is not smaller than `a.col`, `b` should be greater than `a`.\r\n\r\nSolution:\r\n\r\n- Add a `type` field to `vim.Pos` to distinguish `end` and `start` positions and use it on `__lt`, `__le` and `__eq` to normalize `end` and `start` positions before comparing them. With the same example above, `b._end` would now be considered to have `col = 21` which is smaller than `a.start`s `col = 22`.\r\n  - This would also avoid having separated `vim.Pos.treesitter_start`/`vim.Pos.treesitter_end` functions (also applies for `vim.Pos.mark` and `vim.Pos.api`) and simply checking whether the position is a `start` or an `end` inside of each function.\r\n- If this is deemed not desired, an alternative could be changing the semantics of `vim.Pos` so that both `start` and `end` are inclusive.\r\n\r\n---\r\n\r\nProblem:\r\n\r\nCurrently, `vim.Range` represents a 0 based end-exclusive range, but the Neovim API uses ranges with `start` == `end` to represent certain operations (e.g. insert text in a position with `nvim_buf_set_text`).\r\n\r\nSolution:\r\n\r\nSpecial case `vim.Range.api` and `vim.Range.to_api` to avoid modifying `end` (by not performing the usual translations between `vim.Range` and `api-indexing` semantics) when `start` == `end` to keep them in sync. For example\r\n\r\n```lua\r\nlocal buf = vim.api.nvim_get_curent_buf()\r\nlocal range = vim.range(0,0,0,0, {buf = buf})\r\n-- ...\r\nlocal srow, scol, erow, ecol = range:to_api()\r\nvim.api.nvim_buf_set_text(buf, srow, scol, erow, ecol, {'this is inserted at the beggining of the buffer'})\r\n```",
    "closed_at": null,
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2480091314"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480091314"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Is there any need to distinguish `start` or `end` on `Pos`? I think the related operations would be better on `Range`.",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T03:47:11Z",
            "diff_hunk": "@@ -10,6 +10,8 @@\n local api = vim.api\n local validate = vim.validate\n \n+---@alias vim.Pos.Type 'start'|'end'",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2480091314",
            "id": 2480091314,
            "line": 13,
            "node_id": "PRRC_kwDOAPphoM6T0zCy",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 13,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/pos.lua",
            "position": 4,
            "pull_request_review_id": 3402488093,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480091314/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T04:06:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480091314",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61115159?v=4",
                "events_url": "https://api.github.com/users/ofseed/events{/privacy}",
                "followers_url": "https://api.github.com/users/ofseed/followers",
                "following_url": "https://api.github.com/users/ofseed/following{/other_user}",
                "gists_url": "https://api.github.com/users/ofseed/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ofseed",
                "id": 61115159,
                "login": "ofseed",
                "node_id": "MDQ6VXNlcjYxMTE1MTU5",
                "organizations_url": "https://api.github.com/users/ofseed/orgs",
                "received_events_url": "https://api.github.com/users/ofseed/received_events",
                "repos_url": "https://api.github.com/users/ofseed/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ofseed/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ofseed/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ofseed",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2480095322"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480095322"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Even if such a field should be added, I don't think `type` is a good name because it's too general. Since one of our main goals is to do \"type conversions\" of positions, that name would be confusing. Something more specific like `bound` would be better.",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T03:50:30Z",
            "diff_hunk": "@@ -42,12 +44,19 @@ local validate = vim.validate\n --- When specified, it indicates that this position belongs to a specific buffer.\n --- This field is required when performing position conversions.\n ---@field buf? integer\n+---\n+--- Optional type.\n+---\n+--- When specified, it indicates the type of this position.\n+--- This field is required when performing position conversions and comparisons.\n+---@field type? vim.Pos.Type",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2480095322",
            "id": 2480095322,
            "line": 52,
            "node_id": "PRRC_kwDOAPphoM6T00Ba",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 52,
            "original_position": 18,
            "original_start_line": null,
            "path": "runtime/lua/vim/pos.lua",
            "position": 18,
            "pull_request_review_id": 3402488093,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480095322/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T04:06:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480095322",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61115159?v=4",
                "events_url": "https://api.github.com/users/ofseed/events{/privacy}",
                "followers_url": "https://api.github.com/users/ofseed/followers",
                "following_url": "https://api.github.com/users/ofseed/following{/other_user}",
                "gists_url": "https://api.github.com/users/ofseed/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ofseed",
                "id": 61115159,
                "login": "ofseed",
                "node_id": "MDQ6VXNlcjYxMTE1MTU5",
                "organizations_url": "https://api.github.com/users/ofseed/orgs",
                "received_events_url": "https://api.github.com/users/ofseed/received_events",
                "repos_url": "https://api.github.com/users/ofseed/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ofseed/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ofseed/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ofseed",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2480100026"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480100026"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Can't this be achieved with `to_extmark`? IIRC, `:h api-indexing` only distinguishes between two types, one for `extmark` and one for `mark`.",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T03:54:29Z",
            "diff_hunk": "@@ -203,6 +243,118 @@ function Pos.extmark(pos)\n   return Pos.new(row, col)\n end\n \n+--- Converts |vim.Pos| to treesitter position.\n+---@param pos vim.Pos\n+---@return integer, integer\n+function Pos.to_treesitter(pos)\n+  local col = pos.col\n+  local row = pos.row\n+  if pos.type == 'end' and col == 0 then\n+    row = row - 1\n+    col = #get_line(pos.buf, row)\n+  end\n+  return row, col\n+end\n+\n+--- Creates a new |vim.Pos| from treesitter position.\n+---@param buf integer\n+---@param type vim.Pos.Type\n+---@param row integer\n+---@param col integer\n+function Pos.treesitter(buf, type, row, col)\n+  validate('buf', buf, 'number')\n+  validate('row', row, 'number')\n+  validate('col', col, 'number')\n+\n+  -- TODO(TheLeoP): we are technically losing information here. Treesitter has\n+  -- both kind of end indexing (row_incluvsive-col_exclusive and\n+  -- row_exclusive-col_0). But, does it matter in practice?\n+  if type == 'end' and col > 0 and col == #get_line(buf, row) then\n+    row = row + 1\n+    col = 0\n+  end\n+\n+  return Pos.new(row, col, { buf = buf, type = type })\n+end\n+\n+-- TODO(TheLeoP): does this one require a mandatory `buf`?\n+--- Creates a new |vim.Pos| from vimscript (|builtin-functions|) position.\n+---@param buf integer\n+---@param lnum integer 1-based\n+---@param col integer 1-based\n+function Pos.vimscript(buf, lnum, col)\n+  validate('buf', buf, 'number')\n+  validate('lnum', lnum, 'number')\n+  validate('col', col, 'number')\n+\n+  if col == vim.v.maxcol then\n+    col = 0\n+  else\n+    lnum = lnum - 1\n+    col = col - 1\n+  end\n+\n+  -- TODO(TheLeoP): handle multibyte characters\n+  return Pos.new(lnum, col, { buf = buf })\n+end\n+\n+-- TODO(TheLeoP): should we have an optional parameter `range_type` (line, block, char) and modify\n+-- the range depending on it?\n+--- Creates a new |vim.Pos| from mark-like position.\n+---@param buf integer\n+---@param type vim.Pos.Type\n+---@param range [integer, integer]\n+function Pos.mark(buf, type, range)\n+  validate('buf', buf, 'number')\n+  validate('range', range, 'table')\n+\n+  local row, col = unpack(range)\n+  if type == 'start' then\n+    row = row - 1\n+  elseif type == 'end' then\n+    local row_length = #get_line(buf, row - 1)\n+    col = math.min(row_length, col + 1)\n+    if col == row_length then\n+      col = 0\n+    elseif col ~= 0 then\n+      row = row - 1\n+    end\n+  end\n+\n+  return Pos.new(row, col, { buf = buf, type = type })\n+end\n+\n+--- Converts |vim.Pos| to |api-indexing| position.\n+---@param pos vim.Pos\n+---@return integer, integer",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2480100026",
            "id": 2480100026,
            "line": 329,
            "node_id": "PRRC_kwDOAPphoM6T01K6",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 329,
            "original_position": 219,
            "original_start_line": null,
            "path": "runtime/lua/vim/pos.lua",
            "position": 219,
            "pull_request_review_id": 3402488093,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480100026/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T04:06:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480100026",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61115159?v=4",
                "events_url": "https://api.github.com/users/ofseed/events{/privacy}",
                "followers_url": "https://api.github.com/users/ofseed/followers",
                "following_url": "https://api.github.com/users/ofseed/following{/other_user}",
                "gists_url": "https://api.github.com/users/ofseed/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ofseed",
                "id": 61115159,
                "login": "ofseed",
                "node_id": "MDQ6VXNlcjYxMTE1MTU5",
                "organizations_url": "https://api.github.com/users/ofseed/orgs",
                "received_events_url": "https://api.github.com/users/ofseed/received_events",
                "repos_url": "https://api.github.com/users/ofseed/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ofseed/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ofseed/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ofseed",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2480102223"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480102223"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I don't think we need to provide a separate `has_pos`; instead, overload the existing `has` to accept a `Pos` as a parameter.",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T03:56:05Z",
            "diff_hunk": "@@ -108,6 +122,15 @@ function Range.has(outer, inner)\n   return outer.start <= inner.start and outer.end_ >= inner.end_\n end\n \n+--- Checks whether {outer} range contains {pos}.\n+---\n+---@param outer vim.Range\n+---@param pos vim.Pos\n+---@return boolean `true` if {outer} range fully contains {post}.\n+function Range.has_pos(outer, pos)",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2480102223",
            "id": 2480102223,
            "line": 130,
            "node_id": "PRRC_kwDOAPphoM6T01tP",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 130,
            "original_position": 70,
            "original_start_line": null,
            "path": "runtime/lua/vim/range.lua",
            "position": 70,
            "pull_request_review_id": 3402488093,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 3,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480102223/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T04:06:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480102223",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61115159?v=4",
                "events_url": "https://api.github.com/users/ofseed/events{/privacy}",
                "followers_url": "https://api.github.com/users/ofseed/followers",
                "following_url": "https://api.github.com/users/ofseed/following{/other_user}",
                "gists_url": "https://api.github.com/users/ofseed/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ofseed",
                "id": 61115159,
                "login": "ofseed",
                "node_id": "MDQ6VXNlcjYxMTE1MTU5",
                "organizations_url": "https://api.github.com/users/ofseed/orgs",
                "received_events_url": "https://api.github.com/users/ofseed/received_events",
                "repos_url": "https://api.github.com/users/ofseed/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ofseed/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ofseed/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ofseed",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2480108401"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480108401"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "`Range` is something I implemented based on the existing `vim.treesitter.Range`. My original idea was to use `vim.Range` to replace all the range types we use internally. Therefore, where possible, I think it would be better for `vim.treesitter` to use `vim.Range`, thereby avoiding the introduction of additional types.",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T04:02:33Z",
            "diff_hunk": "@@ -176,6 +199,197 @@ function Range.lsp(buf, range, position_encoding)\n   return Range.new(start, end_)\n end\n \n+--- Converts |vim.Range| to `integer, integer, integer, integer` equivalent to the result of |TSNode:range()|.\n+---\n+--- Example:\n+--- ```lua\n+--- -- `buf` is required for conversion to Treesitter range.\n+--- local buf = vim.api.nvim_get_current_buf()\n+--- local range = vim.range(3, 5, 4, 0, { buf = buf })\n+---\n+--- -- Convert to Treesitter range, you can call it in a method style.\n+--- local start_row, start_col, end_row, end_col = range:to_treesitter()\n+--- ```\n+---@param range vim.Range\n+---@return integer, integer, integer, integer\n+function Range.to_treesitter(range)",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2480108401",
            "id": 2480108401,
            "line": 215,
            "node_id": "PRRC_kwDOAPphoM6T03Nx",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 215,
            "original_position": 94,
            "original_start_line": null,
            "path": "runtime/lua/vim/range.lua",
            "position": 94,
            "pull_request_review_id": 3402488093,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 2,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 1,
                "total_count": 3,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480108401/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T04:06:43Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2480108401",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/61115159?v=4",
                "events_url": "https://api.github.com/users/ofseed/events{/privacy}",
                "followers_url": "https://api.github.com/users/ofseed/followers",
                "following_url": "https://api.github.com/users/ofseed/following{/other_user}",
                "gists_url": "https://api.github.com/users/ofseed/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/ofseed",
                "id": 61115159,
                "login": "ofseed",
                "node_id": "MDQ6VXNlcjYxMTE1MTU5",
                "organizations_url": "https://api.github.com/users/ofseed/orgs",
                "received_events_url": "https://api.github.com/users/ofseed/received_events",
                "repos_url": "https://api.github.com/users/ofseed/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/ofseed/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ofseed/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/ofseed",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2482131764"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482131764"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "You need to distinguish `start` from `end` to be able to correctly compare (i.e. `<`, `>`, etc) two positions",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T17:06:24Z",
            "diff_hunk": "@@ -10,6 +10,8 @@\n local api = vim.api\n local validate = vim.validate\n \n+---@alias vim.Pos.Type 'start'|'end'",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2482131764",
            "id": 2482131764,
            "in_reply_to_id": 2480091314,
            "line": 13,
            "node_id": "PRRC_kwDOAPphoM6T8lM0",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 13,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/lua/vim/pos.lua",
            "position": 4,
            "pull_request_review_id": 3405254238,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482131764/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T17:51:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482131764",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
                "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
                "followers_url": "https://api.github.com/users/TheLeoP/followers",
                "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
                "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TheLeoP",
                "id": 53507599,
                "login": "TheLeoP",
                "node_id": "MDQ6VXNlcjUzNTA3NTk5",
                "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
                "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
                "repos_url": "https://api.github.com/users/TheLeoP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/TheLeoP",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2482194272"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482194272"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I read `:h api-indexing` as \"there are 3 types of API indexing: regular indexing (0-based, end-exclusive up to n byte), mark indexing (1-based, not mention about end-type), extmark indexing (0-based, end-inclusive up to n + 1 byte )\". But, with testing, I'm seeing that this is more of a conceptual distinction, both regular indexing and extkmark indexing seem to go up to n bytes, but that's considered exclusive for functions like `nvim_buf_get_text` and inclusive for functions like `nvim_buf_get_extmarks`. I can group both together inside of `vim.Pos` and `vim.Range`, is there a preference between using either `extmark` or `api` for both cases?",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T17:27:54Z",
            "diff_hunk": "@@ -203,6 +243,118 @@ function Pos.extmark(pos)\n   return Pos.new(row, col)\n end\n \n+--- Converts |vim.Pos| to treesitter position.\n+---@param pos vim.Pos\n+---@return integer, integer\n+function Pos.to_treesitter(pos)\n+  local col = pos.col\n+  local row = pos.row\n+  if pos.type == 'end' and col == 0 then\n+    row = row - 1\n+    col = #get_line(pos.buf, row)\n+  end\n+  return row, col\n+end\n+\n+--- Creates a new |vim.Pos| from treesitter position.\n+---@param buf integer\n+---@param type vim.Pos.Type\n+---@param row integer\n+---@param col integer\n+function Pos.treesitter(buf, type, row, col)\n+  validate('buf', buf, 'number')\n+  validate('row', row, 'number')\n+  validate('col', col, 'number')\n+\n+  -- TODO(TheLeoP): we are technically losing information here. Treesitter has\n+  -- both kind of end indexing (row_incluvsive-col_exclusive and\n+  -- row_exclusive-col_0). But, does it matter in practice?\n+  if type == 'end' and col > 0 and col == #get_line(buf, row) then\n+    row = row + 1\n+    col = 0\n+  end\n+\n+  return Pos.new(row, col, { buf = buf, type = type })\n+end\n+\n+-- TODO(TheLeoP): does this one require a mandatory `buf`?\n+--- Creates a new |vim.Pos| from vimscript (|builtin-functions|) position.\n+---@param buf integer\n+---@param lnum integer 1-based\n+---@param col integer 1-based\n+function Pos.vimscript(buf, lnum, col)\n+  validate('buf', buf, 'number')\n+  validate('lnum', lnum, 'number')\n+  validate('col', col, 'number')\n+\n+  if col == vim.v.maxcol then\n+    col = 0\n+  else\n+    lnum = lnum - 1\n+    col = col - 1\n+  end\n+\n+  -- TODO(TheLeoP): handle multibyte characters\n+  return Pos.new(lnum, col, { buf = buf })\n+end\n+\n+-- TODO(TheLeoP): should we have an optional parameter `range_type` (line, block, char) and modify\n+-- the range depending on it?\n+--- Creates a new |vim.Pos| from mark-like position.\n+---@param buf integer\n+---@param type vim.Pos.Type\n+---@param range [integer, integer]\n+function Pos.mark(buf, type, range)\n+  validate('buf', buf, 'number')\n+  validate('range', range, 'table')\n+\n+  local row, col = unpack(range)\n+  if type == 'start' then\n+    row = row - 1\n+  elseif type == 'end' then\n+    local row_length = #get_line(buf, row - 1)\n+    col = math.min(row_length, col + 1)\n+    if col == row_length then\n+      col = 0\n+    elseif col ~= 0 then\n+      row = row - 1\n+    end\n+  end\n+\n+  return Pos.new(row, col, { buf = buf, type = type })\n+end\n+\n+--- Converts |vim.Pos| to |api-indexing| position.\n+---@param pos vim.Pos\n+---@return integer, integer",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2482194272",
            "id": 2482194272,
            "in_reply_to_id": 2480100026,
            "line": 329,
            "node_id": "PRRC_kwDOAPphoM6T80dg",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 329,
            "original_position": 219,
            "original_start_line": null,
            "path": "runtime/lua/vim/pos.lua",
            "position": 219,
            "pull_request_review_id": 3405254238,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482194272/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T17:51:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482194272",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
                "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
                "followers_url": "https://api.github.com/users/TheLeoP/followers",
                "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
                "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TheLeoP",
                "id": 53507599,
                "login": "TheLeoP",
                "node_id": "MDQ6VXNlcjUzNTA3NTk5",
                "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
                "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
                "repos_url": "https://api.github.com/users/TheLeoP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/TheLeoP",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36397#discussion_r2482251876"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36397"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482251876"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Got it.\r\n\r\nInitially, my  understanding was that `vim.Range` was meant to always normalize end positions at the end of a line (no matter if they included the newline or not) to be row_exclusive-col_0, but I'm realizing that there's nothing in the original implementation that suggest that. I'll simply document explicitly that row_exclusive-col_0 end positions in ranges include newlines.",
            "commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "created_at": "2025-10-31T17:51:04Z",
            "diff_hunk": "@@ -176,6 +199,197 @@ function Range.lsp(buf, range, position_encoding)\n   return Range.new(start, end_)\n end\n \n+--- Converts |vim.Range| to `integer, integer, integer, integer` equivalent to the result of |TSNode:range()|.\n+---\n+--- Example:\n+--- ```lua\n+--- -- `buf` is required for conversion to Treesitter range.\n+--- local buf = vim.api.nvim_get_current_buf()\n+--- local range = vim.range(3, 5, 4, 0, { buf = buf })\n+---\n+--- -- Convert to Treesitter range, you can call it in a method style.\n+--- local start_row, start_col, end_row, end_col = range:to_treesitter()\n+--- ```\n+---@param range vim.Range\n+---@return integer, integer, integer, integer\n+function Range.to_treesitter(range)",
            "html_url": "https://github.com/neovim/neovim/pull/36397#discussion_r2482251876",
            "id": 2482251876,
            "in_reply_to_id": 2480108401,
            "line": 215,
            "node_id": "PRRC_kwDOAPphoM6T9Chk",
            "original_commit_id": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
            "original_line": 215,
            "original_position": 94,
            "original_start_line": null,
            "path": "runtime/lua/vim/range.lua",
            "position": 94,
            "pull_request_review_id": 3405254238,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482251876/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-10-31T17:51:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2482251876",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
                "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
                "followers_url": "https://api.github.com/users/TheLeoP/followers",
                "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
                "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TheLeoP",
                "id": 53507599,
                "login": "TheLeoP",
                "node_id": "MDQ6VXNlcjUzNTA3NTk5",
                "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
                "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
                "repos_url": "https://api.github.com/users/TheLeoP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/TheLeoP",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "@bfredl Since I don't know the inner workings of indexing, does anything sticks out to you as wrong in this PR?",
            "created_at": "2025-10-30T16:37:24Z",
            "html_url": "https://github.com/neovim/neovim/pull/36397#issuecomment-3468958993",
            "id": 3468958993,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36397",
            "node_id": "IC_kwDOAPphoM7OxB0R",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3468958993/reactions"
            },
            "updated_at": "2025-10-30T16:37:24Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3468958993",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
                "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
                "followers_url": "https://api.github.com/users/TheLeoP/followers",
                "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
                "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TheLeoP",
                "id": 53507599,
                "login": "TheLeoP",
                "node_id": "MDQ6VXNlcjUzNTA3NTk5",
                "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
                "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
                "repos_url": "https://api.github.com/users/TheLeoP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/TheLeoP",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I left a bunch of `TODO(TheLeoP)` comments with doubts about implementation details, so any feedback on them is also welcomed",
            "created_at": "2025-10-30T16:40:03Z",
            "html_url": "https://github.com/neovim/neovim/pull/36397#issuecomment-3468968671",
            "id": 3468968671,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36397",
            "node_id": "IC_kwDOAPphoM7OxELf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3468968671/reactions"
            },
            "updated_at": "2025-10-30T16:40:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3468968671",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
                "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
                "followers_url": "https://api.github.com/users/TheLeoP/followers",
                "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
                "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TheLeoP",
                "id": 53507599,
                "login": "TheLeoP",
                "node_id": "MDQ6VXNlcjUzNTA3NTk5",
                "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
                "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
                "repos_url": "https://api.github.com/users/TheLeoP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/TheLeoP",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Very nice! Can we start with the simplest case (api, or treesitter, or ...) and focus on merging that before moving to the more difficult cases?",
            "created_at": "2025-10-30T23:52:05Z",
            "html_url": "https://github.com/neovim/neovim/pull/36397#issuecomment-3470736904",
            "id": 3470736904,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36397",
            "node_id": "IC_kwDOAPphoM7O3z4I",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3470736904/reactions"
            },
            "updated_at": "2025-10-30T23:52:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3470736904",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Now that I have a better understanding of the whole picture, I'm thinking of doing the following (starting from scratch):\r\n\r\n- implementing 1 and 2 from https://github.com/neovim/neovim/issues/25509#issuecomment-3471197106 (don't nest `vim.Pos` tables inside of `vim.Range` , use numeric indices for both `vim.Pos` and `vim.Range` instead of `row`, `start_row`, etc and use `__index` to allow them to be accessed with `row`, `start_row`, etc) \r\n- add conversion interfaces for `mark` and `vimscript` with tests (I could add only one if that's preffered)\r\n- document the behavior of ranges with row_exclusive-col_0 (as opposed to row_inclusive-col_exclusive) end positions\r\n- overload `vim.Range.has` to also work when `inner` is a  `vim.Pos`\r\n\r\nDoes that sound good? @justinmk \r\n\r\nI would left for a future PR the following:\r\n- Handling the comparison between `start` and `end` positions (either in `vim.Pos` or in `vim.Range)\r\n- Implementing 3 from https://github.com/neovim/neovim/issues/25509#issuecomment-3471197106 (add a `data` field to `vim.Range` to be able to allow ranges to have arbitrary data within them)\r\n- Maybe expose `extmark`/`to_extmark` as `api`/`to_api` instead\r\n- Refactor other usages of custom ranges on Neovim core to use `vim.Range`\r\n- Discuss if the `mark` interface should accept a `range_type` parameter for either char, line or block wise ranges (similar to `:h getregion()`)",
            "created_at": "2025-10-31T18:46:05Z",
            "html_url": "https://github.com/neovim/neovim/pull/36397#issuecomment-3474438656",
            "id": 3474438656,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36397",
            "node_id": "IC_kwDOAPphoM7PF7oA",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3474438656/reactions"
            },
            "updated_at": "2025-10-31T18:47:52Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3474438656",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
                "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
                "followers_url": "https://api.github.com/users/TheLeoP/followers",
                "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
                "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TheLeoP",
                "id": 53507599,
                "login": "TheLeoP",
                "node_id": "MDQ6VXNlcjUzNTA3NTk5",
                "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
                "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
                "repos_url": "https://api.github.com/users/TheLeoP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/TheLeoP",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36397/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/36397/commits",
    "created_at": "2025-10-30T16:33:29Z",
    "diff_url": "https://github.com/neovim/neovim/pull/36397.diff",
    "draft": false,
    "head": {
        "label": "TheLeoP:vim.range",
        "ref": "vim.range",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/TheLeoP/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/TheLeoP/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/TheLeoP/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/TheLeoP/neovim/branches{/branch}",
            "clone_url": "https://github.com/TheLeoP/neovim.git",
            "collaborators_url": "https://api.github.com/repos/TheLeoP/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/TheLeoP/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/TheLeoP/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/TheLeoP/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/TheLeoP/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/TheLeoP/neovim/contributors",
            "created_at": "2025-10-30T16:21:12Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/TheLeoP/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/TheLeoP/neovim/downloads",
            "events_url": "https://api.github.com/repos/TheLeoP/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/TheLeoP/neovim/forks",
            "full_name": "TheLeoP/neovim",
            "git_commits_url": "https://api.github.com/repos/TheLeoP/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/TheLeoP/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/TheLeoP/neovim/git/tags{/sha}",
            "git_url": "git://github.com/TheLeoP/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/TheLeoP/neovim/hooks",
            "html_url": "https://github.com/TheLeoP/neovim",
            "id": 1086593699,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/TheLeoP/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/TheLeoP/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/TheLeoP/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/TheLeoP/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/TheLeoP/neovim/labels{/name}",
            "language": null,
            "languages_url": "https://api.github.com/repos/TheLeoP/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/TheLeoP/neovim/merges",
            "milestones_url": "https://api.github.com/repos/TheLeoP/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOQMQaow",
            "notifications_url": "https://api.github.com/repos/TheLeoP/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
                "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
                "followers_url": "https://api.github.com/users/TheLeoP/followers",
                "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
                "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TheLeoP",
                "id": 53507599,
                "login": "TheLeoP",
                "node_id": "MDQ6VXNlcjUzNTA3NTk5",
                "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
                "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
                "repos_url": "https://api.github.com/users/TheLeoP/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/TheLeoP",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/TheLeoP/neovim/pulls{/number}",
            "pushed_at": "2025-10-30T16:22:56Z",
            "releases_url": "https://api.github.com/repos/TheLeoP/neovim/releases{/id}",
            "size": 338294,
            "ssh_url": "git@github.com:TheLeoP/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/TheLeoP/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/TheLeoP/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/TheLeoP/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/TheLeoP/neovim/subscription",
            "svn_url": "https://github.com/TheLeoP/neovim",
            "tags_url": "https://api.github.com/repos/TheLeoP/neovim/tags",
            "teams_url": "https://api.github.com/repos/TheLeoP/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/TheLeoP/neovim/git/trees{/sha}",
            "updated_at": "2025-10-30T16:21:12Z",
            "url": "https://api.github.com/repos/TheLeoP/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "77cb75d8f130e73f7994e6f34c3bf156710c20c8",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
            "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
            "followers_url": "https://api.github.com/users/TheLeoP/followers",
            "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
            "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/TheLeoP",
            "id": 53507599,
            "login": "TheLeoP",
            "node_id": "MDQ6VXNlcjUzNTA3NTk5",
            "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
            "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
            "repos_url": "https://api.github.com/users/TheLeoP/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/TheLeoP",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/36397",
    "id": 2963901612,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36397",
    "labels": [],
    "locked": false,
    "merge_commit_sha": "b51ecfa3f9e464516faac89ae5e1a12121990534",
    "merged_at": null,
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6wqYys",
    "number": 36397,
    "patch_url": "https://github.com/neovim/neovim/pull/36397.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/36397/comments",
    "state": "open",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/77cb75d8f130e73f7994e6f34c3bf156710c20c8",
    "title": "feat: extend vim.Pos and vim.Range",
    "updated_at": "2025-10-31T18:47:52Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/36397",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/53507599?v=4",
        "events_url": "https://api.github.com/users/TheLeoP/events{/privacy}",
        "followers_url": "https://api.github.com/users/TheLeoP/followers",
        "following_url": "https://api.github.com/users/TheLeoP/following{/other_user}",
        "gists_url": "https://api.github.com/users/TheLeoP/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/TheLeoP",
        "id": 53507599,
        "login": "TheLeoP",
        "node_id": "MDQ6VXNlcjUzNTA3NTk5",
        "organizations_url": "https://api.github.com/users/TheLeoP/orgs",
        "received_events_url": "https://api.github.com/users/TheLeoP/received_events",
        "repos_url": "https://api.github.com/users/TheLeoP/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/TheLeoP/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/TheLeoP/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/TheLeoP",
        "user_view_type": "public"
    }
}
{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/32407/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/32407/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/32407"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/32407"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/32407/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/a7171f248011cf96f8a26c4d58a17b5586bfaf5c"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 5870,
            "forks_count": 5870,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 1861,
            "open_issues_count": 1861,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-02-17T23:14:59Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 308398,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 86255,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-02-18T02:05:55Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 86255,
            "watchers_count": 86255,
            "web_commit_signoff_required": false
        },
        "sha": "8117db48ed5939dcb93e84f6e740c1b46317dd31",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "See https://github.com/neovim/neovim/issues/32402.\r\n\r\nThis triggers a `TermRequest` any time a APC `VTermStringFragment` is received.\r\n\r\n- [x] need handle not yet terminated requests, either by waiting for `\\e\\\\` before triggering or implementing a request type parameter on the event data, currently it will always prepend `\\e_` as the identifying string.\r\n- [x] implement test\r\n- [x] update docs",
    "closed_at": "2025-02-13T14:24:02Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1952893579"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1952893579"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\r\n• The |terminal| emits a |TermRequest| autocommand event when the\r\n```",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T15:33:44Z",
            "diff_hunk": "@@ -371,6 +371,8 @@ TERMINAL\n • The |terminal| has experimental support for the Kitty keyboard protocol\n   (sometimes called \"CSI u\" key encoding). Only the \"Disambiguate escape\n   codes\" mode is currently supported.\n+• The |terminal| now additionally emits a |TermRequest| autocommand event when the",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1952893579",
            "id": 1952893579,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50ZsqL",
            "original_commit_id": "dfffbfef5517f8991ada1c19adfae09515886980",
            "original_line": 374,
            "original_position": 4,
            "original_start_line": null,
            "path": "runtime/doc/news.txt",
            "position": null,
            "pull_request_review_id": 2612351248,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1952893579/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T15:33:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1952893579",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953291509"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953291509"
                }
            },
            "author_association": "MEMBER",
            "body": "We should `xmemdupz` the termrequest buffer before passing to `schedule_termrequest`, otherwise there is a race condition (if `on_osc` is called again before `emit_termrequest` is called, you've just overwritten the buffer).",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T19:38:55Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953291509",
            "id": 1953291509,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bNz1",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 318,
            "original_position": 25,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613019694,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953291509/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T19:38:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953291509",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953293052"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953293052"
                }
            },
            "author_association": "MEMBER",
            "body": "Same thing but imo a little nicer to read.\r\n\r\n```suggestion\r\n      kv_size(term->termrequest_buffer) = 0;\r\n```",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T19:40:06Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953293052",
            "id": 1953293052,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bOL8",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 314,
            "original_position": 19,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613022091,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953293052/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T19:40:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953293052",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953297096"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953297096"
                }
            },
            "author_association": "MEMBER",
            "body": "Add a doc comment here please",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T19:43:20Z",
            "diff_hunk": "@@ -186,6 +186,8 @@ struct terminal {\n   char *selection_buffer;  /// libvterm selection buffer\n   StringBuilder selection;  /// Growable array containing full selection data\n \n+  StringBuilder termrequest_buffer;",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953297096",
            "id": 1953297096,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bPLI",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 189,
            "original_position": 4,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613028531,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953297096/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T19:43:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953297096",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953297996"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953297996"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\r\n    kv_size(term->termrequest_buffer) = 0;\r\n```",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T19:44:06Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);\n+    kv_init(term->termrequest_buffer);\n+  }\n   return 1;\n }\n \n static int on_dcs(const char *command, size_t commandlen, VTermStringFragment frag, void *user)\n {\n+  Terminal *term = user;\n+\n   if (command == NULL || frag.str == NULL) {\n     return 0;\n   }\n   if (!has_event(EVENT_TERMREQUEST)) {\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1bP%*s\", (int)commandlen, command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(user, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953297996",
            "id": 1953297996,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bPZM",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 340,
            "original_position": 49,
            "original_start_line": 338,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613030007,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953297996/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-02-12T19:44:06Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953297996",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953298824"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953298824"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\r\n    kv_size(term->termrequest_buffer) = 0;\r\n```",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T19:44:47Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);\n+    kv_init(term->termrequest_buffer);\n+  }\n   return 1;\n }\n \n static int on_dcs(const char *command, size_t commandlen, VTermStringFragment frag, void *user)\n {\n+  Terminal *term = user;\n+\n   if (command == NULL || frag.str == NULL) {\n     return 0;\n   }\n   if (!has_event(EVENT_TERMREQUEST)) {\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1bP%*s\", (int)commandlen, command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(user, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1bP%*s\", (int)commandlen, command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);\n+    kv_init(term->termrequest_buffer);\n+  }\n+  return 1;\n+}\n+\n+static int on_apc(VTermStringFragment frag, void *user)\n+{\n+  Terminal *term = user;\n+  if (frag.str == NULL || frag.len == 0) {\n+    return 0;\n+  }\n+\n+  if (!has_event(EVENT_TERMREQUEST)) {\n+    return 1;\n+  }\n+\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953298824",
            "id": 1953298824,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bPmI",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 365,
            "original_position": 74,
            "original_start_line": 363,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613031394,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953298824/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-02-12T19:44:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953298824",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953299153"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953299153"
                }
            },
            "author_association": "MEMBER",
            "body": "Don't include terminator.\r\n\r\n```suggestion\r\n```",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T19:45:05Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);\n+    kv_init(term->termrequest_buffer);\n+  }\n   return 1;\n }\n \n static int on_dcs(const char *command, size_t commandlen, VTermStringFragment frag, void *user)\n {\n+  Terminal *term = user;\n+\n   if (command == NULL || frag.str == NULL) {\n     return 0;\n   }\n   if (!has_event(EVENT_TERMREQUEST)) {\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1bP%*s\", (int)commandlen, command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(user, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1bP%*s\", (int)commandlen, command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);\n+    kv_init(term->termrequest_buffer);\n+  }\n+  return 1;\n+}\n+\n+static int on_apc(VTermStringFragment frag, void *user)\n+{\n+  Terminal *term = user;\n+  if (frag.str == NULL || frag.len == 0) {\n+    return 0;\n+  }\n+\n+  if (!has_event(EVENT_TERMREQUEST)) {\n+    return 1;\n+  }\n+\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b_\");\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    kv_printf(term->termrequest_buffer, \"\\x1b\\\\\");",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953299153",
            "id": 1953299153,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bPrR",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 370,
            "original_position": 79,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613031953,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953299153/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T19:45:12Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953299153",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953299854"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953299854"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Doesn't the `kv_init` call immediately after that line set the `items` pointer back to `NULL`?",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T19:45:39Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953299854",
            "id": 1953299854,
            "in_reply_to_id": 1953291509,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bP2O",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 318,
            "original_position": 25,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613033067,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953299854/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T19:45:54Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953299854",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953330596"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953330596"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I looked at it again and `term->termrequest_buffer.items` gets set to `NULL`, completely disowning that pointer (it gets freed later in `emit_termrequest`). The next `on_*` call will then allocate a new one. I might be seriously misunderstanding something though.",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T20:11:01Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953330596",
            "id": 1953330596,
            "in_reply_to_id": 1953291509,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bXWk",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 318,
            "original_position": 25,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613088900,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953330596/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T20:11:20Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953330596",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953341775"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953341775"
                }
            },
            "author_association": "MEMBER",
            "body": "Ah yea you're right. Still, I'd rather we `xmemdupz` the items and _not_ re-init the buffer. This will give us slightly fewer re-allocations if we get many long sequences (rather than re-growing the buffer every time, we can re-use the buffer).",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T20:20:45Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953341775",
            "id": 1953341775,
            "in_reply_to_id": 1953291509,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50baFP",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 318,
            "original_position": 25,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613107275,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953341775/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T20:20:46Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953341775",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953346365"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953346365"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Good point, I'll change it.",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T20:24:50Z",
            "diff_hunk": "@@ -307,26 +309,68 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n     return 1;\n   }\n \n-  StringBuilder request = KV_INITIAL_VALUE;\n-  kv_printf(request, \"\\x1b]%d;\", command);\n-  kv_concat_len(request, frag.str, frag.len);\n-  schedule_termrequest(term, request.items, request.size);\n+  if (frag.initial) {\n+    if (kv_size(term->termrequest_buffer) > 0) {\n+      kv_drop(term->termrequest_buffer, kv_size(term->termrequest_buffer));\n+    }\n+    kv_printf(term->termrequest_buffer, \"\\x1b]%d;\", command);\n+  }\n+  kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n+  if (frag.final) {\n+    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953346365",
            "id": 1953346365,
            "in_reply_to_id": 1953291509,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50bbM9",
            "original_commit_id": "1692b798b08be90732b450b6624daa069b3290f9",
            "original_line": 318,
            "original_position": 25,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613114863,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953346365/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T20:24:50Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953346365",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953388990"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953388990"
                }
            },
            "author_association": "MEMBER",
            "body": "This is my mistake, I asked you to use `xmemdupz` but since we are passing the length to `schedule_termrequest` we don't need the null sentinel, so `xmemdup` will do. I'll fix that up.",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-12T20:57:32Z",
            "diff_hunk": "@@ -315,8 +315,8 @@ static int on_osc(int command, VTermStringFragment frag, void *user)\n   }\n   kv_concat_len(term->termrequest_buffer, frag.str, frag.len);\n   if (frag.final) {\n-    schedule_termrequest(user, term->termrequest_buffer.items, term->termrequest_buffer.size);\n-    kv_init(term->termrequest_buffer);\n+    char *payload = xmemdupz(term->termrequest_buffer.items, term->termrequest_buffer.size);",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953388990",
            "id": 1953388990,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50blm-",
            "original_commit_id": "cde11e4ca62c5b678b0be2806ec6c013bebd9635",
            "original_line": 318,
            "original_position": 6,
            "original_start_line": null,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613187925,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953388990/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-02-12T20:57:33Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953388990",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/32407#discussion_r1953600958"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/32407"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953600958"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\r\n  char *selection_buffer;  ///< libvterm selection buffer\r\n  StringBuilder selection;  ///< Growable array containing full selection data\r\n\r\n  StringBuilder termrequest_buffer;  ///< Growable array containing unfinished request payload\r\n```",
            "commit_id": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
            "created_at": "2025-02-13T00:34:20Z",
            "diff_hunk": "@@ -186,6 +186,8 @@ struct terminal {\n   char *selection_buffer;  /// libvterm selection buffer\n   StringBuilder selection;  /// Growable array containing full selection data\n \n+  StringBuilder termrequest_buffer;  /// Growable array containing unfinished request payload",
            "html_url": "https://github.com/neovim/neovim/pull/32407#discussion_r1953600958",
            "id": 1953600958,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM50cZW-",
            "original_commit_id": "95c7e04b118f8566f68472e459c144e7b8b363af",
            "original_line": 189,
            "original_position": 4,
            "original_start_line": 186,
            "path": "src/nvim/terminal.c",
            "position": null,
            "pull_request_review_id": 2613549171,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953600958/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-02-13T00:34:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/1953600958",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/35768171?v=4",
                "events_url": "https://api.github.com/users/zeertzjq/events{/privacy}",
                "followers_url": "https://api.github.com/users/zeertzjq/followers",
                "following_url": "https://api.github.com/users/zeertzjq/following{/other_user}",
                "gists_url": "https://api.github.com/users/zeertzjq/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/zeertzjq",
                "id": 35768171,
                "login": "zeertzjq",
                "node_id": "MDQ6VXNlcjM1NzY4MTcx",
                "organizations_url": "https://api.github.com/users/zeertzjq/orgs",
                "received_events_url": "https://api.github.com/users/zeertzjq/received_events",
                "repos_url": "https://api.github.com/users/zeertzjq/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/zeertzjq/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/zeertzjq/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/zeertzjq",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "APC requests are now buffered until the entire string is collected in the callback, only then is `TermRequest` triggered. I think this is the easiest option to handle this. If people agree I'll also do that for the DCS and OSC handlers, and add some tests.",
            "created_at": "2025-02-12T14:33:27Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2653886541",
            "id": 2653886541,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eLxhN",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2653886541/reactions"
            },
            "updated_at": "2025-02-12T14:33:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2653886541",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> I'll also do that for the DCS and OSC handlers,\r\n\r\nAt a high level that SGTM but @gpanders has more context and can say whether there's a reason not to.\r\n\r\nBTW, if the buffered payload is never \"completed\", what happens? For bracketed paste, that is currently an undefined situation, and Nvim can get \"stuck\" waiting for the sequence to complete. Ideally, we should timeout (and log an error, possibly also raise a `EXX` error) if the sequence never completes. But that should probably be a separate PR.",
            "created_at": "2025-02-12T15:32:34Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654070206",
            "id": 2654070206,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eMeW-",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654070206/reactions"
            },
            "updated_at": "2025-02-12T15:36:11Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654070206",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thanks for the review!\r\n\r\nAs far as I understand the spec DCS and OSC should also be terminated by ST (or BEL) and therefore need to be buffered as well. Also currently the payload for DCS and OSC events does not include the terminating ST, I think it is more consistent to include that since we include the command sequence in the beginning as well, then the payload would be the entire valid DCS or OSC sequence. But yes, I'd also be happy to leave them as is if there is a reason they should not be buffered.\r\n\r\nI also thought a bit about what happens when the payload is never completed. I think rather than adding a timeout, vterm should indicate when it leaves a string state without receiving a string terminator.\r\n\r\nEdit: I think for now at least the buffer should be cleared if a new request is received and it is not empty. I'm happy to open a new PR to properly handle this, if there is agreement on how.",
            "created_at": "2025-02-12T16:15:49Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654206202",
            "id": 2654206202,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eM_j6",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654206202/reactions"
            },
            "updated_at": "2025-02-12T16:22:14Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654206202",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I left the ST out of the DCS and OSC payloads for now, because adding it would mean updating a bunch of tests and I only want to do that if we agree to add the ST to the payloads.",
            "created_at": "2025-02-12T17:37:05Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654418696",
            "id": 2654418696,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eNzcI",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654418696/reactions"
            },
            "updated_at": "2025-02-12T17:37:05Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654418696",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "I'll mark this as ready even though there are some open questions, just to signal that I think that apart from these small things the PR is done.",
            "created_at": "2025-02-12T19:17:04Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654633636",
            "id": 2654633636,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eOn6k",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654633636/reactions"
            },
            "updated_at": "2025-02-12T19:17:04Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654633636",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">Also currently the payload for DCS and OSC events does not include the terminating ST, I think it is more consistent to include that\r\n\r\nNo because DCS and OSC can be terminated either by ST or BEL and users shouldn't have to care which with their pattern.\r\n\r\nThere's also no reason to. The event data has the entire sequence. The terminator isn't needed.",
            "created_at": "2025-02-12T19:34:56Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654669848",
            "id": 2654669848,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eOwwY",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654669848/reactions"
            },
            "updated_at": "2025-02-12T19:34:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654669848",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">BTW, if the buffered payload is never \"completed\", what happens? \r\n\r\nIf the sequence is never terminated then the buffer stays populated until a new sequence arrives, at which point the old contents of the buffer are ~~flushed~~ dropped.",
            "created_at": "2025-02-12T19:35:50Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654672244",
            "id": 2654672244,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eOxV0",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654672244/reactions"
            },
            "updated_at": "2025-02-12T20:21:27Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654672244",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "CONTRIBUTOR",
            "body": "Thank you so much for the review!\r\n\r\n> If the sequence is never terminated then the buffer stays populated until a new sequence arrives, at which point the old contents of the buffer are flushed.\r\n\r\nFlushed as in sent out or as in dropped like it is now?",
            "created_at": "2025-02-12T19:48:14Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654696357",
            "id": 2654696357,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eO3Ol",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654696357/reactions"
            },
            "updated_at": "2025-02-13T14:51:55Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654696357",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> Flushed as in sent out or as in dropped like it is now?\r\n\r\nYes dropped, thanks for the correction.",
            "created_at": "2025-02-12T20:21:16Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2654759835",
            "id": 2654759835,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6ePGub",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654759835/reactions"
            },
            "updated_at": "2025-02-13T14:52:02Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2654759835",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Thanks @tbung!",
            "created_at": "2025-02-13T14:24:13Z",
            "html_url": "https://github.com/neovim/neovim/pull/32407#issuecomment-2656754091",
            "id": 2656754091,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
            "node_id": "IC_kwDOAPphoM6eWtmr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 2,
                "total_count": 2,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2656754091/reactions"
            },
            "updated_at": "2025-02-13T14:24:13Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/2656754091",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
                "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
                "followers_url": "https://api.github.com/users/gpanders/followers",
                "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
                "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/gpanders",
                "id": 8965202,
                "login": "gpanders",
                "node_id": "MDQ6VXNlcjg5NjUyMDI=",
                "organizations_url": "https://api.github.com/users/gpanders/orgs",
                "received_events_url": "https://api.github.com/users/gpanders/received_events",
                "repos_url": "https://api.github.com/users/gpanders/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/gpanders",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/32407/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/32407/commits",
    "created_at": "2025-02-11T20:17:38Z",
    "diff_url": "https://github.com/neovim/neovim/pull/32407.diff",
    "draft": false,
    "head": {
        "label": "tbung:forward-apc",
        "ref": "forward-apc",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/tbung/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/tbung/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/tbung/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/tbung/neovim/branches{/branch}",
            "clone_url": "https://github.com/tbung/neovim.git",
            "collaborators_url": "https://api.github.com/repos/tbung/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/tbung/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/tbung/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/tbung/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/tbung/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/tbung/neovim/contributors",
            "created_at": "2023-09-27T14:45:42Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/tbung/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/tbung/neovim/downloads",
            "events_url": "https://api.github.com/repos/tbung/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/tbung/neovim/forks",
            "full_name": "tbung/neovim",
            "git_commits_url": "https://api.github.com/repos/tbung/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/tbung/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/tbung/neovim/git/tags{/sha}",
            "git_url": "git://github.com/tbung/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/tbung/neovim/hooks",
            "html_url": "https://github.com/tbung/neovim",
            "id": 697348391,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/tbung/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/tbung/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/tbung/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/tbung/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/tbung/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/tbung/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/tbung/neovim/merges",
            "milestones_url": "https://api.github.com/repos/tbung/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "R_kgDOKZCxJw",
            "notifications_url": "https://api.github.com/repos/tbung/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
                "events_url": "https://api.github.com/users/tbung/events{/privacy}",
                "followers_url": "https://api.github.com/users/tbung/followers",
                "following_url": "https://api.github.com/users/tbung/following{/other_user}",
                "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tbung",
                "id": 4084982,
                "login": "tbung",
                "node_id": "MDQ6VXNlcjQwODQ5ODI=",
                "organizations_url": "https://api.github.com/users/tbung/orgs",
                "received_events_url": "https://api.github.com/users/tbung/received_events",
                "repos_url": "https://api.github.com/users/tbung/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tbung",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/tbung/neovim/pulls{/number}",
            "pushed_at": "2025-02-17T05:12:24Z",
            "releases_url": "https://api.github.com/repos/tbung/neovim/releases{/id}",
            "size": 300460,
            "ssh_url": "git@github.com:tbung/neovim.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/tbung/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/tbung/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/tbung/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/tbung/neovim/subscription",
            "svn_url": "https://github.com/tbung/neovim",
            "tags_url": "https://api.github.com/repos/tbung/neovim/tags",
            "teams_url": "https://api.github.com/repos/tbung/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/tbung/neovim/git/trees{/sha}",
            "updated_at": "2025-02-15T11:52:52Z",
            "url": "https://api.github.com/repos/tbung/neovim",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
            "events_url": "https://api.github.com/users/tbung/events{/privacy}",
            "followers_url": "https://api.github.com/users/tbung/followers",
            "following_url": "https://api.github.com/users/tbung/following{/other_user}",
            "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/tbung",
            "id": 4084982,
            "login": "tbung",
            "node_id": "MDQ6VXNlcjQwODQ5ODI=",
            "organizations_url": "https://api.github.com/users/tbung/orgs",
            "received_events_url": "https://api.github.com/users/tbung/received_events",
            "repos_url": "https://api.github.com/users/tbung/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/tbung",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/32407",
    "id": 2329664844,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/32407",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "built-in :terminal or :shell",
            "id": 212696822,
            "name": "terminal",
            "node_id": "MDU6TGFiZWwyMTI2OTY4MjI=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/terminal"
        }
    ],
    "locked": false,
    "merge_commit_sha": "93480f7fbaa5b4e5418d95dd35005daa6142dbb9",
    "merged_at": "2025-02-13T14:24:02Z",
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6K291M",
    "number": 32407,
    "patch_url": "https://github.com/neovim/neovim/pull/32407.patch",
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/32407/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/a7171f248011cf96f8a26c4d58a17b5586bfaf5c",
    "title": "feat(term): trigger TermRequest for APC",
    "updated_at": "2025-02-13T14:52:02Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/32407",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/4084982?v=4",
        "events_url": "https://api.github.com/users/tbung/events{/privacy}",
        "followers_url": "https://api.github.com/users/tbung/followers",
        "following_url": "https://api.github.com/users/tbung/following{/other_user}",
        "gists_url": "https://api.github.com/users/tbung/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/tbung",
        "id": 4084982,
        "login": "tbung",
        "node_id": "MDQ6VXNlcjQwODQ5ODI=",
        "organizations_url": "https://api.github.com/users/tbung/orgs",
        "received_events_url": "https://api.github.com/users/tbung/received_events",
        "repos_url": "https://api.github.com/users/tbung/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/tbung/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tbung/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/tbung",
        "user_view_type": "public"
    }
}
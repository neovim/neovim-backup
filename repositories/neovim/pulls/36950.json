{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36950/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36950/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/36950"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/36950"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36950/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/766f5d1cc140720e80846325bc3cc0d1e7dbdef9"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 6460,
            "forks_count": 6460,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 2031,
            "open_issues_count": 2031,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-12-15T23:50:03Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 355921,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 94967,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-12-16T02:41:18Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 94967,
            "watchers_count": 94967,
            "web_commit_signoff_required": false
        },
        "sha": "9c6ce77aa4b3ea6c9ed12975ae9ef8cd85f19c3a",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "The previous iteration of range support allowed multiple active requests to be in progress simultaneously. The original work was going to attempt to support doing range requests simultaneously with a full request so that range requests could show highlights more quickly until the full request was received and processed.\r\n\r\nHowever, a bug was preventing any but the most recent request to actually apply to the client's highlighting state and the simultaneous range+full functionality was not implemented, so that complexity was unused. It was effectively only using one active request at a time but was just using range requests on WinScrolled events instead of a full (or delta) request when the document version changed.\r\n\r\nThis PR reverts the complexity around having multiple active requests at a time. It doesn't change any visible behavior other than fixing a couple bugs that were occurring for non-range-supported LSP servers (like sending full/delta requests on every WinScrolled event).\r\n\r\nA possible future enhancement could be to track the ranges that have been requested and successfully processed on the current result, and then do a range intersection to only request ranges that haven't been requested/processed yet, or at least the smallest single visible range that encapsulates all unprocessed ranges so far. Then when processing the responses, merge the results with previous highlights (order must be maintained for the binary searches on this list), and then clear it all and start over whenever the document version changes. This would prevent doing duplicate work for the same document version as the window is scrolled and would also help prevent the tokens' highlights from \"flickering\" in and out as the window is scrolled around.\r\n\r\nFixes #36928\r\nClose #36942",
    "closed_at": null,
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2616904552"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616904552"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I removed this in the original PR as it wasnt clear _why_ we relook up the client.\nCan you explain why?",
            "commit_id": "543c21b090257ceaa9af287d2dd5ad1fa08b58e8",
            "created_at": "2025-12-14T10:23:38Z",
            "diff_hunk": "@@ -266,63 +249,56 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n+      local active_request = state.active_request\n \n-      local new_version = current_result.version ~= version and full_request_version ~= version\n+      local supports_range = client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+      local supports_delta = client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr)\n \n-      if new_version or range then\n-        -- Cancel stale in-flight request\n-        if new_version then\n-          self:cancel_all_requests(client)\n+      if (supports_range and range) or (current_result.version ~= version and active_request.version ~= version) then\n+        -- cancel stale in-flight request\n+        if active_request.request_id then\n+          client:cancel_request(active_request.request_id)\n+          active_request = {}\n+          state.active_request = active_request\n         end\n \n+        ---@class lsp.SemanticTokensParams\n         local params = { textDocument = util.make_text_document_params(self.bufnr) }\n \n         ---@type vim.lsp.protocol.Method.ClientToServer.Request\n         local method = 'textDocument/semanticTokens/full'\n \n-        if client:supports_method('textDocument/semanticTokens/range', self.bufnr) then\n+        if supports_range then\n           method = 'textDocument/semanticTokens/range'\n-          if range then\n-            params.range = range\n-          else\n-            -- If no range is provided, send requests for all visible ranges\n-            -- This should be made better/removed once we can record capability  for textDocument/semanticTokens/range\n-            -- only\n-            local visible_range = self:get_visible_range()\n-            self:send_request(visible_range)\n-            return\n-          end\n-        elseif client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr) then\n-          if current_result.result_id then\n-            method = 'textDocument/semanticTokens/full/delta'\n-            params.previousResultId = current_result.result_id\n-          end\n-        elseif not client:supports_method('textDocument/semanticTokens/full', self.bufnr) then\n-          -- No suitable provider, skip this client\n-          return\n+          params.range = range or self:get_visible_range()\n+        elseif supports_delta and current_result.result_id then\n+          method = 'textDocument/semanticTokens/full/delta'\n+          params.previousResultId = current_result.result_id\n         end\n \n         ---@param response? lsp.SemanticTokens|lsp.SemanticTokensDelta\n         local success, request_id = client:request(method, params, function(err, response, ctx)\n+          -- look client up again using ctx.client_id instead of using a captured\n+          -- client object\n+          local c = vim.lsp.get_client_by_id(ctx.client_id)",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2616904552",
            "id": 2616904552,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6b-sto",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 287,
            "original_position": 132,
            "original_start_line": 281,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3574957401,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616904552/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-14T10:43:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616904552",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18444302?v=4",
                "events_url": "https://api.github.com/users/tris203/events{/privacy}",
                "followers_url": "https://api.github.com/users/tris203/followers",
                "following_url": "https://api.github.com/users/tris203/following{/other_user}",
                "gists_url": "https://api.github.com/users/tris203/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tris203",
                "id": 18444302,
                "login": "tris203",
                "node_id": "MDQ6VXNlcjE4NDQ0MzAy",
                "organizations_url": "https://api.github.com/users/tris203/orgs",
                "received_events_url": "https://api.github.com/users/tris203/received_events",
                "repos_url": "https://api.github.com/users/tris203/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tris203/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tris203/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tris203",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2616904990"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616904990"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I dont think you need this it should be infered",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-14T10:24:00Z",
            "diff_hunk": "@@ -602,9 +556,13 @@ function STHighlighter:reset()\n   for client_id, state in pairs(self.client_state) do\n     api.nvim_buf_clear_namespace(self.bufnr, state.namespace, 0, -1)\n     state.current_result = {}\n-    local client = vim.lsp.get_client_by_id(client_id)\n-    assert(client)\n-    self:cancel_all_requests(client)\n+    if state.active_request.request_id then\n+      ---@type vim.lsp.Client|nil",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2616904990",
            "id": 2616904990,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6b-s0e",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 567,
            "original_position": 229,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3574957401,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616904990/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-14T10:43:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616904990",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18444302?v=4",
                "events_url": "https://api.github.com/users/tris203/events{/privacy}",
                "followers_url": "https://api.github.com/users/tris203/followers",
                "following_url": "https://api.github.com/users/tris203/following{/other_user}",
                "gists_url": "https://api.github.com/users/tris203/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tris203",
                "id": 18444302,
                "login": "tris203",
                "node_id": "MDQ6VXNlcjE4NDQ0MzAy",
                "organizations_url": "https://api.github.com/users/tris203/orgs",
                "received_events_url": "https://api.github.com/users/tris203/received_events",
                "repos_url": "https://api.github.com/users/tris203/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tris203/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tris203/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tris203",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2616905176"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616905176"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I think it should also be infered here",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-14T10:24:10Z",
            "diff_hunk": "@@ -626,9 +584,14 @@ function STHighlighter:mark_dirty(client_id)\n   if state.current_result then\n     state.current_result.version = nil\n   end\n-  local client = vim.lsp.get_client_by_id(client_id)\n-  assert(client)\n-  self:cancel_all_requests(client)\n+\n+  if state.active_request.request_id then\n+    ---@type vim.lsp.Client|nil",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2616905176",
            "id": 2616905176,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6b-s3Y",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 596,
            "original_position": 247,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3574957401,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616905176/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-14T10:43:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616905176",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18444302?v=4",
                "events_url": "https://api.github.com/users/tris203/events{/privacy}",
                "followers_url": "https://api.github.com/users/tris203/followers",
                "following_url": "https://api.github.com/users/tris203/following{/other_user}",
                "gists_url": "https://api.github.com/users/tris203/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tris203",
                "id": 18444302,
                "login": "tris203",
                "node_id": "MDQ6VXNlcjE4NDQ0MzAy",
                "organizations_url": "https://api.github.com/users/tris203/orgs",
                "received_events_url": "https://api.github.com/users/tris203/received_events",
                "repos_url": "https://api.github.com/users/tris203/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tris203/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tris203/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tris203",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2616909370"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616909370"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Minor perf, but if we inline these then we save time looking up the capability until its about to be used",
            "commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "created_at": "2025-12-14T10:32:01Z",
            "diff_hunk": "@@ -266,63 +249,56 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n+      local active_request = state.active_request\n \n-      local new_version = current_result.version ~= version and full_request_version ~= version\n+      local supports_range = client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+      local supports_delta = client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr)",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2616909370",
            "id": 2616909370,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6b-t46",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 255,
            "original_position": 81,
            "original_start_line": 254,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3574957401,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616909370/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-14T10:43:21Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2616909370",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/18444302?v=4",
                "events_url": "https://api.github.com/users/tris203/events{/privacy}",
                "followers_url": "https://api.github.com/users/tris203/followers",
                "following_url": "https://api.github.com/users/tris203/following{/other_user}",
                "gists_url": "https://api.github.com/users/tris203/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/tris203",
                "id": 18444302,
                "login": "tris203",
                "node_id": "MDQ6VXNlcjE4NDQ0MzAy",
                "organizations_url": "https://api.github.com/users/tris203/orgs",
                "received_events_url": "https://api.github.com/users/tris203/received_events",
                "repos_url": "https://api.github.com/users/tris203/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/tris203/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/tris203/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/tris203",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617097526"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617097526"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "If the client is destroyed while the request is outstanding, then having it captured here prevents garbage collection. If we do this instead, we allow the client to be destroyed (possibly) and then this response does nothing.",
            "commit_id": "543c21b090257ceaa9af287d2dd5ad1fa08b58e8",
            "created_at": "2025-12-14T13:26:16Z",
            "diff_hunk": "@@ -266,63 +249,56 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n+      local active_request = state.active_request\n \n-      local new_version = current_result.version ~= version and full_request_version ~= version\n+      local supports_range = client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+      local supports_delta = client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr)\n \n-      if new_version or range then\n-        -- Cancel stale in-flight request\n-        if new_version then\n-          self:cancel_all_requests(client)\n+      if (supports_range and range) or (current_result.version ~= version and active_request.version ~= version) then\n+        -- cancel stale in-flight request\n+        if active_request.request_id then\n+          client:cancel_request(active_request.request_id)\n+          active_request = {}\n+          state.active_request = active_request\n         end\n \n+        ---@class lsp.SemanticTokensParams\n         local params = { textDocument = util.make_text_document_params(self.bufnr) }\n \n         ---@type vim.lsp.protocol.Method.ClientToServer.Request\n         local method = 'textDocument/semanticTokens/full'\n \n-        if client:supports_method('textDocument/semanticTokens/range', self.bufnr) then\n+        if supports_range then\n           method = 'textDocument/semanticTokens/range'\n-          if range then\n-            params.range = range\n-          else\n-            -- If no range is provided, send requests for all visible ranges\n-            -- This should be made better/removed once we can record capability  for textDocument/semanticTokens/range\n-            -- only\n-            local visible_range = self:get_visible_range()\n-            self:send_request(visible_range)\n-            return\n-          end\n-        elseif client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr) then\n-          if current_result.result_id then\n-            method = 'textDocument/semanticTokens/full/delta'\n-            params.previousResultId = current_result.result_id\n-          end\n-        elseif not client:supports_method('textDocument/semanticTokens/full', self.bufnr) then\n-          -- No suitable provider, skip this client\n-          return\n+          params.range = range or self:get_visible_range()\n+        elseif supports_delta and current_result.result_id then\n+          method = 'textDocument/semanticTokens/full/delta'\n+          params.previousResultId = current_result.result_id\n         end\n \n         ---@param response? lsp.SemanticTokens|lsp.SemanticTokensDelta\n         local success, request_id = client:request(method, params, function(err, response, ctx)\n+          -- look client up again using ctx.client_id instead of using a captured\n+          -- client object\n+          local c = vim.lsp.get_client_by_id(ctx.client_id)",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617097526",
            "id": 2617097526,
            "in_reply_to_id": 2616904552,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6b_b02",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 287,
            "original_position": 132,
            "original_start_line": 281,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3575269516,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617097526/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-14T13:26:16Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617097526",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617098152"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617098152"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "It was not inferred by lua_ls for me without this. /shrug",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-14T13:26:55Z",
            "diff_hunk": "@@ -602,9 +556,13 @@ function STHighlighter:reset()\n   for client_id, state in pairs(self.client_state) do\n     api.nvim_buf_clear_namespace(self.bufnr, state.namespace, 0, -1)\n     state.current_result = {}\n-    local client = vim.lsp.get_client_by_id(client_id)\n-    assert(client)\n-    self:cancel_all_requests(client)\n+    if state.active_request.request_id then\n+      ---@type vim.lsp.Client|nil",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617098152",
            "id": 2617098152,
            "in_reply_to_id": 2616904990,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6b_b-o",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 567,
            "original_position": 229,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3575271367,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617098152/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-14T13:26:56Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617098152",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617107728"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617107728"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I don't think there's much of a perf cost here. The function itself is pretty fast and we use the range support one twice. For non-range clients, it's zero cost. Both are looked up in that case anyway.\n\nAs for pulling the delta one out, I think doing its lookup once per range request won't make a difference but it certainly cleans up the code to place the two method lookups next to each other like this.",
            "commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "created_at": "2025-12-14T13:34:18Z",
            "diff_hunk": "@@ -266,63 +249,56 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n+      local active_request = state.active_request\n \n-      local new_version = current_result.version ~= version and full_request_version ~= version\n+      local supports_range = client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+      local supports_delta = client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr)",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617107728",
            "id": 2617107728,
            "in_reply_to_id": 2616909370,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6b_eUQ",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 255,
            "original_position": 81,
            "original_start_line": 254,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3575288168,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617107728/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-14T13:34:18Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617107728",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617553734"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617553734"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "I went ahead and did something to address this. Now, the `supports_range` and `supports_delta` are stored on the client state so it only has to be looked up once per LSP client/buffer. This is much better than per request, thanks for pointing it out!",
            "commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "created_at": "2025-12-14T22:30:08Z",
            "diff_hunk": "@@ -266,63 +249,56 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n+      local active_request = state.active_request\n \n-      local new_version = current_result.version ~= version and full_request_version ~= version\n+      local supports_range = client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+      local supports_delta = client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr)",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617553734",
            "id": 2617553734,
            "in_reply_to_id": 2616909370,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cBLNG",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 255,
            "original_position": 81,
            "original_start_line": 254,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3575923068,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617553734/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-14T22:30:08Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617553734",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617660431"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617660431"
                }
            },
            "author_association": "MEMBER",
            "body": "This new line seems to be messing up the doc generation.\n```suggestion\n\n```",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T00:56:26Z",
            "diff_hunk": "@@ -23,19 +23,16 @@ local M = {}\n --- @field highlights? STTokenRange[] cache of highlight ranges for this document version\n --- @field tokens? integer[] raw token array as received by the server. used for calculating delta responses\n --- @field namespace_cleared? boolean whether the namespace was cleared for this result yet\n-\n+---",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617660431",
            "id": 2617660431,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cBlQP",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 26,
            "original_position": 5,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576046442,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617660431/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:00:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617660431",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617660620"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617660620"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n\n```",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T00:56:40Z",
            "diff_hunk": "@@ -23,19 +23,16 @@ local M = {}\n --- @field highlights? STTokenRange[] cache of highlight ranges for this document version\n --- @field tokens? integer[] raw token array as received by the server. used for calculating delta responses\n --- @field namespace_cleared? boolean whether the namespace was cleared for this result yet\n-\n+---\n --- @class (private) STActiveRequest\n --- @field request_id? integer the LSP request ID of the most recent request sent to the server\n --- @field version? integer the document version associated with the most recent request\n-\n----@alias full_request 'FULL'\n-\n----@type full_request\n-local FULL = 'FULL'\n-\n+---",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617660620",
            "id": 2617660620,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cBlTM",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 30,
            "original_position": 15,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576046442,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617660620/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:00:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617660620",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617662008"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617662008"
                }
            },
            "author_association": "MEMBER",
            "body": "Agreed, the type annotation is unnecessary.",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T00:58:16Z",
            "diff_hunk": "@@ -602,9 +556,13 @@ function STHighlighter:reset()\n   for client_id, state in pairs(self.client_state) do\n     api.nvim_buf_clear_namespace(self.bufnr, state.namespace, 0, -1)\n     state.current_result = {}\n-    local client = vim.lsp.get_client_by_id(client_id)\n-    assert(client)\n-    self:cancel_all_requests(client)\n+    if state.active_request.request_id then\n+      ---@type vim.lsp.Client|nil",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617662008",
            "id": 2617662008,
            "in_reply_to_id": 2616904990,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cBlo4",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 567,
            "original_position": 229,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576046442,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617662008/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:00:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617662008",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617662348"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617662348"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n```",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T00:58:37Z",
            "diff_hunk": "@@ -197,34 +194,28 @@ function STHighlighter:new(bufnr)\n     buffer = self.bufnr,\n     group = self.augroup,\n     callback = function()\n-      local visible_range = self:get_visible_range()\n-      self:send_request(visible_range)\n+      self:send_request()\n     end,\n   })\n \n   return self\n end\n \n----@private\n----@param client vim.lsp.Client\n-function STHighlighter:cancel_all_requests(client)\n-  local state = self.client_state[client.id]\n-\n-  for idx, request in pairs(state.active_requests) do\n-    if request.request_id then\n-      client:cancel_request(request.request_id)\n-      state.active_requests[idx] = nil\n-    end\n-  end\n-end\n-\n ---@package\n function STHighlighter:on_attach(client_id)\n+  ---@type vim.lsp.Client|nil",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617662348",
            "id": 2617662348,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cBluM",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 206,
            "original_position": 71,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576046442,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617662348/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:00:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617662348",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617663118"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663118"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion,\n```\n`or false` is redundant.",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T00:59:39Z",
            "diff_hunk": "@@ -197,34 +194,28 @@ function STHighlighter:new(bufnr)\n     buffer = self.bufnr,\n     group = self.augroup,\n     callback = function()\n-      local visible_range = self:get_visible_range()\n-      self:send_request(visible_range)\n+      self:send_request()\n     end,\n   })\n \n   return self\n end\n \n----@private\n----@param client vim.lsp.Client\n-function STHighlighter:cancel_all_requests(client)\n-  local state = self.client_state[client.id]\n-\n-  for idx, request in pairs(state.active_requests) do\n-    if request.request_id then\n-      client:cancel_request(request.request_id)\n-      state.active_requests[idx] = nil\n-    end\n-  end\n-end\n-\n ---@package\n function STHighlighter:on_attach(client_id)\n+  ---@type vim.lsp.Client|nil\n+  local client = vim.lsp.get_client_by_id(client_id)\n   local state = self.client_state[client_id]\n   if not state then\n     state = {\n       namespace = api.nvim_create_namespace('nvim.lsp.semantic_tokens:' .. client_id),\n-      active_requests = {},\n+      supports_range = client\n+          and client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+        or false,",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617663118",
            "id": 2617663118,
            "line": 223,
            "node_id": "PRRC_kwDOAPphoM6cBl6O",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 223,
            "original_position": 80,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576046442,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663118/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:00:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663118",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617663315"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663315"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion,\n```",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T00:59:47Z",
            "diff_hunk": "@@ -197,34 +194,28 @@ function STHighlighter:new(bufnr)\n     buffer = self.bufnr,\n     group = self.augroup,\n     callback = function()\n-      local visible_range = self:get_visible_range()\n-      self:send_request(visible_range)\n+      self:send_request()\n     end,\n   })\n \n   return self\n end\n \n----@private\n----@param client vim.lsp.Client\n-function STHighlighter:cancel_all_requests(client)\n-  local state = self.client_state[client.id]\n-\n-  for idx, request in pairs(state.active_requests) do\n-    if request.request_id then\n-      client:cancel_request(request.request_id)\n-      state.active_requests[idx] = nil\n-    end\n-  end\n-end\n-\n ---@package\n function STHighlighter:on_attach(client_id)\n+  ---@type vim.lsp.Client|nil\n+  local client = vim.lsp.get_client_by_id(client_id)\n   local state = self.client_state[client_id]\n   if not state then\n     state = {\n       namespace = api.nvim_create_namespace('nvim.lsp.semantic_tokens:' .. client_id),\n-      active_requests = {},\n+      supports_range = client\n+          and client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+        or false,\n+      supports_delta = client\n+          and client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr)\n+        or false,",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617663315",
            "id": 2617663315,
            "line": 226,
            "node_id": "PRRC_kwDOAPphoM6cBl9T",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 226,
            "original_position": 83,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576046442,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663315/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:00:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663315",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617663526"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663526"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n```",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T01:00:00Z",
            "diff_hunk": "@@ -256,73 +247,65 @@ end\n --- are saved to facilitate document synchronization in the response.\n ---\n ---@package\n----@param range? lsp.Range\n-function STHighlighter:send_request(range)\n+function STHighlighter:send_request()\n   local version = util.buf_versions[self.bufnr]\n \n   self:reset_timer()\n \n   for client_id, state in pairs(self.client_state) do\n+    ---@type vim.lsp.Client|nil",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617663526",
            "id": 2617663526,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cBmAm",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 256,
            "original_position": 100,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576046442,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663526/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:00:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617663526",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617667489"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617667489"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Weird, my lua ls definitely complains it can't infer the type here. Maybe my env is set up wrong. I'll remove for now. ",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T01:02:50Z",
            "diff_hunk": "@@ -602,9 +556,13 @@ function STHighlighter:reset()\n   for client_id, state in pairs(self.client_state) do\n     api.nvim_buf_clear_namespace(self.bufnr, state.namespace, 0, -1)\n     state.current_result = {}\n-    local client = vim.lsp.get_client_by_id(client_id)\n-    assert(client)\n-    self:cancel_all_requests(client)\n+    if state.active_request.request_id then\n+      ---@type vim.lsp.Client|nil",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617667489",
            "id": 2617667489,
            "in_reply_to_id": 2616904990,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cBm-h",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 567,
            "original_position": 229,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576058746,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617667489/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:02:51Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617667489",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617668379"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617668379"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "~~Wouldn't it be nil without it? I didn't want it to possibly be nil but rather always a valid boolean.~~\n\nEdit: nope, I'm just hallucinating. I'll update. ",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T01:03:38Z",
            "diff_hunk": "@@ -197,34 +194,28 @@ function STHighlighter:new(bufnr)\n     buffer = self.bufnr,\n     group = self.augroup,\n     callback = function()\n-      local visible_range = self:get_visible_range()\n-      self:send_request(visible_range)\n+      self:send_request()\n     end,\n   })\n \n   return self\n end\n \n----@private\n----@param client vim.lsp.Client\n-function STHighlighter:cancel_all_requests(client)\n-  local state = self.client_state[client.id]\n-\n-  for idx, request in pairs(state.active_requests) do\n-    if request.request_id then\n-      client:cancel_request(request.request_id)\n-      state.active_requests[idx] = nil\n-    end\n-  end\n-end\n-\n ---@package\n function STHighlighter:on_attach(client_id)\n+  ---@type vim.lsp.Client|nil\n+  local client = vim.lsp.get_client_by_id(client_id)\n   local state = self.client_state[client_id]\n   if not state then\n     state = {\n       namespace = api.nvim_create_namespace('nvim.lsp.semantic_tokens:' .. client_id),\n-      active_requests = {},\n+      supports_range = client\n+          and client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+        or false,",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617668379",
            "id": 2617668379,
            "in_reply_to_id": 2617663118,
            "line": 223,
            "node_id": "PRRC_kwDOAPphoM6cBnMb",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 223,
            "original_position": 80,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576060491,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617668379/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:05:01Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617668379",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617670095"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617670095"
                }
            },
            "author_association": "MEMBER",
            "body": "It's okay. Boolean expressions are tricky  ",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T01:05:44Z",
            "diff_hunk": "@@ -197,34 +194,28 @@ function STHighlighter:new(bufnr)\n     buffer = self.bufnr,\n     group = self.augroup,\n     callback = function()\n-      local visible_range = self:get_visible_range()\n-      self:send_request(visible_range)\n+      self:send_request()\n     end,\n   })\n \n   return self\n end\n \n----@private\n----@param client vim.lsp.Client\n-function STHighlighter:cancel_all_requests(client)\n-  local state = self.client_state[client.id]\n-\n-  for idx, request in pairs(state.active_requests) do\n-    if request.request_id then\n-      client:cancel_request(request.request_id)\n-      state.active_requests[idx] = nil\n-    end\n-  end\n-end\n-\n ---@package\n function STHighlighter:on_attach(client_id)\n+  ---@type vim.lsp.Client|nil\n+  local client = vim.lsp.get_client_by_id(client_id)\n   local state = self.client_state[client_id]\n   if not state then\n     state = {\n       namespace = api.nvim_create_namespace('nvim.lsp.semantic_tokens:' .. client_id),\n-      active_requests = {},\n+      supports_range = client\n+          and client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+        or false,",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617670095",
            "id": 2617670095,
            "in_reply_to_id": 2617663118,
            "line": 223,
            "node_id": "PRRC_kwDOAPphoM6cBnnP",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 223,
            "original_position": 80,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576063011,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617670095/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T01:05:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617670095",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617739003"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617739003"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Didn't seem to make a difference. Removed them anyway, but docs didn't change.",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T02:08:15Z",
            "diff_hunk": "@@ -23,19 +23,16 @@ local M = {}\n --- @field highlights? STTokenRange[] cache of highlight ranges for this document version\n --- @field tokens? integer[] raw token array as received by the server. used for calculating delta responses\n --- @field namespace_cleared? boolean whether the namespace was cleared for this result yet\n-\n+---",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617739003",
            "id": 2617739003,
            "in_reply_to_id": 2617660431,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cB4b7",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 26,
            "original_position": 5,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576160323,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617739003/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T02:08:15Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617739003",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617745989"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617745989"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Anyway, I went ahead and reverted this change back to what's in master. I'm not sure that any possible race condition here would ever actually happen. This pattern of capturing the client itself in the closure seems to occur elsewhere in the lsp code so there is precedent even if it's technically possible to process results for otherwise-destroyed clients.",
            "commit_id": "543c21b090257ceaa9af287d2dd5ad1fa08b58e8",
            "created_at": "2025-12-15T02:14:03Z",
            "diff_hunk": "@@ -266,63 +249,56 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n+      local active_request = state.active_request\n \n-      local new_version = current_result.version ~= version and full_request_version ~= version\n+      local supports_range = client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+      local supports_delta = client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr)\n \n-      if new_version or range then\n-        -- Cancel stale in-flight request\n-        if new_version then\n-          self:cancel_all_requests(client)\n+      if (supports_range and range) or (current_result.version ~= version and active_request.version ~= version) then\n+        -- cancel stale in-flight request\n+        if active_request.request_id then\n+          client:cancel_request(active_request.request_id)\n+          active_request = {}\n+          state.active_request = active_request\n         end\n \n+        ---@class lsp.SemanticTokensParams\n         local params = { textDocument = util.make_text_document_params(self.bufnr) }\n \n         ---@type vim.lsp.protocol.Method.ClientToServer.Request\n         local method = 'textDocument/semanticTokens/full'\n \n-        if client:supports_method('textDocument/semanticTokens/range', self.bufnr) then\n+        if supports_range then\n           method = 'textDocument/semanticTokens/range'\n-          if range then\n-            params.range = range\n-          else\n-            -- If no range is provided, send requests for all visible ranges\n-            -- This should be made better/removed once we can record capability  for textDocument/semanticTokens/range\n-            -- only\n-            local visible_range = self:get_visible_range()\n-            self:send_request(visible_range)\n-            return\n-          end\n-        elseif client:supports_method('textDocument/semanticTokens/full/delta', self.bufnr) then\n-          if current_result.result_id then\n-            method = 'textDocument/semanticTokens/full/delta'\n-            params.previousResultId = current_result.result_id\n-          end\n-        elseif not client:supports_method('textDocument/semanticTokens/full', self.bufnr) then\n-          -- No suitable provider, skip this client\n-          return\n+          params.range = range or self:get_visible_range()\n+        elseif supports_delta and current_result.result_id then\n+          method = 'textDocument/semanticTokens/full/delta'\n+          params.previousResultId = current_result.result_id\n         end\n \n         ---@param response? lsp.SemanticTokens|lsp.SemanticTokensDelta\n         local success, request_id = client:request(method, params, function(err, response, ctx)\n+          -- look client up again using ctx.client_id instead of using a captured\n+          -- client object\n+          local c = vim.lsp.get_client_by_id(ctx.client_id)",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617745989",
            "id": 2617745989,
            "in_reply_to_id": 2616904552,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cB6JF",
            "original_commit_id": "693041d06e4b3f111f7bd44f745478b8ec2c9006",
            "original_line": 287,
            "original_position": 132,
            "original_start_line": 281,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576167945,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617745989/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-15T02:14:03Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617745989",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617752195"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617752195"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Ah ha! I wasn't crazy! :joy: From the lint job after I took out `or false`:\r\n\r\n```\r\n runtime/lua/vim/lsp/semantic_tokens.lua:211:7 [Warning] Cannot assign `boolean?` to `boolean`.\r\n- Optional type cannot match `boolean`\r\n- Type `nil` cannot match `boolean` (assign-type-mismatch)\r\n          supports_range = client\r\n          ^^^^^^^^^^^^^^\r\nruntime/lua/vim/lsp/semantic_tokens.lua:213:7 [Warning] Cannot assign `boolean?` to `boolean`.\r\n- Optional type cannot match `boolean`\r\n- Type `nil` cannot match `boolean` (assign-type-mismatch)\r\n          supports_delta = client\r\n          ^^^^^^^^^^^^^^\r\n```",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T02:19:29Z",
            "diff_hunk": "@@ -197,34 +194,28 @@ function STHighlighter:new(bufnr)\n     buffer = self.bufnr,\n     group = self.augroup,\n     callback = function()\n-      local visible_range = self:get_visible_range()\n-      self:send_request(visible_range)\n+      self:send_request()\n     end,\n   })\n \n   return self\n end\n \n----@private\n----@param client vim.lsp.Client\n-function STHighlighter:cancel_all_requests(client)\n-  local state = self.client_state[client.id]\n-\n-  for idx, request in pairs(state.active_requests) do\n-    if request.request_id then\n-      client:cancel_request(request.request_id)\n-      state.active_requests[idx] = nil\n-    end\n-  end\n-end\n-\n ---@package\n function STHighlighter:on_attach(client_id)\n+  ---@type vim.lsp.Client|nil\n+  local client = vim.lsp.get_client_by_id(client_id)\n   local state = self.client_state[client_id]\n   if not state then\n     state = {\n       namespace = api.nvim_create_namespace('nvim.lsp.semantic_tokens:' .. client_id),\n-      active_requests = {},\n+      supports_range = client\n+          and client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+        or false,",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617752195",
            "id": 2617752195,
            "in_reply_to_id": 2617663118,
            "line": 223,
            "node_id": "PRRC_kwDOAPphoM6cB7qD",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 223,
            "original_position": 80,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576173980,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617752195/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T02:19:29Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617752195",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617769158"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617769158"
                }
            },
            "author_association": "MEMBER",
            "body": "```suggestion\n        ---@type lsp.SemanticTokensParams\n```",
            "commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "created_at": "2025-12-15T02:34:57Z",
            "diff_hunk": "@@ -266,43 +255,31 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n-\n-      local new_version = current_result.version ~= version and full_request_version ~= version\n-\n-      if new_version or range then\n-        -- Cancel stale in-flight request\n-        if new_version then\n-          self:cancel_all_requests(client)\n+      local active_request = state.active_request\n+\n+      if\n+        state.supports_range\n+        or (current_result.version ~= version and active_request.version ~= version)\n+      then\n+        -- cancel stale in-flight request\n+        if active_request.request_id then\n+          client:cancel_request(active_request.request_id)\n+          active_request = {}\n+          state.active_request = active_request\n         end\n \n+        ---@class lsp.SemanticTokensParams",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617769158",
            "id": 2617769158,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cB_zG",
            "original_commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "original_line": 271,
            "original_position": 126,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576191133,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617769158/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T02:34:57Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617769158",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617769991"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617769991"
                }
            },
            "author_association": "MEMBER",
            "body": "Using `class` here is causing this type to be doc-generated.",
            "commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "created_at": "2025-12-15T02:35:35Z",
            "diff_hunk": "@@ -266,43 +255,31 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n-\n-      local new_version = current_result.version ~= version and full_request_version ~= version\n-\n-      if new_version or range then\n-        -- Cancel stale in-flight request\n-        if new_version then\n-          self:cancel_all_requests(client)\n+      local active_request = state.active_request\n+\n+      if\n+        state.supports_range\n+        or (current_result.version ~= version and active_request.version ~= version)\n+      then\n+        -- cancel stale in-flight request\n+        if active_request.request_id then\n+          client:cancel_request(active_request.request_id)\n+          active_request = {}\n+          state.active_request = active_request\n         end\n \n+        ---@class lsp.SemanticTokensParams",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617769991",
            "id": 2617769991,
            "in_reply_to_id": 2617769158,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cCAAH",
            "original_commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "original_line": 271,
            "original_position": 126,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576191906,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617769991/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T02:47:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617769991",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617771246"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617771246"
                }
            },
            "author_association": "MEMBER",
            "body": "Oh very interesting. Lua is a truly chaotic language. Thank you for trying!",
            "commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "created_at": "2025-12-15T02:36:44Z",
            "diff_hunk": "@@ -197,34 +194,28 @@ function STHighlighter:new(bufnr)\n     buffer = self.bufnr,\n     group = self.augroup,\n     callback = function()\n-      local visible_range = self:get_visible_range()\n-      self:send_request(visible_range)\n+      self:send_request()\n     end,\n   })\n \n   return self\n end\n \n----@private\n----@param client vim.lsp.Client\n-function STHighlighter:cancel_all_requests(client)\n-  local state = self.client_state[client.id]\n-\n-  for idx, request in pairs(state.active_requests) do\n-    if request.request_id then\n-      client:cancel_request(request.request_id)\n-      state.active_requests[idx] = nil\n-    end\n-  end\n-end\n-\n ---@package\n function STHighlighter:on_attach(client_id)\n+  ---@type vim.lsp.Client|nil\n+  local client = vim.lsp.get_client_by_id(client_id)\n   local state = self.client_state[client_id]\n   if not state then\n     state = {\n       namespace = api.nvim_create_namespace('nvim.lsp.semantic_tokens:' .. client_id),\n-      active_requests = {},\n+      supports_range = client\n+          and client:supports_method('textDocument/semanticTokens/range', self.bufnr)\n+        or false,",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617771246",
            "id": 2617771246,
            "in_reply_to_id": 2617663118,
            "line": 223,
            "node_id": "PRRC_kwDOAPphoM6cCATu",
            "original_commit_id": "d3e0aef0a5a304e46b7d3167f084fbb7fad98c2c",
            "original_line": 223,
            "original_position": 80,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576191906,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617771246/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T02:47:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617771246",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617775622"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617775622"
                }
            },
            "author_association": "MEMBER",
            "body": "Nit:\n```suggestion\n      local client = assert(vim.lsp.get_client_by_id(client_id))\n```",
            "commit_id": "66c65ecdb01d0cac914ebc41f3a505a837411d3a",
            "created_at": "2025-12-15T02:40:34Z",
            "diff_hunk": "@@ -602,9 +558,12 @@ function STHighlighter:reset()\n   for client_id, state in pairs(self.client_state) do\n     api.nvim_buf_clear_namespace(self.bufnr, state.namespace, 0, -1)\n     state.current_result = {}\n-    local client = vim.lsp.get_client_by_id(client_id)\n-    assert(client)\n-    self:cancel_all_requests(client)\n+    if state.active_request.request_id then\n+      local client = vim.lsp.get_client_by_id(client_id)\n+      assert(client)",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617775622",
            "id": 2617775622,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cCBYG",
            "original_commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "original_line": 567,
            "original_position": 251,
            "original_start_line": 562,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576191906,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617775622/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-12-15T02:47:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617775622",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617783828"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617783828"
                }
            },
            "author_association": "MEMBER",
            "body": "It looks like it might be helpful to abstract this logic of canceling the active client request into a local function.",
            "commit_id": "66c65ecdb01d0cac914ebc41f3a505a837411d3a",
            "created_at": "2025-12-15T02:47:26Z",
            "diff_hunk": "@@ -626,9 +585,13 @@ function STHighlighter:mark_dirty(client_id)\n   if state.current_result then\n     state.current_result.version = nil\n   end\n-  local client = vim.lsp.get_client_by_id(client_id)\n-  assert(client)\n-  self:cancel_all_requests(client)\n+\n+  if state.active_request.request_id then",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617783828",
            "id": 2617783828,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cCDYU",
            "original_commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "original_line": 593,
            "original_position": 266,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576191906,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 1,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 1,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617783828/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T02:47:31Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617783828",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
                "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
                "followers_url": "https://api.github.com/users/MariaSolOs/followers",
                "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
                "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/MariaSolOs",
                "id": 62502207,
                "login": "MariaSolOs",
                "node_id": "MDQ6VXNlcjYyNTAyMjA3",
                "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
                "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
                "repos_url": "https://api.github.com/users/MariaSolOs/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/MariaSolOs",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/36950#discussion_r2617790642"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/36950"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617790642"
                }
            },
            "author_association": "CONTRIBUTOR",
            "body": "Fixed.",
            "commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "created_at": "2025-12-15T02:53:12Z",
            "diff_hunk": "@@ -266,43 +255,31 @@ function STHighlighter:send_request(range)\n     local client = vim.lsp.get_client_by_id(client_id)\n     if client then\n       local current_result = state.current_result\n-      local active_requests = state.active_requests\n-\n-      local full_request_version = active_requests[FULL] and active_requests[FULL].version\n-\n-      local new_version = current_result.version ~= version and full_request_version ~= version\n-\n-      if new_version or range then\n-        -- Cancel stale in-flight request\n-        if new_version then\n-          self:cancel_all_requests(client)\n+      local active_request = state.active_request\n+\n+      if\n+        state.supports_range\n+        or (current_result.version ~= version and active_request.version ~= version)\n+      then\n+        -- cancel stale in-flight request\n+        if active_request.request_id then\n+          client:cancel_request(active_request.request_id)\n+          active_request = {}\n+          state.active_request = active_request\n         end\n \n+        ---@class lsp.SemanticTokensParams",
            "html_url": "https://github.com/neovim/neovim/pull/36950#discussion_r2617790642",
            "id": 2617790642,
            "in_reply_to_id": 2617769158,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6cCFCy",
            "original_commit_id": "994e88bf9fbf91fa445bb2fa2f545213aebf6c09",
            "original_line": 271,
            "original_position": 126,
            "original_start_line": null,
            "path": "runtime/lua/vim/lsp/semantic_tokens.lua",
            "position": 1,
            "pull_request_review_id": 3576212151,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617790642/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-12-15T04:55:47Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2617790642",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/36950/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/36950/commits",
    "created_at": "2025-12-14T09:02:33Z",
    "diff_url": "https://github.com/neovim/neovim/pull/36950.diff",
    "draft": false,
    "head": {
        "label": "jdrouhard:semantic-token-range-simplify",
        "ref": "semantic-token-range-simplify",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/jdrouhard/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/jdrouhard/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/jdrouhard/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/jdrouhard/neovim/branches{/branch}",
            "clone_url": "https://github.com/jdrouhard/neovim.git",
            "collaborators_url": "https://api.github.com/repos/jdrouhard/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/jdrouhard/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/jdrouhard/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/jdrouhard/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/jdrouhard/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/jdrouhard/neovim/contributors",
            "created_at": "2020-12-31T19:19:10Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/jdrouhard/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/jdrouhard/neovim/downloads",
            "events_url": "https://api.github.com/repos/jdrouhard/neovim/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/jdrouhard/neovim/forks",
            "full_name": "jdrouhard/neovim",
            "git_commits_url": "https://api.github.com/repos/jdrouhard/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/jdrouhard/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/jdrouhard/neovim/git/tags{/sha}",
            "git_url": "git://github.com/jdrouhard/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/jdrouhard/neovim/hooks",
            "html_url": "https://github.com/jdrouhard/neovim",
            "id": 325860513,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/jdrouhard/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/jdrouhard/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/jdrouhard/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/jdrouhard/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/jdrouhard/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/jdrouhard/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/jdrouhard/neovim/merges",
            "milestones_url": "https://api.github.com/repos/jdrouhard/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkzMjU4NjA1MTM=",
            "notifications_url": "https://api.github.com/repos/jdrouhard/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
                "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
                "followers_url": "https://api.github.com/users/jdrouhard/followers",
                "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
                "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/jdrouhard",
                "id": 394891,
                "login": "jdrouhard",
                "node_id": "MDQ6VXNlcjM5NDg5MQ==",
                "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
                "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
                "repos_url": "https://api.github.com/users/jdrouhard/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/jdrouhard",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/jdrouhard/neovim/pulls{/number}",
            "pushed_at": "2025-12-15T13:41:04Z",
            "releases_url": "https://api.github.com/repos/jdrouhard/neovim/releases{/id}",
            "size": 343944,
            "ssh_url": "git@github.com:jdrouhard/neovim.git",
            "stargazers_count": 1,
            "stargazers_url": "https://api.github.com/repos/jdrouhard/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/jdrouhard/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/jdrouhard/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/jdrouhard/neovim/subscription",
            "svn_url": "https://github.com/jdrouhard/neovim",
            "tags_url": "https://api.github.com/repos/jdrouhard/neovim/tags",
            "teams_url": "https://api.github.com/repos/jdrouhard/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/jdrouhard/neovim/git/trees{/sha}",
            "updated_at": "2024-05-22T04:10:42Z",
            "url": "https://api.github.com/repos/jdrouhard/neovim",
            "visibility": "public",
            "watchers": 1,
            "watchers_count": 1,
            "web_commit_signoff_required": false
        },
        "sha": "766f5d1cc140720e80846325bc3cc0d1e7dbdef9",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
            "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
            "followers_url": "https://api.github.com/users/jdrouhard/followers",
            "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
            "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/jdrouhard",
            "id": 394891,
            "login": "jdrouhard",
            "node_id": "MDQ6VXNlcjM5NDg5MQ==",
            "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
            "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
            "repos_url": "https://api.github.com/users/jdrouhard/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/jdrouhard",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/36950",
    "id": 3099530930,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/36950",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": null,
            "id": 662566370,
            "name": "lsp",
            "node_id": "MDU6TGFiZWw2NjI1NjYzNzA=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/lsp"
        }
    ],
    "locked": false,
    "merge_commit_sha": "bef06d0a9d42bc886cd292db4b307fd19ce7bd74",
    "merged_at": null,
    "milestone": null,
    "node_id": "PR_kwDOAPphoM64vxay",
    "number": 36950,
    "patch_url": "https://github.com/neovim/neovim/pull/36950.patch",
    "requested_reviewers": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/55766287?v=4",
            "events_url": "https://api.github.com/users/ribru17/events{/privacy}",
            "followers_url": "https://api.github.com/users/ribru17/followers",
            "following_url": "https://api.github.com/users/ribru17/following{/other_user}",
            "gists_url": "https://api.github.com/users/ribru17/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/ribru17",
            "id": 55766287,
            "login": "ribru17",
            "node_id": "MDQ6VXNlcjU1NzY2Mjg3",
            "organizations_url": "https://api.github.com/users/ribru17/orgs",
            "received_events_url": "https://api.github.com/users/ribru17/received_events",
            "repos_url": "https://api.github.com/users/ribru17/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/ribru17/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ribru17/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/ribru17",
            "user_view_type": "public"
        },
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/62502207?v=4",
            "events_url": "https://api.github.com/users/MariaSolOs/events{/privacy}",
            "followers_url": "https://api.github.com/users/MariaSolOs/followers",
            "following_url": "https://api.github.com/users/MariaSolOs/following{/other_user}",
            "gists_url": "https://api.github.com/users/MariaSolOs/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/MariaSolOs",
            "id": 62502207,
            "login": "MariaSolOs",
            "node_id": "MDQ6VXNlcjYyNTAyMjA3",
            "organizations_url": "https://api.github.com/users/MariaSolOs/orgs",
            "received_events_url": "https://api.github.com/users/MariaSolOs/received_events",
            "repos_url": "https://api.github.com/users/MariaSolOs/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/MariaSolOs/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/MariaSolOs/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/MariaSolOs",
            "user_view_type": "public"
        }
    ],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/36950/comments",
    "state": "open",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/766f5d1cc140720e80846325bc3cc0d1e7dbdef9",
    "title": "fix(lsp): simplify semantic tokens range request logic",
    "updated_at": "2025-12-15T13:41:05Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/36950",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/394891?v=4",
        "events_url": "https://api.github.com/users/jdrouhard/events{/privacy}",
        "followers_url": "https://api.github.com/users/jdrouhard/followers",
        "following_url": "https://api.github.com/users/jdrouhard/following{/other_user}",
        "gists_url": "https://api.github.com/users/jdrouhard/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/jdrouhard",
        "id": 394891,
        "login": "jdrouhard",
        "node_id": "MDQ6VXNlcjM5NDg5MQ==",
        "organizations_url": "https://api.github.com/users/jdrouhard/orgs",
        "received_events_url": "https://api.github.com/users/jdrouhard/received_events",
        "repos_url": "https://api.github.com/users/jdrouhard/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/jdrouhard/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jdrouhard/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/jdrouhard",
        "user_view_type": "public"
    }
}
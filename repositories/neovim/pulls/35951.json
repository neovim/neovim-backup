{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/35951/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/35951/commits"
        },
        "html": {
            "href": "https://github.com/neovim/neovim/pull/35951"
        },
        "issue": {
            "href": "https://api.github.com/repos/neovim/neovim/issues/35951"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/35951/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/neovim/neovim/pulls/35951"
        },
        "statuses": {
            "href": "https://api.github.com/repos/neovim/neovim/statuses/3287b90a60b603bbaa2296eadf4f2bf0482b5c63"
        }
    },
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "MEMBER",
    "auto_merge": null,
    "base": {
        "label": "neovim:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/neovim/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/neovim/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/neovim/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/neovim/neovim/branches{/branch}",
            "clone_url": "https://github.com/neovim/neovim.git",
            "collaborators_url": "https://api.github.com/repos/neovim/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/neovim/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/neovim/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/neovim/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/neovim/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/neovim/neovim/contributors",
            "created_at": "2014-01-31T13:39:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/neovim/neovim/deployments",
            "description": "Vim-fork focused on extensibility and usability",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/neovim/neovim/downloads",
            "events_url": "https://api.github.com/repos/neovim/neovim/events",
            "fork": false,
            "forks": 6416,
            "forks_count": 6416,
            "forks_url": "https://api.github.com/repos/neovim/neovim/forks",
            "full_name": "neovim/neovim",
            "git_commits_url": "https://api.github.com/repos/neovim/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/neovim/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/neovim/neovim/git/tags{/sha}",
            "git_url": "git://github.com/neovim/neovim.git",
            "has_discussions": true,
            "has_downloads": true,
            "has_issues": true,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": true,
            "homepage": "https://neovim.io",
            "hooks_url": "https://api.github.com/repos/neovim/neovim/hooks",
            "html_url": "https://github.com/neovim/neovim",
            "id": 16408992,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/neovim/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/neovim/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/neovim/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/neovim/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/neovim/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/neovim/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/neovim/neovim/merges",
            "milestones_url": "https://api.github.com/repos/neovim/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNjQwODk5Mg==",
            "notifications_url": "https://api.github.com/repos/neovim/neovim/notifications{?since,all,participating}",
            "open_issues": 2049,
            "open_issues_count": 2049,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
                "events_url": "https://api.github.com/users/neovim/events{/privacy}",
                "followers_url": "https://api.github.com/users/neovim/followers",
                "following_url": "https://api.github.com/users/neovim/following{/other_user}",
                "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/neovim",
                "id": 6471485,
                "login": "neovim",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
                "organizations_url": "https://api.github.com/users/neovim/orgs",
                "received_events_url": "https://api.github.com/users/neovim/received_events",
                "repos_url": "https://api.github.com/users/neovim/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/neovim",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/neovim/neovim/pulls{/number}",
            "pushed_at": "2025-11-18T01:49:14Z",
            "releases_url": "https://api.github.com/repos/neovim/neovim/releases{/id}",
            "size": 351477,
            "ssh_url": "git@github.com:neovim/neovim.git",
            "stargazers_count": 94330,
            "stargazers_url": "https://api.github.com/repos/neovim/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/neovim/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/neovim/neovim/subscription",
            "svn_url": "https://github.com/neovim/neovim",
            "tags_url": "https://api.github.com/repos/neovim/neovim/tags",
            "teams_url": "https://api.github.com/repos/neovim/neovim/teams",
            "topics": [
                "api",
                "c",
                "lua",
                "neovim",
                "nvim",
                "text-editor",
                "vim"
            ],
            "trees_url": "https://api.github.com/repos/neovim/neovim/git/trees{/sha}",
            "updated_at": "2025-11-18T01:55:51Z",
            "url": "https://api.github.com/repos/neovim/neovim",
            "visibility": "public",
            "watchers": 94330,
            "watchers_count": 94330,
            "web_commit_signoff_required": false
        },
        "sha": "236d831d77d61e8de6bb7191fc0a7fb0743a5021",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/6471485?v=4",
            "events_url": "https://api.github.com/users/neovim/events{/privacy}",
            "followers_url": "https://api.github.com/users/neovim/followers",
            "following_url": "https://api.github.com/users/neovim/following{/other_user}",
            "gists_url": "https://api.github.com/users/neovim/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/neovim",
            "id": 6471485,
            "login": "neovim",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjY0NzE0ODU=",
            "organizations_url": "https://api.github.com/users/neovim/orgs",
            "received_events_url": "https://api.github.com/users/neovim/received_events",
            "repos_url": "https://api.github.com/users/neovim/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/neovim/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/neovim/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/neovim",
            "user_view_type": "public"
        }
    },
    "body": "## Problem:\r\n\r\nThe `term://` buffer-name generated by `jobstart(term=true)` is mostly broken, because it does not set the full command, which:\r\n- is confusing\r\n- will fail to \"restore\" (re-invoke) the terminal by visiting the `term://` buffer-name.\r\n\r\n## Solution:\r\n- Append the full cmd+args to the URI as a JSON array.\r\n- The reverse case of `:edit term://...` still works as normal, since in that case the user is providing the argument delimiting (quoting).\r\n- Improve the default `BufReadCmd term://*` handler:\r\n  - Handles the JSON command form.\r\n  - Rewrite as Lua (missing `|endif` since c5b34fa55483d84d1de32937ffff0b7cf1aeba78 ðŸ™ˆ)\r\n- Support URI `#fragment` https://github.com/neovim/neovim/issues/3278\r\n    - Alternative: `term+1234://` ? [ref](https://github.com/neovim/neovim/pull/36564)\r\n\r\nFix https://github.com/neovim/neovim/issues/3278\r\n\r\nBefore:\r\n\r\n```\r\n:lua vim.fn.jobstart({'gh','status'},{term=true})\r\n  => term://~//67329:/usr/local/bin/gh             # broken\r\n\r\n:edit term://gh status\r\n  => term://~//67366:gh status\r\n```\r\n\r\nAfter:\r\n\r\n```\r\n:lua vim.fn.jobstart({'gh','status'},{term=true})\r\n  => term://~//67314:[\"/usr/local/bin/gh\", \"status\"]\r\n\r\n:edit term://gh status\r\n  => term://~//67366:gh status                     # no change\r\n```\r\n\r\n## Todo\r\n\r\n- Support URI `#fragment`\r\n- âœ… `:edit term://...` should preserve its name?\r\n- (unrelated to this PR) fix [leak](https://github.com/neovim/neovim/pull/35951#discussion_r2389709575) when `jobstart` reuses an existing terminal buffer.",
    "closed_at": null,
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/35951#discussion_r2386756897"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/35951"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2386756897"
                }
            },
            "author_association": "MEMBER",
            "body": "Using `shell_argv_to_str`, which quotes the cmd args, works. But a quirk is that if you visit the resulting buffer `term://` name, the `BufReadCmd term://*` handler invokes it in a `jobstart(<string>)`, which internally then redundantly shell-quotes everything again...",
            "commit_id": "e341cefa2e63f0519c6357a78c5f452c0b697d9b",
            "created_at": "2025-09-29T05:37:56Z",
            "diff_hunk": "@@ -4040,8 +4040,13 @@ void f_jobstart(typval_T *argvars, typval_T *rettv, EvalFuncData fptr)\n       IObuff[2] = NUL;\n     }\n \n+    // Build full command string: \"'cmd 'arg1' 'arg 2' â€¦\".\n+    char *cmdstr = shell_argv_to_str(argv);\n     // Terminal URI: \"term://$CWD//$PID:$CMD\"\n-    snprintf(NameBuff, sizeof(NameBuff), \"term://%s//%d:%s\", IObuff, pid, cmd);\n+    // TODO(justinmk): URI v2: https://github.com/neovim/neovim/issues/3278\n+    snprintf(NameBuff, sizeof(NameBuff), \"term://%s//%d:%s\", IObuff, pid, cmdstr);",
            "html_url": "https://github.com/neovim/neovim/pull/35951#discussion_r2386756897",
            "id": 2386756897,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6OQwUh",
            "original_commit_id": "e341cefa2e63f0519c6357a78c5f452c0b697d9b",
            "original_line": 4047,
            "original_position": 18,
            "original_start_line": 4043,
            "path": "src/nvim/eval/funcs.c",
            "position": 1,
            "pull_request_review_id": 3277991221,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/35951",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2386756897/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-09-29T05:38:35Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2386756897",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/35951#discussion_r2389411771"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/35951"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389411771"
                }
            },
            "author_association": "MEMBER",
            "body": "implemented `shell_argv_to_json` instead.",
            "commit_id": "e341cefa2e63f0519c6357a78c5f452c0b697d9b",
            "created_at": "2025-09-29T22:31:19Z",
            "diff_hunk": "@@ -4040,8 +4040,13 @@ void f_jobstart(typval_T *argvars, typval_T *rettv, EvalFuncData fptr)\n       IObuff[2] = NUL;\n     }\n \n+    // Build full command string: \"'cmd 'arg1' 'arg 2' â€¦\".\n+    char *cmdstr = shell_argv_to_str(argv);\n     // Terminal URI: \"term://$CWD//$PID:$CMD\"\n-    snprintf(NameBuff, sizeof(NameBuff), \"term://%s//%d:%s\", IObuff, pid, cmd);\n+    // TODO(justinmk): URI v2: https://github.com/neovim/neovim/issues/3278\n+    snprintf(NameBuff, sizeof(NameBuff), \"term://%s//%d:%s\", IObuff, pid, cmdstr);",
            "html_url": "https://github.com/neovim/neovim/pull/35951#discussion_r2389411771",
            "id": 2389411771,
            "in_reply_to_id": 2386756897,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6Oa4e7",
            "original_commit_id": "e341cefa2e63f0519c6357a78c5f452c0b697d9b",
            "original_line": 4047,
            "original_position": 18,
            "original_start_line": 4043,
            "path": "src/nvim/eval/funcs.c",
            "position": 1,
            "pull_request_review_id": 3282013238,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/35951",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389411771/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-09-29T22:31:19Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389411771",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/35951#discussion_r2389709575"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/35951"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389709575"
                }
            },
            "author_association": "MEMBER",
            "body": "Forcing 'nomodified' so that `jobstart` can reuse the existing terminal buffer, exposes a leak. This is not technically \"supported\" but maybe we should.\n\n```\n= Indirect leak of 80000 byte(s) in 1 object(s) allocated from:\n=     #0 0x555f2a37cda3 in malloc (/home/runner/work/neovim/neovim/build/bin/nvim+0xd2dda3) (BuildId: 0223c81575fe8615e437fe31bdd2262c6d6305c6)\n=     #1 0x555f2b01d774 in try_malloc /home/runner/work/neovim/neovim/src/nvim/memory.c:113:15\n=     #2 0x555f2b01d9d4 in xmalloc /home/runner/work/neovim/neovim/src/nvim/memory.c:147:15\n=     #3 0x555f2b73bf5e in terminal_open /home/runner/work/neovim/neovim/src/nvim/terminal.c:532:23\n=     #4 0x555f2a675a92 in channel_terminal_open /home/runner/work/neovim/neovim/src/nvim/channel.c:832:3\n=     #5 0x555f2a956664 in f_jobstart /home/runner/work/neovim/neovim/src/nvim/eval/funcs.c:4067:5\n```",
            "commit_id": "3aa828565274a61362971461c8c6ec5502f13602",
            "created_at": "2025-09-30T02:49:03Z",
            "diff_hunk": "@@ -61,4 +64,46 @@ describe(':edit term://*', function()\n     scr:expect(exp_screen)\n     eq(bufcontents, api.nvim_buf_get_lines(0, 0, -1, true))\n   end)\n+\n+  it('handles truncated command JSON', function()\n+    -- jobstart(term=true) will truncate very long commands.\n+    -- The term://* BufReadCmd handler should not attempt to execute them.\n+    matches(\n+      'Command was truncated',\n+      t.pcall_err(n.command, 'edit ' .. fn.fnameescape([=[term://[\"ls\", \"...\"] ]=]))\n+    )\n+  end)\n+end)\n+\n+describe('jobstart(term=true)', function()\n+  it('sets full command as JSON array in term://â€¦ name', function()\n+    local jobid = fn.jobstart(\n+      { testprg('shell-test'), 'arg1', 'arg2 with spaces' },\n+      { term = true }\n+    )\n+    -- Should look like: `term:///cwd//PID:[\"/path/to/shell-test\", \"arg1\", \"arg2\"]`\n+    matches(\n+      [[^term://.*/%d+:%[\".*/shell%-test%.?e?x?e?\", \"arg1\", \"arg2 with spaces\"%]$]],\n+      fn.bufname('%')\n+    )\n+\n+    fn.jobwait({ jobid })\n+    command('set nomodified')\n+    -- Try a command with complex quoted args.\n+    fn.jobstart({ testprg('shell-test'), 'arg1', [[[\"arg 2\"] \"with\" 'quotes']] }, { term = true })",
            "html_url": "https://github.com/neovim/neovim/pull/35951#discussion_r2389709575",
            "id": 2389709575,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6OcBMH",
            "original_commit_id": "48d8a6681f9a1b1b55f265ede2cd860235698dd3",
            "original_line": 93,
            "original_position": 62,
            "original_start_line": 91,
            "path": "test/functional/terminal/edit_spec.lua",
            "position": 1,
            "pull_request_review_id": 3282398413,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/35951",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389709575/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": "RIGHT",
            "subject_type": "line",
            "updated_at": "2025-09-30T02:49:48Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389709575",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/neovim/neovim/pull/35951#discussion_r2389714281"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/35951"
                },
                "self": {
                    "href": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389714281"
                }
            },
            "author_association": "MEMBER",
            "body": "This change escaped the `\\[` as intended, but `:badd` still fails...\r\n\r\n~~add `:set isfname+=[` before this line in the session file?~~ \r\n~~Call `jobstart()` explicitly?~~\r\nis it a slash (path separator) mismatch?\r\nðŸ˜­ \r\n\r\n```\r\nERROR    test/functional\\ex_cmds\\mksession_spec.lua @ 36: :mksession restores same :terminal buf in splits\r\ntest\\functional\\testnvim.lua:141: D:\\a\\neovim\\neovim\\Xtest-functional-ex_cmds-mksession_spec.vim, \r\nline 12: Vim(badd):E480: No match:\r\nterm://D:/a/neovim/neovim//14092:\\[\"C://Windows//system32//cmd.exe\"]\r\n```",
            "commit_id": "e85d842edc7fc0918e74bfdf776c470cb35ad82d",
            "created_at": "2025-09-30T02:53:01Z",
            "diff_hunk": "@@ -4135,14 +4136,18 @@ char *vim_strsave_fnameescape(const char *const fname, const int what)\n     }\n   }\n   buf[j] = NUL;\n-  char *p = vim_strsave_escaped(fname, buf);\n+  char *p = vim_strsave_escaped(fname, what == VSE_SESSION ? PATH_ESC_CHARS : buf);",
            "html_url": "https://github.com/neovim/neovim/pull/35951#discussion_r2389714281",
            "id": 2389714281,
            "line": null,
            "node_id": "PRRC_kwDOAPphoM6OcCVp",
            "original_commit_id": "48d8a6681f9a1b1b55f265ede2cd860235698dd3",
            "original_line": 4139,
            "original_position": 13,
            "original_start_line": null,
            "path": "src/nvim/ex_getln.c",
            "position": 1,
            "pull_request_review_id": 3282403393,
            "pull_request_url": "https://api.github.com/repos/neovim/neovim/pulls/35951",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389714281/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2025-09-30T19:41:45Z",
            "url": "https://api.github.com/repos/neovim/neovim/pulls/comments/2389714281",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "CONTRIBUTOR",
            "body": "> ## Problem:\r\n> \r\n> The `term://` buffer-name generated by `jobstart(term=true)` is mostly broken, because it does not set the full command, which:\r\n> \r\n>     * is confusing\r\n> \r\n>     * will fail to \"restore\" (re-invoke) the terminal by visiting the `term://` buffer-name.\r\n> \r\n\r\nIs this relevant here: What if the full command contains a `rm ...` and we \"restore\" (re-invoke) the terminal now from the full command? Suprise deletion or expected behavior?\r\n\r\n",
            "created_at": "2025-10-01T22:02:22Z",
            "html_url": "https://github.com/neovim/neovim/pull/35951#issuecomment-3358315869",
            "id": 3358315869,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35951",
            "node_id": "IC_kwDOAPphoM7IK9Vd",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3358315869/reactions"
            },
            "updated_at": "2025-10-01T22:02:22Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3358315869",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2077655?v=4",
                "events_url": "https://api.github.com/users/oni-link/events{/privacy}",
                "followers_url": "https://api.github.com/users/oni-link/followers",
                "following_url": "https://api.github.com/users/oni-link/following{/other_user}",
                "gists_url": "https://api.github.com/users/oni-link/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/oni-link",
                "id": 2077655,
                "login": "oni-link",
                "node_id": "MDQ6VXNlcjIwNzc2NTU=",
                "organizations_url": "https://api.github.com/users/oni-link/orgs",
                "received_events_url": "https://api.github.com/users/oni-link/received_events",
                "repos_url": "https://api.github.com/users/oni-link/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/oni-link/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/oni-link/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/oni-link",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "> What if the full command contains a `rm ...` and we \"restore\" (re-invoke) the terminal now from the full command?\r\n\r\nTwo things to note:\r\n\r\n- if the last arg is `...` then the command is not run (there is a test for this)\r\n- but your question in general is valid. it also applies to the existing behavior, which just is kind of broken but still could run an (incomplete) destructive operation\r\n\r\nSo either we should prompt before actually \"restoring\" (re-invoking) the terminal, or just don't attempt to re-invoke it. But that would imply we should remove the `BufReadCmd` handler.",
            "created_at": "2025-10-01T22:13:02Z",
            "html_url": "https://github.com/neovim/neovim/pull/35951#issuecomment-3358342157",
            "id": 3358342157,
            "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35951",
            "node_id": "IC_kwDOAPphoM7ILDwN",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3358342157/reactions"
            },
            "updated_at": "2025-10-01T22:13:53Z",
            "url": "https://api.github.com/repos/neovim/neovim/issues/comments/3358342157",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            }
        }
    ],
    "comments_url": "https://api.github.com/repos/neovim/neovim/issues/35951/comments",
    "commits_url": "https://api.github.com/repos/neovim/neovim/pulls/35951/commits",
    "created_at": "2025-09-29T04:50:21Z",
    "diff_url": "https://github.com/neovim/neovim/pull/35951.diff",
    "draft": false,
    "head": {
        "label": "justinmk:fixtermevent",
        "ref": "fixtermevent",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/justinmk/neovim/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/justinmk/neovim/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/justinmk/neovim/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/justinmk/neovim/branches{/branch}",
            "clone_url": "https://github.com/justinmk/neovim.git",
            "collaborators_url": "https://api.github.com/repos/justinmk/neovim/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/justinmk/neovim/comments{/number}",
            "commits_url": "https://api.github.com/repos/justinmk/neovim/commits{/sha}",
            "compare_url": "https://api.github.com/repos/justinmk/neovim/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/justinmk/neovim/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/justinmk/neovim/contributors",
            "created_at": "2014-02-28T23:17:54Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/justinmk/neovim/deployments",
            "description": "somewhere in todo.txt",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/justinmk/neovim/downloads",
            "events_url": "https://api.github.com/repos/justinmk/neovim/events",
            "fork": true,
            "forks": 1,
            "forks_count": 1,
            "forks_url": "https://api.github.com/repos/justinmk/neovim/forks",
            "full_name": "justinmk/neovim",
            "git_commits_url": "https://api.github.com/repos/justinmk/neovim/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/justinmk/neovim/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/justinmk/neovim/git/tags{/sha}",
            "git_url": "git://github.com/justinmk/neovim.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": false,
            "has_wiki": false,
            "homepage": "http://neovim.io",
            "hooks_url": "https://api.github.com/repos/justinmk/neovim/hooks",
            "html_url": "https://github.com/justinmk/neovim",
            "id": 17302877,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/justinmk/neovim/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/justinmk/neovim/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/justinmk/neovim/issues{/number}",
            "keys_url": "https://api.github.com/repos/justinmk/neovim/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/justinmk/neovim/labels{/name}",
            "language": "Vim Script",
            "languages_url": "https://api.github.com/repos/justinmk/neovim/languages",
            "license": {
                "key": "other",
                "name": "Other",
                "node_id": "MDc6TGljZW5zZTA=",
                "spdx_id": "NOASSERTION",
                "url": null
            },
            "merges_url": "https://api.github.com/repos/justinmk/neovim/merges",
            "milestones_url": "https://api.github.com/repos/justinmk/neovim/milestones{/number}",
            "mirror_url": null,
            "name": "neovim",
            "node_id": "MDEwOlJlcG9zaXRvcnkxNzMwMjg3Nw==",
            "notifications_url": "https://api.github.com/repos/justinmk/neovim/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
                "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
                "followers_url": "https://api.github.com/users/justinmk/followers",
                "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
                "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/justinmk",
                "id": 1359421,
                "login": "justinmk",
                "node_id": "MDQ6VXNlcjEzNTk0MjE=",
                "organizations_url": "https://api.github.com/users/justinmk/orgs",
                "received_events_url": "https://api.github.com/users/justinmk/received_events",
                "repos_url": "https://api.github.com/users/justinmk/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/justinmk",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/justinmk/neovim/pulls{/number}",
            "pushed_at": "2025-11-17T06:36:05Z",
            "releases_url": "https://api.github.com/repos/justinmk/neovim/releases{/id}",
            "size": 339909,
            "ssh_url": "git@github.com:justinmk/neovim.git",
            "stargazers_count": 2,
            "stargazers_url": "https://api.github.com/repos/justinmk/neovim/stargazers",
            "statuses_url": "https://api.github.com/repos/justinmk/neovim/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/justinmk/neovim/subscribers",
            "subscription_url": "https://api.github.com/repos/justinmk/neovim/subscription",
            "svn_url": "https://github.com/justinmk/neovim",
            "tags_url": "https://api.github.com/repos/justinmk/neovim/tags",
            "teams_url": "https://api.github.com/repos/justinmk/neovim/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/justinmk/neovim/git/trees{/sha}",
            "updated_at": "2025-10-14T23:51:13Z",
            "url": "https://api.github.com/repos/justinmk/neovim",
            "visibility": "public",
            "watchers": 2,
            "watchers_count": 2,
            "web_commit_signoff_required": false
        },
        "sha": "3287b90a60b603bbaa2296eadf4f2bf0482b5c63",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
            "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
            "followers_url": "https://api.github.com/users/justinmk/followers",
            "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
            "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/justinmk",
            "id": 1359421,
            "login": "justinmk",
            "node_id": "MDQ6VXNlcjEzNTk0MjE=",
            "organizations_url": "https://api.github.com/users/justinmk/orgs",
            "received_events_url": "https://api.github.com/users/justinmk/received_events",
            "repos_url": "https://api.github.com/users/justinmk/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/justinmk",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/neovim/neovim/pull/35951",
    "id": 2869030509,
    "issue_url": "https://api.github.com/repos/neovim/neovim/issues/35951",
    "labels": [
        {
            "color": "c5def5",
            "default": false,
            "description": "Nvim defaults for options, colorscheme/theme, autocmds/events, etc.",
            "id": 103777064,
            "name": "defaults",
            "node_id": "MDU6TGFiZWwxMDM3NzcwNjQ=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/defaults"
        },
        {
            "color": "c5def5",
            "default": false,
            "description": "built-in :terminal or :shell",
            "id": 212696822,
            "name": "terminal",
            "node_id": "MDU6TGFiZWwyMTI2OTY4MjI=",
            "url": "https://api.github.com/repos/neovim/neovim/labels/terminal"
        }
    ],
    "locked": false,
    "merge_commit_sha": "c344dc3e2f7a9d419dbf736b6bc6deb5e064f60e",
    "merged_at": null,
    "milestone": null,
    "node_id": "PR_kwDOAPphoM6rAe5t",
    "number": 35951,
    "patch_url": "https://github.com/neovim/neovim/pull/35951.patch",
    "requested_reviewers": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/8965202?v=4",
            "events_url": "https://api.github.com/users/gpanders/events{/privacy}",
            "followers_url": "https://api.github.com/users/gpanders/followers",
            "following_url": "https://api.github.com/users/gpanders/following{/other_user}",
            "gists_url": "https://api.github.com/users/gpanders/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/gpanders",
            "id": 8965202,
            "login": "gpanders",
            "node_id": "MDQ6VXNlcjg5NjUyMDI=",
            "organizations_url": "https://api.github.com/users/gpanders/orgs",
            "received_events_url": "https://api.github.com/users/gpanders/received_events",
            "repos_url": "https://api.github.com/users/gpanders/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/gpanders/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/gpanders/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/gpanders",
            "user_view_type": "public"
        }
    ],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/neovim/neovim/pulls/comments{/number}",
    "review_comments_url": "https://api.github.com/repos/neovim/neovim/pulls/35951/comments",
    "state": "open",
    "statuses_url": "https://api.github.com/repos/neovim/neovim/statuses/3287b90a60b603bbaa2296eadf4f2bf0482b5c63",
    "title": "feat(terminal): jobstart() term:// buffer name",
    "updated_at": "2025-11-15T21:43:07Z",
    "url": "https://api.github.com/repos/neovim/neovim/pulls/35951",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/1359421?v=4",
        "events_url": "https://api.github.com/users/justinmk/events{/privacy}",
        "followers_url": "https://api.github.com/users/justinmk/followers",
        "following_url": "https://api.github.com/users/justinmk/following{/other_user}",
        "gists_url": "https://api.github.com/users/justinmk/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/justinmk",
        "id": 1359421,
        "login": "justinmk",
        "node_id": "MDQ6VXNlcjEzNTk0MjE=",
        "organizations_url": "https://api.github.com/users/justinmk/orgs",
        "received_events_url": "https://api.github.com/users/justinmk/received_events",
        "repos_url": "https://api.github.com/users/justinmk/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/justinmk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/justinmk/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/justinmk",
        "user_view_type": "public"
    }
}